{"version":3,"file":"lrn-math.umd.js","sources":["lrn-math.umd.js"],"sourcesContent":["import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport { FlattenedNodesObserver } from \"@polymer/polymer/lib/utils/flattened-nodes-observer.js\";\nimport { pathFromUrl } from \"@polymer/polymer/lib/utils/resolve-url.js\";\nimport \"@lrnwebcomponents/hax-body-behaviors/lib/HAXWiring.js\";\nimport \"@lrnwebcomponents/es-global-bridge/es-global-bridge.js\";\n/**\n * `lrn-math`\n * `An element for presenting Math based content.`\n *\n * @demo demo/index.html\n */\n\nlet LrnMath = Polymer({\n  _template: html`\n    <style>\n       :host {\n        display: inline;\n      }\n    </style>\n    [[prefix]] [[math]] [[suffix]]\n`,\n\n  is: \"lrn-math\",\n\n  behaviors: [HAXBehaviors.PropertiesBehaviors],\n\n  properties: {\n    /**\n     * Styling for targeting the math pre and post\n     */\n    prefix: {\n      type: String,\n      value: \"$$\"\n    },\n    suffix: {\n      type: String,\n      value: \"$$\"\n    },\n    /**\n     * display the math inline\n     */\n    inline: {\n      type: Boolean,\n      value: true,\n      reflectToAttribute: true\n    },\n    /**\n     * The math to get rendered.\n     */\n    math: {\n      type: String\n    },\n    /**\n     * backdown to inject text\n     */\n    mathText: {\n      type: String,\n      observer: \"_mathChanged\"\n    }\n  },\n\n  observers: [\"_inlineChanged(inline)\"],\n\n  /**\n   * Modify pre and suffix if inline is set\n   */\n  _inlineChanged: function(inline) {\n    if (inline) {\n      this.prefix = \"\\\\(\";\n      this.suffix = \"\\\\)\";\n    }\n  },\n\n  /**\n   * Notice math changed, update slot.\n   */\n  _mathChanged: function(newValue, oldValue) {\n    if (newValue !== oldValue) {\n      while (dom(this).firstChild !== null) {\n        dom(this).removeChild(dom(this).firstChild);\n      }\n      let frag = document.createTextNode(newValue);\n      dom(this).appendChild(frag);\n    }\n  },\n\n  /**\n   * Attached life cycle\n   */\n  attached: function() {\n    // Establish hax properties if they exist\n    let props = {\n      canScale: true,\n      canPosition: true,\n      canEditSource: true,\n      gizmo: {\n        title: \"Math\",\n        description: \"Present math in a nice looking way.\",\n        icon: \"places:all-inclusive\",\n        color: \"grey\",\n        groups: [\"Content\"],\n        handles: [\n          {\n            type: \"math\",\n            math: \"mathText\"\n          },\n          {\n            type: \"inline\",\n            text: \"mathText\"\n          }\n        ],\n        meta: {\n          author: \"LRNWebComponents\"\n        }\n      },\n      settings: {\n        quick: [\n          {\n            property: \"inline\",\n            title: \"Inline\",\n            description: \"Display this math inline\",\n            inputMethod: \"boolean\",\n            icon: \"remove\"\n          }\n        ],\n        configure: [\n          {\n            property: \"mathText\",\n            title: \"Math\",\n            description: \"Math\",\n            inputMethod: \"textfield\",\n            icon: \"editor:format-quote\"\n          },\n          {\n            property: \"inline\",\n            title: \"Inline\",\n            description: \"Display this math inline\",\n            inputMethod: \"boolean\",\n            icon: \"remove\"\n          }\n        ],\n        advanced: []\n      }\n    };\n    this.setHaxProperties(props);\n    const name = \"mathjax\";\n    const basePath = pathFromUrl(import.meta.url);\n    const location = `${basePath}lib/mathjax/latest.js`;\n    window.addEventListener(\n      `es-bridge-${name}-loaded`,\n      this._mathjaxLoaded.bind(this)\n    );\n    window.ESGlobalBridge.requestAvailability();\n    window.ESGlobalBridge.instance.load(name, location);\n  },\n  /**\n   * Notice changes to the slot and reflect these to the math value\n   * so that we can render it to the page.\n   */\n  _mathjaxLoaded: function() {\n    this._observer = new FlattenedNodesObserver(this, info => {\n      this.math = info.addedNodes.map(node => node.textContent).toString();\n      window.MathJax.Hub.Config({\n        skipStartupTypeset: true,\n        jax: [\"input/TeX\", \"output/HTML-CSS\"],\n        messageStyle: \"none\",\n        tex2jax: {\n          preview: \"none\"\n        }\n      });\n      window.MathJax.Hub.Queue([\"Typeset\", window.MathJax.Hub, \"lrn-math\"]);\n    });\n  }\n});\nexport { LrnMath };\n"],"names":["LrnMath","Polymer","_template","html","is","behaviors","HAXBehaviors","PropertiesBehaviors","properties","prefix","type","String","value","suffix","inline","Boolean","reflectToAttribute","math","mathText","observer","observers","_inlineChanged","_mathChanged","newValue","oldValue","dom","this","firstChild","removeChild","frag","document","createTextNode","appendChild","attached","setHaxProperties","canScale","canPosition","canEditSource","gizmo","title","description","icon","color","groups","handles","text","meta","author","settings","quick","property","inputMethod","configure","advanced","basePath","pathFromUrl","location","window","addEventListener","_mathjaxLoaded","bind","ESGlobalBridge","requestAvailability","instance","load","_observer","FlattenedNodesObserver","info","_this","addedNodes","map","node","textContent","toString","MathJax","Hub","Config","skipStartupTypeset","jax","messageStyle","tex2jax","preview","Queue"],"mappings":"2qCAaIA,EAAUC,UAAQ,CACpBC,UAAWC,YASXC,GAAI,WAEJC,UAAW,CAACC,aAAaC,qBAEzBC,WAAY,CAIVC,OAAQ,CACNC,KAAMC,OACNC,MAAO,MAETC,OAAQ,CACNH,KAAMC,OACNC,MAAO,MAKTE,OAAQ,CACNJ,KAAMK,QACNH,OAAO,EACPI,oBAAoB,GAKtBC,KAAM,CACJP,KAAMC,QAKRO,SAAU,CACRR,KAAMC,OACNQ,SAAU,iBAIdC,UAAW,CAAC,0BAKZC,eAAgB,SAASP,GACnBA,SACGL,OAAS,WACTI,OAAS,QAOlBS,aAAc,SAASC,EAAUC,MAC3BD,IAAaC,EAAU,MACO,OAAzBC,MAAIC,MAAMC,YACfF,MAAIC,MAAME,YAAYH,MAAIC,MAAMC,gBAE9BE,EAAOC,SAASC,eAAeR,GACnCE,MAAIC,MAAMM,YAAYH,KAO1BI,SAAU,gBAuDHC,iBArDO,CACVC,UAAU,EACVC,aAAa,EACbC,eAAe,EACfC,MAAO,CACLC,MAAO,OACPC,YAAa,sCACbC,KAAM,uBACNC,MAAO,OACPC,OAAQ,CAAC,WACTC,QAAS,CACP,CACElC,KAAM,OACNO,KAAM,YAER,CACEP,KAAM,SACNmC,KAAM,aAGVC,KAAM,CACJC,OAAQ,qBAGZC,SAAU,CACRC,MAAO,CACL,CACEC,SAAU,SACVX,MAAO,SACPC,YAAa,2BACbW,YAAa,UACbV,KAAM,WAGVW,UAAW,CACT,CACEF,SAAU,WACVX,MAAO,OACPC,YAAa,OACbW,YAAa,YACbV,KAAM,uBAER,CACES,SAAU,SACVX,MAAO,SACPC,YAAa,2BACbW,YAAa,UACbV,KAAM,WAGVY,SAAU,UAKRC,EAAWC,8LACXC,YAAcF,2BACpBG,OAAOC,qCAHM,qBAKXhC,KAAKiC,eAAeC,KAAKlC,OAE3B+B,OAAOI,eAAeC,sBACtBL,OAAOI,eAAeE,SAASC,KARlB,UAQ6BR,IAM5CG,eAAgB,2BACTM,UAAY,IAAIC,yBAAuBxC,KAAM,SAAAyC,GAChDC,EAAKnD,KAAOkD,EAAKE,WAAWC,IAAI,SAAAC,UAAQA,EAAKC,cAAaC,WAC1DhB,OAAOiB,QAAQC,IAAIC,OAAO,CACxBC,oBAAoB,EACpBC,IAAK,CAAC,YAAa,mBACnBC,aAAc,OACdC,QAAS,CACPC,QAAS,UAGbxB,OAAOiB,QAAQC,IAAIO,MAAM,CAAC,UAAWzB,OAAOiB,QAAQC,IAAK"}