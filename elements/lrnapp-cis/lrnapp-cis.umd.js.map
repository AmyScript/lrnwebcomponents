{"version":3,"file":"lrnapp-cis.umd.js","sources":["lib/lrnapp-cis-course-card.js","lrnapp-cis.umd.js"],"sourcesContent":["import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nimport \"@polymer/paper-card/paper-card.js\";\nimport \"@polymer/iron-image/iron-image.js\";\nimport \"@lrnwebcomponents/lrndesign-avatar/lrndesign-avatar.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\n/*\n `lrnapp-cis-course-card`\n Present a course card\n*/\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\"></style>\n    <style>\n       :host {\n        display: inline-flex;\n      }\n      :host([size=\"micro\"]) {\n        transform: scale(.5);\n      }\n      :host([size=\"small\"]) {\n        transform: scale(.8);\n      }\n\n      paper-card {\n        border-radius: 4px;\n        margin: 0;\n        width: 100%;\n      }\n\n      .card-actions {\n        background-color: #f5f5f5;\n        border-radius: 0 0 4px 4px;\n        padding: 0 8px;\n      }\n      .card-actions .card-action-details{\n        display: inline-block;\n        vertical-align: middle;\n        vertical-align: -webkit-baseline-middle;\n        width: 80%;\n      }\n      #avatar {\n        display: inline-block;\n        vertical-align: text-top;\n        transform: scale(.8);\n      }\n\n      .card-control-height {\n        height: 240px;\n      }\n\n      [elevation=\"0\"] {\n        border: solid 1px #EEEEEE;\n      }\n\n      .text-right {\n        text-align: right;\n      }\n\n      .text-left {\n        text-align: left;\n      }\n\n      .name, .title {\n        color: #222;\n        font-size: 12.8px;\n        font-weight: 600;\n        line-height: 20px;\n        padding: 0 12px;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        margin-top: 8px;\n      }\n\n      .title {\n        font-size: 11.2px;\n        font-weight: 400;\n      }\n\n      .divider {\n        height: 1px;\n        width: 100%;\n        background: #efefef;\n      }\n\n      .course-icon {\n        --iron-icon-height: 100%;\n        --iron-icon-width: 100%;\n        overflow: hidden;\n        color: grey;\n      }\n      .course-icon:hover,\n      .course-icon:focus {\n        color: black;\n      }\n\n      .center {\n        margin: auto;\n        width: 80%;\n        padding: 16px;\n      }\n\n      .link {\n        font-size: 16px;\n        line-height: 16px;\n      }\n\n      .course-info {\n        width: 100%;\n      }\n      .course-preview {\n        height: 160px;\n      }\n      lrndesign-avatar {\n        margin: -16px 8px 0 0;\n        position: absolute;\n        right: 0;\n      }\n\n      .card-content {\n        padding: 0;\n        margin: 0;\n        overflow: hidden;\n      }\n\n      .inline {\n        display: inline;\n      }\n\n    </style>\n    <paper-card elevation=\"[[elevation]]\">\n      <div class=\"card-content card-control-height card-control-center\">\n        <div class=\"course-preview\">\n          <iron-icon class=\"course-icon\" icon=\"[[icon]]\" hidden\\$=\"[[!icon]]\"></iron-icon>\n          <iron-image style=\"width:100%; height:100%; background-color: lightgray;\" sizing=\"cover\" preload=\"\" fade=\"\" src=\"[[image]]\" hidden\\$=\"[[!image]]\"></iron-image>\n        </div>\n        <lrndesign-avatar label=\"[[name]]\" jdenticon=\"\" color=\"[[color]] darken-4\">\n        </lrndesign-avatar>\n        <div class=\"course-info\">\n          <div class=\"divider\"></div>\n          <div class=\"name\">[[name]]</div>\n          <div class=\"title\">[[title]]</div>\n        </div>\n      </div>\n      <div class=\"card-actions\" hidden=\"\">\n        <div class=\"card-action-details\">\n        </div>\n      </div>\n    </paper-card>\n`,\n\n  is: \"lrnapp-cis-course-card\",\n\n  listeners: {\n    mouseenter: \"_mouseEnter\",\n    mouseleave: \"_mouseLeave\"\n  },\n\n  properties: {\n    size: {\n      type: String\n    },\n    /**\n     * Cover image src.\n     */\n    image: {\n      type: String\n    },\n    /**\n     * Icon to use if image isn't there.\n     */\n    icon: {\n      type: String,\n      value: false\n    },\n    /**\n     * name of the course like sing100\n     */\n    name: {\n      type: String,\n      value: \"\"\n    },\n    /**\n     * title of the course like Intro to studies\n     */\n    title: {\n      type: String,\n      value: \"\"\n    },\n    /**\n     * color of the course item\n     */\n    color: {\n      type: String,\n      value: \"grey\"\n    },\n    /**\n     * Visual elevation of the item off the UI via paper element height\n     */\n    elevation: {\n      type: Number,\n      value: 1,\n      reflectToAttribute: true\n    }\n  },\n\n  /**\n   * Increase elevation while hovering.\n   */\n  _mouseEnter: function(e) {\n    this.__oldElevation = this.elevation;\n    if (this.elevation + 2 > 5) {\n      this.elevation = 5;\n    } else {\n      this.elevation += 2;\n    }\n  },\n\n  /**\n   * Reset the elevation.\n   */\n  _mouseLeave: function(e) {\n    this.elevation = this.__oldElevation;\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/iron-pages/iron-pages.js\";\nimport \"@polymer/iron-list/iron-list.js\";\nimport \"@polymer/iron-selector/iron-selector.js\";\nimport \"@polymer/paper-toast/paper-toast.js\";\nimport \"@polymer/paper-styles/paper-styles.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@polymer/paper-listbox/paper-listbox.js\";\nimport \"@polymer/paper-dropdown-menu/paper-dropdown-menu.js\";\nimport \"@polymer/paper-item/paper-item.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@polymer/app-route/app-location.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"./lib/lrnapp-cis-course-card.js\";\n/**\n`lrnapp-cis`\nA learning application for visualizing course information and listing.\n\n@demo ../../demo/index.html\n\n@microcopy - the mental model for this app\n - cis - Course Information System\n -\n -\n\n*/\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\"></style>\n    <style>\n      :host {\n        display: block;\n        align-content: center;\n      }\n      #loading {\n        width: 100%;\n        z-index: 1000;\n        opacity: .8;\n        text-align: center;\n        align-content: center;\n        justify-content: center;\n        height: 100vh;\n        position: absolute;\n        background-color: white;\n      }\n      iron-selector {\n        line-height: 16px;\n      }\n      iron-selector lrnsys-button {\n        display: inline-flex;\n      }\n      paper-button.coursecard-wrapper {\n        margin: 0;\n        padding: 0;\n      }\n      lrnapp-cis-course-card {\n        padding: 0;\n        margin: 16px;\n        height: 240px;\n        width: 224px;\n      }\n      .courses-grid {\n        margin: 0 auto;\n        width: 95%;\n      }\n      .iron-selected .display-mode {\n        background-color: #ff6f00;\n        color: white;\n      }\n      .iron-list-container {\n        display: flex;\n        flex-direction: column;\n        min-height:50vh;\n      }\n      iron-list {\n        flex: 1 1 auto;\n      }\n    </style>\n    <iron-ajax auto=\"\" url=\"[[sourcePath]]\" params=\"\" handle-as=\"json\" last-response=\"{{cisResponse}}\" on-response=\"_handleResponse\"></iron-ajax>\n\n    <app-location route=\"{{route}}\" query-params=\"{{queryParams}}\"></app-location>\n    <app-route route=\"{{route}}\" pattern=\"[[endPoint]]/:page\" data=\"{{data}}\" tail=\"{{tail}}\" query-params=\"{{queryParams}}\">\n    </app-route>\n\n    <div id=\"loading\">\n      <h3>Loading..</h3>\n      <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n    </div>\n    <app-toolbar class=\"\">\n      <span main-title=\"\"></span>\n      <span top-item=\"\" style=\"text-align:right;font-size:8px;padding-right:16px;\">Displaying [[courses.length]] of [[originalCourses.length]]</span>\n      <paper-dropdown-menu label=\"Course\" hidden\\$=\"[[!courses]]\">\n        <paper-listbox slot=\"dropdown-content\" class=\"dropdown-content\" selected=\"{{queryParams.course}}\" attr-for-selected=\"item-id\">\n          <paper-item></paper-item>\n          <template is=\"dom-repeat\" items=\"[[_toArray(courses)]]\" as=\"course\">\n          <paper-item item-id=\"[[course.id]]\">[[course.data.name]]</paper-item>\n          </template>\n        </paper-listbox>\n      </paper-dropdown-menu>\n      <paper-dropdown-menu label=\"Program\" hidden\\$=\"[[!programs]]\">\n        <paper-listbox slot=\"dropdown-content\" class=\"dropdown-content\" selected=\"{{queryParams.program}}\" attr-for-selected=\"item-id\">\n          <paper-item></paper-item>\n        <template is=\"dom-repeat\" items=\"[[_toArray(programs)]]\" as=\"program\">\n          <paper-item item-id=\"[[program.id]]\">[[program.data.name]]</paper-item>\n        </template>\n        </paper-listbox>\n      </paper-dropdown-menu>\n      <paper-dropdown-menu label=\"Academic home\" hidden\\$=\"[[!academics]]\">\n        <paper-listbox slot=\"dropdown-content\" class=\"dropdown-content\" selected=\"{{queryParams.academic}}\" attr-for-selected=\"item-id\">\n          <paper-item></paper-item>\n        <template is=\"dom-repeat\" items=\"[[_toArray(academics)]]\" as=\"academic\">\n          <paper-item item-id=\"[[academic.id]]\">[[academic.data.name]]</paper-item>\n        </template>\n        </paper-listbox>\n      </paper-dropdown-menu>\n    </app-toolbar>\n    <div class=\"courses-grid\">\n    <iron-pages selected=\"{{data.page}}\" attr-for-selected=\"name\" fallback-selection=\"courses\" role=\"main\">\n      <div class=\"iron-list-container\" name=\"courses\">\n        <iron-list items=\"[[courses]]\" as=\"course\" grid=\"\">\n          <template>\n          <paper-button data-course-id\\$=\"[[course.id]]\" class=\"coursecard-wrapper\" on-tap=\"_loadCourseUrl\">\n            <lrnapp-cis-course-card elevation=\"2\" data-course-id\\$=\"[[course.id]]\" name=\"[[course.data.name]]\" image=\"[[course.data.image]]\" title=\"[[course.data.title]]\" color=\"[[course.data.color]]\">\n            </lrnapp-cis-course-card>\n          </paper-button>\n          </template>\n        </iron-list>\n      </div>\n    </iron-pages>\n    </div>\n    <paper-toast id=\"toast\"></paper-toast>\n`,\n\n  is: \"lrnapp-cis\",\n\n  properties: {\n    /**\n     * The cisResponse from server\n     */\n    cisResponse: {\n      type: Object\n    },\n    /**\n     * The courses to render; potentially filtered\n     */\n    courses: {\n      type: Array,\n      computed: \"_coursesCompute(originalCourses, queryParams)\"\n    },\n    /**\n     * The original courses array; used to filter against\n     */\n    originalCourses: {\n      type: Array\n    },\n    /**\n     * The courses to render\n     */\n    courses: {\n      type: Array,\n      value: []\n    },\n    /**\n     * The programs to render\n     */\n    programs: {\n      type: Array,\n      value: []\n    },\n    /**\n     * The academics to render\n     */\n    academics: {\n      type: Array,\n      value: []\n    },\n    /**\n     * sourcePath for data.\n     */\n    sourcePath: {\n      type: String\n    },\n    /**\n     * Endpoint for data.\n     */\n    endPoint: {\n      type: String,\n      value: \"/\"\n    },\n    /**\n     * base path for the app\n     */\n    basePath: {\n      type: String,\n      value: \"/\"\n    },\n    /**\n     * Active / clicked course.\n     */\n    activeCourse: {\n      type: String,\n      value: null\n    },\n    queryParams: {\n      type: Object,\n      notify: true\n    },\n    _blockcycle: {\n      type: Boolean,\n      value: false\n    }\n  },\n\n  listeners: {\n    \"route-change\": \"_routeChange\"\n  },\n\n  observers: [\"_routeChanged(route, endPoint)\"],\n\n  // If the current route is outside the scope of our app\n  // then allow the website to break out of the single page\n  // application routing\n  _routeChanged: function(route, endPoint) {\n    if (typeof route.path === \"string\") {\n      if (typeof endPoint === \"string\") {\n        if (route.path.startsWith(endPoint)) {\n          return;\n        }\n      }\n      // reload the page which since route changed will load that page\n      window.location.reload();\n    }\n  },\n\n  /**\n   * Change route from deeper in the app.\n   */\n  _routeChange: function(e) {\n    var details = e.detail;\n    if (typeof details.queryParams.course !== typeof undefined) {\n      this.set(\"queryParams.course\", details.queryParams.course);\n    }\n    if (typeof details.queryParams.academic !== typeof undefined) {\n      this.set(\"queryParams.academic\", details.queryParams.academic);\n    }\n    if (typeof details.queryParams.program !== typeof undefined) {\n      this.set(\"queryParams.program\", details.queryParams.program);\n    }\n    if (typeof details.data.page !== typeof undefined) {\n      this.set(\"data.page\", details.data.page);\n    }\n  },\n\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  },\n\n  /**\n   * Handle response for the whole courses object.\n   */\n  _handleResponse: function(event) {\n    var course = {};\n    var program = {};\n    var academic = {};\n    var tmp = {\n      courses: [],\n      programs: [],\n      academics: []\n    };\n    var programs = [];\n    var academics = [];\n    // get the CIS response's data and convert to array ahead of time\n    var courses = this._toArray(this.cisResponse.data.courses);\n    // original = active off the bat then we apply filters later to chang this\n    this.set(\"originalCourses\", courses);\n    // figure out courses, programs and academics\n    for (var index = 0; index < courses.length; index++) {\n      course = courses[index];\n      program = courses[index].relationships.program;\n      academic = courses[index].relationships.academic;\n      tmp.programs[program.id] = program;\n      tmp.academics[academic.id] = academic;\n      tmp.courses[course.id] = course;\n    }\n    // this is stupid but we have to normalize the IDs or else dom repeats will be screwed up\n    tmp.programs.forEach(function(element) {\n      programs.push(element);\n    });\n    // this is stupid but we have to normalize the IDs or else dom repeats will be screwed up\n    tmp.academics.forEach(function(element) {\n      academics.push(element);\n    });\n    this.$.loading.hidden = true;\n    this.set(\"academics\", academics);\n    this.set(\"programs\", programs);\n    this.set(\"courses\", courses);\n  },\n\n  /**\n   * Handle tap on paper-button above to redirect to the correct course url.\n   */\n  _loadCourseUrl: function(e) {\n    let root = this;\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // this will have the id of the current course\n    var active = local.getAttribute(\"data-course-id\");\n    // find the course by it's unique id and filter just to it\n    let findCourse = this.originalCourses.filter(course => {\n      if (course.id !== active) {\n        return false;\n      }\n      return true;\n    });\n    // if we found one, make it the top level item\n    if (findCourse.length > 0) {\n      findCourse = findCourse.pop();\n    }\n    // double check we have a URI\n    if (typeof findCourse.data.uri !== typeof undefined) {\n      window.location.href = findCourse.data.uri;\n    }\n  },\n\n  /**\n   * Compute the active list of courses\n   */\n  _coursesCompute: function(originalCourses, queryParams) {\n    console.log(originalCourses);\n    console.log(queryParams);\n    // if we don't have an original courses object to work with then we need to bail\n    if (typeof originalCourses === \"undefined\") {\n      return [];\n    }\n    // define vars\n    const root = this;\n    let filteredCourses = [];\n    // filter the courses by the query params\n    filteredCourses = originalCourses.filter(course => {\n      if (typeof root.queryParams.course !== \"undefined\") {\n        if (course.id !== root.queryParams.course) {\n          return false;\n        }\n      }\n      if (typeof root.queryParams.program !== \"undefined\") {\n        if (course.relationships.program.id !== root.queryParams.program) {\n          return false;\n        }\n      }\n      if (typeof root.queryParams.academic !== \"undefined\") {\n        if (course.relationships.academic.id !== root.queryParams.academic) {\n          return false;\n        }\n      }\n      return true;\n    });\n    // delay and repaint, can help with refresh issues\n    setTimeout(() => {\n      document.querySelector(\"iron-list\").fire(\"iron-resize\");\n    }, 200);\n    return filteredCourses;\n  }\n});\n"],"names":["_template","html","is","listeners","mouseenter","mouseleave","properties","size","type","String","image","icon","value","name","title","color","elevation","Number","reflectToAttribute","_mouseEnter","e","__oldElevation","this","_mouseLeave","cisResponse","Object","courses","Array","computed","originalCourses","notify","Boolean","observers","_routeChanged","route","endPoint","path","startsWith","window","location","reload","_routeChange","details","detail","_typeof","queryParams","course","set","academic","program","data","page","_toArray","obj","keys","map","key","_handleResponse","event","tmp","programs","academics","index","length","relationships","id","forEach","element","push","$","loading","hidden","_loadCourseUrl","active","dom","localTarget","getAttribute","findCourse","filter","pop","uri","href","_coursesCompute","console","log","filteredCourses","root","setTimeout","document","querySelector","fire"],"mappings":"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"}