!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@polymer/polymer/polymer-legacy.js"),require("@polymer/iron-icons/iron-icons.js"),require("@polymer/iron-icons/hardware-icons.js"),require("@polymer/iron-ajax/iron-ajax.js"),require("@polymer/paper-icon-button/paper-icon-button.js"),require("@polymer/paper-styles/color.js"),require("@lrnwebcomponents/paper-search/paper-search-bar.js"),require("@polymer/paper-tooltip/paper-tooltip.js"),require("@polymer/paper-slider/paper-slider.js"),require("@polymer/app-layout/app-layout.js"),require("@polymer/app-layout/app-drawer/app-drawer.js"),require("@polymer/app-layout/app-header/app-header.js"),require("@polymer/app-layout/app-toolbar/app-toolbar.js"),require("@polymer/app-layout/app-scroll-effects/app-scroll-effects.js"),require("@polymer/app-route/app-location.js"),require("@polymer/app-route/app-route.js"),require("@lrnwebcomponents/materializecss-styles/materializecss-styles.js"),require("@lrnwebcomponents/lrndesign-stepper/lrndesign-stepper.js"),require("@lrnwebcomponents/lrnsys-progress/lrnsys-progress.js"),require("@lrnwebcomponents/elmsln-loading/elmsln-loading.js"),require("@lrnwebcomponents/page-scroll-position/page-scroll-position.js"),require("@lrnwebcomponents/hax-body/hax-body.js"),require("@lrnwebcomponents/material-progress/material-progress.js"),require("@lrnwebcomponents/lrndesign-mapmenu/lrndesign-mapmenu.js"),require("@polymer/polymer/lib/legacy/polymer.dom.js"),require("@polymer/polymer/lib/mixins/element-mixin.js"),require("paper-search/paper-search-bar.js")):"function"==typeof define&&define.amd?define(["@polymer/polymer/polymer-legacy.js","@polymer/iron-icons/iron-icons.js","@polymer/iron-icons/hardware-icons.js","@polymer/iron-ajax/iron-ajax.js","@polymer/paper-icon-button/paper-icon-button.js","@polymer/paper-styles/color.js","@lrnwebcomponents/paper-search/paper-search-bar.js","@polymer/paper-tooltip/paper-tooltip.js","@polymer/paper-slider/paper-slider.js","@polymer/app-layout/app-layout.js","@polymer/app-layout/app-drawer/app-drawer.js","@polymer/app-layout/app-header/app-header.js","@polymer/app-layout/app-toolbar/app-toolbar.js","@polymer/app-layout/app-scroll-effects/app-scroll-effects.js","@polymer/app-route/app-location.js","@polymer/app-route/app-route.js","@lrnwebcomponents/materializecss-styles/materializecss-styles.js","@lrnwebcomponents/lrndesign-stepper/lrndesign-stepper.js","@lrnwebcomponents/lrnsys-progress/lrnsys-progress.js","@lrnwebcomponents/elmsln-loading/elmsln-loading.js","@lrnwebcomponents/page-scroll-position/page-scroll-position.js","@lrnwebcomponents/hax-body/hax-body.js","@lrnwebcomponents/material-progress/material-progress.js","@lrnwebcomponents/lrndesign-mapmenu/lrndesign-mapmenu.js","@polymer/polymer/lib/legacy/polymer.dom.js","@polymer/polymer/lib/mixins/element-mixin.js","paper-search/paper-search-bar.js"],e):e(n.polymerLegacy_js,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,n.polymer_dom_js,n.elementMixin_js)}(this,function(n,e,t,a,i,o,s,r,l,p,d,c,h,m,u,g,b,y,v,x,f,w,j,P,k,z){"use strict";function _(n){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function q(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function D(){var n=q(['\n    <style include="materializecss-styles"></style>\n    <style>\n      :host {\n        display: block;\n      }\n      paper-progress {\n        --paper-progress-active-color: var(--paper-blue-300, blue);\n        --paper-progress-secondary-color: var(--paper-yellow-300, yellow);\n        --paper-progress-container-color: var(--paper-green-300, green);\n        height: 1.5em;\n        display: inline-block;\n        vertical-align: text-top;\n      }\n      lrndesign-avatar {\n        display: inline-block;\n      }\n      lrnsys-progress-circle {\n        font-size: 4em;\n      }\n      .progress-icon {\n        height: 2.5em;\n        width: 2.5em;\n        padding: .25em;\n        display: inline-block;\n        color: white;\n        background-color: var(--paper-gray-300, gray);\n        border-radius: 50%;\n      }\n      .progress-row {\n        display: block;\n        width: 100%;\n      }\n      .progress-left,\n      .progress-right {\n        padding: 1em;\n        display: inline-block;\n        height: 10em;\n        vertical-align: text-top;\n      }\n      material-progress-histo {\n        width: 100%;\n        @apply(--paper-font-body2);\n      }\n      material-progress-bars {\n        width: 100%;\n        @apply(--paper-font-body2);\n      }\n      material-progress-bars > .bar > span {\n        text-align: end;\n        font-size: 0.9em;\n        @apply(--layout-flex);\n      }\n      .bar {\n        background-color: var(--paper-deep-orange-500);\n      }\n      .bar.run {\n        background-color: var(--paper-purple-500);\n      }\n      .bar.hello {\n        background-color: var(--paper-cyan-500);\n      }\n      .bar.world {\n        background-color: var(--paper-orange-500);\n      }\n    </style>\n    <iron-ajax id="dataajax" url="[[sourcePath]]" params="[[requestParams]]" handle-as="json" on-response="handleDataResponse" last-response="{{readTimeData}}"></iron-ajax>\n\n    <div id="bodyloading" class="loading">\n      <elmsln-loading color="grey-text" size="large"></elmsln-loading>\n      <h3 class="loading-text">Loading content..</h3>\n    </div>\n    <div>\n    <material-progress-bars max="128" bar-height="22" animated="">\n      <div class="bar" data-value="21">\n        <iron-icon icon="av:video-library"></iron-icon>\n      </div>\n      <div class="bar run" data-value="13">\n        <iron-icon icon="maps:directions-run"></iron-icon>\n      </div>\n      <div class="bar hello" data-value="50">\n        <iron-icon icon="maps:directions-bike"></iron-icon>\n        <span>Hello</span>\n      </div>\n      <div class="bar world" data-value="30">\n        <span>World</span>\n      </div>\n    </material-progress-bars>\n    <material-progress-histo bar-height="22" animated="">\n      <div class="bar" data-value="21">\n        <iron-icon icon="maps:directions-walk"></iron-icon>\n      </div>\n      <div class="bar run" data-value="13">\n        <iron-icon icon="maps:directions-run"></iron-icon>\n      </div>\n      <div class="bar hello" data-value="50">\n        <iron-icon icon="maps:directions-bike"></iron-icon>\n        <span>Hello</span>\n      </div>\n      <div class="bar world" data-value="30">\n        <span>World</span>\n      </div>\n    </material-progress-histo>\n    <template is="dom-repeat" items="[[dashboardItems]]" as="item">\n      <div class="progress-row">\n        <div class="progress-left">\n          <lrnsys-progress-circle status="disabled" class="flex" icon="[[item.meta.icon]]"></lrnsys-progress-circle>\n        </div>\n        <div class="progress-right">\n          <h3 class="progress-item-title">[[item.attributes.title]]</h3>\n          <div class="description-content">\n            <div>\n              <lrn-icon icon="network" class="progress-icon"></lrn-icon>\n              <paper-progress value="70" secondary-progress="80"></paper-progress>\n            </div>\n            <div>\n              <lrndesign-avatar src="[[userData.user.avatar]]" label="[[userData.user.display_name]]"></lrndesign-avatar>\n              <paper-progress value="70" secondary-progress="80"></paper-progress>\n            </div>\n          </div>\n        </div>\n      </div>\n    </template>\n    </div>\n']);return D=function(){return n},n}function $(){var n=q(['\n    <style include="materializecss-styles"></style>\n    <style>\n      :host {\n        display: block;\n        font-size: 1em;\n        box-sizing: content-box;\n      }\n      #toolbar {\n        color: gray;\n        background-color: white;\n        padding: 0 .5em;\n        margin: 0;\n        height: auto;\n        box-sizing: content-box;\n        transition: all .4s ease;\n      }\n      paper-button {\n        padding: 0;\n        margin: 0;\n        min-width: 1rem;\n      }\n\n      hax-panel ::shadow app-drawer {\n        padding: 0;\n        top: 0;\n        bottom: 0;\n        position: absolute;\n        box-sizing: content-box;\n        margin-left: -300px;\n        --app-drawer-content-container: {\n          background-color: #fafafa;\n          padding: 0;\n          border-right: 1px solid #c8c8c8;\n          overflow: inherit;\n          width: 300px !important;\n        }\n      }\n      app-drawer {\n        padding: 0;\n        top: 0;\n        bottom: 0;\n        z-index: 1;\n        position: absolute;\n        box-sizing: content-box;\n        --app-drawer-content-container: {\n          background-color: #fafafa;\n          padding: 0;\n          border-right: 1px solid #c8c8c8;\n          overflow-y: scroll;\n          width: 300px !important;\n          box-shadow: 0 76px 8px 0 rgba(0, 0, 0, 0.4);\n          height: 100vh;\n          top: 0;\n          position: sticky;\n        }\n      }\n      hax-panel {\n        font-size: .8rem;\n      }\n      hax-panel {\n      --app-drawer-content-container: {\n          background-color: #fafafa;\n          padding: 0;\n          border-right: 1px solid #c8c8c8;\n          overflow-y: scroll;\n          width: 300px !important;\n          box-shadow: 0 76px 8px 0 rgba(0, 0, 0, 0.4);\n          height: 100vh;\n          top: 0;\n          position: sticky;\n        }\n      }\n\n      lrndesign-stepper-button {\n        --lrndesign-stepper-btn-active: #f6f7f7;\n      }\n      lrndesign-stepper-button ::shadow paper-button {\n        margin: 0;\n        height: 3em;\n      }\n      lrndesign-stepper-button ::shadow .title-container.lrndesign-stepper-button {\n        padding: 0;\n        width: 100%;\n        right: unset;\n      }\n      lrndesign-stepper-button ::shadow .node-title.lrndesign-stepper-button {\n        font-size: .9em;\n        line-height: 1.5em;\n      }\n\n      .loading {\n        width: 100%;\n        z-index: 1000;\n        opacity: .9;\n        text-align: center;\n        align-content: space-around;\n        justify-content: center;\n        position: absolute;\n        background-color: white;\n        padding: 0;\n        margin: 0;\n        display: flex;\n        margin: 0 auto;\n        visibility: visible;\n        transition: visibility 1s, opacity 1s ease;\n      }\n      .loading elmsln-loading {\n        margin: 0 5em;\n        display: inline-flex;\n      }\n      #bodyloading {\n        height: 100%;\n        display: flex;\n        justify-content: center;\n      }\n      #bodyloading .loading,\n      #bodyloading elmsln-loading{\n        display: block;\n        height: 5em;\n      }\n      .outline-title {\n        margin-left: .5em;\n        max-width: 50%;\n      }\n      .content-nav-buttons {\n        top: 60%;\n        position: fixed;\n        opacity: .8;\n        padding: 0 .25em;\n        height: 40%;\n        padding-top: 15%;\n        margin-top: -15%;\n      }\n      .content-nav-buttons:hover {\n        opacity: 1;\n      }\n      .prev {\n        left: 0;\n        order: 1;\n      }\n      .next {\n        right: 0;\n        transition: right .2s ease;\n        order: 2;\n      }\n      app-header {\n        width: 100%;\n        left: 0 !important;\n        z-index: 2 !important;\n        position: sticky !important;\n      }\n      app-header-layout {\n        margin: 0;\n        padding: 0;\n        width: 100%;\n      }\n      .content-body {\n        position: relative;\n        padding: 0;\n        margin: -3em 4em 5em 4em;\n        font-size: 1.1em;\n        transition:\n          margin .4s ease,\n          width .4s ease;\n      }\n\n      .content-nav-buttons paper-icon-button {\n        width: 4em;\n        height: 4em;\n        opacity: .4;\n        display: block;\n        visibility: visible;\n        transition:\n          opacity .4s linear,\n          visibility 1s linear,\n          height .4s ease,\n          width .4s ease;\n      }\n      .content-nav-buttons paper-icon-button:hover {\n        opacity: 1;\n      }\n      paper-tooltip {\n        --paper-tooltip-opacity: .96;\n      }\n      :host([drawer-opened]) .content-nav-buttons paper-icon-button {\n        width: 2.5em;\n        height: 2.5em;\n      }\n      :host([edit-mode]) .content-nav-buttons {\n        opacity: 0;\n        pointer-events: none;\n        visibility: hidden;\n      }\n      .content-title {\n        font-size: 1.4em;\n        margin: 0;\n        padding: .25em 0;\n        background-color: white;\n        top: 70px;\n        position: sticky;\n      }\n      .content-current {\n        min-height: 100vh;\n      }\n      .content-next {\n        background-color: grey;\n        opacity: .8;\n      }\n      #header {\n        position: sticky;\n        top: 0;\n        left: 0;\n        width: 100%;\n        color: black;\n        background-color: white;\n        z-index: 2;\n        padding: 0;\n        margin: 0;\n        opacity: 1;\n        box-sizing: content-box;\n        transition: all .4s ease;\n      }\n      app-drawer-layout {\n        font-family: sans-serif;\n      }\n      :host {\n        --app-drawer-width: 300px;\n      }\n      :host([full-width]) {\n        --app-drawer-width: 0px;\n      }\n      :host([drawer-opened]) .prev,\n      :host([edit-mode]) .prev {\n        left: 17em;\n      }\n      .progress-container {\n        width: 90%;\n        padding: 0;\n        margin: 0 0 0 1em;\n        overflow: visible;\n      }\n\n      [main-title] {\n        font-weight: lighter;\n        padding: .6em 0 0 0;\n        margin: 0;\n        height: 3em;\n        overflow-y: scroll;\n      }\n      [hidden] {\n        visibility: hidden !important;\n        opacity: 0 !important;\n        display: block !important;\n      }\n      paper-search-bar[hidden] {\n        display: none !important;\n      }\n      lrnsys-progress {\n        margin-top: .5em;\n        padding: .2em 0 0 0;\n        box-sizing: content-box;\n      }\n      lrnsys-progress lrnsys-progress-circle {\n        list-style-type: none;\n        box-sizing: content-box;\n      }\n\n      #bookdrawercontent {\n        overflow: scroll;\n        visibility: visible;\n        display: block;\n        opacity: 1;\n        transition: visibility 1s linear, opacity 1s linear;\n      }\n      @media (max-width: 1200px) {\n        :host .content-body {\n          font-size: .94em;\n        }\n      }\n      @media (max-width: 960px) {\n        :host .content-body {\n          font-size: .92em;\n        }\n      }\n      @media (max-width: 820px) {\n        :host .content-body {\n          font-size: .9em;\n        }\n      }\n      @media (max-width: 700px) {\n        :host .content-body {\n          font-size: .9em;\n        }\n      }\n      @media (max-width: 639px) {\n        app-drawer-layout {\n          top: 0;\n        }\n        [main-title] {\n          font-size: .8em;\n        }\n        .content-title {\n          font-size: 1.1em;\n        }\n        .outline-title {\n          position: absolute !important;\n          clip: rect(1px 1px 1px 1px); /* IE6, IE7 */\n          clip: rect(1px, 1px, 1px, 1px);\n          overflow: hidden;\n          height: 1px;\n        }\n        :host .content-body {\n          margin: 0 .5em;\n          font-size: .9em;\n          width: 85%;\n        }\n        .content-nav-buttons {\n          position: relative;\n          display: flex;\n          top: unset;\n          padding: 0;\n          opacity: .8;\n          height: unset;\n          margin: 0;\n        }\n        .content-nav {\n          width: 100%;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          vertical-align: middle;\n        }\n        .next {\n          right: unset;\n        }\n      }\n      @media (max-width: 500px) {\n        [main-title] {\n          font-size: .7em;\n        }\n      }\n      /**\n       * Authoring section\n       */\n      #editbutton {\n        position: fixed;\n        bottom: 0;\n        right: 0;\n        margin: 2em;\n        padding: .5em;\n        width: 1.6em;\n        height: 1.6em;\n        visibility: visible;\n        opacity: 1;\n        transition: all .4s ease;\n      }\n      :host([edit-mode]) #editbutton {\n        width: 100%;\n        z-index: 100;\n        right: 0;\n        bottom: 0;\n        border-radius: 0;\n        margin: 0;\n        padding: 1em;\n        background-color: var(--paper-blue-500) !important;\n      }\n      :host([edit-mode]) #header {\n        background-color: var(--paper-grey-500);\n      }\n      :host([edit-mode]) #toolbar {\n        opacity: .5;\n      }\n      .your-progress-button {\n        padding-right: 1em;\n      }\n      #mapmenu {\n        padding: 1em 0;\n        overflow-x: hidden;\n      }\n      .course-title-drawer {\n        font-size: 1.2em;\n      }\n    </style>\n    <page-scroll-position value="{{scrollPosition}}"></page-scroll-position>\n    <div id="anchor"></div>\n    <iron-ajax id="outlineajax" params="[[requestParams]]" url="[[outlinePath]]" handle-as="json" on-response="handleOutlineResponse" last-response="{{outlineData}}"></iron-ajax>\n    <iron-ajax id="bookajax" params="[[requestParams]]" url="[[bookPath]]" handle-as="json" on-response="handleBookResponse" last-response="{{bookData}}"></iron-ajax>\n    <iron-ajax id="pageajax" url="[[pagePath]]" params="[[pageParams]]" handle-as="json" on-response="handlePageResponse" last-response="{{pageData}}"></iron-ajax>\n    <iron-ajax id="pageupdateajax" url="[[pageUpdatePath]]" params="[[pageParams]]" method="PUT" body="[[updatePageData]]" content-type="application/json" handle-as="json" on-response="_handleUpdateResponse"></iron-ajax>\n    <iron-ajax id="pagedeleteajax" url="[[pageDeletePath]]" params="[[pageParams]]" method="DELETE" content-type="application/json" handle-as="json" on-response="_handleDeleteResponse"></iron-ajax>\n    <iron-ajax id="pagecreateajax" url="[[pageCreatePath]]" method="POST" body="[[createRequestBody]]" handle-as="json" on-response="_ajaxCreateStubHandler"></iron-ajax>\n\n    <app-location route="{{route}}" query-params="{{queryParams}}"></app-location>\n    <app-route route="{{route}}" pattern="[[endPoint]]/:type/:id" data="{{data}}" tail="{{tail}}" query-params="{{queryParams}}">\n    </app-route>\n  \x3c!-- body where most of the heavy lifting happens --\x3e\n    <app-drawer-layout>\n      <hax-panel id="haxpanel">\n        <span slot="post">\n          <lrnsys-collapselist-item>\n          <span slot="label"><div class="label">Engagements</div></span>\n          <span slot="content">\n            <hax-panel-item icon="touch-app" icon-class="blue-text" label="Interactive video" event-name="h5p-interactive-video" voice-command="insert interactive video"></hax-panel-item>\n            <hax-panel-item icon="hardware:videogame-asset" icon-class="red-text" label="Self-check" event-name="h5p-multiple-choice" voice-command="insert self check"></hax-panel-item>\n            <hax-panel-item icon="timeline" icon-class="yellow-text text-darken-4" label="Timeline" event-name="timeline" voice-command="insert timeline"></hax-panel-item>\n            <hax-panel-item icon="maps:place" icon-class="green-text" label="Map" event-name="map" voice-command="insert map"></hax-panel-item>\n            <hax-panel-item icon="social:share" icon-class="pink-text" label="JMOL" event-name="jmol" voice-command="insert molecule"></hax-panel-item>\n            <hax-panel-item icon="social:poll" icon-class="orange-text" label="Poll" event-name="poll" voice-command="insert poll"></hax-panel-item>\n          </span>\n        </lrnsys-collapselist-item>\n        <lrnsys-collapselist-item>\n          <span slot="label"><div class="label">Assessments</div></span>\n          <span slot="content">\n            <hax-panel-item icon="assignment" icon-class="yellow-text text-darken-2" label="Assignment" event-name="assignment" voice-command="insert assignment"></hax-panel-item>\n            <hax-panel-item icon="assessment" icon-class="purple-text text-darken-2" label="Quiz" event-name="quiz" voice-command="insert quiz"></hax-panel-item>\n          </span>\n        </lrnsys-collapselist-item>\n      </span>\n      </hax-panel>\n      <app-drawer slot="drawer" id="bookdrawer" opened="{{drawerOpened}}" swipe-open="" transition-duration="150">\n        <div id="bookdrawercontent" style="height: 100%; overflow: auto;" hidden$="[[!bookItems]]">\n          <paper-search-bar hide-filter-button="" hidden$="[[!showSearch]]"></paper-search-bar>\n          <lrndesign-mapmenu id="mapmenu" on-tap="_bookOutlineTap">\n            \x3c!-- Server response will populate this --\x3e\n          </lrndesign-mapmenu>\n        </div>\n      </app-drawer>\n      <app-header-layout>\n        <app-header slot="header" id="header" shadow="" fixed="">\n          <div id="outlineloading" class="loading">\n            <elmsln-loading color="grey-text" size="medium"></elmsln-loading>\n            <elmsln-loading color="grey-text" size="medium"></elmsln-loading>\n            <elmsln-loading color="grey-text" size="medium"></elmsln-loading>\n          </div>\n          <app-toolbar id="toolbar" sticky="" class="tall">\n            <div style="pointer-events: auto;" class="menu-btn-wrap">\n              <paper-icon-button style="pointer-events: auto;" title="Content outline" id="menubutton" icon="menu"></paper-icon-button>\n            </div>\n            <div spacer="" class="outline-title">[[outlineTitle]]</div>\n            <div spacer="" main-title="" style="pointer-events: auto;">\n              <div class="progress-container">\n                <lrnsys-progress sound-finish="[[soundFinish]]" sound="[[sound]]" complete-sound="[[completeSound]]" finished-sound="[[finishedSound]]" title="The steps to complete this lesson" id="progress" active="{{activePage}}" items="{{outlineItems}}" progressive-unlock="" size="small"></lrnsys-progress>\n              </div>\n            </div>\n            <div class="your-progress-button">\n              <lrnsys-dialog body-append="" modal="" on-tap="progressdashboardopen" header="Your progress" alt="Your progress">\n                <span slot="button"><iron-icon icon="av:equalizer"></iron-icon></span>\n                <div>\n                  <lrnapp-book-progress-dashboard id="progressdashboard" source-path="[[progressDashboardPath]]" route-data="[[data]]"></lrnapp-book-progress-dashboard>\n                </div>\n              </lrnsys-dialog>\n            </div>\n          </app-toolbar>\n        </app-header>\n        <div class="content-body">\n          <div id="current" class="content-current">\n            <h2 id="currenttitle" class="content-title">[[currentTitle]]</h2>\n            <div id="bodyloading" class="loading">\n              <elmsln-loading color="grey-text" size="large"></elmsln-loading>\n              <h3 class="loading-text">Loading content..</h3>\n            </div>\n            <div>\n              <hax-body id="haxbody">\n                <slot id="slottedarea"></slot>\n              </hax-body>\n            </div>\n          </div>\n        </div>\n        <div class="content-nav">\n          <div class="content-nav-buttons next">\n            <paper-icon-button id="next" title="[[nextLabel]]" on-tap="_nextBtn" icon="hardware:keyboard-arrow-right" data-voicecommand="next page" hidden$="[[!hasNextPage]]"></paper-icon-button>\n            <paper-tooltip for="next" position="left" offset="0" animation-delay="100">\n              [[nextLabel]]\n            </paper-tooltip>\n          </div>\n          <div class="content-nav-buttons prev">\n            <paper-icon-button id="prev" title="[[prevLabel]]" on-tap="_prevBtn" icon="hardware:keyboard-arrow-left" data-voicecommand="previous page" hidden$="[[!hasPrevPage]]"></paper-icon-button>\n            <paper-tooltip for="prev" position="right" offset="0" animation-delay="100">\n              [[prevLabel]]\n            </paper-tooltip>\n          </div>\n        </div>\n      </app-header-layout>\n    </app-drawer-layout>\n    \x3c!-- edit mode if they have permissions --\x3e\n    <paper-fab id="editbutton" icon="editor:mode-edit" class="red white-text" hidden$="[[!currentPageData.page.meta.canUpdate]]" data-voicecommand="Edit content" on-tap="_toggleEditMode" title="Tap to place content in edit mode."></paper-fab>\n    <paper-tooltip for="editbutton" position="bottom" offset="8" animation-delay="100">\n      <span id="fablabel">edit mode</span>\n    </paper-tooltip>\n    <paper-toast id="toast" horizontal-align="left"></paper-toast>\n'],['\n    <style include="materializecss-styles"></style>\n    <style>\n      :host {\n        display: block;\n        font-size: 1em;\n        box-sizing: content-box;\n      }\n      #toolbar {\n        color: gray;\n        background-color: white;\n        padding: 0 .5em;\n        margin: 0;\n        height: auto;\n        box-sizing: content-box;\n        transition: all .4s ease;\n      }\n      paper-button {\n        padding: 0;\n        margin: 0;\n        min-width: 1rem;\n      }\n\n      hax-panel ::shadow app-drawer {\n        padding: 0;\n        top: 0;\n        bottom: 0;\n        position: absolute;\n        box-sizing: content-box;\n        margin-left: -300px;\n        --app-drawer-content-container: {\n          background-color: #fafafa;\n          padding: 0;\n          border-right: 1px solid #c8c8c8;\n          overflow: inherit;\n          width: 300px !important;\n        }\n      }\n      app-drawer {\n        padding: 0;\n        top: 0;\n        bottom: 0;\n        z-index: 1;\n        position: absolute;\n        box-sizing: content-box;\n        --app-drawer-content-container: {\n          background-color: #fafafa;\n          padding: 0;\n          border-right: 1px solid #c8c8c8;\n          overflow-y: scroll;\n          width: 300px !important;\n          box-shadow: 0 76px 8px 0 rgba(0, 0, 0, 0.4);\n          height: 100vh;\n          top: 0;\n          position: sticky;\n        }\n      }\n      hax-panel {\n        font-size: .8rem;\n      }\n      hax-panel {\n      --app-drawer-content-container: {\n          background-color: #fafafa;\n          padding: 0;\n          border-right: 1px solid #c8c8c8;\n          overflow-y: scroll;\n          width: 300px !important;\n          box-shadow: 0 76px 8px 0 rgba(0, 0, 0, 0.4);\n          height: 100vh;\n          top: 0;\n          position: sticky;\n        }\n      }\n\n      lrndesign-stepper-button {\n        --lrndesign-stepper-btn-active: #f6f7f7;\n      }\n      lrndesign-stepper-button ::shadow paper-button {\n        margin: 0;\n        height: 3em;\n      }\n      lrndesign-stepper-button ::shadow .title-container.lrndesign-stepper-button {\n        padding: 0;\n        width: 100%;\n        right: unset;\n      }\n      lrndesign-stepper-button ::shadow .node-title.lrndesign-stepper-button {\n        font-size: .9em;\n        line-height: 1.5em;\n      }\n\n      .loading {\n        width: 100%;\n        z-index: 1000;\n        opacity: .9;\n        text-align: center;\n        align-content: space-around;\n        justify-content: center;\n        position: absolute;\n        background-color: white;\n        padding: 0;\n        margin: 0;\n        display: flex;\n        margin: 0 auto;\n        visibility: visible;\n        transition: visibility 1s, opacity 1s ease;\n      }\n      .loading elmsln-loading {\n        margin: 0 5em;\n        display: inline-flex;\n      }\n      #bodyloading {\n        height: 100%;\n        display: flex;\n        justify-content: center;\n      }\n      #bodyloading .loading,\n      #bodyloading elmsln-loading{\n        display: block;\n        height: 5em;\n      }\n      .outline-title {\n        margin-left: .5em;\n        max-width: 50%;\n      }\n      .content-nav-buttons {\n        top: 60%;\n        position: fixed;\n        opacity: .8;\n        padding: 0 .25em;\n        height: 40%;\n        padding-top: 15%;\n        margin-top: -15%;\n      }\n      .content-nav-buttons:hover {\n        opacity: 1;\n      }\n      .prev {\n        left: 0;\n        order: 1;\n      }\n      .next {\n        right: 0;\n        transition: right .2s ease;\n        order: 2;\n      }\n      app-header {\n        width: 100%;\n        left: 0 !important;\n        z-index: 2 !important;\n        position: sticky !important;\n      }\n      app-header-layout {\n        margin: 0;\n        padding: 0;\n        width: 100%;\n      }\n      .content-body {\n        position: relative;\n        padding: 0;\n        margin: -3em 4em 5em 4em;\n        font-size: 1.1em;\n        transition:\n          margin .4s ease,\n          width .4s ease;\n      }\n\n      .content-nav-buttons paper-icon-button {\n        width: 4em;\n        height: 4em;\n        opacity: .4;\n        display: block;\n        visibility: visible;\n        transition:\n          opacity .4s linear,\n          visibility 1s linear,\n          height .4s ease,\n          width .4s ease;\n      }\n      .content-nav-buttons paper-icon-button:hover {\n        opacity: 1;\n      }\n      paper-tooltip {\n        --paper-tooltip-opacity: .96;\n      }\n      :host([drawer-opened]) .content-nav-buttons paper-icon-button {\n        width: 2.5em;\n        height: 2.5em;\n      }\n      :host([edit-mode]) .content-nav-buttons {\n        opacity: 0;\n        pointer-events: none;\n        visibility: hidden;\n      }\n      .content-title {\n        font-size: 1.4em;\n        margin: 0;\n        padding: .25em 0;\n        background-color: white;\n        top: 70px;\n        position: sticky;\n      }\n      .content-current {\n        min-height: 100vh;\n      }\n      .content-next {\n        background-color: grey;\n        opacity: .8;\n      }\n      #header {\n        position: sticky;\n        top: 0;\n        left: 0;\n        width: 100%;\n        color: black;\n        background-color: white;\n        z-index: 2;\n        padding: 0;\n        margin: 0;\n        opacity: 1;\n        box-sizing: content-box;\n        transition: all .4s ease;\n      }\n      app-drawer-layout {\n        font-family: sans-serif;\n      }\n      :host {\n        --app-drawer-width: 300px;\n      }\n      :host([full-width]) {\n        --app-drawer-width: 0px;\n      }\n      :host([drawer-opened]) .prev,\n      :host([edit-mode]) .prev {\n        left: 17em;\n      }\n      .progress-container {\n        width: 90%;\n        padding: 0;\n        margin: 0 0 0 1em;\n        overflow: visible;\n      }\n\n      [main-title] {\n        font-weight: lighter;\n        padding: .6em 0 0 0;\n        margin: 0;\n        height: 3em;\n        overflow-y: scroll;\n      }\n      [hidden] {\n        visibility: hidden !important;\n        opacity: 0 !important;\n        display: block !important;\n      }\n      paper-search-bar[hidden] {\n        display: none !important;\n      }\n      lrnsys-progress {\n        margin-top: .5em;\n        padding: .2em 0 0 0;\n        box-sizing: content-box;\n      }\n      lrnsys-progress lrnsys-progress-circle {\n        list-style-type: none;\n        box-sizing: content-box;\n      }\n\n      #bookdrawercontent {\n        overflow: scroll;\n        visibility: visible;\n        display: block;\n        opacity: 1;\n        transition: visibility 1s linear, opacity 1s linear;\n      }\n      @media (max-width: 1200px) {\n        :host .content-body {\n          font-size: .94em;\n        }\n      }\n      @media (max-width: 960px) {\n        :host .content-body {\n          font-size: .92em;\n        }\n      }\n      @media (max-width: 820px) {\n        :host .content-body {\n          font-size: .9em;\n        }\n      }\n      @media (max-width: 700px) {\n        :host .content-body {\n          font-size: .9em;\n        }\n      }\n      @media (max-width: 639px) {\n        app-drawer-layout {\n          top: 0;\n        }\n        [main-title] {\n          font-size: .8em;\n        }\n        .content-title {\n          font-size: 1.1em;\n        }\n        .outline-title {\n          position: absolute !important;\n          clip: rect(1px 1px 1px 1px); /* IE6, IE7 */\n          clip: rect(1px, 1px, 1px, 1px);\n          overflow: hidden;\n          height: 1px;\n        }\n        :host .content-body {\n          margin: 0 .5em;\n          font-size: .9em;\n          width: 85%;\n        }\n        .content-nav-buttons {\n          position: relative;\n          display: flex;\n          top: unset;\n          padding: 0;\n          opacity: .8;\n          height: unset;\n          margin: 0;\n        }\n        .content-nav {\n          width: 100%;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          vertical-align: middle;\n        }\n        .next {\n          right: unset;\n        }\n      }\n      @media (max-width: 500px) {\n        [main-title] {\n          font-size: .7em;\n        }\n      }\n      /**\n       * Authoring section\n       */\n      #editbutton {\n        position: fixed;\n        bottom: 0;\n        right: 0;\n        margin: 2em;\n        padding: .5em;\n        width: 1.6em;\n        height: 1.6em;\n        visibility: visible;\n        opacity: 1;\n        transition: all .4s ease;\n      }\n      :host([edit-mode]) #editbutton {\n        width: 100%;\n        z-index: 100;\n        right: 0;\n        bottom: 0;\n        border-radius: 0;\n        margin: 0;\n        padding: 1em;\n        background-color: var(--paper-blue-500) !important;\n      }\n      :host([edit-mode]) #header {\n        background-color: var(--paper-grey-500);\n      }\n      :host([edit-mode]) #toolbar {\n        opacity: .5;\n      }\n      .your-progress-button {\n        padding-right: 1em;\n      }\n      #mapmenu {\n        padding: 1em 0;\n        overflow-x: hidden;\n      }\n      .course-title-drawer {\n        font-size: 1.2em;\n      }\n    </style>\n    <page-scroll-position value="{{scrollPosition}}"></page-scroll-position>\n    <div id="anchor"></div>\n    <iron-ajax id="outlineajax" params="[[requestParams]]" url="[[outlinePath]]" handle-as="json" on-response="handleOutlineResponse" last-response="{{outlineData}}"></iron-ajax>\n    <iron-ajax id="bookajax" params="[[requestParams]]" url="[[bookPath]]" handle-as="json" on-response="handleBookResponse" last-response="{{bookData}}"></iron-ajax>\n    <iron-ajax id="pageajax" url="[[pagePath]]" params="[[pageParams]]" handle-as="json" on-response="handlePageResponse" last-response="{{pageData}}"></iron-ajax>\n    <iron-ajax id="pageupdateajax" url="[[pageUpdatePath]]" params="[[pageParams]]" method="PUT" body="[[updatePageData]]" content-type="application/json" handle-as="json" on-response="_handleUpdateResponse"></iron-ajax>\n    <iron-ajax id="pagedeleteajax" url="[[pageDeletePath]]" params="[[pageParams]]" method="DELETE" content-type="application/json" handle-as="json" on-response="_handleDeleteResponse"></iron-ajax>\n    <iron-ajax id="pagecreateajax" url="[[pageCreatePath]]" method="POST" body="[[createRequestBody]]" handle-as="json" on-response="_ajaxCreateStubHandler"></iron-ajax>\n\n    <app-location route="{{route}}" query-params="{{queryParams}}"></app-location>\n    <app-route route="{{route}}" pattern="[[endPoint]]/:type/:id" data="{{data}}" tail="{{tail}}" query-params="{{queryParams}}">\n    </app-route>\n  \x3c!-- body where most of the heavy lifting happens --\x3e\n    <app-drawer-layout>\n      <hax-panel id="haxpanel">\n        <span slot="post">\n          <lrnsys-collapselist-item>\n          <span slot="label"><div class="label">Engagements</div></span>\n          <span slot="content">\n            <hax-panel-item icon="touch-app" icon-class="blue-text" label="Interactive video" event-name="h5p-interactive-video" voice-command="insert interactive video"></hax-panel-item>\n            <hax-panel-item icon="hardware:videogame-asset" icon-class="red-text" label="Self-check" event-name="h5p-multiple-choice" voice-command="insert self check"></hax-panel-item>\n            <hax-panel-item icon="timeline" icon-class="yellow-text text-darken-4" label="Timeline" event-name="timeline" voice-command="insert timeline"></hax-panel-item>\n            <hax-panel-item icon="maps:place" icon-class="green-text" label="Map" event-name="map" voice-command="insert map"></hax-panel-item>\n            <hax-panel-item icon="social:share" icon-class="pink-text" label="JMOL" event-name="jmol" voice-command="insert molecule"></hax-panel-item>\n            <hax-panel-item icon="social:poll" icon-class="orange-text" label="Poll" event-name="poll" voice-command="insert poll"></hax-panel-item>\n          </span>\n        </lrnsys-collapselist-item>\n        <lrnsys-collapselist-item>\n          <span slot="label"><div class="label">Assessments</div></span>\n          <span slot="content">\n            <hax-panel-item icon="assignment" icon-class="yellow-text text-darken-2" label="Assignment" event-name="assignment" voice-command="insert assignment"></hax-panel-item>\n            <hax-panel-item icon="assessment" icon-class="purple-text text-darken-2" label="Quiz" event-name="quiz" voice-command="insert quiz"></hax-panel-item>\n          </span>\n        </lrnsys-collapselist-item>\n      </span>\n      </hax-panel>\n      <app-drawer slot="drawer" id="bookdrawer" opened="{{drawerOpened}}" swipe-open="" transition-duration="150">\n        <div id="bookdrawercontent" style="height: 100%; overflow: auto;" hidden\\$="[[!bookItems]]">\n          <paper-search-bar hide-filter-button="" hidden\\$="[[!showSearch]]"></paper-search-bar>\n          <lrndesign-mapmenu id="mapmenu" on-tap="_bookOutlineTap">\n            \x3c!-- Server response will populate this --\x3e\n          </lrndesign-mapmenu>\n        </div>\n      </app-drawer>\n      <app-header-layout>\n        <app-header slot="header" id="header" shadow="" fixed="">\n          <div id="outlineloading" class="loading">\n            <elmsln-loading color="grey-text" size="medium"></elmsln-loading>\n            <elmsln-loading color="grey-text" size="medium"></elmsln-loading>\n            <elmsln-loading color="grey-text" size="medium"></elmsln-loading>\n          </div>\n          <app-toolbar id="toolbar" sticky="" class="tall">\n            <div style="pointer-events: auto;" class="menu-btn-wrap">\n              <paper-icon-button style="pointer-events: auto;" title="Content outline" id="menubutton" icon="menu"></paper-icon-button>\n            </div>\n            <div spacer="" class="outline-title">[[outlineTitle]]</div>\n            <div spacer="" main-title="" style="pointer-events: auto;">\n              <div class="progress-container">\n                <lrnsys-progress sound-finish="[[soundFinish]]" sound="[[sound]]" complete-sound="[[completeSound]]" finished-sound="[[finishedSound]]" title="The steps to complete this lesson" id="progress" active="{{activePage}}" items="{{outlineItems}}" progressive-unlock="" size="small"></lrnsys-progress>\n              </div>\n            </div>\n            <div class="your-progress-button">\n              <lrnsys-dialog body-append="" modal="" on-tap="progressdashboardopen" header="Your progress" alt="Your progress">\n                <span slot="button"><iron-icon icon="av:equalizer"></iron-icon></span>\n                <div>\n                  <lrnapp-book-progress-dashboard id="progressdashboard" source-path="[[progressDashboardPath]]" route-data="[[data]]"></lrnapp-book-progress-dashboard>\n                </div>\n              </lrnsys-dialog>\n            </div>\n          </app-toolbar>\n        </app-header>\n        <div class="content-body">\n          <div id="current" class="content-current">\n            <h2 id="currenttitle" class="content-title">[[currentTitle]]</h2>\n            <div id="bodyloading" class="loading">\n              <elmsln-loading color="grey-text" size="large"></elmsln-loading>\n              <h3 class="loading-text">Loading content..</h3>\n            </div>\n            <div>\n              <hax-body id="haxbody">\n                <slot id="slottedarea"></slot>\n              </hax-body>\n            </div>\n          </div>\n        </div>\n        <div class="content-nav">\n          <div class="content-nav-buttons next">\n            <paper-icon-button id="next" title="[[nextLabel]]" on-tap="_nextBtn" icon="hardware:keyboard-arrow-right" data-voicecommand="next page" hidden\\$="[[!hasNextPage]]"></paper-icon-button>\n            <paper-tooltip for="next" position="left" offset="0" animation-delay="100">\n              [[nextLabel]]\n            </paper-tooltip>\n          </div>\n          <div class="content-nav-buttons prev">\n            <paper-icon-button id="prev" title="[[prevLabel]]" on-tap="_prevBtn" icon="hardware:keyboard-arrow-left" data-voicecommand="previous page" hidden\\$="[[!hasPrevPage]]"></paper-icon-button>\n            <paper-tooltip for="prev" position="right" offset="0" animation-delay="100">\n              [[prevLabel]]\n            </paper-tooltip>\n          </div>\n        </div>\n      </app-header-layout>\n    </app-drawer-layout>\n    \x3c!-- edit mode if they have permissions --\x3e\n    <paper-fab id="editbutton" icon="editor:mode-edit" class="red white-text" hidden\\$="[[!currentPageData.page.meta.canUpdate]]" data-voicecommand="Edit content" on-tap="_toggleEditMode" title="Tap to place content in edit mode."></paper-fab>\n    <paper-tooltip for="editbutton" position="bottom" offset="8" animation-delay="100">\n      <span id="fablabel">edit mode</span>\n    </paper-tooltip>\n    <paper-toast id="toast" horizontal-align="left"></paper-toast>\n']);return $=function(){return n},n}n.Polymer({_template:n.html(D()),is:"lrnapp-book-progress-dashboard",properties:{routeData:{type:Object,observer:"_routeDataChanged"},requestParams:{type:Object,value:{node:null}},sourcePath:{type:String},readTimeData:{type:Object,value:[]},userData:{type:Object,value:[]},showProgress:{type:Boolean,value:!1,reflectToAttribute:!0,observer:"_showProgressChanged"}},_routeDataChanged:function(n,e){"undefined"!==_(n)&&(this.requestParams[n.type]=n.id,this.progressChanged&&this.$.dataajax.generateRequest())},_showProgressChanged:function(n,e){n&&"undefined"!==_(this.routeData)&&this.$.dataajax.generateRequest()},handleDataResponse:function(n){var e=n.detail.response.data;this.$.bodyloading.hidden=!0,this.userData=e.userdata,this.dashboardItems=this._toArray(e.items),console.log(e)},_toArray:function(n){return Object.keys(n).map(function(e){return n[e]})}}),n.Polymer({_template:n.html($()),is:"lrnapp-book",listeners:{"menubutton.tap":"toggleBook","progress.node-percent-milestone":"testMilestone","route-change":"_routeChange","haxpanel.hax-item-selected":"_haxOperation","haxpanel.hax-content-insert":"_haxContentInsert"},observers:["_routeChanged(data, route, endPoint)"],properties:{progressDashboardPath:{type:String},showSearch:{type:Boolean,reflectToAttribute:!0,value:!1},createRequestBody:{type:Object,computed:"_computeCreateRequestBody(currentPageData)"},updatePageData:{type:Object,value:{id:null,type:null,attributes:{}}},pageUpdatePath:{type:String,computed:"_computePageUpdatePath(data, sourcePath)"},sourcePath:{type:String},editMode:{type:Boolean,value:!1,reflectToAttribute:!0,observer:"_editModeChanged"},drawerOpened:{type:Boolean,value:!0,reflectToAttribute:!0},route:{type:Object,notify:!0},currentTitle:{type:String},outlineTitle:{type:String},bookTitle:{type:String,value:"Course outline"},soundFinish:{type:Boolean,value:!0},sound:{type:Boolean,value:!0},completeSound:{type:String,value:""},finishedSound:{type:String,value:""},scrollPosition:{type:Number,value:0,observer:"_scrollChanged"},activePage:{type:Number,value:0,observer:"_activePageChanged"},activeOutline:{type:Number,value:0,observer:"_activeOutlineChanged"},outlineItems:{type:Array,value:[],notify:!0,observer:"_outlineItemsChanged"},bookItems:{type:Array,value:[],notify:!0},itemResponses:{type:Array,value:[]},requestParams:{type:Object,notify:!0,value:{node:null}},pageParams:{type:Object,notify:!0,value:{load:!1}},outlineData:{type:Object,notify:!0},bookData:{type:Object,notify:!0},pageData:{type:Object,notify:!0},outlinePath:{type:String},bookPath:{type:String},pagePath:{type:String},hasPrevPage:{type:Boolean,notify:!0},prevLabel:{type:String},hasNextPage:{type:Boolean,notify:!0},nextLabel:{type:String},resetScroll:{type:Boolean,value:!1},currentPageData:{type:Object,value:{},observer:"_currentPageDataUpdated"},responseData:{type:Object,value:{}},rebuildOutline:{type:Boolean,value:!1},fullWidth:{type:Boolean,reflectToAttribute:!0,value:!1,observer:"_fullWidthChanged"}},ready:function(n){var e=this;this.$.bodyloading.hidden=!0,this.$.outlineajax.generateRequest(),setTimeout(function(){e._resetScroll()},500)},_fullWidthChanged:function(n,e){z.updateStyles()},progressdashboardopen:function(n){this.$.progressdashboard.showProgress=!0},_computePageUpdatePath:function(n,e){return e.replace("%",n.id)},_haxOperation:function(n){this.$.toast.show(n.detail.eventName)},_haxContentInsert:function(n){this.$.toast.show(n.detail.eventName);var e={};"undefined"!==_(n.detail.properties)&&(e=n.detail.properties),this.$.haxbody.haxInsert(n.detail.tag,n.detail.content,e)},_computeCreateRequestBody:function(n){if("undefined"!==_(n.page))return{bid:n.page.relationships.book.id,pid:n.page.relationships.parent.id}},_toggleEditMode:function(n){this.editMode=!this.editMode},_editModeChanged:function(n,e){if("undefined"!==_(n))if(!0===n)this.$.editbutton.icon="save",this.$.editbutton.title="Tap to save content and exit edit mode",this.$.fablabel="save changes",this.__bookdraweropened=this.$.bookdrawer.opened,this.$.bookdrawer.opened&&(this.$.bookdrawer.opened=!1),this.$.haxpanel.opened=!0,this.$.currenttitle.contentEditable=!0,this.$.haxbody.editMode=!0,this.resetScroll=!0,this.$.toast.show("Authoring mode active");else if(this.$.editbutton.icon="editor:mode-edit",this.$.editbutton.title="Tap to place content in edit mode.",this.$.fablabel="edit mode",this.$.bookdrawer.opened=this.__bookdraweropened,this.$.haxpanel.opened=!1,this.$.currenttitle.contentEditable=!1,this.$.haxbody.editMode=!1,this.resetScroll=!1,!0===e){var t=!1,a=this.$.haxbody.haxToContent();this.$.currenttitle.innerHTML!==this.currentPageData.title&&(this.currentPageData.title=this.$.currenttitle.innerHTML,this.updatePageData.attributes.title=this.currentPageData.title),this.currentPageData.content!==a&&(this.currentPageData.content=a,this.updatePageData.attributes.body=this.currentPageData.content,t=!0),t&&(this.updatePageData.type=this.data.type,this.updatePageData.id=this.data.id,this.$.toast.show("Saving..."),this.$.pageupdateajax.generateRequest())}},_handleUpdateResponse:function(n){this.$.toast.show("Saved!")},_bookOutlineTap:function(n){var e=k.dom(n).localTarget;"undefined"!==_(e.getAttribute("data-book-parent"))&&(this.activeOutline=e.getAttribute("data-book-parent"))},_activeOutlineChanged:function(n,e){"undefined"!==_(n)&&"undefined"!==_(e)&&(this.rebuildOutline=!0)},_routeChanged:function(n,e,t){if("string"==typeof e.path){if("string"==typeof t&&e.path.startsWith(t))return void(0!=this.pageParams.load&&"undefined"!==_(n.type)&&"undefined"!==_(n.id)&&(this.pageParams[n.type]=n.id,"undefined"!==_(this.responseData[n.type+n.id])?this.set("currentPageData",this.responseData[n.type+n.id]):(this.$.bodyloading.hidden=!1,this.$.pageajax.generateRequest()),this.rebuildOutline&&(this.set("requestParams",[]),this.set("requestParams",this.pageParams),"undefined"!==_(this.responseData[n.type+"."+n.id+".outline"])?(this.activePage=0,this.set("outlineItems",[]),this.set("outlineItems",this._toArray(this.responseData[n.type+"."+n.id+".outline"].items)),this.set("outlineTitle",this.responseData[n.type+"."+n.id+".outline"].items.outlineTitle)):(this.$.outlineloading.hidden=!1,this.pageParams.load=!1,this.$.outlineajax.generateRequest()),this.rebuildOutline=!1)));window.location.reload()}},_resetScroll:function(){this.resetScroll=!0,this.scrollPosition=0,this.$.anchor.scrollIntoView({block:"start",behavior:"smooth",inline:"nearest"})},_activePageChanged:function(n,e){var t=this;"undefined"!==_(n)&&("undefined"!==_(this.outlineItems)&&(this.set("route.path",this.outlineItems[n].url),this.updatePageData.attributes={},this.updatePageData.id=null,this.updatePageData.type=null),_(e),setTimeout(function(){t.resetScroll=!1},1e3),0==n?this.hasPrevPage=!1:(this.hasPrevPage=!0,"undefined"!==_(this.outlineItems)&&(this.prevLabel=this.outlineItems[n-1].title)),"undefined"!==_(this.outlineItems)&&n+1==this.outlineItems.length?this.hasNextPage=!1:(this.hasNextPage=!0,"undefined"!==_(this.outlineItems)&&(this.nextLabel=this.outlineItems[n+1].title)))},_outlineItemsChanged:function(n,e){"undefined"!==_(n)&&0!=n.length&&(0!=this.activePage&&(this.prevLabel=n[this.activePage-1].title),this.activePage+1!=n.length&&(this.nextLabel=n[this.activePage+1].title))},testMilestone:function(n){75==n.detail.percentage&&console.log("@todo preload the next page and present grayed out right of UI.")},_scrollChanged:function(n,e){"undefined"!==_(this.outlineItems)&&"undefined"!==_(this.outlineItems[this.activePage])&&n>this.outlineItems[this.activePage].value&&!this.resetScroll&&(n>=75?(this.outlineItems[this.activePage].value=this.outlineItems[this.activePage].max,this.set("outlineItems."+this.activePage+".value",this.outlineItems[this.activePage].max)):(this.outlineItems[this.activePage].value=n,this.set("outlineItems."+this.activePage+".value",n)))},_nextBtn:function(n){this.activePage<this.outlineItems.length-1&&(this.set("outlineItems."+this.activePage+".value",this.outlineItems[this.activePage].max),this.activePage=this.activePage+1)},_prevBtn:function(n){this.activePage>0&&(this.activePage=this.activePage-1)},toggleBook:function(n){this.editMode?(this.$.haxpanel.toggle(),this.fullWidth=!this.$.haxpanel.opened):(this.$.bookdrawer.toggle(),this.fullWidth=!this.$.bookdrawer.opened)},handleOutlineResponse:function(n){if("undefined"!==_(n)){var e=n.detail.response.data,t=this._toArray(n.detail.response.data.items),a=n.detail.response.data.outlineTitle;0!==this.activePage&&(this.activePage=0),this.set("responseData."+this.data.type+"."+this.data.id+".outline",e),this.set("outlineItems",[]),this.set("outlineItems",t),this.set("outlineTitle",a);var i=0;for(var o in t)this.data.type===t[o].type&&this.data.id===t[o].id&&0!==o&&(i=parseInt(o));0!==i&&(this.activePage=i),this.$.outlineloading.hidden=!0,this.pageParams.load=!0,0===this.bookItems.length&&(this.$.bookajax.generateRequest(),this.pageParams=this.requestParams,this.$.pageajax.generateRequest())}},handleBookResponse:function(n){var e=n.detail.response.data;this.set("bookItems",this._toArray(e.items)),this.$.mapmenu.innerHTML=e.render},handlePageResponse:function(n){if("undefined"!==_(n)){var e=n.detail.response.data;this.set("responseData."+this.data.type+this.data.id,e),this.set("currentPageData",e)}},_currentPageDataUpdated:function(n,e){if("undefined"!==_(n)&&"undefined"!==_(n.content)){this.set("currentTitle",n.title);for(var t=k.dom(this.$.haxbody);null!==t.firstChild;)t.removeChild(t.firstChild);var a=document.createElement("div"),i=document.createRange().createContextualFragment(n.content);if(a.appendChild(i),null==a.firstChild)(o=document.createElement("p")).innerHTML=a.innerHTML,(a=document.createElement("div")).innerHTML=o.outerHTML;else if("undefined"!==_(a.firstChild.length)){var o;(o=document.createElement("p")).innerHTML=a.innerHTML,(a=document.createElement("div")).innerHTML=o.outerHTML}for(;a.firstChild;)k.dom(this.$.haxbody).appendChild(a.firstChild);this._resetScroll(),this.$.bodyloading.hidden=!0,this.editMode&&!n.page.meta.canUpdate&&(this.editMode=!1)}},_toArray:function(n){return Object.keys(n).map(function(e){return n[e]})}})});
//# sourceMappingURL=lrnapp-book.umd.js.map
