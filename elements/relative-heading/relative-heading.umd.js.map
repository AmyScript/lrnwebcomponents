{"version":3,"file":"relative-heading.umd.js","sources":["lib/relative-heading-manager.js","relative-heading.umd.js"],"sourcesContent":["import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\n\nwindow.RelativeHeadingManager = {};\nwindow.RelativeHeadingManager.instance = null;\n\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: none;\n      }\n    </style>\n`,\n\n  is: \"relative-heading-manager\",\n  properties: {},\n\n  /*\n   * listen for headings and set their parent elements\n   */\n  created: function() {\n    let root = this;\n    if (!window.RelativeHeadingManager.instance) {\n      window.RelativeHeadingManager.instance = root;\n    }\n    document.body.addEventListener(\"heading-created\", function(e) {\n      let el = e.detail,\n        pid = el.getAttribute(\"subtopic-of\"),\n        parent = document.getElementById(pid);\n      if (parent !== el.parentHeading) {\n        el._setParent(parent);\n      }\n    });\n  }\n});\n\n/*\n * checks to see if there is an instance available, and if not appends one\n */\nwindow.RelativeHeadingManager.requestAvailability = function() {\n  if (!window.RelativeHeadingManager.instance) {\n    window.RelativeHeadingManager.instance = document.createElement(\n      \"relative-heading-manager\"\n    );\n  }\n\n  document.body.appendChild(window.RelativeHeadingManager.instance);\n};\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"./lib/relative-heading-manager.js\";\n/**\n`relative-heading`\nA LRN element\n\n@demo demo/index.html\n\n@microcopy - the mental model for this element\n -\n -\n -\n\n*/\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n    </style>\n    <div id=\"html\"></div>\n`,\n\n  is: \"relative-heading\",\n\n  properties: {\n    /* \n     * id of the heading element that this heading is a subtopic of \n     */\n    subtopicOf: {\n      type: String,\n      value: null,\n      reflectToAttribute: true\n    },\n    /* \n     * text of the heading \n     */\n    text: {\n      type: String,\n      value: null,\n      reflectToAttribute: true\n    },\n    /* \n     * the id of the heading element that this heading is a subtopic of \n     */\n    parentHeading: {\n      type: Object,\n      value: {}\n    },\n    /* \n     * the heading tag, eg. <h1/>, <h2/> ...\n     */\n    tag: {\n      type: String,\n      value: null,\n      reflectToAttribute: true\n    }\n  },\n\n  /* \n   * make sure the heading manager is ready to listen \n   */\n  created: function() {\n    window.RelativeHeadingManager.requestAvailability();\n  },\n\n  /* \n   * fire a heading created event for the heading manager\n   */\n  attached: function() {\n    this.fire(\"heading-created\", this);\n  },\n\n  /* \n   * fired if the subtopic changes\n   */\n  attributeChanged: function(name, type) {\n    if (name === \"subtopic-of\") {\n      this.fire(\"heading-created\", this);\n    } else if (name === \"tag\") {\n      this.fire(\"heading-changed\", this);\n      this.$.html.innerHTML =\n        \"<\" + this.tag + \">\" + this.text + \"</\" + this.tag + \">\";\n    }\n  },\n\n  /* \n   * sets the parent of the heading\n   */\n  _setParent: function(el) {\n    let root = this;\n    if (root.__parentListener !== undefined)\n      root.parentHeading.removeEventListener(\"heading-changed\");\n    root.parentHeading = el;\n    if (el !== null) {\n      root.__parentListener = root.parentHeading.addEventListener(\n        \"heading-changed\",\n        function(e) {\n          root._setTag();\n        }\n      );\n    }\n    this._setTag();\n  },\n\n  /* \n   * gets the  heading tag name\n   */\n  _setTag: function() {\n    let tag = \"h1\",\n      level = 1,\n      h = function(level) {\n        // get the tag name based on the number of the heading, eg. 1 for <h1/>, 2 for <h2/>\n        return \"h\" + Math.max(Math.min(level, 6), 1);\n      };\n    // if there is a parent heading, get the parent's tag attribute or tagName attribute\n    if (this.parentHeading !== null) {\n      if (\n        this.parentHeading.tag !== undefined &&\n        this.parentHeading.tag !== null\n      ) {\n        level =\n          parseInt(this.parentHeading.tag.toLowerCase().replace(\"h\", \"\")) + 1;\n      } else if (\n        this.parentHeading.tagName !== undefined &&\n        this.parentHeading.tagName.match(/^H[0-6]$/)\n      ) {\n        level =\n          parseInt(this.parentHeading.tagName.toLowerCase().replace(\"h\", \"\")) +\n          1;\n      }\n      // if there is a tag attribute, get that\n    } else if (this.tag !== undefined && this.tag !== null) {\n      level = parseInt(this.tag.toLowerCase().replace(\"h\", \"\"));\n    }\n    tag = h(level);\n    this.tag = tag;\n  }\n});\n"],"names":["window","RelativeHeadingManager","instance","_template","html","is","properties","created","this","document","body","addEventListener","e","el","detail","pid","getAttribute","parent","getElementById","parentHeading","_setParent","requestAvailability","createElement","appendChild","subtopicOf","type","String","value","reflectToAttribute","text","Object","tag","attached","fire","attributeChanged","name","$","innerHTML","root","undefined","__parentListener","removeEventListener","_setTag","level","parseInt","toLowerCase","replace","tagName","match","Math","max","min","h"],"mappings":"+pBAEAA,OAAOC,uBAAyB,GAChCD,OAAOC,uBAAuBC,SAAW,eAEjC,CACNC,UAAWC,YAQXC,GAAI,2BACJC,WAAY,GAKZC,QAAS,WAEFP,OAAOC,uBAAuBC,WACjCF,OAAOC,uBAAuBC,SAFrBM,MAIXC,SAASC,KAAKC,iBAAiB,kBAAmB,SAASC,OACrDC,EAAKD,EAAEE,OACTC,EAAMF,EAAGG,aAAa,eACtBC,EAASR,SAASS,eAAeH,GAC/BE,IAAWJ,EAAGM,eAChBN,EAAGO,WAAWH,QAStBjB,OAAOC,uBAAuBoB,oBAAsB,WAC7CrB,OAAOC,uBAAuBC,WACjCF,OAAOC,uBAAuBC,SAAWO,SAASa,cAChD,6BAIJb,SAASC,KAAKa,YAAYvB,OAAOC,uBAAuBC,qBChClD,CACNC,UAAWC,YASXC,GAAI,mBAEJC,WAAY,CAIVkB,WAAY,CACVC,KAAMC,OACNC,MAAO,KACPC,oBAAoB,GAKtBC,KAAM,CACJJ,KAAMC,OACNC,MAAO,KACPC,oBAAoB,GAKtBT,cAAe,CACbM,KAAMK,OACNH,MAAO,IAKTI,IAAK,CACHN,KAAMC,OACNC,MAAO,KACPC,oBAAoB,IAOxBrB,QAAS,WACPP,OAAOC,uBAAuBoB,uBAMhCW,SAAU,gBACHC,KAAK,kBAAmBzB,OAM/B0B,iBAAkB,SAASC,EAAMV,GAClB,gBAATU,OACGF,KAAK,kBAAmBzB,MACX,QAAT2B,SACJF,KAAK,kBAAmBzB,WACxB4B,EAAEhC,KAAKiC,UACV,IAAM7B,KAAKuB,IAAM,IAAMvB,KAAKqB,KAAO,KAAOrB,KAAKuB,IAAM,MAO3DX,WAAY,SAASP,OACfyB,EAAO9B,UACmB+B,IAA1BD,EAAKE,kBACPF,EAAKnB,cAAcsB,oBAAoB,mBACzCH,EAAKnB,cAAgBN,EACV,OAAPA,IACFyB,EAAKE,iBAAmBF,EAAKnB,cAAcR,iBACzC,kBACA,SAASC,GACP0B,EAAKI,kBAINA,WAMPA,QAAS,eACHX,EACFY,EAAQ,EAMiB,OAAvBnC,KAAKW,mBAEsBoB,IAA3B/B,KAAKW,cAAcY,KACQ,OAA3BvB,KAAKW,cAAcY,IAEnBY,EACEC,SAASpC,KAAKW,cAAcY,IAAIc,cAAcC,QAAQ,IAAK,KAAO,OAErCP,IAA/B/B,KAAKW,cAAc4B,SACnBvC,KAAKW,cAAc4B,QAAQC,MAAM,cAEjCL,EACEC,SAASpC,KAAKW,cAAc4B,QAAQF,cAAcC,QAAQ,IAAK,KAC/D,QAGkBP,IAAb/B,KAAKuB,KAAkC,OAAbvB,KAAKuB,MACxCY,EAAQC,SAASpC,KAAKuB,IAAIc,cAAcC,QAAQ,IAAK,MAEvDf,EAxBM,SAASY,SAEJ,IAAMM,KAAKC,IAAID,KAAKE,IAAIR,EAAO,GAAI,GAsBxCS,CAAET,QACHZ,IAAMA"}