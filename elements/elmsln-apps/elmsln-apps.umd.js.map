{"version":3,"file":"elmsln-apps.umd.js","sources":["lib/elmsmedia-dashboard/elmsmedia-dashboard-filters.js","lib/elmsmedia-dashboard/paper-chip.js","lib/elmsmedia-dashboard/elmsmedia-dashboard-toolbar-filter.js","lib/elmsmedia-dashboard/elmsmedia-dashboard-toolbar-filters.js","lib/elmsmedia-dashboard/elmsmedia-dashboard-toolbar-button.js","lib/elmsmedia-dashboard/elmsmedia-dashboard.js","lib/elmsmedia-upload/elmsmedia-upload.js","lib/lrnapp-book/lrnapp-book-progress-dashboard.js","lib/lrnapp-book/lrnapp-book.js","lib/lrnapp-canvas-listing/lrnapp-canvas-listing.js","lib/lrnapp-cis/lrnapp-cis-course-card.js","lib/lrnapp-cis/lrnapp-cis.js","lib/lrnapp-gallery-grid/lrnapp-gallery-grid.js","lib/lrnapp-media-grid/lrnapp-media-grid.js","lib/lrnapp-media-management/lrnapp-media-management.js","lib/lrnapp-media-upload/lrnapp-media-upload.js","lib/lrnapp-open-studio/lrnapp-open-studio-table.js","lib/lrnapp-open-studio/lrnapp-open-studio-projects.js","lib/lrnapp-open-studio/lrnapp-open-studio-assignments.js","lib/lrnapp-open-studio/lrnapp-open-studio.js","lib/lrnapp-studio-dashboard/lrnapp-block-recent-project.js","lib/lrnapp-studio-dashboard/lrnapp-block-recent-submissions.js","lib/lrnapp-studio-dashboard/lrnapp-block-recent-comments-comment.js","lib/lrnapp-studio-dashboard/lrnapp-block-recent-comments.js","lib/lrnapp-studio-dashboard/lrnapp-block-need-feedback.js","lib/lrnapp-studio-dashboard/lrnapp-studio-dashboard.js","lib/lrnapp-studio-instructor/lrnapp-studio-instructor.js","lib/lrnapp-studio-kanban/lrnapp-studio-project-button.js","lib/lrnapp-studio-kanban/lrnapp-studio-assignment-button.js","lib/lrnapp-studio-kanban/lrnapp-studio-kanban.js","lib/lrnapp-studio-root/lrnapp-studio-root.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-display.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-media-editoverlay.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-edit-add-asset.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-edit-image.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-edit-images.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-edit-file.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-edit-files.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-edit-video.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-edit-links.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-edit-textarea.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-edit.js","lib/lrnapp-studio-submission/lrnapp-studio-block.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-critique-panel.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-critique.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-object.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-comment.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-comments.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-page.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-button.js","lib/lrnapp-studio-submission/lrnapp-studio-submission.js","lib/mooc-content/mooc-content.js"],"sourcesContent":["import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-icon-button/paper-icon-button.js\";\nimport \"@polymer/paper-dropdown-menu/paper-dropdown-menu.js\";\nimport \"@polymer/paper-listbox/paper-listbox.js\";\nimport \"@polymer/paper-item/paper-item.js\";\nlet ElmsmediaDashboardFilters = Polymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n      paper-dropdown-menu {\n        display: block;\n        width: 100%;\n      }\n    </style>\n\n    <paper-dropdown-menu label=\"Order\">\n      <paper-listbox\n        slot=\"dropdown-content\"\n        attr-for-selected=\"name\"\n        selected=\"{{form.order}}\"\n      >\n        <paper-item name=\"ASC\">Ascending</paper-item>\n        <paper-item name=\"DESC\">Descending</paper-item>\n      </paper-listbox>\n    </paper-dropdown-menu>\n\n    <paper-dropdown-menu label=\"Media Type\">\n      <paper-listbox\n        slot=\"dropdown-content\"\n        attr-for-selected=\"name\"\n        selected=\"{{form.media_type}}\"\n      >\n        <paper-item name=\"elmsmedia_image\">Image</paper-item>\n        <paper-item name=\"h5p\">H5P</paper-item>\n        <paper-item name=\"video\">Video</paper-item>\n        <paper-item name=\"external_video\">External Video</paper-item>\n        <paper-item name=\"audio\">audio</paper-item>\n      </paper-listbox>\n    </paper-dropdown-menu>\n  `,\n\n  is: \"elmsmedia-dashboard-filters\",\n\n  properties: {\n    form: {\n      type: Object,\n      value: {}\n    }\n  },\n\n  observers: [\"_formChanged(form.*)\"],\n\n  _formChanged: function(form) {\n    const path = form.path.replace(\"form.\", \"\");\n    const propValue = form.value;\n    this.fire(\"add-filter\", {\n      path: path,\n      propValue: propValue\n    });\n  }\n});\nexport { ElmsmediaDashboardFilters };\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-styles/color.js\";\nimport \"@polymer/paper-styles/typography.js\";\n/**\nA material design [chip](https://www.google.com/design/spec/components/chips.html)\n### Example\n```html\n<paper-chip>Apples</paper-chip>\n```\n### Styling\nThe following custom properties and mixins are available for styling:\nCustom property | Description | Default\n----------------|-------------|----------\n`--paper-chip-background` | The background color of the chip | `--paper-grey-300`\n`--paper-chip-background-selectable` | The background color hover of the chip | `--paper-grey-600`\n`--paper-chip-color` | The text color | `--primary-text-color`\n`--paper-chip-color-selectable` | The text color hover of the chip | `white`\n@demo demo/chip.html\n*/\nlet PaperChip = Polymer({\n  _template: html`\n    <custom-style>\n      <style is=\"custom-style\">\n        :host {\n          display: inline-block;\n          background-color: var(--paper-chip-background, var(--paper-grey-300));\n          height: 32px;\n          line-height: 32px !important;\n          padding: 0 12px;\n          border-radius: 16px;\n          color: var(--paper-chip-color, var(--primary-text-color));\n          font-size: 13px !important;\n          @apply --paper-font-body1;\n          @apply --paper-chip;\n        }\n        :host([selectable]) {\n          cursor: pointer;\n        }\n        :host([selectable]:hover) {\n          background-color: var(\n            --paper-chip-background-selectable,\n            var(--paper-grey-400)\n          );\n        }\n      </style>\n    </custom-style>\n    <slot></slot>\n  `,\n  is: \"paper-chip\",\n  properties: {\n    selectable: {\n      type: Boolean,\n      value: false,\n      reflectToAttribute: true\n    }\n  }\n});\nexport { PaperChip };\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-icon-button/paper-icon-button.js\";\nimport \"@polymer/paper-tooltip/paper-tooltip.js\";\nimport \"./paper-chip.js\";\nlet ElmsmediaDashboardToolbarFilter = Polymer({\n  _template: html`\n    <custom-style>\n      <style is=\"custom-style\">\n        :host {\n          display: flex;\n          font-size: 0.8em;\n        }\n        paper-icon-button {\n          --paper-icon-button: {\n            height: 30px;\n            width: 30px;\n            margin-right: -12px;\n          }\n        }\n      </style>\n    </custom-style>\n    <paper-chip>\n      [[title]]\n      <paper-icon-button\n        id=\"clear\"\n        icon=\"clear\"\n        title=\"Remove filter\"\n        on-click=\"remove\"\n      ></paper-icon-button>\n    </paper-chip>\n    <paper-tooltip\n      for=\"clear\"\n      position=\"top\"\n      animation-delay=\"100\"\n      margin-top=\"5\"\n      aria-hidden=\"true\"\n      >Remove Filter</paper-tooltip\n    >\n  `,\n  is: \"elmsmedia-dashboard-toolbar-filter\",\n  properties: {\n    path: {\n      type: String,\n      value: \"\"\n    },\n    propValue: {\n      type: String,\n      value: \"\"\n    },\n    title: {\n      type: String,\n      value: \"\"\n    }\n  },\n  remove: function(e) {\n    this.fire(\"remove-filter\", {\n      path: this.path,\n      propValue: this.propValue\n    });\n  }\n});\nexport { ElmsmediaDashboardToolbarFilter };\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"./elmsmedia-dashboard-toolbar-filter.js\";\nlet ElmsmediaDashboardToolbarFilters = Polymer({\n  _template: html`\n    <style>\n      :host {\n        display: flex;\n        align-items: center;\n      }\n      elmsmedia-dashboard-toolbar-filter {\n        margin-right: 4.8px;\n      }\n    </style>\n\n    <template is=\"dom-repeat\" items=\"[[_filtersArray]]\" as=\"item\">\n      <elmsmedia-dashboard-toolbar-filter\n        path=\"[[item.path]]\"\n        prop-value=\"[[item.propValue]]\"\n        title=\"[[item.title]]\"\n      ></elmsmedia-dashboard-toolbar-filter>\n    </template>\n  `,\n\n  is: \"elmsmedia-dashboard-toolbar-filters\",\n\n  properties: {\n    filters: {\n      type: Object,\n      value: {}\n    },\n    _filtersArray: {\n      type: Array,\n      computed: \"_filtersArrayCompute(filters, filters.*)\"\n    }\n  },\n\n  _filtersArrayCompute: function(filters) {\n    let filtersArray = [];\n    for (f in filters) {\n      const prop = f;\n      // account for mulitple filter values\n      const values = filters[f].split(\",\");\n      // ignore the page property\n      if (prop !== \"page\") {\n        values.forEach(value => {\n          filtersArray.push({\n            path: prop,\n            propValue: value,\n            title: `${prop}: ${value}`\n          });\n        });\n      }\n    }\n    return filtersArray;\n  }\n});\nexport { ElmsmediaDashboardToolbarFilters };\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\nlet ElmsmediaDashboardToolbarButton = Polymer({\n  _template: html`\n    <style>\n      :host {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        opacity: 0.7;\n      }\n      #title {\n        font-size: 1em;\n        margin: 0;\n        margin-right: 0.3em;\n        padding: 0;\n      }\n    </style>\n    <paper-button id=\"button\">\n      <h3 id=\"title\">[[title]]</h3>\n      <iron-icon id=\"icon\" icon=\"[[icon]]\"></iron-icon>\n    </paper-button>\n  `,\n\n  is: \"elmsmedia-dashboard-toolbar-button\",\n\n  properties: {\n    title: {\n      type: String,\n      value: \"\"\n    },\n    icon: {\n      type: String,\n      value: \"\"\n    }\n  }\n});\nexport { ElmsmediaDashboardToolbarButton };\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@polymer/app-route/app-location.js\";\nimport \"@polymer/paper-dialog/paper-dialog.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@lrnwebcomponents/hax-body/lib/hax-app.js\";\nimport \"./elmsmedia-dashboard-filters.js\";\nimport \"./elmsmedia-dashboard-toolbar-filters.js\";\nimport \"./elmsmedia-dashboard-toolbar-button.js\";\nlet ElmsmediaDashboard = Polymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n      paper-dialog {\n        padding: 1em;\n      }\n      #toolbar {\n        display: flex;\n        justify-content: flex-end;\n        align-items: center;\n      }\n    </style>\n\n    <app-location route=\"{{route}}\"></app-location>\n    <app-route\n      route=\"{{route}}\"\n      pattern=\"/:page\"\n      data=\"{{data}}\"\n      tail=\"{{tail}}\"\n      query-params=\"{{queryParams}}\"\n    ></app-route>\n\n    <div id=\"toolbar\">\n      <elmsmedia-dashboard-toolbar-filters\n        filters=\"[[queryParams]]\"\n      ></elmsmedia-dashboard-toolbar-filters>\n      <elmsmedia-dashboard-toolbar-button\n        icon=\"filter-list\"\n        title=\"Filter\"\n        on-click=\"toggleFilters\"\n      ></elmsmedia-dashboard-toolbar-button>\n      <elmsmedia-dashboard-toolbar-button\n        icon=\"search\"\n        title=\"Search\"\n        on-click=\"toggleSearch\"\n      ></elmsmedia-dashboard-toolbar-button>\n    </div>\n\n    <paper-dialog id=\"filterDialog\" with-backdrop=\"\">\n      <h3>Filter Media</h3>\n      <elmsmedia-dashboard-filters\n        form=\"{{queryParams}}\"\n        on-filter-changed=\"_filterChanged\"\n      ></elmsmedia-dashboard-filters>\n      <div class=\"buttons\">\n        <paper-button dialog-dismiss=\"\">Dismiss dialog</paper-button>\n      </div>\n    </paper-dialog>\n\n    <hax-app\n      id=\"haxSource\"\n      auto=\"\"\n      query-param=\"title\"\n      request-end-point=\"[[requestEndPoint]]\"\n      request-params=\"{{queryParams}}\"\n      data=\"{\n      &quot;root&quot;: &quot;list&quot;,\n      &quot;gizmoType&quot;: &quot;video&quot;,\n      &quot;url&quot;: &quot;http://media.elmsln.local/entity_iframe/node/&quot;,\n      &quot;id&quot;: &quot;id&quot;,\n      &quot;title&quot;: &quot;attributes.title&quot;,\n      &quot;description&quot;: &quot;attributes.body&quot;,\n      &quot;image&quot;: &quot;display.image&quot;,\n      &quot;customGizmoType&quot;: &quot;type&quot;}\"\n    ></hax-app>\n  `,\n\n  is: \"elmsmedia-dashboard\",\n\n  properties: {\n    requestEndPoint: {\n      type: String,\n      value: \"\"\n    },\n    queryParams: {\n      type: Object,\n      value: {}\n    }\n  },\n\n  _computeRequestEndPoint: function(endPoint, csrfToken) {\n    return `${endPoint}/api/data?token=${csrfToken}`;\n  },\n\n  /**\n   * Listen for filter changes and reset the page count\n   * @todo unsetting this object does not always work\n   */\n  _filterChanged: function(e) {\n    let newParams = Object.assign({}, e.detail);\n    newParams = this._cleanParams(newParams);\n    this.set(\"queryParams\", {});\n    this.set(\"queryParams\", newParams);\n  },\n\n  /**\n   * Helper function to prepare parameters object for the url\n   * @todo this is horribly written\n   */\n  _cleanParams: function(params) {\n    let newParams = {};\n    for (x in params) {\n      const prop = x;\n      const value = params[x];\n      if (value === \"\" || value === null || value === undefined) {\n        // do nothing\n      } else {\n        // add the clean property to the new params object\n        newParams[prop] = value;\n      }\n    }\n    return newParams;\n  },\n\n  toggleSearch: function(e) {\n    const searchEnabled = this.$.haxSource.search;\n    this.$.haxSource.search = !searchEnabled;\n  },\n\n  toggleFilters: function(e) {\n    this.$.filterDialog.toggle();\n  },\n\n  removeFilter: function(path, propValue) {\n    const currentParams = Object.assign({}, this.queryParams);\n    // get the current value of the filter\n    const currentValue = _.get(currentParams, path);\n    // remove the specified filter from the current value\n    // by converting to an array and filtering it\n    const newValue = currentValue\n      .split(\",\")\n      .filter(v => v !== propValue)\n      .join(\",\");\n    const newParams = _.set(currentParams, path, newValue);\n    const newCleanParams = this._cleanParams(newParams);\n    this.set(\"queryParams\", {});\n    this.set(\"queryParams\", newCleanParams);\n  },\n\n  ready: function() {\n    this.addEventListener(\"remove-filter\", e => {\n      this.removeFilter(e.detail.path, e.detail.propValue);\n    });\n  },\n  detached: function() {\n    this.removeEventListener(\"remove-filter\", e => {\n      this.removeFilter(e.detail.path, e.detail.propValue);\n    });\n  }\n});\nexport { ElmsmediaDashboard };\n","/**\n * Copyright 2018 The Pennsylvania State University\n * @license Apache-2.0, see License.md for full text.\n */\nimport { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@vaadin/vaadin-upload/vaadin-upload.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nimport \"@polymer/paper-dialog/paper-dialog.js\";\nimport \"@polymer/app-layout/app-toolbar/app-toolbar.js\";\nimport \"@polymer/paper-dropdown-menu/paper-dropdown-menu.js\";\nimport \"@polymer/paper-listbox/paper-listbox.js\";\nimport \"@polymer/paper-item/paper-item.js\";\nimport \"@polymer/paper-checkbox/paper-checkbox.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@polymer/paper-input/paper-input.js\";\nlet ElmsMediaUpload = Polymer({\n  _template: html`\n    <custom-style>\n      <style is=\"custom-style\" include=\"materializecss-styles\">\n        :host {\n          display: block;\n        }\n        paper-button {\n          padding: 0;\n          margin: 0;\n          min-width: 1rem;\n        }\n        vaadin-upload.thick-border {\n          --primary-color: #396;\n          --dark-primary-color: #063;\n          --light-primary-color: #6c9;\n          --error-color: darkred;\n          border: 2px solid #ccc;\n          padding: 14px;\n          background: #eee;\n          border-radius: 0;\n        }\n        vaadin-upload.thick-border[dragover] {\n          border-color: #396;\n        }\n      </style>\n    </custom-style>\n    <vaadin-upload\n      target\\$=\"{{uploadPath}}\"\n      method=\"POST\"\n      form-data-name=\"file-upload\"\n      timeout=\"0\"\n      accept=\"video/mp4,image/*,audio/*,application/pdf,application/zip\"\n    ></vaadin-upload>\n    <paper-dialog\n      id=\"dialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n      with-backdrop=\"\"\n    >\n      <app-toolbar>\n        <paper-dropdown-menu label=\"Display style\">\n          <paper-listbox slot=\"dropdown-content\" class=\"dropdown-content\">\n            <paper-item value=\"image\">Image</paper-item>\n            <paper-item value=\"image__circle\">Circle</paper-item>\n          </paper-listbox>\n        </paper-dropdown-menu>\n        <paper-checkbox class=\"styled\" checked=\"{{hasLightbox}}\">\n          Lightbox <span class=\"subtitle\"> Users can click to expand </span>\n        </paper-checkbox>\n        <paper-button raised=\"\" class=\"green\">Save</paper-button>\n      </app-toolbar>\n      <h2 id=\"title\">{{uploadTitle}}</h2>\n      <paper-input\n        label=\"Title\"\n        placeholder=\"Title\"\n        value=\"{{uploadTitle}}\"\n      ></paper-input>\n      <div id=\"content\"></div>\n    </paper-dialog>\n  `,\n\n  is: \"elmsmedia-upload\",\n\n  listeners: {\n    \"upload-success\": \"_uploadSuccess\"\n  },\n\n  properties: {\n    uploadPath: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    uploadTitle: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    hasLightbox: {\n      type: Boolean,\n      reflectToAttribute: true,\n      notify: true\n    }\n  },\n\n  /**\n   * _uploadSuccess triggered after an event of a successful upload goes through\n   */\n  _uploadSuccess: function(event) {\n    // parse the raw response cause it won't be natively\n    // since event wants to tell you about the file generally\n    var response = JSON.parse(event.detail.xhr.response);\n    this.uploadTitle = response.data.node.title;\n    this.$.content.innerHTML = response.data.node.nid;\n    this.$.dialog.open();\n  }\n});\nexport { ElmsMediaUpload };\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-icons/iron-icons.js\";\nimport \"@polymer/iron-icons/hardware-icons.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/paper-icon-button/paper-icon-button.js\";\nimport \"@polymer/paper-styles/color.js\";\nimport \"@lrnwebcomponents/paper-search/lib/paper-search-bar.js\";\nimport \"@polymer/paper-tooltip/paper-tooltip.js\";\nimport \"@polymer/paper-slider/paper-slider.js\";\nimport \"@polymer/app-layout/app-layout.js\";\nimport \"@polymer/app-layout/app-drawer/app-drawer.js\";\nimport \"@polymer/app-layout/app-header/app-header.js\";\nimport \"@polymer/app-layout/app-toolbar/app-toolbar.js\";\nimport \"@polymer/app-layout/app-scroll-effects/app-scroll-effects.js\";\nimport \"@polymer/app-route/app-location.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nimport \"@lrnwebcomponents/lrndesign-stepper/lrndesign-stepper.js\";\nimport \"@lrnwebcomponents/lrnsys-progress/lrnsys-progress.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/page-scroll-position/page-scroll-position.js\";\nimport \"@lrnwebcomponents/hax-body/hax-body.js\";\nimport \"@lrnwebcomponents/material-progress/material-progress.js\";\nimport \"@lrnwebcomponents/lrndesign-mapmenu/lrndesign-mapmenu.js\";\n\n/**\n`lrnapp-book-progress-dashboard`\nA LRN element\n\n* @demo demo/index.html\n\n@microcopy\n  progress - the amount the student has moved through the active item(s)\n  active item - pages of content the user is engaging with\n  stats\n\n*/\nPolymer({\n  _template: html`\n    <custom-style>\n      <style is=\"custom-style\" include=\"materializecss-styles\">\n        :host {\n          display: block;\n        }\n        paper-progress {\n          --paper-progress-active-color: var(--paper-blue-300, blue);\n          --paper-progress-secondary-color: var(--paper-yellow-300, yellow);\n          --paper-progress-container-color: var(--paper-green-300, green);\n          height: 1.5em;\n          display: inline-block;\n          vertical-align: text-top;\n        }\n        lrndesign-avatar {\n          display: inline-block;\n        }\n        lrnsys-progress-circle {\n          font-size: 4em;\n        }\n        .progress-icon {\n          height: 2.5em;\n          width: 2.5em;\n          padding: 0.25em;\n          display: inline-block;\n          color: white;\n          background-color: var(--paper-gray-300, gray);\n          border-radius: 50%;\n        }\n        .progress-row {\n          display: block;\n          width: 100%;\n        }\n        .progress-left,\n        .progress-right {\n          padding: 1em;\n          display: inline-block;\n          height: 10em;\n          vertical-align: text-top;\n        }\n        material-progress-histo {\n          width: 100%;\n          @apply (--paper-font-body2);\n        }\n        material-progress-bars {\n          width: 100%;\n          @apply (--paper-font-body2);\n        }\n        material-progress-bars > .bar > span {\n          text-align: end;\n          font-size: 0.9em;\n          @apply (--layout-flex);\n        }\n        .bar {\n          background-color: var(--paper-deep-orange-500);\n        }\n        .bar.run {\n          background-color: var(--paper-purple-500);\n        }\n        .bar.hello {\n          background-color: var(--paper-cyan-500);\n        }\n        .bar.world {\n          background-color: var(--paper-orange-500);\n        }\n      </style>\n    </custom-style>\n    <iron-ajax\n      id=\"dataajax\"\n      url=\"[[sourcePath]]\"\n      params=\"[[requestParams]]\"\n      handle-as=\"json\"\n      on-response=\"handleDataResponse\"\n      last-response=\"{{readTimeData}}\"\n    ></iron-ajax>\n\n    <div id=\"bodyloading\" class=\"loading\">\n      <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n      <h3 class=\"loading-text\">Loading content..</h3>\n    </div>\n    <div>\n      <material-progress-bars max=\"128\" bar-height=\"22\" animated=\"\">\n        <div class=\"bar\" data-value=\"21\">\n          <iron-icon icon=\"av:video-library\"></iron-icon>\n        </div>\n        <div class=\"bar run\" data-value=\"13\">\n          <iron-icon icon=\"maps:directions-run\"></iron-icon>\n        </div>\n        <div class=\"bar hello\" data-value=\"50\">\n          <iron-icon icon=\"maps:directions-bike\"></iron-icon>\n          <span>Hello</span>\n        </div>\n        <div class=\"bar world\" data-value=\"30\"><span>World</span></div>\n      </material-progress-bars>\n      <material-progress-histo bar-height=\"22\" animated=\"\">\n        <div class=\"bar\" data-value=\"21\">\n          <iron-icon icon=\"maps:directions-walk\"></iron-icon>\n        </div>\n        <div class=\"bar run\" data-value=\"13\">\n          <iron-icon icon=\"maps:directions-run\"></iron-icon>\n        </div>\n        <div class=\"bar hello\" data-value=\"50\">\n          <iron-icon icon=\"maps:directions-bike\"></iron-icon>\n          <span>Hello</span>\n        </div>\n        <div class=\"bar world\" data-value=\"30\"><span>World</span></div>\n      </material-progress-histo>\n      <template is=\"dom-repeat\" items=\"[[dashboardItems]]\" as=\"item\">\n        <div class=\"progress-row\">\n          <div class=\"progress-left\">\n            <lrnsys-progress-circle\n              status=\"disabled\"\n              class=\"flex\"\n              icon=\"[[item.meta.icon]]\"\n            ></lrnsys-progress-circle>\n          </div>\n          <div class=\"progress-right\">\n            <h3 class=\"progress-item-title\">[[item.attributes.title]]</h3>\n            <div class=\"description-content\">\n              <div>\n                <lrn-icon icon=\"network\" class=\"progress-icon\"></lrn-icon>\n                <paper-progress\n                  value=\"70\"\n                  secondary-progress=\"80\"\n                ></paper-progress>\n              </div>\n              <div>\n                <lrndesign-avatar\n                  src=\"[[userData.user.avatar]]\"\n                  label=\"[[userData.user.display_name]]\"\n                ></lrndesign-avatar>\n                <paper-progress\n                  value=\"70\"\n                  secondary-progress=\"80\"\n                ></paper-progress>\n              </div>\n            </div>\n          </div>\n        </div>\n      </template>\n    </div>\n  `,\n\n  is: \"lrnapp-book-progress-dashboard\",\n\n  properties: {\n    /**\n     * Data about the active route; this includes item type and id.\n     */\n    routeData: {\n      type: Object,\n      observer: \"_routeDataChanged\"\n    },\n    /**\n     * Params for the request for outline/book to load.\n     */\n    requestParams: {\n      type: Object,\n      value: {\n        node: null\n      }\n    },\n    /**\n     * Path to get data into the UI\n     */\n    sourcePath: {\n      type: String\n    },\n    /**\n     * Read time data\n     */\n    readTimeData: {\n      type: Object,\n      value: []\n    },\n    /**\n     * User data.\n     */\n    userData: {\n      type: Object,\n      value: []\n    },\n    /**\n     * If this is visible; useful for toggling / activating.\n     */\n    showProgress: {\n      type: Boolean,\n      value: false,\n      reflectToAttribute: true,\n      observer: \"_showProgressChanged\"\n    }\n  },\n\n  /**\n   * Notice route data has changed.\n   */\n  _routeDataChanged: function(newValue, oldValue) {\n    if (typeof newValue !== typeof undefined) {\n      this.requestParams[newValue.type] = newValue.id;\n      // if we're visible kick off the call\n      if (this.progressChanged) {\n        this.$.dataajax.generateRequest();\n      }\n    }\n  },\n\n  /**\n   * Showing element state has changed\n   */\n  _showProgressChanged: function(newValue, oldValue) {\n    // ensure we are visible\n    if (newValue && typeof this.routeData !== typeof undefined) {\n      this.$.dataajax.generateRequest();\n    }\n  },\n\n  /**\n   * Response data.\n   */\n  handleDataResponse: function(obj) {\n    let response = obj.detail.response.data;\n    // show the info\n    this.$.bodyloading.hidden = true;\n    // split the data into two sets\n    this.userData = response.userdata;\n    this.dashboardItems = this._toArray(response.items);\n  },\n\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","/**\n * Copyright 2018 The Pennsylvania State University\n * @license Apache-2.0, see License.md for full text.\n */\nimport { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@polymer/iron-icons/iron-icons.js\";\nimport \"@polymer/iron-icons/hardware-icons.js\";\nimport \"@polymer/paper-icon-button/paper-icon-button.js\";\nimport \"@polymer/paper-styles/color.js\";\nimport \"@lrnwebcomponents/paper-search/lib/paper-search-bar.js\";\nimport \"@polymer/paper-tooltip/paper-tooltip.js\";\nimport \"@lrnwebcomponents/haxcms-elements/lib/haxcms-theme-behavior.js\";\nimport \"@polymer/paper-slider/paper-slider.js\";\nimport \"@lrnwebcomponents/simple-toast/simple-toast.js\";\nimport \"@polymer/app-layout/app-layout.js\";\nimport \"@polymer/app-layout/app-drawer/app-drawer.js\";\nimport \"@polymer/app-layout/app-header/app-header.js\";\nimport \"@polymer/app-layout/app-toolbar/app-toolbar.js\";\nimport \"@polymer/app-layout/app-scroll-effects/app-scroll-effects.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nimport \"@lrnwebcomponents/lrndesign-stepper/lrndesign-stepper.js\";\nimport \"@lrnwebcomponents/lrnsys-progress/lrnsys-progress.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/page-scroll-position/page-scroll-position.js\";\nimport \"@lrnwebcomponents/material-progress/material-progress.js\";\nimport \"@lrnwebcomponents/map-menu/map-menu.js\";\nimport \"./lrnapp-book-progress-dashboard.js\";\n/**\n`lrnapp-book`\nA LRN element\n\n* @demo demo/index.html\n\n@microcopy\n  node / circle - A progress circle on the line\n  nodes / items - the list of items in the progress bar\n  bubble - reserved for when events fire out of an element or value is tracking events\n  percentage - amount complete either in the bar or the nodes themselves\n  bar - the underlayed bar that's tracking overall progression\n  author mode - authoring mode\n*/\nPolymer({\n  _template: html`\n    <custom-style>\n      <style is=\"custom-style\" include=\"materializecss-styles\">\n        :host {\n          display: block;\n          font-size: 16px;\n          box-sizing: content-box;\n        }\n        #toolbar {\n          color: gray;\n          background-color: white;\n          padding: 0 8px;\n          margin: 0;\n          height: auto;\n          box-sizing: content-box;\n          transition: all 0.4s ease;\n        }\n        paper-button {\n          padding: 0;\n          margin: 0;\n          min-width: 16px;\n        }\n        app-drawer {\n          padding: 0;\n          top: 0;\n          bottom: 0;\n          z-index: 1;\n          position: absolute;\n          box-sizing: content-box;\n          --app-drawer-content-container: {\n            background-color: #fafafa;\n            padding: 0;\n            border-right: 1px solid #c8c8c8;\n            overflow-y: scroll;\n            width: 300px !important;\n            box-shadow: 0 76px 8px 0 rgba(0, 0, 0, 0.4);\n            height: 100vh;\n            top: 0;\n            position: sticky;\n          }\n        }\n        lrndesign-stepper-button {\n          --lrndesign-stepper-btn-active: #f6f7f7;\n        }\n        lrndesign-stepper-button ::slotted(paper-button) {\n          margin: 0;\n          height: 48px;\n        }\n        lrndesign-stepper-button ::slotted(.title-container) {\n          padding: 0;\n          width: 100%;\n          right: unset;\n        }\n        lrndesign-stepper-button ::slotted(.node-title) {\n          font-size: 15px;\n          line-height: 24px;\n        }\n\n        .loading {\n          width: 100%;\n          z-index: 1000;\n          opacity: 0.9;\n          text-align: center;\n          align-content: space-around;\n          justify-content: center;\n          position: absolute;\n          background-color: white;\n          padding: 0;\n          margin: 0;\n          display: flex;\n          margin: 0 auto;\n          visibility: visible;\n          transition: visibility 1s, opacity 1s ease;\n        }\n        .loading elmsln-loading {\n          margin: 0 5em;\n          display: inline-flex;\n        }\n        #bodyloading {\n          height: 100%;\n          display: flex;\n          justify-content: center;\n        }\n        #bodyloading .loading,\n        #bodyloading elmsln-loading {\n          display: block;\n          height: 5em;\n        }\n        .outline-title {\n          margin-left: 0.5em;\n          max-width: 50%;\n        }\n        .content-nav-buttons {\n          top: 60%;\n          position: fixed;\n          opacity: 0.8;\n          padding: 0 0.25em;\n          height: 40%;\n          padding-top: 15%;\n          margin-top: -15%;\n        }\n        .content-nav-buttons:hover {\n          opacity: 1;\n        }\n        .prev {\n          left: 0;\n          order: 1;\n        }\n        .next {\n          right: 0;\n          transition: right 0.2s ease;\n          order: 2;\n        }\n        app-header {\n          width: 100%;\n          left: 0 !important;\n          z-index: 2 !important;\n          position: sticky !important;\n        }\n        app-header-layout {\n          margin: 0;\n          padding: 0;\n          width: 100%;\n        }\n        .content-body {\n          position: relative;\n          padding: 0;\n          margin: -3em 4em 5em 4em;\n          font-size: 1.1em;\n          transition: margin 0.4s ease, width 0.4s ease;\n        }\n\n        .content-nav-buttons paper-icon-button {\n          width: 4em;\n          height: 4em;\n          opacity: 0.4;\n          display: block;\n          visibility: visible;\n          transition: opacity 0.4s linear, visibility 1s linear,\n            height 0.4s ease, width 0.4s ease;\n        }\n        .content-nav-buttons paper-icon-button:hover {\n          opacity: 1;\n        }\n        paper-tooltip {\n          --paper-tooltip-opacity: 0.96;\n        }\n        :host([drawer-opened]) .content-nav-buttons paper-icon-button {\n          width: 2.5em;\n          height: 2.5em;\n        }\n        :host([edit-mode]) .content-nav-buttons {\n          opacity: 0;\n          pointer-events: none;\n          visibility: hidden;\n        }\n        .content-title {\n          font-size: 1.4em;\n          margin: 0;\n          padding: 0.25em 0;\n          background-color: white;\n          top: 70px;\n          position: sticky;\n        }\n        .content-current {\n          min-height: 100vh;\n        }\n        .content-next {\n          background-color: grey;\n          opacity: 0.8;\n        }\n        #header {\n          position: sticky;\n          top: 0;\n          left: 0;\n          width: 100%;\n          color: black;\n          background-color: white;\n          z-index: 2;\n          padding: 0;\n          margin: 0;\n          opacity: 1;\n          box-sizing: content-box;\n          transition: all 0.4s ease;\n        }\n        app-drawer-layout {\n          font-family: sans-serif;\n        }\n        :host {\n          --app-drawer-width: 300px;\n        }\n        :host([full-width]) {\n          --app-drawer-width: 0px;\n        }\n        :host([drawer-opened]) .prev,\n        :host([edit-mode]) .prev {\n          left: 19em;\n        }\n        .progress-container {\n          width: 90%;\n          padding: 0;\n          margin: 0 0 0 1em;\n          overflow: visible;\n        }\n\n        [main-title] {\n          font-weight: lighter;\n          padding: 0.6em 0 0 0;\n          margin: 0;\n          height: 3em;\n          overflow-y: scroll;\n        }\n        [hidden] {\n          visibility: hidden !important;\n          opacity: 0 !important;\n          display: block !important;\n        }\n        paper-search-bar[hidden] {\n          display: none !important;\n        }\n        lrnsys-progress {\n          margin-top: 0.5em;\n          padding: 0.2em 0 0 0;\n          box-sizing: content-box;\n        }\n        lrnsys-progress lrnsys-progress-circle {\n          list-style-type: none;\n          box-sizing: content-box;\n        }\n\n        #bookdrawercontent {\n          overflow: scroll;\n          visibility: visible;\n          display: block;\n          opacity: 1;\n          transition: visibility 1s linear, opacity 1s linear;\n        }\n        @media (max-width: 1200px) {\n          :host .content-body {\n            font-size: 0.94em;\n          }\n        }\n        @media (max-width: 960px) {\n          :host .content-body {\n            font-size: 0.92em;\n          }\n        }\n        @media (max-width: 820px) {\n          :host .content-body {\n            font-size: 0.9em;\n          }\n        }\n        @media (max-width: 700px) {\n          :host .content-body {\n            font-size: 0.9em;\n          }\n        }\n        @media (max-width: 639px) {\n          app-drawer-layout {\n            top: 0;\n          }\n          [main-title] {\n            font-size: 0.8em;\n          }\n          .content-title {\n            font-size: 1.1em;\n          }\n          .outline-title {\n            position: absolute !important;\n            clip: rect(1px 1px 1px 1px); /* IE6, IE7 */\n            clip: rect(1px, 1px, 1px, 1px);\n            overflow: hidden;\n            height: 1px;\n          }\n          :host .content-body {\n            margin: 0 0.5em;\n            font-size: 0.9em;\n            width: 85%;\n          }\n          .content-nav-buttons {\n            position: relative;\n            display: flex;\n            top: unset;\n            padding: 0;\n            opacity: 0.8;\n            height: unset;\n            margin: 0;\n          }\n          .content-nav {\n            width: 100%;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            vertical-align: middle;\n          }\n          .next {\n            right: unset;\n          }\n        }\n        @media (max-width: 500px) {\n          [main-title] {\n            font-size: 0.7em;\n          }\n        }\n        \n        :host([edit-mode]) #header {\n          background-color: var(--paper-grey-500);\n        }\n        :host([edit-mode]) #toolbar {\n          opacity: 0.5;\n        }\n        .your-progress-button {\n          padding-right: 1em;\n        }\n        #mapmenu {\n          padding: 1em 0;\n          overflow-x: hidden;\n        }\n        .course-title-drawer {\n          font-size: 1.2em;\n        }\n        /**\n         * Hide the slotted content during edit mode. This must be here to work.\n         */\n        :host([edit-mode]) #slot {\n          display: none;\n        }\n      </style>\n    </custom-style>\n    <page-scroll-position value=\"{{scrollPosition}}\"></page-scroll-position>\n    <div id=\"anchor\"></div>\n    <!-- body where most of the heavy lifting happens -->\n    <app-drawer-layout>\n      <!-- LRNApp book we expect to navigate -->\n      <app-drawer\n        slot=\"drawer\"\n        id=\"bookdrawer\"\n        opened=\"{{drawerOpened}}\"\n        swipe-open=\"\"\n        transition-duration=\"300\"\n      >\n        <div\n          id=\"bookdrawercontent\"\n          style=\"height: 100%; overflow: auto;\"\n          hidden\\$=\"[[!bookItems]]\"\n        >\n          <paper-search-bar\n            hide-filter-button=\"\"\n            hidden\\$=\"[[!showSearch]]\"\n          ></paper-search-bar>\n          <map-menu id=\"mapmenu\" manifest=\"[[manifest]]\">\n            <!-- Server response will populate this -->\n          </map-menu>\n        </div>\n      </app-drawer>\n      <app-header-layout>\n        <app-header slot=\"header\" id=\"header\" shadow=\"\" fixed=\"\">\n          <div id=\"outlineloading\" class=\"loading\">\n            <elmsln-loading color=\"grey-text\" size=\"medium\"></elmsln-loading>\n            <elmsln-loading color=\"grey-text\" size=\"medium\"></elmsln-loading>\n            <elmsln-loading color=\"grey-text\" size=\"medium\"></elmsln-loading>\n          </div>\n          <app-toolbar id=\"toolbar\" sticky=\"\" class=\"tall\">\n            <div style=\"pointer-events: auto;\" class=\"menu-btn-wrap\">\n              <paper-icon-button\n                style=\"pointer-events: auto;\"\n                title=\"Content outline\"\n                id=\"menubutton\"\n                icon=\"menu\"\n                on-tap=\"toggleBook\"\n              ></paper-icon-button>\n            </div>\n            <div spacer=\"\" class=\"outline-title\">[[outlineTitle]]</div>\n            <div spacer=\"\" main-title=\"\" style=\"pointer-events: auto;\">\n              <div class=\"progress-container\">\n                <lrnsys-progress\n                  sound-finish=\"[[soundFinish]]\"\n                  sound=\"[[sound]]\"\n                  complete-sound=\"[[completeSound]]\"\n                  finished-sound=\"[[finishedSound]]\"\n                  title=\"The steps to complete this lesson\"\n                  id=\"progress\"\n                  active=\"{{activePage}}\"\n                  manifest=\"{{manifest}}\"\n                  progressive-unlock=\"\"\n                  size=\"small\"\n                ></lrnsys-progress>\n              </div>\n            </div>\n            <!--\n              <div class=\"your-progress-button\">\n                <lrnsys-dialog body-append modal on-tap=\"progressdashboardopen\" header=\"Your progress\" alt=\"Your progress\">\n                  <span slot=\"button\"><iron-icon icon=\"av:equalizer\"></iron-icon></span>\n                  <div>\n                    <lrnapp-book-progress-dashboard id=\"progressdashboard\" source-path=\"[[progressDashboardPath]]\" route-data=\"[[data]]\"></lrnapp-book-progress-dashboard>\n                  </div>\n                </lrnsys-dialog>\n              </div>\n            -->\n          </app-toolbar>\n        </app-header>\n        <div class=\"content-body\">\n          <div id=\"current\" class=\"content-current\">\n            <h2 id=\"currenttitle\" class=\"content-title\">[[currentTitle]]</h2>\n            <div id=\"bodyloading\" class=\"loading\">\n              <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n              <h3 class=\"loading-text\">Loading content..</h3>\n            </div>\n            <div id=\"contentcontainer\">\n              <div id=\"slot\"><slot></slot></div>\n            </div>\n          </div>\n        </div>\n        <div class=\"content-nav\">\n          <div class=\"content-nav-buttons next\">\n            <paper-icon-button\n              id=\"next\"\n              title=\"[[nextLabel]]\"\n              on-tap=\"_nextBtn\"\n              icon=\"hardware:keyboard-arrow-right\"\n              data-voicecommand=\"next page\"\n              hidden\\$=\"[[!hasNextPage]]\"\n            ></paper-icon-button>\n            <paper-tooltip\n              for=\"next\"\n              position=\"left\"\n              offset=\"0\"\n              animation-delay=\"100\"\n            >\n              [[nextLabel]]\n            </paper-tooltip>\n          </div>\n          <div class=\"content-nav-buttons prev\">\n            <paper-icon-button\n              id=\"prev\"\n              title=\"[[prevLabel]]\"\n              on-tap=\"_prevBtn\"\n              icon=\"hardware:keyboard-arrow-left\"\n              data-voicecommand=\"previous page\"\n              hidden\\$=\"[[!hasPrevPage]]\"\n            ></paper-icon-button>\n            <paper-tooltip\n              for=\"prev\"\n              position=\"right\"\n              offset=\"0\"\n              animation-delay=\"100\"\n            >\n              [[prevLabel]]\n            </paper-tooltip>\n          </div>\n        </div>\n      </app-header-layout>\n    </app-drawer-layout>\n  `,\n\n  is: \"lrnapp-book\",\n  behaviors: [HAXCMSBehaviors.Theme],\n  properties: {\n    /**\n     * App store connection.\n     */\n    appStoreConnection: {\n      type: Object,\n      value: {\n        url:\n          \"/sing100/sites/all/libraries/webcomponents/polymer/apps-src/lrnapp-book/appstore.json\"\n      }\n    },\n    /**\n     * Path for getting progress dashboard data\n     */\n    progressDashboardPath: {\n      type: String\n    },\n    /**\n     * Option to display the search bar.\n     */\n    showSearch: {\n      type: Boolean,\n      reflectToAttribute: true,\n      value: false\n    },\n    /**\n     * Source path to the 'find one' end point\n     */\n    sourcePath: {\n      type: String\n    },\n    /**\n     * Edit / authoring mode.\n     */\n    editMode: {\n      type: Boolean,\n      reflectToAttribute: true,\n      value: false,\n      notify: true,\n      observer: \"_editModeChanged\"\n    },\n    /**\n     * Binding so we can style based on drawer status\n     * @type {Object}\n     */\n    drawerOpened: {\n      type: Boolean,\n      value: true,\n      reflectToAttribute: true\n    },\n    /**\n     * Title for the content\n     */\n    currentTitle: {\n      type: String\n    },\n    /**\n     * Title for the top of the bar\n     */\n    outlineTitle: {\n      type: String\n    },\n    /**\n     * Title for the top of the bar\n     */\n    bookTitle: {\n      type: String,\n      value: \"Course outline\"\n    },\n    /**\n     * If the sound should play on finish.\n     */\n    soundFinish: {\n      type: Boolean,\n      value: true\n    },\n    /**\n     * If the sound should play on complete.\n     */\n    sound: {\n      type: Boolean,\n      value: true\n    },\n    /**\n     * Completing a step sound.\n     */\n    completeSound: {\n      type: String,\n      value: \"\"\n    },\n    /**\n     * Finished sound file.\n     */\n    finishedSound: {\n      type: String,\n      value: \"\"\n    },\n    /**\n     * Distance through the present document so we can visualize\n     */\n    scrollPosition: {\n      type: Number,\n      value: 0,\n      observer: \"_scrollChanged\"\n    },\n    /**\n     * Track the active page exposed from the progress bar.\n     */\n    activePage: {\n      type: Number,\n      value: 0,\n      observer: \"_activePageChanged\"\n    },\n    /**\n     * Track the active outline to load data for the progress bar.\n     */\n    activeOutline: {\n      type: Number,\n      value: 0,\n      observer: \"_activeOutlineChanged\"\n    },\n    /**\n     * List of items in our outline presently.\n     */\n    outlineItems: {\n      type: Array,\n      value: [],\n      notify: true,\n      observer: \"_outlineItemsChanged\"\n    },\n    /**\n     * List of items in our book presently.\n     */\n    bookItems: {\n      type: Array,\n      notify: true\n    },\n    /**\n     * Item responses.\n     */\n    itemResponses: {\n      type: Array,\n      value: []\n    },\n    /**\n     * Params for the request for outline/book to load.\n     */\n    requestParams: {\n      type: Object,\n      notify: true,\n      value: {\n        node: null\n      }\n    },\n    /**\n     * Params for the request for content to load.\n     */\n    pageParams: {\n      type: Object,\n      notify: true,\n      value: {\n        load: false\n      }\n    },\n    /**\n     * Returned data for processing.\n     */\n    outlineData: {\n      type: Object,\n      notify: true\n    },\n    /**\n     * Returned data for processing.\n     */\n    bookData: {\n      type: Object,\n      notify: true\n    },\n    /**\n     * Returned data for processing.\n     */\n    pageData: {\n      type: Object,\n      notify: true\n    },\n    /**\n     * data pathway that expects the present outline returned.\n     */\n    outlinePath: {\n      type: String\n    },\n    /**\n     * data pathway that expects the book chapters returned.\n     */\n    bookPath: {\n      type: String\n    },\n    /**\n     * data pathway that expects the book chapters returned.\n     */\n    pagePath: {\n      type: String\n    },\n    /**\n     * Simple flag for having the previous button show.\n     */\n    hasPrevPage: {\n      type: Boolean,\n      notify: true\n    },\n    /**\n     * Previous page title.\n     */\n    prevLabel: {\n      type: String\n    },\n    /**\n     * Simple flag for having the next button show.\n     */\n    hasNextPage: {\n      type: Boolean,\n      notify: true\n    },\n    /**\n     * Next page title.\n     */\n    nextLabel: {\n      type: String\n    },\n    /**\n     * Ensure scrolling doesn't influence during a transition.\n     */\n    resetScroll: {\n      type: Boolean,\n      value: false\n    },\n    /**\n     * Store current page data.\n     */\n    currentPageData: {\n      type: Object,\n      value: {},\n      observer: \"_currentPageDataUpdated\"\n    },\n    /**\n     * Store current page data.\n     */\n    manifest: {\n      type: Object,\n      value: {},\n      observer: '_manifestChanged',\n    },\n    /**\n     * Rebuild outline flag so we know to call it on page build.\n     */\n    rebuildOutline: {\n      type: Boolean,\n      value: false\n    },\n    /**\n     * Track if we should go full width or not.\n     */\n    fullWidth: {\n      type: Boolean,\n      reflectToAttribute: true,\n      value: false,\n      observer: \"_fullWidthChanged\"\n    }\n  },\n\n  /**\n   * Ready event.\n   */\n  ready: function(e) {\n    this.setupHAXTheme(true, this.$.contentcontainer);\n    window.SimpleToast.requestAvailability();\n    this.$.bodyloading.hidden = true;\n    // scroll top into view\n    setTimeout(() => {\n      this._resetScroll();\n    }, 500);\n  },\n  /**\n   * attached life cycle\n   */\n  attached: function() {\n    this.$.progress.addEventListener(\n      \"node-percent-milestone\",\n      this.testMilestone.bind(this)\n    );\n    this.$.mapmenu.addEventListener(\n      \"link-clicked\",\n      this._menuItemClicked.bind(this)\n    );\n  },\n  /**\n   * detached life cycle\n   */\n  detached: function() {\n    this.setupHAXTheme(false);\n    this.$.progress.removeEventListener(\n      \"node-percent-milestone\",\n      this.testMilestone.bind(this)\n    );\n    this.$.mapmenu.removeEventListener(\n      \"link-clicked\",\n      this._menuItemClicked.bind(this)\n    );\n  },\n  _menuItemClicked: function(e) {\n    let i = this.manifest.items.findIndex(j => j.id === e.detail.id);\n    this.activePage = i;\n  },\n  /**\n   * When element is told to be full width it'll close things.\n   */\n  _fullWidthChanged: function(newValue, oldValue) {\n    this.updateStyles();\n  },\n  /**\n   * Handle click on dashboard to trigger loading data.\n   */\n  progressdashboardopen: function(e) {\n    this.$.progressdashboard.showProgress = true;\n  },\n\n  /**\n   * Generate path to point to the right endpoint for updating items.\n   */\n  _computePageUpdatePath: function(data, sourcePath) {\n    return sourcePath.replace(\"%\", data.id);\n  },\n\n  /**\n   * Calculate what would happen if we added a page here.\n   */\n  _computeCreateRequestBody: function(currentPageData) {\n    if (typeof currentPageData.page !== typeof undefined) {\n      return {\n        bid: currentPageData.page.relationships.book.id,\n        pid: currentPageData.page.relationships.parent.id\n      };\n    }\n  },\n\n  /**\n   * React when state changes for editMode\n   */\n  _editModeChanged: function(newValue, oldValue) {\n    if (typeof newValue !== typeof undefined) {\n      if (newValue === true) {\n        this.$.currenttitle.contentEditable = true;\n        // block scroll tracking during edit mode\n        this.resetScroll = true;\n        // notification to user\n        const evt = new CustomEvent(\"simple-toast-show\", {\n          bubbles: true,\n          cancelable: true,\n          detail: {\n            text: \"Editor mode active\",\n            duration: 5000,\n          }\n        });\n      } else {\n        this.$.currenttitle.contentEditable = false;\n        // allow scrolling to take place now\n        this.resetScroll = false;\n        // we were in edit mode, now time to save for real\n        if (oldValue === true) {\n          // see if title changed\n          if (this.$.currenttitle.innerHTML !== this.currentPageData.title) {\n            this.currentPageData.title = this.$.currenttitle.innerHTML;\n          }\n          const evt = new CustomEvent(\"simple-toast-show\", {\n            bubbles: true,\n            cancelable: true,\n            detail: {\n              text: \"Saved\",\n              duration: 0,\n            }\n          });\n          this.dispatchEvent(evt);\n        }\n      }\n    }\n  },\n\n  /**\n   * A book level button was pressed, we need to invoke a change of\n   * content as well as outline.\n   */\n  _activeOutlineChanged: function(newValue, oldValue) {\n    if (\n      typeof newValue !== typeof undefined &&\n      typeof oldValue !== typeof undefined\n    ) {\n      // trigger loading state\n      this.rebuildOutline = true;\n    }\n  },\n\n  /**\n   * Reset scroll position visually and internally data wise.\n   */\n  _resetScroll: function() {\n    this.resetScroll = true;\n    this.scrollPosition = 0;\n    this.$.anchor.scrollIntoView({\n      block: \"start\",\n      behavior: \"smooth\",\n      inline: \"nearest\"\n    });\n  },\n\n  /**\n   * React to active page being changed.\n   */\n  _activePageChanged: function(newValue, oldValue) {\n    if (typeof newValue !== typeof undefined) {\n      if (typeof this.outlineItems !== typeof undefined && this.outlineItems.length > 0) {\n        this.fire(\"json-outline-schema-active-item-changed\", this.outlineItems[newValue]);\n      }\n      // scroll into view the container that's about to be swapped out\n      if (typeof oldValue !== typeof undefined) {\n      }\n      // ensure that scrolling percentage doesn't increase the next item\n      // while active is being changed\n      setTimeout(() => {\n        this.resetScroll = false;\n      }, 1000);\n\n      // manage the previous page button on the UI\n      if (newValue == 0) {\n        this.hasPrevPage = false;\n      } else {\n        this.hasPrevPage = true;\n        if (typeof this.outlineItems !== typeof undefined) {\n          this.prevLabel = this.outlineItems[newValue - 1].title;\n        }\n      }\n      // manage next page button on the UI\n      if (\n        typeof this.outlineItems !== typeof undefined &&\n        newValue + 1 == this.outlineItems.length\n      ) {\n        this.hasNextPage = false;\n      } else {\n        this.hasNextPage = true;\n        if (typeof this.outlineItems !== typeof undefined) {\n          this.nextLabel = this.outlineItems[newValue + 1].title;\n        }\n      }\n    }\n  },\n\n  /**\n   * React to items being changed.\n   */\n  _outlineItemsChanged: function(newValue, oldValue) {\n    // these need set immediately\n    if (typeof newValue !== typeof undefined && newValue.length != 0) {\n      // manage the previous page button on the UI\n      if (this.activePage != 0) {\n        this.prevLabel = newValue[this.activePage - 1].title;\n      }\n      // manage next page button on the UI\n      if (this.activePage + 1 != newValue.length) {\n        this.nextLabel = newValue[this.activePage + 1].title;\n      }\n    }\n  },\n\n  /**\n   * Test what milestone has been hit and if we should start to preload\n   * items as a result of it!\n   */\n  testMilestone: function(e) {\n    // we should preload the next page\n    if (e.detail.percentage == 75) {\n      console.log(\n        \"@todo preload the next page and present grayed out right of UI.\"\n      );\n    }\n  },\n\n  /**\n   * Pass down scroll change to the element for progress visualization.\n   */\n  _scrollChanged: function(newValue, oldValue) {\n    // only evaluate scroll if value is greater then previous\n    if (\n      typeof this.outlineItems !== typeof undefined &&\n      typeof this.outlineItems[this.activePage] !== typeof undefined &&\n      newValue > this.outlineItems[this.activePage].metadata.value &&\n      !this.resetScroll\n    ) {\n      // once we get 90% of the way through the material consider it finished\n      if (newValue >= 75) {\n        this.outlineItems[this.activePage].metadata.value = this.outlineItems[\n          this.activePage\n        ].metadata.max;\n        this.set(\n          \"outlineItems.\" + this.activePage + \".metadata.value\",\n          this.outlineItems[this.activePage].metadata.max\n        );\n      } else {\n        this.outlineItems[this.activePage].metadata.value = newValue;\n        this.set(\"outlineItems.\" + this.activePage + \".metadata.value\", newValue);\n      }\n    }\n  },\n\n  /**\n   * Pass down the click to the next page if we have one\n   */\n  _nextBtn: function(e) {\n    // make sure we are able to move forward more\n    if (this.activePage < this.outlineItems.length - 1) {\n      this.set(\n        \"outlineItems.\" + this.activePage + \".metadata.value\",\n        this.outlineItems[this.activePage].metadata.max\n      );\n      this.activePage = this.activePage + 1;\n    }\n  },\n\n  /**\n   * Pass down the click to the prev page if we have one\n   */\n  _prevBtn: function(e) {\n    if (this.activePage > 0) {\n      this.activePage = this.activePage - 1;\n    }\n  },\n\n  /**\n   * Toggle the book drawer\n   */\n  toggleBook: function(e) {\n    // if we are in edit mode then we ned to close this\n    this.$.bookdrawer.toggle();\n    this.fullWidth = !this.$.bookdrawer.opened;\n  },\n\n  /**\n   * Handle the response.\n   */\n  _manifestChanged: function(newValue, oldValue) {\n    if (typeof newValue !== typeof undefined) {\n      const items = newValue.items;\n      const outlineTitle = newValue.title;\n      // set active to 0 because once we update the outlineItems it will try to\n      // pick a title and be out of sync for a moment in time\n      if (this.activePage !== 0) {\n        this.activePage = 0;\n      }\n      // set outline items to repaint, aggressively\n      this.set(\"outlineItems\", []);\n      this.set(\"outlineItems\", items);\n      this.notifyPath('outlineItems.*');\n      this.set('bookItems', []);\n      this.set('bookItems', items);\n      this.notifyPath('bookItems.*');\n      // set title to match new parent title\n      this.set(\"outlineTitle\", outlineTitle);\n      this.$.outlineloading.hidden = true;\n      this.pageParams.load = true;\n    }\n  },\n  /**\n   * Handle page object getting updated. This allows\n   * for updating parts of the page either from the localcache\n   * or from the ajax call.\n   */\n  _currentPageDataUpdated: function(newValue, oldValue) {\n    if (\n      typeof newValue !== typeof undefined &&\n      typeof newValue.content !== typeof undefined\n    ) {\n      // set page title; easiest for sure\n      this.set(\"currentTitle\", newValue.title);\n      // when updating data we need to clear the slot's content\n      // while maintaining the data model correctly\n      let slot = dom(this);\n      while (slot.firstChild !== null) {\n        slot.removeChild(slot.firstChild);\n      }\n      // add HTML to a div which makes it's DOM unpack\n      var tmp = document.createElement(\"div\");\n      let frag = document\n        .createRange()\n        .createContextualFragment(newValue.content);\n      tmp.appendChild(frag);\n      // trap for text without wrapping HTML tags\n      if (tmp.firstChild == null) {\n        var tmp2 = document.createElement(\"p\");\n        tmp2.innerHTML = tmp.innerHTML;\n        tmp = document.createElement(\"div\");\n        tmp.innerHTML = tmp2.outerHTML;\n      } else if (typeof tmp.firstChild.length !== typeof undefined) {\n        var tmp2 = document.createElement(\"p\");\n        tmp2.innerHTML = tmp.innerHTML;\n        tmp = document.createElement(\"div\");\n        tmp.innerHTML = tmp2.outerHTML;\n      }\n      // same as above but in reverse; now take stuf from what\n      // came across and correctly add it into the slot\n      while (tmp.firstChild) {\n        dom(this).appendChild(tmp.firstChild);\n      }\n      // reset scroll position back to top of this content\n      this._resetScroll();\n      // hide the loading area\n      this.$.bodyloading.hidden = true;\n      // manage state associated w/ edit mode if we were in edit mode previously\n      if (this.editMode && !newValue.page.meta.canUpdate) {\n        this.editMode = false;\n      }\n    }\n  },\n\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-column-group.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-filter.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-sorter.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-selection-column.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/iron-image/iron-image.js\";\nimport \"@polymer/paper-tooltip/paper-tooltip.js\";\nimport \"@lrnwebcomponents/lrnsys-layout/lib/lrnsys-dialog.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/lrndesign-avatar/lrndesign-avatar.js\";\n\nPolymer({\n  _template: html`\n    <custom-style>\n      <style is=\"custom-style\" include=\"materializecss-styles\">\n        :host {\n          display: block;\n          margin: 0 2em;\n        }\n        .loading {\n          width: 100%;\n          z-index: 1000;\n          opacity: 0.8;\n          text-align: center;\n          align-content: center;\n          justify-content: center;\n          height: 100vh;\n          position: absolute;\n          background-color: white;\n        }\n        vaadin-grid#material {\n          height: 75vh;\n          font-family: Roboto, sans-serif;\n          --divider-color: rgba(0, 0, 0, var(--dark-divider-opacity));\n\n          --vaadin-grid-cell: {\n            padding: 0;\n          }\n\n          --vaadin-grid-header-cell: {\n            height: 3.5em;\n            color: rgba(0, 0, 0, var(--dark-secondary-opacity));\n            font-size: 1em;\n          }\n\n          --vaadin-grid-body-cell: {\n            height: 3em;\n            color: rgba(0, 0, 0, var(--dark-primary-opacity));\n            font-size: 0.8em;\n          }\n\n          --vaadin-grid-body-row-hover-cell: {\n            background-color: var(--paper-grey-200);\n          }\n\n          --vaadin-grid-body-row-selected-cell: {\n            background-color: var(--paper-grey-100);\n          }\n\n          --vaadin-grid-focused-cell: {\n            box-shadow: none;\n            font-weight: bold;\n          }\n        }\n\n        vaadin-grid#material .cell {\n          overflow: hidden;\n          text-overflow: ellipsis;\n          padding-right: 56px;\n        }\n\n        vaadin-grid#material .cell.last {\n          padding-right: 24px;\n        }\n\n        vaadin-grid#material .cell.numeric {\n          text-align: right;\n        }\n\n        vaadin-grid#material paper-checkbox {\n          --primary-color: var(--paper-indigo-500);\n          margin: 0 24px;\n        }\n\n        vaadin-grid#material vaadin-grid-sorter {\n          --vaadin-grid-sorter-arrow: {\n            display: none !important;\n          }\n        }\n\n        vaadin-grid#material vaadin-grid-sorter .cell {\n          flex: 1;\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n        }\n\n        vaadin-grid#material vaadin-grid-sorter iron-icon {\n          transform: scale(0.8);\n        }\n\n        vaadin-grid#material vaadin-grid-sorter:not([direction]) iron-icon {\n          color: rgba(0, 0, 0, var(--dark-disabled-opacity));\n        }\n\n        vaadin-grid#material vaadin-grid-sorter[direction] {\n          color: rgba(0, 0, 0, var(--dark-primary-opacity));\n        }\n\n        vaadin-grid#material vaadin-grid-sorter[direction=\"desc\"] iron-icon {\n          transform: scale(0.8) rotate(180deg);\n        }\n        vaadin-grid-sorter {\n          text-align: center;\n        }\n        lrndesign-avatar {\n          display: inline-flex;\n        }\n        lrnsys-dialog {\n          display: inline-flex;\n        }\n        lrnsys-dialog #dialog-trigger span {\n          pointer-events: none;\n        }\n        .avatar-name {\n          line-height: 2em;\n          margin: 0;\n          display: inline-block;\n        }\n        .listing-select {\n          display: block;\n          height: 100%;\n          margin: 0;\n          width: 100%;\n        }\n      </style>\n    </custom-style>\n    <iron-ajax\n      auto\n      url=\"[[sourcePath]]\"\n      params=\"{&quot;return&quot;: &quot;courses&quot;}\"\n      handle-as=\"json\"\n      on-response=\"handleResponse\"\n      last-response=\"{{queryResponse}}\"\n    ></iron-ajax>\n    <div id=\"loading\" class=\"loading\">\n      <h3>Loading..</h3>\n      <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n    </div>\n    <vaadin-grid\n      column-reordering-allowed\n      id=\"material\"\n      aria-label=\"Course list\"\n      items=\"[[_toArray(canvasCourses)]]\"\n    >\n      <vaadin-grid-column width=\"50px\" flex-grow=\"0\">\n        <template class=\"header\"\n          >#</template\n        >\n        <template\n          >[[index]]</template\n        >\n        <template class=\"footer\"\n          >#</template\n        >\n      </vaadin-grid-column>\n      <vaadin-grid-column width=\"200px\" flex-grow=\"0\" resizable>\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"term\">Semester</vaadin-grid-sorter>\n        </template>\n        <template>\n          [[item.term]]\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Semester\"\n            path=\"term\"\n            value=\"[[_filterTerm]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"Semester\"\n              value=\"{{_filterTerm::input}}\"\n              focus-target\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable>\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"name\">Name</vaadin-grid-sorter>\n        </template>\n        <template\n          >[[item.name]]</template\n        >\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Course\"\n            path=\"name\"\n            value=\"[[_filterCourse]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"Course\"\n              value=\"{{_filterCourse::input}}\"\n              focus-target\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable>\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"sis_course_id\">SIS</vaadin-grid-sorter>\n        </template>\n        <template>\n          [[item.sis_course_id]]\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Student information system ID\"\n            path=\"sis_course_id\"\n            value=\"[[_filterSIS]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"SIS\"\n              value=\"{{_filterSIS::input}}\"\n              focus-target\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column width=\"100px\" flex-grow=\"0\" resizable>\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"student_count\">Students</vaadin-grid-sorter>\n        </template>\n        <template\n          >[[item.student_count]]</template\n        >\n      </vaadin-grid-column>\n      <vaadin-grid-column width=\"100px\" flex-grow=\"0\" resizable>\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"workflow_state\">State</vaadin-grid-sorter>\n        </template>\n        <template\n          >[[item.workflow_state]]</template\n        >\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Workflow state\"\n            path=\"workflow_state\"\n            value=\"[[_filterWorkflow]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"State\"\n              value=\"{{_filterWorkflow::input}}\"\n              focus-target\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column>\n        <template class=\"header\"\n          >ELMSLN Course</template\n        >\n        <template>\n          <select\n            name$=\"elmsln--map--:key:[[item.sis_course_id]]:key:[[item.term]]:key:[[item.start]]:key:[[item.end]]\"\n            class=\"listing-select\"\n            value=\"{{item.elmslnCourse::input}}\"\n          >\n            <template is=\"dom-repeat\" items=\"[[elmslnCourses]]\" as=\"elmsCourse\">\n              <option value=\"[[elmsCourse.machineName]]\"\n                >[[elmsCourse.name]] ([[elmsCourse.machineName]])</option\n              >\n            </template>\n          </select>\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Course\"\n            path=\"elmslnCourse\"\n            value=\"[[_filterELMSLNCourse]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"Course\"\n              value=\"{{_filterELMSLNCourse::input}}\"\n              focus-target\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column width=\"100px\" flex-grow=\"0\">\n        <template class=\"header\"></template>\n        <template>\n          <paper-button\n            raised\n            on-click=\"_triggerDialog\"\n            id$=\"{{item.sis_course_id}}\"\n            >Details</paper-button\n          >\n        </template>\n        <template class=\"footer\"></template>\n      </vaadin-grid-column>\n    </vaadin-grid>\n    <iron-ajax\n      id=\"request\"\n      url=\"[[sourcePath]]\"\n      params=\"{&quot;return&quot;: &quot;users&quot;}\"\n      handle-as=\"json\"\n      on-response=\"handleRosterResponse\"\n      last-response=\"{{queryResponse}}\"\n    ></iron-ajax>\n    <lrnsys-dialog\n      tabindex=\"-1\"\n      id=\"details-dialog\"\n      body-append\n      header=\"{{activeCourse.name}}\"\n    >\n      <div slot=\"content\">\n        <template is=\"dom-if\" if=\"{{!roster}}\">\n          <div id=\"loadingRoster\" class=\"loading\">\n            <h3>Loading..</h3>\n            <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n          </div>\n        </template>\n      </div>\n      <div slot=\"header\">\n        <template is=\"dom-if\" if=\"{{roster}}\">\n          <template is=\"dom-if\" if=\"{{activeCourse.image}}\">\n            <iron-image\n              style=\"width:100%; height:200px; background-color: lightgray;\"\n              sizing=\"cover\"\n              preload\n              fade\n              src$=\"{{activeCourse.image}}\"\n            ></iron-image>\n          </template>\n          <span class=\"heading\">\n            <span>Student count: {{activeCourse.student_count}}</span>\n            <span>SIS ID: {{activeCourse.sis_course_id}}</span>\n            <span>Term: {{activeCourse.term}}</span>\n            <span>Workflow: {{activeCourse.workflow_state}}</span>\n          </span>\n        </template>\n      </div>\n      <div id=\"loadingContent\" slot=\"content\">\n        <template is=\"dom-repeat\" items=\"[[_toArray(roster)]]\" as=\"roleList\">\n          <h2>{{roleList.role}}s</h2>\n          <template\n            is=\"dom-repeat\"\n            items=\"[[_toArray(roleList.users)]]\"\n            as=\"user\"\n          >\n            <div class=\"avatar-name\" id$=\"user-{{user.id}}\">\n              <lrndesign-avatar\n                label$=\"{{user.name}}\"\n                src$=\"{{user.picture}}\"\n              ></lrndesign-avatar>\n            </div>\n            <paper-tooltip for$=\"user-{{user.id}}\">{{user.name}}</paper-tooltip>\n          </template>\n        </template>\n      </div>\n    </lrnsys-dialog>\n  `,\n  is: \"lrnapp-canvas-listing\",\n  properties: {\n    elmslnCourses: {\n      type: Array,\n      notify: true\n    },\n    canvasCourses: {\n      type: Array,\n      notify: true\n    },\n    roster: {\n      type: Array,\n      notify: true,\n      value: false\n    },\n    queryResponse: {\n      type: Array,\n      notify: true\n    },\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    activeCourse: {\n      type: String,\n      notify: true,\n      reflectToAttribute: true\n    }\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  },\n  /**\n   * Toggling collapse on an iron element.\n   */\n  collapseToggle: function(e) {\n    e.target.nextElementSibling.toggle();\n  },\n  /**\n   * Trigger the dialog box to opened and kick off request for data.\n   */\n  _triggerDialog: function(e) {\n    let root = this;\n    root.shadowRoot.querySelector(\"#details-dialog\").toggleDialog();\n    root.roster = false;\n    root.activeCourse = root.canvasCourses[e.target.id];\n    root.shadowRoot.querySelector(\"#request\").params[\"sis_course_id\"] =\n      root.activeCourse.sis_course_id;\n    root.shadowRoot.querySelector(\"#request\").generateRequest();\n    root.shadowRoot.querySelector(\"#loadingContent\").style.display = \"none\";\n  },\n  handleResponse: function() {\n    let root = this;\n    root.elmslnCourses = root.queryResponse.data.elmslnCourses;\n    root.canvasCourses = root.queryResponse.data.canvasCourses;\n    root.$.loading.hidden = true;\n  },\n  handleRosterResponse: function() {\n    let root = this;\n    root.roster = root.queryResponse.data;\n    root.shadowRoot.querySelector(\"#loadingContent\").style.display = \"block\";\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-card/paper-card.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\nimport \"@polymer/iron-image/iron-image.js\";\nimport \"@lrnwebcomponents/lrndesign-avatar/lrndesign-avatar.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\n/*\n `lrnapp-cis-course-card`\n Present a course card\n*/\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\">\n      :host {\n        display: inline-flex;\n      }\n      :host([size=\"micro\"]) {\n        transform: scale(0.5);\n      }\n      :host([size=\"small\"]) {\n        transform: scale(0.8);\n      }\n      paper-card {\n        border-radius: 4px;\n        margin: 0;\n        width: 100%;\n      }\n      .card-actions {\n        background-color: #f5f5f5;\n        border-radius: 0 0 4px 4px;\n        padding: 0 8px;\n      }\n      .card-actions .card-action-details {\n        display: inline-block;\n        vertical-align: middle;\n        vertical-align: -webkit-baseline-middle;\n        width: 80%;\n      }\n      #avatar {\n        display: inline-block;\n        vertical-align: text-top;\n        transform: scale(0.8);\n      }\n      .card-control-height {\n        height: 240px;\n      }\n      [elevation=\"0\"] {\n        border: solid 1px #eeeeee;\n      }\n      .text-right {\n        text-align: right;\n      }\n      .text-left {\n        text-align: left;\n      }\n      .name,\n      .title {\n        color: #222;\n        font-size: 14px;\n        font-weight: 600;\n        line-height: 20px;\n        padding: 0 12px;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        margin-top: 8px;\n      }\n      .title {\n        font-size: 12px;\n        font-weight: 400;\n      }\n      .divider {\n        height: 1px;\n        width: 100%;\n        background: #efefef;\n      }\n      .course-icon {\n        --iron-icon-height: 100%;\n        --iron-icon-width: 100%;\n        overflow: hidden;\n        color: grey;\n      }\n      .course-icon:hover,\n      .course-icon:focus {\n        color: black;\n      }\n      .center {\n        margin: auto;\n        width: 80%;\n        padding: 16px;\n      }\n      .link {\n        font-size: 16px;\n        line-height: 16px;\n      }\n      .course-info {\n        width: 100%;\n      }\n      .course-preview {\n        height: 160px;\n      }\n      lrndesign-avatar {\n        margin: -16px 8px 0 0;\n        position: absolute;\n        right: 0;\n      }\n      .card-content {\n        padding: 0;\n        margin: 0;\n        overflow: hidden;\n      }\n      .inline {\n        display: inline;\n      }\n    </style>\n    <paper-card elevation=\"[[elevation]]\">\n      <div class=\"card-content card-control-height card-control-center\">\n        <div class=\"course-preview\">\n          <iron-icon\n            class=\"course-icon\"\n            icon=\"[[icon]]\"\n            hidden\\$=\"[[!icon]]\"\n          ></iron-icon>\n          <iron-image\n            style=\"width:100%; height:100%; background-color: lightgray;\"\n            sizing=\"cover\"\n            preload=\"\"\n            fade=\"\"\n            src=\"[[image]]\"\n            hidden\\$=\"[[!image]]\"\n          ></iron-image>\n        </div>\n        <lrndesign-avatar\n          label=\"[[name]]\"\n          jdenticon=\"\"\n          color=\"[[color]] darken-4\"\n        >\n        </lrndesign-avatar>\n        <div class=\"course-info\">\n          <div class=\"divider\"></div>\n          <div class=\"name\">[[name]]</div>\n          <div class=\"title\">[[title]]</div>\n        </div>\n      </div>\n      <div class=\"card-actions\" hidden=\"\">\n        <div class=\"card-action-details\"></div>\n      </div>\n    </paper-card>\n  `,\n  is: \"lrnapp-cis-course-card\",\n  listeners: {\n    mouseenter: \"_mouseEnter\",\n    mouseleave: \"_mouseLeave\"\n  },\n  properties: {\n    size: {\n      type: String\n    },\n    /**\n     * Cover image src.\n     */\n    image: {\n      type: String\n    },\n    /**\n     * Icon to use if image isn't there.\n     */\n    icon: {\n      type: String,\n      value: false\n    },\n    /**\n     * name of the course like sing100\n     */\n    name: {\n      type: String,\n      value: \"\"\n    },\n    /**\n     * title of the course like Intro to studies\n     */\n    title: {\n      type: String,\n      value: \"\"\n    },\n    /**\n     * color of the course item\n     */\n    color: {\n      type: String,\n      value: \"grey\"\n    },\n    /**\n     * Visual elevation of the item off the UI via paper element height\n     */\n    elevation: {\n      type: Number,\n      value: 1,\n      reflectToAttribute: true\n    }\n  },\n  /**\n   * Increase elevation while hovering.\n   */\n  _mouseEnter: function(e) {\n    this.__oldElevation = this.elevation;\n    if (this.elevation + 2 > 5) {\n      this.elevation = 5;\n    } else {\n      this.elevation += 2;\n    }\n  },\n  /**\n   * Reset the elevation.\n   */\n  _mouseLeave: function(e) {\n    this.elevation = this.__oldElevation;\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/paper-item/paper-item.js\";\nimport \"@polymer/paper-listbox/paper-listbox.js\";\nimport \"@polymer/paper-dropdown-menu/paper-dropdown-menu.js\";\nimport \"@polymer/app-layout/app-toolbar/app-toolbar.js\";\nimport \"@polymer/iron-list/iron-list.js\";\nimport \"@polymer/iron-pages/iron-pages.js\";\nimport \"@polymer/app-route/app-location.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@polymer/paper-toast/paper-toast.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/lrndesign-course-banner/lrndesign-course-banner.js\";\nimport \"@lrnwebcomponents/lrn-icon/lrn-icon.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"@lrnwebcomponents/lrndesign-avatar/lrndesign-avatar.js\";\nimport \"@lrnwebcomponents/lrnsys-layout/lib/lrnsys-dialog.js\";\nimport \"@lrnwebcomponents/responsive-grid/lib/responsive-grid-col.js\";\nimport \"@lrnwebcomponents/responsive-grid/lib/responsive-grid-row.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nimport \"./lrnapp-cis-course-card.js\";\n/**\n `lrnapp-cis`\n A learning application for visualizing course information and listing.\n\n@demo ../../demo/index.html\n\n@microcopy - the mental model for this app\n - cis - Course Information System\n -\n\n*/\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\">\n      :host {\n        display: block;\n        align-content: center;\n      }\n      #loading {\n        width: 100%;\n        z-index: 1000;\n        opacity: 0.9;\n        padding: 4em 0 0 0;\n        text-align: center;\n        align-content: center;\n        justify-content: center;\n        height: 100vh;\n        position: absolute;\n        background-color: white;\n      }\n      iron-selector {\n        line-height: 1em;\n      }\n      iron-selector lrnsys-button {\n        display: inline-flex;\n      }\n      paper-button.coursecard-wrapper {\n        margin: 0;\n        padding: 0;\n      }\n      paper-button.coursecard-wrapper:focus {\n        outline: blue solid 1px;\n      }\n      lrnapp-cis-course-card {\n        padding: 0;\n        margin: 1em;\n        height: 15em;\n        width: 14em;\n      }\n      .courses-grid {\n        margin: 0 auto;\n        width: 95%;\n      }\n      .iron-selected .display-mode {\n        background-color: #ff6f00;\n        color: white;\n      }\n      .iron-list-container {\n        display: flex;\n        flex-direction: column;\n        min-height: 50vh;\n      }\n      iron-list {\n        flex: 1 1 auto;\n      }\n      .dialog-header {\n        height: unset !important;\n        padding: 0 !important;\n      }\n      .course-dialog-heading.lrndesign-course-banner {\n        font-size: 1em;\n        height: 4em !important;\n      }\n      #coursedetails {\n        margin-top: 1em;\n      }\n      #confirm {\n        max-width: 400px;\n        max-height: 300px;\n      }\n      .buttons {\n        text-align: center;\n      }\n      .buttons paper-button {\n        width: 10em;\n        height: 4em;\n      }\n      .dialog-body {\n        padding: 1em;\n        font-size: 1.8em;\n        text-align: center;\n        margin: 0 auto;\n      }\n      .dialog-body lrn-icon.service-confirm-icon {\n        width: 5em;\n        height: 5em;\n      }\n      .dialog-body responsive-grid-col {\n        height: 4.5em;\n      }\n      .dialog-body lrndesign-avatar.service-confirm-icon {\n        display: inline-block;\n      }\n    </style>\n    <iron-ajax\n      auto=\"\"\n      url=\"[[sourcePath]]\"\n      params=\"\"\n      handle-as=\"json\"\n      last-response=\"{{_cisResponse}}\"\n      on-response=\"_handleResponse\"\n    ></iron-ajax>\n    <iron-ajax\n      url=\"[[courseDataPath]]\"\n      params=\"[[_courseDataParams]]\"\n      handle-as=\"json\"\n      id=\"courserequest\"\n      last-response=\"{{_courseResponse}}\"\n      on-response=\"_handleCourseResponse\"\n    ></iron-ajax>\n    <iron-ajax\n      url=\"[[makeServicePath]]\"\n      params=\"\"\n      handle-as=\"json\"\n      id=\"makeservice\"\n      last-response=\"{{_makeServiceResponse}}\"\n      on-response=\"_handleMakeServiceResponse\"\n    ></iron-ajax>\n    <div id=\"loading\">\n      <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n      <h3>Loading..</h3>\n    </div>\n    <app-toolbar class=\"\">\n      <span main-title=\"\"></span>\n      <span\n        top-item=\"\"\n        style=\"text-align:right;font-size:.5em;padding-right:1em;\"\n        >Displaying [[courses.length]] of [[originalCourses.length]]</span\n      >\n      <paper-dropdown-menu label=\"Course\" hidden\\$=\"[[!courses]]\">\n        <paper-listbox\n          slot=\"dropdown-content\"\n          class=\"dropdown-content\"\n          selected=\"{{queryParams.course}}\"\n          attr-for-selected=\"item-id\"\n        >\n          <paper-item>-- Any --</paper-item>\n          <template\n            is=\"dom-repeat\"\n            items=\"[[_toArray(originalCourses)]]\"\n            as=\"course\"\n          >\n            <paper-item item-id=\"[[course.id]]\"\n              >[[course.attributes.name]]</paper-item\n            >\n          </template>\n        </paper-listbox>\n      </paper-dropdown-menu>\n      <paper-dropdown-menu label=\"Program\" hidden\\$=\"[[!programs]]\">\n        <paper-listbox\n          slot=\"dropdown-content\"\n          class=\"dropdown-content\"\n          selected=\"{{queryParams.program}}\"\n          attr-for-selected=\"item-id\"\n        >\n          <paper-item>-- Any --</paper-item>\n          <template is=\"dom-repeat\" items=\"[[_toArray(programs)]]\" as=\"program\">\n            <paper-item item-id=\"[[program.id]]\"\n              >[[program.attributes.name]]</paper-item\n            >\n          </template>\n        </paper-listbox>\n      </paper-dropdown-menu>\n      <paper-dropdown-menu label=\"Academic home\" hidden\\$=\"[[!academics]]\">\n        <paper-listbox\n          slot=\"dropdown-content\"\n          class=\"dropdown-content\"\n          selected=\"{{queryParams.academic}}\"\n          attr-for-selected=\"item-id\"\n        >\n          <paper-item>-- Any --</paper-item>\n          <template\n            is=\"dom-repeat\"\n            items=\"[[_toArray(academics)]]\"\n            as=\"academic\"\n          >\n            <paper-item item-id=\"[[academic.id]]\"\n              >[[academic.attributes.name]]</paper-item\n            >\n          </template>\n        </paper-listbox>\n      </paper-dropdown-menu>\n    </app-toolbar>\n    <div class=\"courses-grid\">\n      <iron-pages\n        selected=\"{{data.page}}\"\n        attr-for-selected=\"name\"\n        fallback-selection=\"courses\"\n        role=\"main\"\n      >\n        <div class=\"iron-list-container\" name=\"courses\">\n          <iron-list id=\"ironlist\" items=\"[[courses]]\" as=\"course\" grid=\"\">\n            <template>\n              <paper-button\n                data-course-id\\$=\"[[course.id]]\"\n                class=\"coursecard-wrapper\"\n                on-tap=\"_loadCourseUrl\"\n              >\n                <lrnapp-cis-course-card\n                  elevation=\"2\"\n                  data-course-id\\$=\"[[course.id]]\"\n                  name=\"[[course.attributes.name]]\"\n                  image=\"[[course.attributes.image]]\"\n                  title=\"[[course.attributes.title]]\"\n                  color=\"[[course.attributes.color]]\"\n                >\n                </lrnapp-cis-course-card>\n              </paper-button>\n            </template>\n          </iron-list>\n        </div>\n      </iron-pages>\n    </div>\n    <app-location\n      route=\"{{route}}\"\n      query-params=\"{{queryParams}}\"\n    ></app-location>\n    <app-route\n      route=\"{{route}}\"\n      pattern=\"[[endPoint]]/:page\"\n      data=\"{{data}}\"\n      tail=\"{{tail}}\"\n      query-params=\"{{queryParams}}\"\n    >\n    </app-route>\n    <lrnsys-dialog tabindex=\"-1\" id=\"dialog\" disable-auto-focus=\"\">\n      <div slot=\"content\">\n        <div id=\"loadingCourse\" class=\"loading\">\n          <h3>Loading..</h3>\n          <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n        </div>\n      </div>\n      <div class=\"dialog-header\" slot=\"header\">\n        <lrndesign-course-banner\n          image=\"[[activeCourse.attributes.image]]\"\n          name=\"[[activeCourse.attributes.name]]\"\n          title=\"[[activeCourse.attributes.title]]\"\n          color=\"[[activeCourse.attributes.color]] darken-4\"\n        >\n        </lrndesign-course-banner>\n      </div>\n      <div id=\"coursedetails\" slot=\"content\">\n        <responsive-grid-row gutter=\"5\">\n          <responsive-grid-col xl=\"6\" lg=\"6\" md=\"6\" sm=\"12\" xs=\"12\">\n            <div class=\"column\">\n              <h4>Details</h4>\n              <ul>\n                <li\n                  hidden\\$=\"[[!activeCourse.relationships.academic.attributes.name]]\"\n                >\n                  Academic unit:\n                  [[activeCourse.relationships.academic.attributes.name]]\n                </li>\n                <li\n                  hidden\\$=\"[[!activeCourse.relationships.program.attributes.name]]\"\n                >\n                  Program:\n                  [[activeCourse.relationships.program.attributes.name]]\n                </li>\n              </ul>\n              <h4>Learning Network</h4>\n              <template\n                is=\"dom-repeat\"\n                items=\"[[activeCourse.topology.Network]]\"\n                as=\"service\"\n              >\n                <template is=\"dom-if\" if=\"[[!service._exists]]\">\n                  <lrnsys-button\n                    raised=\"\"\n                    on-tap=\"_makeService\"\n                    color=\"grey lighten-4\"\n                    icon-class=\"grey lighten-5\"\n                    data-machine-name\\$=\"[[service.machine_name]]\"\n                  >\n                    <lrn-icon\n                      data-machine-name\\$=\"[[service.machine_name]]\"\n                      icon=\"[[service.icon]]\"\n                      class=\"elmsln-hover-icon\"\n                    ></lrn-icon>\n                    <span data-machine-name\\$=\"[[service.machine_name]]\"\n                      >Make the [[service.title]] service</span\n                    >\n                  </lrnsys-button>\n                </template>\n                <template is=\"dom-if\" if=\"[[service._exists]]\">\n                  <lrnsys-button\n                    raised=\"\"\n                    href=\"[[service.url]]\"\n                    hover-class=\"[[service.color]] lighten-4\"\n                  >\n                    <lrn-icon\n                      icon=\"[[service.icon]]\"\n                      class=\"elmsln-hover-icon\"\n                    ></lrn-icon>\n                    <span>[[service.title]]</span>\n                  </lrnsys-button>\n                </template>\n              </template>\n            </div>\n          </responsive-grid-col>\n          <responsive-grid-col xl=\"6\" lg=\"6\" md=\"6\" sm=\"12\" xs=\"12\">\n            <div class=\"column\">\n              <h4>Operations</h4>\n              <template is=\"dom-if\" if=\"[[activeCourse.meta.canUpdate]]\">\n                <lrnsys-button\n                  raised=\"\"\n                  href=\"[[activeCourse.uris.edit]]\"\n                  label=\"Edit\"\n                  hover-class=\"green lighten-4\"\n                  icon=\"create\"\n                ></lrnsys-button>\n                <lrnsys-button\n                  raised=\"\"\n                  href=\"[[activeCourse.uris.addOffering]]\"\n                  label=\"Add offering\"\n                  hover-class=\"amber lighten-3\"\n                  icon=\"icons:add\"\n                ></lrnsys-button>\n              </template>\n              <lrnsys-button\n                raised=\"\"\n                href=\"[[activeCourse.uris.offerings]]\"\n                label=\"Offerings\"\n                hover-class=\"amber lighten-4\"\n                icon=\"social:people\"\n              ></lrnsys-button>\n              <lrnsys-button\n                raised=\"\"\n                href=\"[[activeCourse.uris.sync]]\"\n                label=\"Sync Roster\"\n                hover-class=\"amber lighten-4\"\n                icon=\"notification:sync\"\n              ></lrnsys-button>\n              <lrnsys-button\n                raised=\"\"\n                href=\"[[activeCourse.uris.uri]]\"\n                label=\"Course page (legacy)\"\n                hover-class=\"brown lighten-4\"\n                icon=\"delete\"\n              ></lrnsys-button>\n              <template is=\"dom-if\" if=\"[[activeCourse.meta.canDelete]]\">\n                <div\n                  style=\"padding: 1em;width: 100%;margin: .5em 0;display: block;background-color:#FF2222;color:#ffffff;border: 1px solid #222222;\"\n                >\n                  <h4>Danger zone</h4>\n                  <lrnsys-button\n                    raised=\"\"\n                    href=\"[[activeCourse.uris.delete]]\"\n                    label=\"Delete\"\n                    hover-class=\"red lighten-1\"\n                    color=\"red lighten-3\"\n                    icon=\"delete\"\n                  ></lrnsys-button>\n                </div>\n              </template>\n            </div>\n          </responsive-grid-col>\n        </responsive-grid-row>\n        <p>[[activeCourse.attributes.body]]</p>\n      </div>\n    </lrnsys-dialog>\n    <lrnsys-dialog id=\"confirm\">\n      <div class=\"dialog-header\" slot=\"header\">\n        Add this to the\n        <strong>[[activeCourse.attributes.title]]</strong> network?\n      </div>\n      <div class=\"dialog-body\">\n        <responsive-grid-row gutter=\"5\">\n          <responsive-grid-col\n            xl=\"3\"\n            lg=\"3\"\n            md=\"3\"\n            sm=\"3\"\n            xs=\"3\"\n          ></responsive-grid-col>\n          <responsive-grid-col xl=\"1\" lg=\"1\" md=\"1\" sm=\"1\" xs=\"1\"\n            >Add</responsive-grid-col\n          >\n          <responsive-grid-col xl=\"2\" lg=\"2\" md=\"2\" sm=\"2\" xs=\"2\"\n            ><lrn-icon\n              icon=\"[[_activeService.icon]]\"\n              class\\$=\"[[_activeService.color]]-text elmsln-hover-icon service-confirm-icon\"\n            ></lrn-icon\n          ></responsive-grid-col>\n          <responsive-grid-col xl=\"3\" lg=\"3\" md=\"3\" sm=\"3\" xs=\"3\"\n            ><strong>[[_activeService.title]]</strong></responsive-grid-col\n          >\n          <responsive-grid-col\n            xl=\"3\"\n            lg=\"3\"\n            md=\"3\"\n            sm=\"3\"\n            xs=\"3\"\n          ></responsive-grid-col>\n        </responsive-grid-row>\n        <responsive-grid-row gutter=\"5\">\n          <responsive-grid-col\n            xl=\"3\"\n            lg=\"3\"\n            md=\"3\"\n            sm=\"3\"\n            xs=\"3\"\n          ></responsive-grid-col>\n          <responsive-grid-col xl=\"1\" lg=\"1\" md=\"1\" sm=\"1\" xs=\"1\"\n            >To</responsive-grid-col\n          >\n          <responsive-grid-col xl=\"2\" lg=\"2\" md=\"2\" sm=\"2\" xs=\"2\"\n            ><lrndesign-avatar\n              class=\"service-confirm-icon\"\n              label=\"[[activeCourse.attributes.name]]\"\n              jdenticon=\"\"\n              color=\"[[activeCourse.attributes.color]] darken-4\"\n            >\n            </lrndesign-avatar\n          ></responsive-grid-col>\n          <responsive-grid-col xl=\"3\" lg=\"3\" md=\"3\" sm=\"3\" xs=\"3\"\n            ><strong\n              >[[activeCourse.attributes.title]]</strong\n            ></responsive-grid-col\n          >\n          <responsive-grid-col\n            xl=\"3\"\n            lg=\"3\"\n            md=\"3\"\n            sm=\"3\"\n            xs=\"3\"\n          ></responsive-grid-col>\n        </responsive-grid-row>\n        <div style=\"margin-top:1em;\">This will take a few moments.</div>\n      </div>\n      <div class=\"buttons\">\n        <paper-button\n          raised=\"\"\n          dialog-confirm=\"\"\n          autofocus=\"\"\n          on-tap=\"_confirmBuild\"\n          class=\"green\"\n          >Let's do it!</paper-button\n        >\n        <paper-button dialog-dismiss=\"\" class=\"red-text\"\n          >Oops, go back.</paper-button\n        >\n      </div>\n    </lrnsys-dialog>\n    <paper-toast id=\"toast\"></paper-toast>\n  `,\n\n  is: \"lrnapp-cis\",\n\n  properties: {\n    /**\n     * The load initial data\n     */\n    _cisResponse: {\n      type: Object\n    },\n    /**\n     * Load individual course data\n     */\n    _courseResponse: {\n      type: Object\n    },\n    /**\n     * Load service creation response\n     */\n    _makeServiceResponse: {\n      type: Object\n    },\n    /**\n     * The courses to render; potentially filtered\n     */\n    courses: {\n      type: Array,\n      value: [],\n      computed: \"_coursesCompute(originalCourses, queryParams)\"\n    },\n    /**\n     * The original courses array; used to filter against\n     */\n    originalCourses: {\n      type: Array,\n      value: [],\n      notify: true\n    },\n    /**\n     * The programs to render\n     */\n    programs: {\n      type: Array,\n      value: []\n    },\n    /**\n     * The academics to render\n     */\n    academics: {\n      type: Array,\n      value: []\n    },\n    /**\n     * sourcePath for data.\n     */\n    sourcePath: {\n      type: String\n    },\n    /**\n     * pathway to access info about a single course.\n     */\n    courseDataPath: {\n      type: String\n    },\n    /**\n     * pathway to creating new service instances\n     */\n    makeServicePath: {\n      type: String\n    },\n    /**\n     * Endpoint for data.\n     */\n    endPoint: {\n      type: String,\n      value: \"/\"\n    },\n    /**\n     * base path for the app\n     */\n    basePath: {\n      type: String,\n      value: \"/\"\n    },\n    /**\n     * Active / clicked course.\n     */\n    activeCourse: {\n      type: Array,\n      value: null\n    },\n    queryParams: {\n      type: Object,\n      notify: true\n    }\n  },\n\n  listeners: {\n    \"route-change\": \"_routeChange\"\n  },\n\n  observers: [\"_routeChanged(route, endPoint)\"],\n\n  // If the current route is outside the scope of our app\n  // then allow the website to break out of the single page\n  // application routing\n  _routeChanged: function(route, endPoint) {\n    if (typeof route.path === \"string\") {\n      if (typeof endPoint === \"string\") {\n        // ignore \"home page\" as well since that's our path\n        if (route.path.startsWith(endPoint) || route.path == \"/\") {\n          return;\n        }\n      }\n      this.$.loading.hidden = false;\n      // reload the page which since route changed will load that page\n      window.location.reload();\n    }\n  },\n\n  /**\n   * Change route from deeper in the app.\n   */\n  _routeChange: function(e) {\n    var details = e.detail;\n    if (typeof details.queryParams.course !== typeof undefined) {\n      this.set(\"queryParams.course\", details.queryParams.course);\n    }\n    if (typeof details.queryParams.academic !== typeof undefined) {\n      this.set(\"queryParams.academic\", details.queryParams.academic);\n    }\n    if (typeof details.queryParams.program !== typeof undefined) {\n      this.set(\"queryParams.program\", details.queryParams.program);\n    }\n    if (typeof details.data.page !== typeof undefined) {\n      this.set(\"data.page\", details.data.page);\n    }\n  },\n\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  },\n\n  /**\n   * Handle course response for additional details about the item\n   */\n  _handleMakeServiceResponse: function(event) {\n    // get the CIS response's data and convert to array ahead of time\n    var response = this._makeServiceResponse;\n    let activeCourse = this.__addServiceLinks(response.data.course);\n    this.set(\"activeCourse\", []);\n    this.set(\"activeCourse\", activeCourse);\n    this.$.toast.show(response.message);\n  },\n\n  /**\n   * Handle course response for additional details about the item\n   */\n  _handleCourseResponse: function(event) {\n    // get the CIS response's data and convert to array ahead of time\n    var activeCourse = this._courseResponse.data.course;\n    this.__addServiceLinks(activeCourse);\n    this.set(\"activeCourse\", []);\n    this.set(\"activeCourse\", activeCourse);\n    this.$.loadingCourse.hidden = true;\n  },\n\n  /**\n   * Helper to mash up services that exist with those that could.\n   */\n  __addServiceLinks: function(courseObject) {\n    // ensure there's a part for the Network people can request\n    if (typeof courseObject.topology.Network === typeof undefined) {\n      courseObject.topology.Network = {};\n    }\n    // loop our services to see what we should add as options\n    for (var key in this.services) {\n      // if it's not in the topology that means it can be added\n      if (\n        typeof courseObject.topology.Network[\n          this.services[key].attributes.machine_name\n        ] === typeof undefined\n      ) {\n        // if we get a miss that means we should add a \"Add this\" version\n        courseObject.topology.Network[\n          this.services[key].attributes.machine_name\n        ] = {\n          color: this.services[key].attributes.color,\n          distro: this.services[key].attributes.distro,\n          icon: this.services[key].attributes.icon,\n          machine_name: this.services[key].attributes.machine_name,\n          title: this.services[key].attributes.title,\n          url: this.services[key].attributes.url,\n          weight: this.services[key].attributes.weight,\n          _exists: false\n        };\n      }\n    }\n    // convert to array after keys in place for the object\n    courseObject.topology.Network = this._toArray(\n      courseObject.topology.Network\n    );\n    // sort items based on weight of the things in the network\n    // so we have a consistent order to things\n    courseObject.topology.Network.sort(function(a, b) {\n      return a.weight - b.weight;\n    });\n    return courseObject;\n  },\n\n  /**\n   * Handle response for the whole courses object.\n   */\n  _handleResponse: function(event) {\n    var course = {};\n    var program = {};\n    var academic = {};\n    var tmp = {\n      courses: [],\n      programs: [],\n      academics: []\n    };\n    var programs = [];\n    var academics = [];\n    // get the CIS response's data and convert to array ahead of time\n    var courses = this._toArray(this._cisResponse.data.courses);\n    this.set(\"services\", this._toArray(this._cisResponse.data.services));\n    // original = active off the bat then we apply filters later to chang this\n    this.set(\"originalCourses\", courses);\n    // figure out courses, programs and academics\n    for (var index = 0; index < courses.length; index++) {\n      course = courses[index];\n      program = courses[index].relationships.program;\n      academic = courses[index].relationships.academic;\n      tmp.programs[program.id] = program;\n      tmp.academics[academic.id] = academic;\n      tmp.courses[course.id] = course;\n    }\n    // this is stupid but we have to normalize the IDs or else dom repeats will be screwed up\n    tmp.programs.forEach(function(element) {\n      programs.push(element);\n    });\n    // this is stupid but we have to normalize the IDs or else dom repeats will be screwed up\n    tmp.academics.forEach(function(element) {\n      academics.push(element);\n    });\n    this.$.loading.hidden = true;\n    this.set(\"academics\", academics);\n    this.set(\"programs\", programs);\n  },\n\n  /**\n   * Request a new service to kick off.\n   */\n  _makeService: function(e) {\n    var normalizedEvent = dom(e);\n    let active = normalizedEvent.localTarget.getAttribute(\"data-machine-name\");\n    const network = this.activeCourse.topology.Network;\n    let service = network.filter(service => {\n      if (service.machine_name !== active) {\n        return false;\n      }\n      return true;\n    });\n    // if we found one, make it the top level item\n    if (service.length > 0) {\n      service = service.pop();\n      this.$.makeservice.params = {\n        course: this.activeCourse.attributes.machine_name,\n        service: service.machine_name\n      };\n      this._activeService = service;\n      // confirm via paper prompt\n      this.$.confirm.toggleDialog();\n    } else {\n      console.log(\"that was not a valid service..\");\n    }\n  },\n\n  /**\n   * Confirm of build.\n   */\n  _confirmBuild: function(e) {\n    this.$.makeservice.generateRequest();\n  },\n\n  /**\n   * Attached lifecycle\n   */\n  attached: function() {\n    // listen for focus event to have fired\n    document.body.addEventListener(\n      \"lrnsys-dialog-modal-closed\",\n      this._accessibleFocus.bind(this)\n    );\n  },\n\n  /**\n   * Set ourselves as having focus after the modal closes.\n   */\n  _accessibleFocus: function(e) {\n    // focus on our dialog triggering button\n    this.__rememberClick.focus();\n  },\n\n  /**\n   * Handle tap on paper-button above to redirect to the correct course url.\n   */\n  _loadCourseUrl: function(e) {\n    this.__rememberClick = e.target;\n    // reset dialog to appear to be loading\n    this.$.loadingCourse.hidden = false;\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // this will have the id of the current course\n    var active = local.getAttribute(\"data-course-id\");\n    // find the course by it's unique id and filter just to it\n    let findCourse = this.originalCourses.filter(course => {\n      if (course.id !== active) {\n        return false;\n      }\n      return true;\n    });\n    // if we found one, make it the top level item\n    if (findCourse.length > 0) {\n      findCourse = findCourse.pop();\n    }\n    this.activeCourse = findCourse;\n    // formulate the post data\n    this._courseDataParams = {\n      id: this.activeCourse.id\n    };\n    // @todo look at query cache mechanism to skip calls\n    // if they've already happened. lrnapp-book has some stuff to do this\n    this.$.courserequest.generateRequest();\n    this.$.dialog.toggleDialog();\n  },\n\n  /**\n   * Compute the active list of courses\n   */\n  _coursesCompute: function(originalCourses, queryParams) {\n    // if we don't have an original courses object to work with then we need to bail\n    if (typeof originalCourses === \"undefined\") {\n      return [];\n    }\n    // define vars\n    const root = this;\n    let filteredCourses = [];\n    // filter the courses by the query params\n    filteredCourses = originalCourses.filter(course => {\n      if (typeof root.queryParams.course !== \"undefined\") {\n        if (course.id !== root.queryParams.course) {\n          return false;\n        }\n      }\n      if (typeof root.queryParams.program !== \"undefined\") {\n        if (course.relationships.program.id !== root.queryParams.program) {\n          return false;\n        }\n      }\n      if (typeof root.queryParams.academic !== \"undefined\") {\n        if (course.relationships.academic.id !== root.queryParams.academic) {\n          return false;\n        }\n      }\n      return true;\n    });\n    // delay and repaint, can help with refresh issues\n    setTimeout(() => {\n      this.$.ironlist.fire(\"iron-resize\");\n    }, 200);\n    return filteredCourses;\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/iron-scroll-threshold/iron-scroll-threshold.js\";\nimport \"@polymer/iron-image/iron-image.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\">\n      :host {\n        display: block;\n      }\n      paper-button {\n        padding: 0;\n        margin: 0;\n        min-width: 1rem;\n      }\n      #details {\n        opacity: 0.5;\n        position: absolute;\n        bottom: 0;\n        right: 0;\n        margin: 0 1rem 0 0;\n        background-color: white;\n        padding: 0.5em;\n      }\n      #details:hover {\n        opacity: 1;\n      }\n      #details span {\n        font-size: 0.6em;\n        font-weight: normal;\n      }\n      #details .comment-on-work {\n        font-size: 0.8em;\n        background-color: white;\n      }\n    </style>\n    <iron-ajax\n      id=\"ajax\"\n      url=\"[[sourcePath]]\"\n      params=\"\"\n      handle-as=\"json\"\n      last-response=\"{{submissions}}\"\n    ></iron-ajax>\n    <iron-scroll-threshold on-lower-threshold=\"_loadMoreData\" id=\"threshold\">\n      <iron-list grid items=\"[[_toArray(submissions.data)]]\" as=\"item\">\n        <template is=\"dom-repeat\" items=\"[[_toArray(item.images)]]\" as=\"image\">\n          <paper-button>\n            <iron-image\n              preload\n              open-url=\"{{item.url}}\"\n              title=\"{{item.title}}\"\n              alt=\"{{item.title}}\"\n              src=\"{{image.src}}\"\n              author=\"{{item.author}}\"\n              comments=\"{{item.comments}}\"\n              height=\"{{image.height}}\"\n              width=\"{{image.width}}\"\n            ></iron-image>\n          </paper-button>\n        </template>\n      </iron-list>\n    </iron-scroll-threshold>\n    <paper-dialog\n      id=\"dialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n    >\n      <paper-dialog-scrollable id=\"dialogResponse\">\n        <iron-image src$=\"[[activeImage]]\"></iron-image>\n        <div id=\"details\">\n          <div class=\"title\">\n            <span>Title:</span> <span>{{{activeTitle}}}</span>\n          </div>\n          <div class=\"author\">\n            <span>Author:</span> <span>{{activeAuthor}}</span>\n          </div>\n          <div class=\"comments\">\n            <span>Comments:</span> <span>{{activeComments}}</span>\n          </div>\n          <div class=\"comment-on-work\">\n            <a href$=\"[[activeUrl]]\">\n              <paper-button raised>Comment on this work</paper-button>\n            </a>\n          </div>\n        </div>\n      </paper-dialog-scrollable>\n    </paper-dialog>\n  `,\n  is: \"lrnapp-gallery-grid\",\n  listeners: {\n    click: \"_triggerDialog\"\n  },\n  properties: {\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    submissions: {\n      type: Array,\n      notify: true\n    },\n    activeImage: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    activeTitle: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    activeAuthor: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    activeComments: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    activeUrl: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    }\n  },\n  /**\n   * When someone clicks if there is a url, then we need to\n   * remote load whatever is in that url.\n   */\n  _triggerDialog: function(e) {\n    // make sure we found an image as we're going through here\n    if (e.target.nextElementSibling.nodeName == \"IMG\") {\n      this.activeImage = e.target.nextElementSibling.src;\n      this.activeTitle = e.target.parentElement.title;\n      this.activeAuthor = e.target.parentElement.author;\n      this.activeComments = e.target.parentElement.comments;\n      this.activeUrl = e.target.parentElement.openUrl;\n      this.shadowRoot.querySelector(\"#dialog\").toggle();\n    }\n  },\n  _loadMoreData: function(e) {\n    this.shadowRoot.querySelector(\"#ajax\").generateRequest();\n    this.shadowRoot.querySelector(\"#threshold\").clearTriggers();\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/iron-scroll-threshold/iron-scroll-threshold.js\";\nimport \"@polymer/iron-list/iron-list.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@polymer/iron-image/iron-image.js\";\nimport \"@polymer/paper-dialog/paper-dialog.js\";\nimport \"@polymer/paper-dialog-scrollable/paper-dialog-scrollable.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\">\n      :host {\n        display: block;\n      }\n      paper-button {\n        padding: 0;\n        margin: 0;\n        min-width: 1rem;\n      }\n      #details {\n        opacity: 0.5;\n        position: absolute;\n        bottom: 0;\n        right: 0;\n        margin: 0 1rem 0 0;\n        background-color: white;\n        padding: 0.5em;\n      }\n      #details:hover {\n        opacity: 1;\n      }\n      #details span {\n        font-size: 0.6em;\n        font-weight: normal;\n      }\n      #details .comment-on-work {\n        font-size: 0.8em;\n        background-color: white;\n      }\n    </style>\n    <iron-ajax\n      id=\"ajax\"\n      url=\"[[sourcePath]]\"\n      params=\"\"\n      handle-as=\"json\"\n      last-response=\"{{images}}\"\n    ></iron-ajax>\n    <iron-scroll-threshold on-lower-threshold=\"_loadMoreData\" id=\"threshold\">\n      <iron-list grid items=\"[[_toArray(images.data)]]\" as=\"image\">\n        <template>\n          <paper-button>\n            <iron-image\n              preload=\"\"\n              title=\"{{image.filename}}\"\n              alt=\"{{image.alt}}\"\n              src=\"{{image.src}}\"\n              height=\"{{image.height}}\"\n              width=\"{{image.width}}\"\n            ></iron-image>\n          </paper-button>\n        </template>\n      </iron-list>\n    </iron-scroll-threshold>\n    <paper-dialog\n      id=\"dialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n    >\n      <paper-dialog-scrollable id=\"dialogResponse\">\n        <iron-image src$=\"[[activeImage]]\"></iron-image>\n        <div id=\"details\">\n          <div class=\"title\">\n            <span>Title:</span> <span>[[activeTitle]]</span>\n          </div>\n          <div class=\"comment-on-work\">\n            <a href$=\"[[activeUrl]]\">\n              <paper-button raised=\"\">View media</paper-button>\n            </a>\n          </div>\n        </div>\n      </paper-dialog-scrollable>\n    </paper-dialog>\n  `,\n  is: \"lrnapp-media-grid\",\n  listeners: {\n    click: \"_triggerDialog\"\n  },\n  properties: {\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    images: {\n      type: Array,\n      notify: true\n    },\n    activeImage: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    activeTitle: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    activeUrl: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    }\n  },\n  /**\n   * When someone clicks if there is a url, then we need to\n   * remote load whatever is in that url.\n   */\n  _triggerDialog: function(e) {\n    // make sure we found an image as we're going through here\n    if (e.target.nextElementSibling.nodeName == \"IMG\") {\n      this.activeImage = e.target.nextElementSibling.src;\n      this.activeTitle = e.target.parentElement.title;\n      this.activeUrl = e.target.parentElement.openUrl;\n      this.shadowRoot.querySelector(\"#dialog\").toggle();\n    }\n  },\n  _loadMoreData: function(e) {\n    this.shadowRoot.querySelector(\"#ajax\").generateRequest();\n    this.shadowRoot.querySelector(\"#threshold\").clearTriggers();\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/iron-scroll-threshold/iron-scroll-threshold.js\";\nimport \"@polymer/iron-image/iron-image.js\";\nimport \"@polymer/iron-list/iron-list.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\">\n      :host {\n        display: block;\n      }\n      paper-button {\n        padding: 0;\n        margin: 0;\n        min-width: 16px;\n      }\n      #details {\n        opacity: 0.5;\n        position: absolute;\n        bottom: 0;\n        right: 0;\n        margin: 0 16px 0 0;\n        background-color: white;\n        padding: 8px;\n      }\n      #details:hover {\n        opacity: 1;\n      }\n      #details span {\n        font-size: 10px;\n        font-weight: normal;\n      }\n      #details .comment-on-work {\n        font-size: 12px;\n        background-color: white;\n      }\n    </style>\n    <iron-ajax\n      id=\"ajax\"\n      url=\"[[source-path]]\"\n      params=\"\"\n      handle-as=\"json\"\n      last-response=\"{{submissions}}\"\n    ></iron-ajax>\n    <iron-scroll-threshold on-lower-threshold=\"_loadMoreData\" id=\"threshold\">\n      <iron-list grid items=\"[[_toArray(submissions.data)]]\" as=\"item\">\n        <template>\n          <paper-card\n            heading=\"{{item.title}}\"\n            image=\"\"\n            elevation=\"2\"\n            animated-shadow=\"true\"\n          >\n            <div class=\"card-content\"></div>\n            <div class=\"card-actions\">\n              <a href=\"{{item.url}}\"\n                ><paper-button raised>View</paper-button></a\n              >\n              <a href=\"{{item.edit_url}}\"\n                ><paper-button raised>Edit</paper-button></a\n              >\n            </div>\n          </paper-card>\n        </template>\n      </iron-list>\n    </iron-scroll-threshold>\n    <paper-dialog\n      id=\"dialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n    >\n      <paper-dialog-scrollable id=\"dialogResponse\">\n        <iron-image src=\"{{activeImage}}\"></iron-image>\n        <div id=\"details\">\n          <div class=\"title\">\n            <span>Title:</span> <span>{{activeTitle}}</span>\n          </div>\n          <div class=\"author\">\n            <span>Author:</span> <span>{{activeAuthor}}</span>\n          </div>\n          <div class=\"comments\">\n            <span>Comments:</span> <span>{{activeComments}}</span>\n          </div>\n          <div class=\"comment-on-work\">\n            <a href=\"{{activeUrl}}\">\n              <paper-button raised>Comment on this work</paper-button>\n            </a>\n          </div>\n        </div>\n      </paper-dialog-scrollable>\n    </paper-dialog>\n  `,\n  is: \"lrnapp-media-management\",\n  listeners: {\n    click: \"_triggerDialog\"\n  },\n  properties: {\n    submissions: {\n      type: Array,\n      notify: true\n    },\n    activeImage: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    activeTitle: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    activeAuthor: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    activeComments: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    activeUrl: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    }\n  },\n  /**\n   * When someone clicks if there is a url, then we need to\n   * remote load whatever is in that url.\n   */\n  _triggerDialog: function(e) {\n    let root = this;\n    // make sure we found an image as we're going through here\n    if (e.target.nextElementSibling.nodeName == \"IMG\") {\n      root.activeImage = e.target.nextElementSibling.src;\n      root.activeTitle = e.target.parentElement.title;\n      root.activeAuthor = e.target.parentElement.author;\n      root.activeComments = e.target.parentElement.comments;\n      root.activeUrl = e.target.parentElement.openUrl;\n      this.shadowRoot.querySelector(\"#dialog\").toggle();\n    }\n  },\n  _loadMoreData: function(e) {\n    let root = this;\n    root.shadowRoot.querySelector(\"#ajax\").generateRequest();\n    root.shadowRoot.querySelector(\"#threshold\").clearTriggers();\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","/**\n * Copyright 2018 The Pennsylvania State University\n * @license Apache-2.0, see License.md for full text.\n */\nimport { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@vaadin/vaadin-upload/vaadin-upload.js\";\n/**\n * `lrnapp-media-upload`\n * `Simple media upload wrapper element`\n *\n * @demo demo/index.html\n */\nlet LrnappMediaUpload = Polymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n      paper-button {\n        padding: 0;\n        margin: 0;\n        min-width: 16px;\n      }\n      vaadin-upload.thick-border {\n        --primary-color: #396;\n        --dark-primary-color: #063;\n        --light-primary-color: #6c9;\n        --error-color: darkred;\n\n        border: 2px solid #ccc;\n        padding: 14px;\n        background: #eee;\n        border-radius: 0;\n      }\n      vaadin-upload.thick-border[dragover] {\n        border-color: #396;\n      }\n    </style>\n    <vaadin-upload\n      target\\$=\"{{uploadPath}}\"\n      method=\"POST\"\n      form-data-name=\"file-upload\"\n    ></vaadin-upload>\n  `,\n\n  is: \"lrnapp-media-upload\",\n\n  properties: {\n    uploadPath: {\n      type: String,\n      notify: true,\n      reflectToAttribute: true\n    }\n  }\n});\nexport { LrnappMediaUpload };\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@polymer/paper-input/paper-input.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-column.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-sorter.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-filter.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nimport \"@lrnwebcomponents/elmsln-apps/lib/lrnapp-studio-submission/lrnapp-studio-submission-display.js\";\nPolymer({\n  _template: html`\n    <custom-style>\n      <style is=\"custom-style\" include=\"materializecss-styles\">\n        :host {\n          display: block;\n          align-content: center;\n          padding: 0.8em;\n        }\n        #loading {\n          width: 100%;\n          z-index: 1000;\n          opacity: 0.8;\n          text-align: center;\n          align-content: center;\n          justify-content: center;\n          height: 100vh;\n          position: absolute;\n          background-color: white;\n        }\n        .center-data {\n          text-align: center;\n        }\n        vaadin-grid#material {\n          height: 75vh;\n          font-family: Roboto, sans-serif;\n          --divider-color: rgba(0, 0, 0, var(--dark-divider-opacity));\n\n          --vaadin-grid-cell: {\n            padding: 0;\n          }\n\n          --vaadin-grid-header-cell: {\n            height: 3.5em;\n            color: rgba(0, 0, 0, var(--dark-secondary-opacity));\n            font-size: 1em;\n          }\n\n          --vaadin-grid-body-cell: {\n            height: 3em;\n            color: rgba(0, 0, 0, var(--dark-primary-opacity));\n            font-size: 0.8em;\n          }\n\n          --vaadin-grid-body-row-hover-cell: {\n            background-color: var(--paper-grey-200);\n          }\n\n          --vaadin-grid-body-row-selected-cell: {\n            background-color: var(--paper-grey-100);\n          }\n\n          --vaadin-grid-focused-cell: {\n            box-shadow: none;\n            font-weight: bold;\n          }\n        }\n\n        vaadin-grid#material .cell {\n          overflow: hidden;\n          text-overflow: ellipsis;\n          padding-right: 56px;\n        }\n\n        vaadin-grid#material .cell.last {\n          padding-right: 24px;\n        }\n\n        vaadin-grid#material .cell.numeric {\n          text-align: right;\n        }\n\n        vaadin-grid#material paper-checkbox {\n          --primary-color: var(--paper-indigo-500);\n          margin: 0 24px;\n        }\n\n        vaadin-grid#material vaadin-grid-sorter {\n          --vaadin-grid-sorter-arrow: {\n            display: none !important;\n          }\n        }\n\n        vaadin-grid#material vaadin-grid-sorter .cell {\n          flex: 1;\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n        }\n\n        vaadin-grid#material vaadin-grid-sorter iron-icon {\n          transform: scale(0.8);\n        }\n\n        vaadin-grid#material vaadin-grid-sorter:not([direction]) iron-icon {\n          color: rgba(0, 0, 0, var(--dark-disabled-opacity));\n        }\n\n        vaadin-grid#material vaadin-grid-sorter[direction] {\n          color: rgba(0, 0, 0, var(--dark-primary-opacity));\n        }\n\n        vaadin-grid#material vaadin-grid-sorter[direction=\"desc\"] iron-icon {\n          transform: scale(0.8) rotate(180deg);\n        }\n        vaadin-grid-sorter {\n          text-align: center;\n        }\n      </style>\n    </custom-style>\n    <vaadin-grid\n      column-reordering-allowed=\"\"\n      id=\"material\"\n      aria-label=\"Course list\"\n      items=\"{{submissions}}\"\n    >\n      <vaadin-grid-column resizable=\"\">\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"relationships.project.data.title\"\n            >Project</vaadin-grid-sorter\n          >\n        </template>\n        <template>\n          <lrnsys-button\n            raised=\"\"\n            on-tap=\"_loadProjectRoute\"\n            data-project-id\\$=\"{{item.relationships.project.data.id}}\"\n            data-author-id\\$=\"{{item.relationships.author.data.id}}\"\n            label=\"[[item.relationships.project.data.title]]\"\n            hover-class=\"amber lighten-4\"\n            icon=\"folder\"\n          ></lrnsys-button>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable=\"\">\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"relationships.assignment.data.title\"\n            >Assignment</vaadin-grid-sorter\n          >\n        </template>\n        <template>\n          [[item.relationships.assignment.data.title]]\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable=\"\" width=\"20em\" flex-grow=\"0\">\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"attributes.title\">Title</vaadin-grid-sorter>\n        </template>\n        <template>\n          <lrnsys-button\n            raised=\"\"\n            on-tap=\"_loadSubmissionUrl\"\n            data-submission-id\\$=\"{{item.id}}\"\n            label=\"[[item.attributes.title]]\"\n            hover-class=\"amber lighten-4\"\n            icon=\"assignment\"\n          ></lrnsys-button>\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Title\"\n            path=\"attributes.title\"\n            value=\"[[_filterTitle]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"Title\"\n              value=\"{{_filterTitle::input}}\"\n              focus-target=\"\"\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable=\"\">\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"meta.changed\">Submitted</vaadin-grid-sorter>\n        </template>\n        <template>\n          [[item.meta.humandate]]\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Submitted\"\n            path=\"meta.changed\"\n            value=\"[[_filterSubmitted]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"Submitted\"\n              value=\"{{_filterSubmitted::input}}\"\n              focus-target=\"\"\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable=\"\">\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"relationships.author.data.display_name\"\n            >Author</vaadin-grid-sorter\n          >\n        </template>\n        <template>\n          [[item.relationships.author.data.display_name]]\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable=\"\" width=\"[[_numWidth]]\">\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"meta.comment_count\"\n            >Comments</vaadin-grid-sorter\n          >\n        </template>\n        <template>\n          <span class=\"center-data\">[[item.meta.comment_count]]</span>\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Comments\"\n            path=\"meta.comment_count\"\n            value=\"[[_filterCommentsCount]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"Comments\"\n              value=\"{{_filterCommentsCount::input}}\"\n              focus-target=\"\"\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable=\"\" width=\"[[_numWidth]]\">\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"attributes.images.length\"\n            >Images</vaadin-grid-sorter\n          >\n        </template>\n        <template>\n          <span class=\"center-data\">[[item.attributes.images.length]]</span>\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Images\"\n            path=\"attributes.images.length\"\n            value=\"[[_filterImageCount]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"Images\"\n              value=\"{{_filterImageCount::input}}\"\n              focus-target=\"\"\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable=\"\" width=\"[[_numWidth]]\">\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"attributes.video.length\"\n            >Video</vaadin-grid-sorter\n          >\n        </template>\n        <template>\n          <span class=\"center-data\">[[item.attributes.video.length]]</span>\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Video\"\n            path=\"attributes.video.length\"\n            value=\"[[_filterVideosCount]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"Video\"\n              value=\"{{_filterVideosCount::input}}\"\n              focus-target=\"\"\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable=\"\" width=\"[[_numWidth]]\">\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"attributes.links.length\"\n            >Links</vaadin-grid-sorter\n          >\n        </template>\n        <template>\n          <span class=\"center-data\">[[item.attributes.links.length]]</span>\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Links\"\n            path=\"attributes.links.length\"\n            value=\"[[_filterLinksCount]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"Links\"\n              value=\"{{_filterLinksCount::input}}\"\n              focus-target=\"\"\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable=\"\" width=\"[[_numWidth]]\">\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"attributes.files.length\"\n            >Files</vaadin-grid-sorter\n          >\n        </template>\n        <template>\n          <span class=\"center-data\">[[item.attributes.files.length]]</span>\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Files\"\n            path=\"attributes.files.length\"\n            value=\"[[_filterFileCount]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"Files\"\n              value=\"{{_filterFileCount::input}}\"\n              focus-target=\"\"\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n    </vaadin-grid>\n  `,\n\n  is: \"lrnapp-open-studio-table\",\n\n  properties: {\n    /**\n     * The submissions to render\n     */\n    submissions: {\n      type: Array,\n      notify: true\n    },\n    _numWidth: {\n      type: String,\n      value: \"2.25em\"\n    },\n    /**\n     * Endpoint for submission data.\n     */\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    /**\n     * base path for the app\n     */\n    basePath: {\n      type: String,\n      notify: true\n    },\n    /**\n     * Active / clicked submission.\n     */\n    activeSubmission: {\n      type: String,\n      value: null,\n      notify: true\n    }\n  },\n\n  _loadProjectRoute: function(e) {\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // this will have the id of the current submission\n    var project = local.getAttribute(\"data-project-id\");\n    var author = local.getAttribute(\"data-author-id\");\n    // fire event w/ parts of the route to changes\n    this.fire(\"route-change\", {\n      data: { page: \"projects\" },\n      queryParams: { author: author, project: project }\n    });\n  },\n\n  /**\n   * Handle tap on paper-button above to redirect to the correct submission url.\n   */\n  _loadSubmissionUrl: function(e) {\n    let root = this;\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // this will have the id of the current submission\n    var active = local.getAttribute(\"data-submission-id\");\n    // @todo need a cleaner integration but this at least goes the right place for now\n    window.location.href =\n      this.basePath + \"lrnapp-studio-submission/submissions/\" + active;\n  },\n\n  /**\n   * Handle response for the whole projects object.\n   */\n  _handleResponse: function(event) {\n    this.$.loading.hidden = true;\n  },\n\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nimport \"@lrnwebcomponents/elmsln-apps/lib/lrnapp-studio-submission/lrnapp-studio-submission-display.js\";\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\"></style>\n    <style>\n      :host {\n        display: block;\n        align-content: center;\n      }\n      #loading {\n        width: 100%;\n        z-index: 1000;\n        opacity: 0.8;\n        text-align: center;\n        align-content: center;\n        justify-content: center;\n        height: 100vh;\n        position: absolute;\n        background-color: white;\n      }\n      h1.empty-title,\n      h1.project-title {\n        font-size: 2em;\n      }\n      h2.assignment-title {\n        font-size: 1.5em;\n        font-weight: bold;\n        width: 100%;\n        border-bottom: solid 1px grey;\n      }\n      .project-steps {\n        display: flex;\n        align-items: center;\n      }\n      .project-step {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        word-break: break-all;\n        word-wrap: break-word;\n      }\n    </style>\n    <template is=\"dom-if\" if=\"[[!showSubmissions]]\">\n      <h1 class=\"empty-title black-text\">\n        Please select an Author and Project in order to review their portfolio\n      </h1>\n    </template>\n    <template is=\"dom-if\" if=\"[[showSubmissions]]\">\n      <h1 class=\"project-title black-text\">\n        [[activeProject.attributes.title]]\n      </h1>\n      <div class=\"project-steps\">\n        <template\n          is=\"dom-repeat\"\n          items=\"[[activeProject.attributes.steps]]\"\n          as=\"assignment\"\n        >\n          <lrnsys-button\n            icon\\$=\"[[_getSubmissionIcon(assignment.id)]]\"\n            icon-class\\$=\"[[_getSubmissionClass(assignment.id)]]\"\n            on-tap=\"_scrollToTarget\"\n            label=\"[[assignment.title]]\"\n            data-assignment-id\\$=\"[[assignment.id]]\"\n            class=\"project-step\"\n            hover-class=\"blue white-text\"\n            raised=\"\"\n            hidden\\$=\"[[!assignment.title]]\"\n          ></lrnsys-button>\n        </template>\n      </div>\n      <template is=\"dom-repeat\" items=\"[[renderSubmissions]]\" as=\"submission\">\n        <a\n          name=\"[[submission.relationships.assignment.title]]\"\n          class\\$=\"assignment-[[submission.relationships.assignment.id]]\"\n          ><h2 class=\"assignment-title\">\n            [[submission.relationships.assignment.title]]\n          </h2></a\n        >\n        <lrnapp-studio-submission-display\n          submission=\"[[submission]]\"\n          class=\"ferpa-protect\"\n        ></lrnapp-studio-submission-display>\n      </template>\n    </template>\n  `,\n\n  is: \"lrnapp-open-studio-projects\",\n\n  properties: {\n    /**\n     * The projects that exist so we can make other calls for data\n     */\n    projects: {\n      type: Array,\n      notify: true\n    },\n    /**\n     * The submissions that exist so we can make other calls for data\n     */\n    submissions: {\n      type: Array,\n      notify: true\n    },\n    /**\n     * The renderSubmissions we kick to the screen\n     */\n    renderSubmissions: {\n      type: Array,\n      notify: true,\n      computed:\n        \"_renderSubmissionsCompute(submissions, activeProject, activeAuthorId)\"\n    },\n    activeProjectId: {\n      type: String,\n      reflectToAttribute: true,\n      value: null\n    },\n    activeProject: {\n      type: Object,\n      computed: \"_activeProjectCompute(activeProjectId, projects)\"\n    },\n    activeAuthorId: {\n      type: String,\n      reflectToAttribute: true,\n      value: null\n    },\n    showSubmissions: {\n      type: Boolean,\n      computed: \"_showSubmissions(activeProjectId, activeAuthorId)\",\n      value: false\n    },\n    /**\n     * Endpoint for submission data.\n     */\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    /**\n     * base path for the app\n     */\n    basePath: {\n      type: String,\n      notify: true\n    }\n  },\n\n  _renderSubmissionsCompute: function(\n    submissions,\n    activeProject,\n    activeAuthorId\n  ) {\n    // if we don't have all three variables then we need to bail and set to null\n    if (!submissions || !activeProject || !activeAuthorId) {\n      return null;\n    }\n    let renderSubmissions = [];\n    // make an array of parent assignment ids\n    const parentAssignments = activeProject.attributes.steps.map(\n      step => step.id\n    );\n    // filter the submissions by if they are listed in the active projects steps\n    renderSubmissions = submissions.filter(submission => {\n      return parentAssignments.includes(submission.relationships.assignment.id);\n    });\n    // sort render submissions by how the assignment steps are listed in the active project\n    renderSubmissions.sort(function(a, b) {\n      for (index = 0; index < activeProject.attributes.steps.length; index++) {\n        if (\n          activeProject.attributes.steps[index].id ==\n          a.relationships.assignment.id\n        ) {\n          return -1;\n        }\n        if (\n          activeProject.attributes.steps[index].id ==\n          b.relationships.assignment.id\n        ) {\n          return 1;\n        }\n      }\n      return 0;\n    });\n    return renderSubmissions;\n  },\n\n  _activeProjectCompute: function(activeProjectId, projects) {\n    let activeProject = null;\n    if (projects) {\n      activeProject = projects.find(project => {\n        return project.id === activeProjectId;\n      });\n    }\n    return activeProject;\n  },\n\n  _showSubmissions: function(activeProjectId, activeAuthorId) {\n    if (activeProjectId && activeAuthorId) {\n      return true;\n    }\n    return false;\n  },\n\n  _getSubmissionIcon: function(id) {\n    for (var index = 0; index < this.renderSubmissions.length; index++) {\n      if (this.renderSubmissions[index].relationships.assignment.id == id) {\n        return \"check\";\n      }\n    }\n    return \"assignment\";\n  },\n\n  _getSubmissionClass: function(id) {\n    for (var index = 0; index < this.renderSubmissions.length; index++) {\n      if (this.renderSubmissions[index].relationships.assignment.id == id) {\n        return \"green-text text-darken-2\";\n      }\n    }\n    return \"grey-text\";\n  },\n\n  _scrollToTarget: function(e) {\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // this will have the id of the current submission\n    var active = local.getAttribute(\"data-assignment-id\");\n    this.shadowRoot\n      .querySelector(\".assignment-\" + active)\n      .scrollIntoView({ block: \"end\", behavior: \"smooth\" });\n  },\n\n  /**\n   * Handle response for the whole projects object.\n   */\n  _handleResponse: function(event) {\n    this.$.loading.hidden = true;\n  },\n\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"@lrnwebcomponents/lrndesign-avatar/lrndesign-avatar.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nimport \"@lrnwebcomponents/elmsln-apps/lib/lrnapp-studio-submission/lrnapp-studio-submission-display.js\";\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\"></style>\n    <style>\n      :host {\n        display: block;\n        align-content: center;\n      }\n      #loading {\n        width: 100%;\n        z-index: 1000;\n        opacity: 0.8;\n        text-align: center;\n        align-content: center;\n        justify-content: center;\n        height: 100vh;\n        position: absolute;\n        background-color: white;\n      }\n      h1.empty-title,\n      h1.assignment-title {\n        font-size: 2em;\n      }\n      .submission-title {\n        font-size: 1em;\n        font-weight: bold;\n        width: 100%;\n        margin-bottom: 2rem;\n        text-transform: none;\n      }\n      .submission-list {\n        display: flex;\n        align-items: center;\n      }\n      .submission-list-item {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        word-break: break-all;\n        word-wrap: break-word;\n      }\n    </style>\n    <template is=\"dom-if\" if=\"[[!showSubmissions]]\">\n      <h1 class=\"empty-title black-text\">\n        Please select an Assignment in order to view all submissions\n      </h1>\n    </template>\n    <template is=\"dom-if\" if=\"[[showSubmissions]]\">\n      <h1 class=\"assignment-title black-text\">\n        [[activeAssignment.attributes.title]]\n      </h1>\n      <div class=\"submission-list\">\n        <template is=\"dom-repeat\" items=\"[[submissions]]\" as=\"submission\">\n          <lrnsys-button\n            on-tap=\"_scrollToTarget\"\n            raised=\"\"\n            class=\"submission-list-item\"\n            button-class=\"submission-list-item\"\n            hover-class=\"blue white-text\"\n            data-submission-id\\$=\"[[submission.id]]\"\n          >\n            <span slot=\"button\">\n              <lrndesign-avatar\n                src=\"[[submission.relationships.author.data.avatar]]\"\n                label=\"[[submission.relationships.author.data.name]]\"\n                style=\"display:inline-block;\"\n                data-submission-id\\$=\"[[submission.id]]\"\n              ></lrndesign-avatar>\n            </span>\n            <span slot=\"label\"\n              >[[submission.relationships.author.data.display_name]]</span\n            >\n          </lrnsys-button>\n        </template>\n      </div>\n      <template is=\"dom-repeat\" items=\"[[submissions]]\" as=\"submission\">\n        <lrnapp-studio-submission-display\n          id\\$=\"submission-[[submission.id]]\"\n          submission=\"[[submission]]\"\n          class=\"ferpa-protect\"\n        ></lrnapp-studio-submission-display>\n        <a tabindex=\"-1\"\n          ><paper-button\n            class=\"submission-title ferpa-protect\"\n            on-tap=\"_loadSubmissionUrl\"\n            data-submission-id\\$=\"[[submission.id]]\"\n            >Tap to comment on[[submission.attributes.title]] by\n            [[submission.relationships.author.data.display_name]]</paper-button\n          ></a\n        >\n      </template>\n    </template>\n  `,\n  is: \"lrnapp-open-studio-assignments\",\n  properties: {\n    /**\n     * The assignments that exist so we can make other calls for data\n     */\n    assignments: {\n      type: Array,\n      notify: true\n    },\n    /**\n     * The submissions that exist so we can make other calls for data\n     */\n    submissions: {\n      type: Array,\n      notify: true\n    },\n    activeAssignmentId: {\n      type: String,\n      reflectToAttribute: true,\n      value: null,\n      notify: true\n    },\n    activeAssignment: {\n      type: Object,\n      notify: true,\n      computed: \"_activeAssignmentCompute(activeAssignmentId, assignments)\"\n    },\n    activeAuthorId: {\n      type: String,\n      reflectToAttribute: true,\n      value: null,\n      notify: true\n    },\n    showSubmissions: {\n      type: Boolean,\n      computed: \"_showSubmissions(activeAssignmentId)\",\n      value: false,\n      notify: true\n    },\n    /**\n     * Endpoint for submission data.\n     */\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    /**\n     * base path for the app\n     */\n    basePath: {\n      type: String,\n      notify: true\n    }\n  },\n  /**\n   * Handle tap on paper-button above to redirect to the correct submission url.\n   */\n  _loadSubmissionUrl: function(e) {\n    let root = this;\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // this will have the id of the current submission\n    var active = local.getAttribute(\"data-submission-id\");\n    // @todo need a cleaner integration but this at least goes the right place for now\n    window.location.href =\n      this.basePath + \"lrnapp-studio-submission/submissions/\" + active;\n  },\n  _activeAssignmentCompute: function(activeAssignmentId, assignments) {\n    let activeAssignment = null;\n    if (assignments) {\n      activeAssignment = assignments.find(assignment => {\n        return assignment.id == activeAssignmentId;\n      });\n    }\n    return activeAssignment;\n  },\n  _showSubmissions: function(activeAssignmentId) {\n    if (activeAssignmentId) {\n      return true;\n    }\n    return false;\n  },\n  _scrollToTarget: function(e) {\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // this will have the id of the current submission\n    var active = local.getAttribute(\"data-submission-id\");\n    this.shadowRoot\n      .querySelector(\"#submission-\" + active)\n      .scrollIntoView({ block: \"start\", behavior: \"smooth\" });\n  },\n  /**\n   * Handle response for the whole assignments object.\n   */\n  _handleResponse: function(event) {\n    this.$.loading.hidden = true;\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/iron-list/iron-list.js\";\nimport \"@polymer/iron-pages/iron-pages.js\";\nimport \"@polymer/iron-selector/iron-selector.js\";\nimport \"@polymer/app-layout/app-toolbar/app-toolbar.js\";\nimport \"@polymer/app-route/app-location.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@polymer/paper-dropdown-menu/paper-dropdown-menu.js\";\nimport \"@polymer/paper-listbox/paper-listbox.js\";\nimport \"@polymer/paper-item/paper-item.js\";\nimport \"@polymer/paper-toast/paper-toast.js\";\nimport \"@lrnwebcomponents/lrndesign-gallerycard/lrndesign-gallerycard.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"./lrnapp-open-studio-table.js\";\nimport \"./lrnapp-open-studio-projects.js\";\nimport \"./lrnapp-open-studio-assignments.js\";\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\">\n      :host {\n        display: block;\n        align-content: center;\n      }\n      #loading {\n        width: 100%;\n        z-index: 1000;\n        opacity: 0.8;\n        text-align: center;\n        align-content: center;\n        justify-content: center;\n        height: 100vh;\n        position: absolute;\n        background-color: white;\n      }\n      iron-selector {\n        line-height: 1em;\n      }\n      iron-selector lrnsys-button {\n        display: inline-flex;\n      }\n      paper-button.gallerycard-wrapper {\n        margin: 0;\n        padding: 0;\n      }\n      lrndesign-gallerycard {\n        padding: 0;\n        margin: 1em;\n        height: 15em;\n        width: 14em;\n      }\n      .gallery-grid {\n        margin: 0 auto;\n        width: 95%;\n      }\n      .iron-selected .display-mode {\n        background-color: #ff6f00;\n        color: white;\n      }\n      .iron-list-container {\n        display: flex;\n        flex-direction: column;\n        min-height: 50vh;\n      }\n      iron-list {\n        flex: 1 1 auto;\n      }\n    </style>\n    <iron-ajax\n      auto\n      url=\"[[sourcePath]]\"\n      params=\"\"\n      handle-as=\"json\"\n      last-response=\"{{studioResponse}}\"\n      on-response=\"_handleResponse\"\n    ></iron-ajax>\n\n    <app-location\n      route=\"{{route}}\"\n      query-params=\"{{queryParams}}\"\n    ></app-location>\n    <app-route\n      route=\"{{route}}\"\n      pattern=\"[[endPoint]]/:page\"\n      data=\"{{data}}\"\n      tail=\"{{tail}}\"\n      query-params=\"{{queryParams}}\"\n    >\n    </app-route>\n\n    <div id=\"loading\">\n      <h3>Loading..</h3>\n      <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n    </div>\n    <app-toolbar class=\"amber lighten-3\">\n      <iron-selector\n        selected=\"{{data.page}}\"\n        attr-for-selected=\"name\"\n        role=\"navigation\"\n      >\n        <a tabindex=\"-1\" name=\"submissions\" on-tap=\"_submissionsClicked\"\n          ><lrnsys-button\n            icon=\"apps\"\n            label=\"Submission display\"\n            hover-class=\"amber darken-4 white-text\"\n            class=\"display-mode\"\n            button-class=\"display-mode style-scope lrnapp-open-studio x-scope lrnsys-button-0\"\n          ></lrnsys-button\n        ></a>\n        <a tabindex=\"-1\" name=\"projects\" on-tap=\"_projectsClicked\"\n          ><lrnsys-button\n            icon=\"folder\"\n            label=\"Project board\"\n            hover-class=\"amber darken-4 white-text\"\n            class=\"display-mode\"\n            button-class=\"display-mode style-scope lrnapp-open-studio x-scope lrnsys-button-0\"\n          ></lrnsys-button\n        ></a>\n        <a tabindex=\"-1\" name=\"assignments\" on-tap=\"_assignmentsClicked\"\n          ><lrnsys-button\n            icon=\"list\"\n            label=\"Assignment centric\"\n            hover-class=\"amber darken-4 white-text\"\n            class=\"display-mode\"\n            button-class=\"display-mode style-scope lrnapp-open-studio x-scope lrnsys-button-0\"\n          ></lrnsys-button\n        ></a>\n        <a tabindex=\"-1\" name=\"table\" on-tap=\"_tableClicked\"\n          ><lrnsys-button\n            icon=\"view-list\"\n            label=\"Table view\"\n            hover-class=\"amber darken-4 white-text\"\n            class=\"display-mode\"\n            button-class=\"display-mode style-scope lrnapp-open-studio x-scope lrnsys-button-0\"\n          ></lrnsys-button\n        ></a>\n      </iron-selector>\n      <span main-title></span>\n      <span top-item style=\"text-align:right;font-size:.5em;padding-right:1em;\"\n        >Displaying [[submissions.length]] of\n        [[originalSubmissions.length]]</span\n      >\n      <paper-dropdown-menu label=\"Author\" hidden$=\"[[!authors]]\">\n        <paper-listbox\n          slot=\"dropdown-content\"\n          class=\"dropdown-content\"\n          selected=\"{{queryParams.author}}\"\n          attr-for-selected=\"item-id\"\n        >\n          <paper-item></paper-item>\n          <template is=\"dom-repeat\" items=\"[[_toArray(authors)]]\" as=\"author\">\n            <paper-item item-id=\"[[author.id]]\"\n              >[[author.display_name]]</paper-item\n            >\n          </template>\n        </paper-listbox>\n      </paper-dropdown-menu>\n      <paper-dropdown-menu label=\"Project\" hidden$=\"[[!projects]]\">\n        <paper-listbox\n          slot=\"dropdown-content\"\n          class=\"dropdown-content\"\n          selected=\"{{queryParams.project}}\"\n          attr-for-selected=\"item-id\"\n        >\n          <paper-item></paper-item>\n          <template is=\"dom-repeat\" items=\"[[_toArray(projects)]]\" as=\"project\">\n            <paper-item item-id=\"[[project.id]]\"\n              >[[project.attributes.title]]</paper-item\n            >\n          </template>\n        </paper-listbox>\n      </paper-dropdown-menu>\n      <paper-dropdown-menu label=\"Assignment\" hidden$=\"[[!assignments]]\">\n        <paper-listbox\n          slot=\"dropdown-content\"\n          class=\"dropdown-content\"\n          selected=\"{{queryParams.assignment}}\"\n          attr-for-selected=\"item-id\"\n        >\n          <paper-item></paper-item>\n          <template\n            is=\"dom-repeat\"\n            items=\"[[_toArray(assignments)]]\"\n            as=\"assignment\"\n          >\n            <paper-item item-id=\"[[assignment.id]]\"\n              >[[assignment.attributes.title]]</paper-item\n            >\n          </template>\n        </paper-listbox>\n      </paper-dropdown-menu>\n    </app-toolbar>\n    <div class=\"gallery-grid\">\n      <iron-pages\n        selected=\"{{data.page}}\"\n        attr-for-selected=\"name\"\n        fallback-selection=\"submissions\"\n        role=\"main\"\n      >\n        <div class=\"iron-list-container\" name=\"submissions\">\n          <iron-list id=\"ironlist\" items=\"[[submissions]]\" as=\"item\" grid>\n            <template>\n              <paper-button\n                data-submission-id$=\"[[item.id]]\"\n                class=\"gallerycard-wrapper\"\n                on-tap=\"_loadSubmissionUrl\"\n              >\n                <lrndesign-gallerycard\n                  elevation=\"2\"\n                  data-submission-id$=\"[[item.id]]\"\n                  title=\"[[item.attributes.title]]\"\n                  author=\"[[item.relationships.author.data]]\"\n                  comments=\"[[item.meta.comment_count]]\"\n                  image=\"[[item.display.image]]\"\n                  icon=\"[[item.display.icon]]\"\n                  date=\"[[item.meta.humandate]]\"\n                  class=\"ferpa-protect\"\n                >\n                </lrndesign-gallerycard>\n              </paper-button>\n            </template>\n          </iron-list>\n        </div>\n        <lrnapp-open-studio-assignments\n          name=\"assignments\"\n          base-path=\"[[basePath]]\"\n          submissions=\"[[submissions]]\"\n          assignments=\"[[assignments]]\"\n          active-author-id=\"[[queryParams.author]]\"\n          active-assignment-id=\"[[queryParams.assignment]]\"\n        ></lrnapp-open-studio-assignments>\n        <lrnapp-open-studio-projects\n          name=\"projects\"\n          base-path=\"[[basePath]]\"\n          projects=\"[[projects]]\"\n          submissions=\"[[submissions]]\"\n          assignments=\"[[assignments]]\"\n          active-author-id=\"[[queryParams.author]]\"\n          active-project-id=\"[[queryParams.project]]\"\n        ></lrnapp-open-studio-projects>\n        <lrnapp-open-studio-table\n          name=\"table\"\n          base-path=\"[[basePath]]\"\n          submissions=\"{{submissions}}\"\n        ></lrnapp-open-studio-table>\n      </iron-pages>\n    </div>\n    <paper-toast id=\"toast\"></paper-toast>\n  `,\n  is: \"lrnapp-open-studio\",\n  properties: {\n    /**\n     * The studioResponse from server\n     */\n    studioResponse: {\n      type: Object,\n      notify: true\n    },\n    /**\n     * The submissions to render; potentially filtered\n     */\n    submissions: {\n      type: Object,\n      notify: true,\n      computed: \"_submissionsCompute(originalSubmissions, queryParams)\"\n    },\n    /**\n     * The original submissions array; used to filter against\n     */\n    originalSubmissions: {\n      type: Object,\n      notify: true\n    },\n    /**\n     * The submissions to render\n     */\n    projects: {\n      type: Array,\n      notify: true,\n      value: []\n    },\n    /**\n     * The assignments to render\n     */\n    assignments: {\n      type: Array,\n      notify: true,\n      value: []\n    },\n    /**\n     * The authors to render\n     */\n    authors: {\n      type: Array,\n      notify: true,\n      value: []\n    },\n    /**\n     * sourcePath for submission data.\n     */\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    /**\n     * Endpoint for submission data.\n     */\n    endPoint: {\n      type: String,\n      notify: true\n    },\n    /**\n     * base path for the app\n     */\n    basePath: {\n      type: String,\n      notify: true\n    },\n    /**\n     * Active / clicked submission.\n     */\n    activeSubmission: {\n      type: String,\n      value: null,\n      notify: true\n    },\n    queryParams: {\n      type: Object,\n      notify: true\n    },\n    _blockcycle: {\n      type: Boolean,\n      value: false\n    }\n  },\n  listeners: {\n    \"route-change\": \"_routeChange\"\n  },\n  observers: [\n    \"_routeChanged(route, endPoint)\",\n    \"_deleteToast(queryParams.deletetoast)\",\n    \"_assignmentFilterChanged(queryParams.assignment)\",\n    \"_projectFilterChanged(queryParams.project)\"\n  ],\n  // If the current route is outside the scope of our app\n  // then allow the website to break out of the single page\n  // application routing\n  _routeChanged: function(route, endPoint) {\n    if (typeof route.path === \"string\") {\n      if (typeof endPoint === \"string\") {\n        if (route.path.startsWith(endPoint)) {\n          return;\n        }\n      }\n      // reload the page which since route changed will load that page\n      window.location.reload();\n    }\n  },\n  /**\n   * Change route from deeper in the app.\n   */\n  _routeChange: function(e) {\n    var details = e.detail;\n    if (typeof details.queryParams.assignment !== typeof undefined) {\n      this.set(\"queryParams.assignment\", details.queryParams.assignment);\n    }\n    if (typeof details.queryParams.project !== typeof undefined) {\n      this.set(\"queryParams.project\", details.queryParams.project);\n    }\n    if (typeof details.queryParams.author !== typeof undefined) {\n      this.set(\"queryParams.author\", details.queryParams.author);\n    }\n    if (typeof details.data.page !== typeof undefined) {\n      this.set(\"data.page\", details.data.page);\n    }\n  },\n  _submissionsCompute: function(originalSubmissions, queryParams) {\n    // if we don't have an original submissions object to work with then we need to bail\n    if (typeof originalSubmissions === \"undefined\") {\n      return [];\n    }\n    // define vars\n    const root = this;\n    let filteredSubmissions = [];\n    // filter the submissions by the query params\n    filteredSubmissions = originalSubmissions.filter(submission => {\n      if (typeof root.queryParams.author !== \"undefined\") {\n        if (\n          submission.relationships.author.data.id !== root.queryParams.author\n        ) {\n          return false;\n        }\n      }\n      if (typeof root.queryParams.project !== \"undefined\") {\n        if (\n          submission.relationships.project.data.id !== root.queryParams.project\n        ) {\n          return false;\n        }\n      }\n      if (typeof root.queryParams.assignment !== \"undefined\") {\n        if (\n          submission.relationships.assignment.id !== root.queryParams.assignment\n        ) {\n          return false;\n        }\n      }\n      return true;\n    });\n    // delay and repaint, can help with refresh issues\n    setTimeout(() => {\n      this.$.ironlist.fire(\"iron-resize\");\n    }, 200);\n    return filteredSubmissions;\n  },\n  /**\n   * Support having a toast message because of delete or error elsewhere.\n   */\n  _deleteToast: function(deletetoast, old) {\n    if (typeof deletetoast !== typeof undefined) {\n      if (deletetoast == \"error\") {\n        this.$.toast.show(\"That submission on longer exists!\");\n      } else {\n        this.$.toast.show(\"Submission deleted successfully!\");\n      }\n      this.set(\"queryParams.deletetoast\", undefined);\n      this.notifyPath(\"queryParams.deletetoast\");\n    }\n  },\n  _assignmentFilterChanged: function(assignment) {\n    // if we have a assignment then we need to uncheck project\n    if (typeof assignment !== typeof undefined && !this._blockcycle) {\n      this._blockcycle = true;\n      this.set(\"queryParams.project\", undefined);\n      this.notifyPath(\"queryParams.project\");\n      this.set(\"queryParams.assignment\", assignment);\n      this.notifyPath(\"queryParams.assignment\");\n    } else {\n      this._blockcycle = false;\n    }\n  },\n  _projectFilterChanged: function(project) {\n    // if we have a project then we need to uncheck assignment\n    if (typeof project !== typeof undefined && !this._blockcycle) {\n      this._blockcycle = true;\n      this.set(\"queryParams.project\", project);\n      this.notifyPath(\"queryParams.project\");\n      this.set(\"queryParams.assignment\", undefined);\n      this.notifyPath(\"queryParams.assignment\");\n    } else {\n      this._blockcycle = false;\n    }\n  },\n  /**\n   * Handle tap on paper-button above to redirect to the correct submission url.\n   */\n  _loadSubmissionUrl: function(e) {\n    let root = this;\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // this will have the id of the current submission\n    var active = local.getAttribute(\"data-submission-id\");\n    // @todo need a cleaner integration but this at least goes the right place for now\n    window.location.href =\n      this.basePath + \"lrnapp-studio-submission/submissions/\" + active;\n  },\n  /**\n   * Handle response for the whole projects object.\n   */\n  _handleResponse: function(event) {\n    let root = this;\n    var author = {};\n    var project = {};\n    var tmp = {\n      authors: [],\n      assignments: []\n    };\n    var assignment = {};\n    var assignments = [];\n    var authors = [];\n    // get the submission response's data and convert to array ahead of time\n    var submissions = this._toArray(root.studioResponse.data.submissions);\n    var projects = this._toArray(root.studioResponse.data.projects);\n    this.set(\"projects\", projects);\n    // original = active off the bat then we apply filters later to chang this\n    this.set(\"originalSubmissions\", submissions);\n    // figure out authors and assignments\n    for (var index = 0; index < submissions.length; index++) {\n      author = submissions[index].relationships.author.data;\n      tmp.authors[author.id] = author;\n      project = submissions[index].relationships.project.data;\n      assignment = submissions[index].relationships.assignment;\n      tmp.assignments[assignment.id] = assignment;\n      tmp.assignments[assignment.id].project = project.id;\n    }\n    // this is stupid but we have to normalize the IDs or else dom repeats will be screwed up\n    tmp.authors.forEach(function(element) {\n      authors.push(element);\n    });\n    // this is stupid but we have to normalize the IDs or else dom repeats will be screwed up\n    tmp.assignments.forEach(function(element) {\n      assignments.push(element);\n    });\n    root.$.loading.hidden = true;\n    this.set(\"assignments\", assignments);\n    this.set(\"authors\", authors);\n  },\n  _submissionsClicked: function(e) {\n    this.set(\"route.path\", this.endPoint + \"/submissions\");\n    this.notifyPath(\"route.path\");\n  },\n  _projectsClicked: function(e) {\n    this.set(\"route.path\", this.endPoint + \"/projects\");\n    this.notifyPath(\"route.path\");\n  },\n  _assignmentsClicked: function(e) {\n    this.set(\"route.path\", this.endPoint + \"/assignments\");\n    this.notifyPath(\"route.path\");\n  },\n  _tableClicked: function(e) {\n    this.set(\"route.path\", this.endPoint + \"/table\");\n    this.notifyPath(\"route.path\");\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\nimport \"@polymer/iron-list/iron-list.js\";\nimport \"@polymer/paper-card/paper-card.js\";\nimport \"@polymer/paper-item/paper-item-shared-styles.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles paper-item-styles\">\n      :host {\n        display: block;\n      }\n      #loading {\n        width: 100%;\n        z-index: 1000;\n        opacity: 0.8;\n        text-align: center;\n        align-content: center;\n        justify-content: center;\n        background-color: white;\n      }\n      paper-button {\n        padding: 0;\n        margin: 0;\n        min-width: 1rem;\n        text-transform: unset;\n      }\n      .project-card {\n        width: 100%;\n        min-width: 15em;\n        max-width: 20em;\n        margin: 0 1em;\n      }\n      .button-contents {\n        display: flex;\n        align-content: center;\n      }\n      .assignment-row {\n        border: 1px solid #000000;\n        background-color: #ffffff;\n      }\n      .assignment-row .assignment-row-button.active {\n        background-color: var(--paper-amber-50);\n        font-weight: bold;\n      }\n      .assignment-row:hover .assignment-operations {\n        display: block;\n        overflow: visible;\n        margin: 0.2em;\n      }\n      .assignment-row-button {\n        width: 100%;\n        justify-content: flex-start;\n        height: 3em;\n        text-transform: none;\n      }\n      .assignment-title {\n        display: inline-flex;\n        align-items: center;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        line-height: 1em;\n      }\n      .status-indicator {\n        border-right: 1px solid grey;\n        padding: 0.5em;\n        margin: 0 0.5em 0 0;\n        display: inline-flex;\n        line-height: 3em;\n        height: 3em;\n        justify-content: center;\n        align-items: center;\n      }\n      .whole-project {\n        width: 100%;\n        margin: 0;\n        padding: 0;\n      }\n    </style>\n    <iron-ajax\n      auto=\"\"\n      url=\"{{sourcePath}}\"\n      handle-as=\"json\"\n      last-response=\"{{response}}\"\n      on-response=\"handleResponse\"\n    ></iron-ajax>\n    <div id=\"loading\">\n      <h3>Loading..</h3>\n      <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n    </div>\n    <template is=\"dom-if\" if=\"[[hasProject]]\">\n      <a tabindex=\"-1\" href\\$=\"[[basePath]]lrnapp-studio-kanban\">\n        <paper-button class=\"whole-project ferpa-protect\">\n          <paper-card\n            id\\$=\"project-[[project.id]]\"\n            class=\"project-card grey lighten-3\"\n            heading=\"{{project.attributes.title}}\"\n            elevation=\"2\"\n          >\n            <div class=\"card-content\">\n              <iron-list\n                items=\"[[_toArray(project.relationships.assignments)]]\"\n                as=\"assignment\"\n              >\n                <template>\n                  <div class=\"assignment-row\" id=\"assignment\">\n                    <lrnsys-button\n                      inner-class=\"no-left-padding\"\n                      class=\"assignment-row-button\"\n                      button-class=\"assignment-row-button\"\n                      id\\$=\"assignment-[[project.id]]-[[assignment.id]]\"\n                      hover-class=\"amber lighten-5\"\n                      href\\$=\"[[basePath]]lrnapp-studio-kanban\"\n                    >\n                      <span slot=\"button\" class=\"button-contents\">\n                        <div\n                          class\\$=\"status-indicator [[assignment.metadata.relatedSubmissions.complete.color]]\"\n                        >\n                          <iron-icon\n                            icon=\"[[assignment.metadata.relatedSubmissions.complete.icon]]\"\n                          ></iron-icon>\n                        </div>\n                        <div class=\"assignment-title\">[[assignment.title]]</div>\n                      </span>\n                    </lrnsys-button>\n                  </div>\n                </template>\n              </iron-list>\n            </div>\n          </paper-card>\n        </paper-button>\n      </a>\n    </template>\n    <template is=\"dom-if\" if=\"[[!hasProject]]\">\n      <lrnsys-button\n        inner-class=\"no-left-padding\"\n        button-class=\"assignment-row-button\"\n        class=\"assignment-row-button\"\n        href\\$=\"[[basePath]]lrnapp-studio-kanban\"\n        hover-class=\"amber lighten-5\"\n      >\n        <span slot=\"button\" class=\"button-contents\">\n          <div class=\"status-indicator\">\n            <iron-icon icon=\"assignment\"></iron-icon>\n          </div>\n          <div class=\"assignment-title\">Tap to start your first project!</div>\n        </span>\n      </lrnsys-button>\n    </template>\n  `,\n\n  is: \"lrnapp-block-recent-project\",\n\n  properties: {\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    response: {\n      type: Object,\n      notify: true\n    },\n    project: {\n      type: Object,\n      notify: true\n    },\n    hasProject: {\n      type: Boolean,\n      notify: true,\n      reflectToAttribute: true,\n      computed: \"_getHasProject(project)\"\n    }\n  },\n\n  /**\n   * Generate the correct boolean for having a project.\n   */\n  _getHasProject: function(project) {\n    if (typeof project.id !== typeof undefined) {\n      return true;\n    }\n    return false;\n  },\n\n  /**\n   * Swap off the loading with project data.\n   */\n  handleResponse: function(e) {\n    this.$.loading.hidden = true;\n    this.project = this.response.data;\n  },\n\n  /**\n   * Generate an array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/iron-list/iron-list.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@lrnwebcomponents/lrndesign-gallerycard/lrndesign-gallerycard.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nPolymer({\n  _template: html`\n    <style include=\"paper-item-styles\">\n      :host {\n        display: block;\n      }\n      paper-button {\n        width: 100%;\n      }\n    </style>\n    <iron-ajax\n      auto=\"\"\n      url=\"{{sourcePath}}\"\n      handle-as=\"json\"\n      last-response=\"{{response}}\"\n      on-response=\"handleResponse\"\n    ></iron-ajax>\n    <div id=\"loading\">\n      <h3>Loading..</h3>\n      <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n    </div>\n    <iron-list items=\"[[_toArray(response.data)]]\" as=\"item\">\n      <template>\n        <paper-button on-tap=\"_loadSubmissionUrl\">\n          <lrndesign-gallerycard\n            data-submission-id\\$=\"[[item.id]]\"\n            title=\"[[item.attributes.title]]\"\n            author=\"[[item.relationships.author.data]]\"\n            comments=\"[[item.meta.comment_count]]\"\n            image=\"[[item.display.image]]\"\n            icon=\"[[item.display.icon]]\"\n            class=\"ferpa-protect\"\n          >\n          </lrndesign-gallerycard>\n        </paper-button>\n      </template>\n    </iron-list>\n  `,\n  is: \"lrnapp-block-recent-submissions\",\n  properties: {\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    response: {\n      type: Array,\n      notify: true\n    }\n  },\n  /**\n   * Handle tap on paper-button above to redirect to the correct submission url.\n   */\n  _loadSubmissionUrl: function(e) {\n    let root = this;\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // this will have the id of the current submission\n    var active = local.getAttribute(\"data-submission-id\");\n    // @todo need a cleaner integration but this at least goes the right place for now\n    window.location.href =\n      this.basePath + \"lrnapp-studio-submission/submissions/\" + active;\n  },\n  handleResponse: function(e) {\n    this.$.loading.hidden = true;\n  },\n  _getViewLink: function(nid) {\n    return this.basePath + \"lrnapp-studio-submission/submissions/\" + nid;\n  },\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { IronResizableBehavior } from \"@polymer/iron-resizable-behavior/iron-resizable-behavior.js\";\nimport \"@polymer/paper-card/paper-card.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@lrnwebcomponents/lrn-icon/lrn-icon.js\";\nimport \"@lrnwebcomponents/lrndesign-avatar/lrndesign-avatar.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n\n      paper-card {\n        padding: 2em 2em 0 2em;\n        clear: right;\n      }\n\n      paper-button {\n        background-color: var(--paper-grey-100);\n        margin: 1em;\n      }\n\n      .card-content {\n        padding-left: 2em;\n        padding-right: 2em;\n        width: 100%;\n      }\n\n      .card-actions {\n        width: 100%;\n      }\n\n      .card-actions paper-button {\n        display: flex;\n      }\n\n      lrndesign-avatar {\n        float: left;\n        margin-right: 1em;\n      }\n\n      .flex-wrap {\n        @apply --layout-horizontal;\n        @apply --layout-wrap;\n      }\n\n      .inactive {\n        max-height: 4.6em;\n        overflow: hidden;\n      }\n\n      paper-button {\n        background: white;\n        width: 100%;\n        display: flex;\n      }\n\n      lrn-icon {\n        color: black;\n        width: 100%;\n      }\n\n      .hidden {\n        display: none;\n      }\n    </style>\n    <paper-card elevation=\"3\" class=\"flex-wrap\">\n      <div class=\"card-content\">\n        <lrndesign-avatar\n          label=\"[[commentUser.name]]\"\n          src=\"[[commentUser.avatar]]\"\n        ></lrndesign-avatar>\n        <h3>[[commentUser.display_name]]</h3>\n        <div id=\"wrapper\" class=\"button-wrapper\">\n          <div id=\"comment\" class=\"inactive\"><slot></slot></div>\n          <paper-button id=\"btn\" class=\"hidden\">\n            <lrn-icon icon=\"chevron-down\" id=\"icon\"></lrn-icon>\n          </paper-button>\n        </div>\n      </div>\n      <div class=\"card-actions\">\n        <template is=\"dom-if\" if=\"[[actionView]]\">\n          <a href$=\"[[actionView]]\" tabindex=\"-1\">\n            <paper-button raised=\"\" id=\"view\">View thread</paper-button>\n          </a>\n        </template>\n      </div>\n    </paper-card>\n  `,\n\n  is: \"lrnapp-block-recent-comments-comment\",\n  behaviors: [IronResizableBehavior],\n\n  listeners: {\n    \"iron-resize\": \"onHeightChange\"\n  },\n\n  onHeightChange: function() {\n    var height = this.$.comment.offsetHeight;\n    if (height > 80) {\n      this.$.btn.classList.toggle(\"hidden\", this.hidden);\n    }\n  },\n  properties: {\n    commentTitle: {\n      type: String,\n      value: \"Comment title\",\n      reflectToAttribute: true,\n      notify: true\n    },\n    actionView: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    dateUpdated: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    commentUser: {\n      type: Object,\n      value: {},\n      reflectToAttribute: true,\n      notify: true\n    }\n  },\n  /**\n   * attached life cycle\n   */\n  attached: function() {\n    this.$.wrapper.addEventListener(\"click\", function(e) {\n      this.$.comment.classList.toggle(\"inactive\", this.inactive);\n    });\n  },\n  /**\n   * detached life cycle\n   */\n  detached: function() {\n    this.$.wrapper.removeEventListener(\"click\", function(e) {\n      this.$.comment.classList.toggle(\"inactive\", this.inactive);\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/paper-item/paper-item.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"./lrnapp-block-recent-comments-comment.js\";\nPolymer({\n  _template: html`\n    <style include=\"paper-item-styles\">\n      :host {\n        display: block;\n      }\n    </style>\n    <div id=\"loading\">\n      <h3>Loading..</h3>\n      <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n    </div>\n    <iron-ajax\n      auto=\"\"\n      url=\"{{sourcePath}}\"\n      handle-as=\"json\"\n      last-response=\"{{response}}\"\n      on-response=\"handleResponse\"\n    ></iron-ajax>\n    <template is=\"dom-repeat\" items=\"[[_toArray(response.data)]]\" as=\"comment\">\n      <lrnapp-block-recent-comments-comment\n        comment-user=\"{{comment.relationships.author.data}}\"\n        comment-title=\"{{comment.attributes.subject}}\"\n        action-view=\"{{_getViewLink(comment.relationships.node.data.id)}}\"\n        date-updated=\"{{comment.attributes.changed}}\"\n        class=\"ferpa-protect\"\n      >\n        [[comment.attributes.body]]\n      </lrnapp-block-recent-comments-comment>\n    </template>\n  `,\n  is: \"lrnapp-block-recent-comments\",\n  properties: {\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    response: {\n      type: Array,\n      notify: true\n    }\n  },\n  handleResponse: function(e) {\n    this.$.loading.hidden = true;\n  },\n  _getViewLink: function(nid) {\n    return this.basePath + \"lrnapp-studio-submission/submissions/\" + nid;\n  },\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/iron-list/iron-list.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/lrndesign-gallerycard/lrndesign-gallerycard.js\";\nPolymer({\n  _template: html`\n    <style include=\"paper-item-styles\">\n      :host {\n        display: block;\n      }\n      paper-button {\n        width: 100%;\n      }\n    </style>\n    <iron-ajax\n      auto=\"\"\n      url=\"{{sourcePath}}\"\n      handle-as=\"json\"\n      last-response=\"{{response}}\"\n      on-response=\"handleResponse\"\n    ></iron-ajax>\n    <div id=\"loading\">\n      <h3>Loading..</h3>\n      <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n    </div>\n    <iron-list items=\"[[_toArray(response.data)]]\" as=\"item\">\n      <template>\n        <paper-button on-tap=\"_loadSubmissionUrl\">\n          <lrndesign-gallerycard\n            data-submission-id\\$=\"[[item.id]]\"\n            title=\"[[item.attributes.title]]\"\n            author=\"[[item.relationships.author.data]]\"\n            comments=\"[[item.meta.comment_count]]\"\n            image=\"[[item.display.image]]\"\n            icon=\"[[item.display.icon]]\"\n            class=\"ferpa-protect\"\n          >\n          </lrndesign-gallerycard>\n        </paper-button>\n      </template>\n    </iron-list>\n  `,\n\n  is: \"lrnapp-block-need-feedback\",\n\n  properties: {\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    response: {\n      type: Array,\n      notify: true\n    }\n  },\n\n  /**\n   * Handle tap on paper-button above to redirect to the correct submission url.\n   */\n  _loadSubmissionUrl: function(e) {\n    let root = this;\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // this will have the id of the current submission\n    var active = local.getAttribute(\"data-submission-id\");\n    // @todo need a cleaner integration but this at least goes the right place for now\n    window.location.href =\n      this.basePath + \"lrnapp-studio-submission/submissions/\" + active;\n  },\n\n  handleResponse: function(e) {\n    this.$.loading.hidden = true;\n  },\n\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-card/paper-card.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nimport \"./lrnapp-block-recent-project.js\";\nimport \"./lrnapp-block-recent-submissions.js\";\nimport \"./lrnapp-block-recent-comments.js\";\nimport \"./lrnapp-block-need-feedback.js\";\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\">\n      :host {\n        display: block;\n        padding: 0 2em;\n      }\n      h1.title {\n        font-size: 2em;\n        color: black;\n        margin: 0;\n        padding: 0.5em 0 0 0;\n        text-transform: none;\n        text-align: left;\n      }\n      p.para {\n        margin: 0;\n        padding: 0.25em 0.5em;\n      }\n      .dashboard-row {\n        width: 100%;\n        display: inline-flex;\n      }\n      .dashboard-item {\n        width: 30%;\n      }\n    </style>\n    <h1 class=\"title\">Welcome back [[username]]!</h1>\n    <p class=\"para\">Here's what's been going on in the studio</p>\n    <div class=\"dashboard-row\">\n      <paper-card heading=\"Your active project\" class=\"dashboard-item\">\n        <div class=\"card-content\">\n          <lrnapp-block-recent-project\n            csrf-token=\"[[csrfToken]]\"\n            end-point=\"[[_getEndPoint(basePath)]]\"\n            base-path=\"[[basePath]]\"\n            source-path=\"[[_getDataSource(csrfToken, basePath,'recent-project')]]\"\n          >\n          </lrnapp-block-recent-project>\n        </div>\n      </paper-card>\n      <paper-card heading=\"Classmates needing feedback\" class=\"dashboard-item\">\n        <div class=\"card-content\">\n          <lrnapp-block-need-feedback\n            csrf-token=\"[[csrfToken]]\"\n            end-point=\"[[_getEndPoint(basePath)]]\"\n            base-path=\"[[basePath]]\"\n            source-path=\"[[_getDataSource(csrfToken, basePath,'need-feedback')]]\"\n          >\n          </lrnapp-block-need-feedback>\n        </div>\n      </paper-card>\n      <paper-card heading=\"Recent Studio submissions\" class=\"dashboard-item\">\n        <div class=\"card-content\">\n          <lrnapp-block-recent-submissions\n            csrf-token=\"[[csrfToken]]\"\n            end-point=\"[[_getEndPoint(basePath)]]\"\n            base-path=\"[[basePath]]\"\n            source-path=\"[[_getDataSource(csrfToken, basePath,'recent-submissions')]]\"\n          >\n          </lrnapp-block-recent-submissions>\n        </div>\n      </paper-card>\n      <paper-card heading=\"Recent Studio comments\" class=\"dashboard-item\">\n        <div class=\"card-content\">\n          <lrnapp-block-recent-comments\n            csrf-token=\"[[csrfToken]]\"\n            end-point=\"[[_getEndPoint(basePath)]]\"\n            base-path=\"[[basePath]]\"\n            source-path=\"[[_getDataSource(csrfToken, basePath,'recent-comments')]]\"\n          >\n          </lrnapp-block-recent-comments>\n        </div>\n      </paper-card>\n    </div>\n  `,\n  is: \"lrnapp-studio-dashboard\",\n  properties: {\n    username: {\n      type: String,\n      reflectToAttribute: true\n    },\n    basePath: {\n      type: String,\n      notify: true,\n      reflectToAttribute: true\n    },\n    csrfToken: {\n      type: String,\n      notify: true,\n      reflectToAttribute: true\n    },\n    sourcePath: {\n      type: String,\n      notify: true,\n      reflectToAttribute: true\n    }\n  },\n  _getEndPoint: function(basePath) {\n    return basePath + \"lrnapp-studio-dashboard/blocks\";\n  },\n  _getDataSource: function(csrfToken, basePath, dataPoint) {\n    return (\n      basePath +\n      \"lrnapp-studio-dashboard/blocks/\" +\n      dataPoint +\n      \"?token=\" +\n      csrfToken\n    );\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@polymer/app-route/app-location.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/paper-toggle-button/paper-toggle-button.js\";\nimport \"@polymer/paper-item/paper-item.js\";\nimport \"@polymer/paper-badge/paper-badge.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@polymer/paper-input/paper-input.js\";\nimport \"@polymer/paper-icon-button/paper-icon-button.js\";\nimport \"@polymer/paper-tooltip/paper-tooltip.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-filter.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-sorter.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-column-group.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-selection-column.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/lrndesign-chart/lib/lrndesign-bar.js\";\nimport \"@lrnwebcomponents/lrndesign-chart/lib/lrndesign-line.js\";\nimport \"@lrnwebcomponents/lrndesign-chart/lib/lrndesign-pie.js\";\nimport \"@lrnwebcomponents/dropdown-select/dropdown-select.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"@lrnwebcomponents/lrndesign-avatar/lrndesign-avatar.js\";\nimport \"@lrnwebcomponents/lrnsys-layout/lib/lrnsys-dialog.js\";\nimport \"@lrnwebcomponents/elmsln-apps/lib/lrnapp-studio-submission/lrnapp-studio-submission.js\";\nPolymer({\n  _template: html`\n  <style include=\"materializecss-styles\">\n    :host {\n      display: block;\n      align-content: center;\n      padding: .8em;\n    }\n    vaadin-grid-table-body > vaadin-grid-cell-content {\n      height: unset !important;\n    }\n    lrnsys-dialog-toolbar {\n      top: 0;\n      position: sticky !important;\n      z-index: 1;\n    }\n    #loading {\n      width: 100%;\n      z-index: 1000;\n      opacity: .8;\n      text-align: center;\n      align-content: center;\n      justify-content: center;\n      height: 100vh;\n      position: absolute;\n      background-color: white;\n    }\n    .center-data {\n      text-align: center;\n    }\n    vaadin-grid#material {\n      height: 75vh;\n      font-family: Roboto, sans-serif;\n      --divider-color: rgba(0, 0, 0, var(--dark-divider-opacity));\n\n      --vaadin-grid-cell: {\n        padding: 0;\n      };\n\n      --vaadin-grid-header-cell: {\n        height: 3.5em;\n        color: rgba(0, 0, 0, var(--dark-secondary-opacity));\n        font-size: 1em;\n      };\n\n      --vaadin-grid-body-cell: {\n        height: 3em;\n        color: rgba(0, 0, 0, var(--dark-primary-opacity));\n        font-size: .8em;\n      };\n\n      --vaadin-grid-body-row-hover-cell: {\n        background-color: var(--paper-grey-200);\n      };\n\n      --vaadin-grid-body-row-selected-cell: {\n        background-color: var(--paper-grey-100);\n      };\n\n      --vaadin-grid-focused-cell: {\n        box-shadow: none;\n        font-weight: bold;\n      };\n    }\n\n    vaadin-grid#material .cell {\n      overflow: hidden;\n      text-overflow: ellipsis;\n      padding-right: 56px;\n    }\n\n    vaadin-grid#material .cell.last {\n      padding-right: 24px;\n    }\n\n    vaadin-grid#material .cell.numeric {\n      text-align: right;\n    }\n\n    vaadin-grid#material paper-checkbox {\n      --primary-color: var(--paper-indigo-500);\n      margin: 0 24px;\n    }\n\n    vaadin-grid#material vaadin-grid-sorter .cell {\n      flex: 1;\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n    }\n\n    vaadin-grid#material vaadin-grid-sorter iron-icon {\n      transform: scale(0.8);\n    }\n\n    vaadin-grid#material vaadin-grid-sorter:not([direction]) iron-icon {\n      color: rgba(0, 0, 0, var(--dark-disabled-opacity));\n    }\n\n    vaadin-grid#material vaadin-grid-sorter[direction] {\n      color: rgba(0, 0, 0, var(--dark-primary-opacity));\n    }\n\n    vaadin-grid#material vaadin-grid-sorter[direction=desc] iron-icon {\n      transform: scale(0.8) rotate(180deg);\n    }\n    vaadin-grid-sorter {\n      text-align: center;\n    }\n\n    lrndesign-avatar {\n      display: inline-block;\n    }\n    .avatar-label {\n      display: inline-block;\n      margin-left: .2em;\n    }\n\n    .avatar-button {\n\n    }\n    .assignment-button {\n      height: 1em;\n    }\n    .project-button {\n      height: 1em;\n    }\n    paper-badge {\n      top: 0 !important;\n      left: unset !important;\n      right: 0;\n      z-index: 1;\n    }\n    .avatar-link {\n      color: black;\n    }\n    .avatar-link paper-button {\n      text-transform: unset;\n    }\n    #selectedproject {\n      display: inline-block;\n    }\n    #datatype {\n      display: inline-block;\n      vertical-align: middle;\n      --paper-toggle-button-checked-bar-color:  var(--paper-green-500);\n      --paper-toggle-button-checked-button-color:  var(--paper-green-500);\n      --paper-toggle-button-checked-ink-color: var(--paper-green-500);\n      --paper-toggle-button-unchecked-bar-color:  var(--paper-amber-900);\n      --paper-toggle-button-unchecked-button-color:  var(--paper-amber-900);\n      --paper-toggle-button-unchecked-ink-color: var(--paper-amber-900);\n    }\n    .comment-list {\n      list-style-image: none;\n      display: inline-block;\n      padding: 0;\n      margin: 0;\n    }\n    .stats-text {\n      font-size: .8em;\n      font-style: italic;\n      line-height: 1em;\n      padding: 0 0 0 2em;\n      display: inline-block;\n      text-align: right;\n    }\n  </style>\n  <app-location route=\"{{route}}\"></app-location>\n  <app-route\n      route=\"{{route}}\"\n      pattern=\"[[endPoint]]/submissions/:submission\"\n      data=\"{{data}}\"\n      tail=\"{{tail}}\">\n  </app-route>\n  <iron-ajax auto\n    id=\"projectrequest\"\n    url=\"[[sourceProjectPath]]\"\n    params=\"\"\n    handle-as=\"json\"\n    last-response=\"{{_projectData}}\"\n    on-response=\"_handleProjectResponse\"></iron-ajax>\n  <iron-ajax\n    id=\"studentrequest\"\n    url=\"[[sourceStudentPath]]\"\n    params='[[studentParams]]'\n    handle-as=\"json\"\n    last-response=\"{{_studentData}}\"\n    on-response=\"_handleStudentResponse\"></iron-ajax>\n  <div id=\"loading\">\n    <h3>Loading..</h3>\n    <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n  </div>\n  <div hidden$=\"[[activeProject]]\">Select a project to begin reviewing work</div>\n  <dropdown-select id=\"selectedproject\" label=\"Project\">\n    <template is=\"dom-repeat\" items=\"[[_toArray(projects)]]\" as=\"project\">\n      <paper-item value$=\"[[project.id]]\">[[project.attributes.title]]</paper-item>\n    </template>\n  </dropdown-select>\n  <paper-toggle-button id=\"datatype\" checked=\"{{dataType}}\" disabled>\n    [[dataTypeText]]\n  </paper-toggle-button>\n  <lrnsys-dialog id=\"statsdialog\" disabled>\n    <span slot=\"button\"><iron-icon icon=\"editor:show-chart\"></iron-icon> Statistics (beta)</span>\n    <span slot=\"toolbar-primary\">\n      [[stats.header]]\n    </span>\n  <span slot=\"content\">\n      <div style=\"padding: 2em 4em;\">\n        <span class=\"stats-text\">[[stats.overview]]</span>\n        <dropdown-select id=\"selectedchart\" label=\"Graph style\">\n          <paper-item value=\"byassignment-submissions\">Submissions by Assignment</paper-item>\n          <paper-item value=\"byassignment-comments\">Comments by Assignment</paper-item>\n          <paper-item value=\"byassignment-commenters\">Commenters by Assignment</paper-item>\n        </dropdown-select>\n        <lrndesign-bar chart-title=\"[[activeChart.title]]\" chart-desc=\"[[activeChart.description]]\" data=\"[[activeChart.data]]\"></lrndesign-bar>\n      </div>\n    </span>\n  </lrnsys-dialog>\n  <vaadin-grid hidden$=\"[[!students]]\" id=\"material\" aria-label=\"Student project list\" items=\"[[_toArray(students)]]\">\n    <vaadin-grid-column resizable>\n      <template class=\"header\">\n        <vaadin-grid-sorter id=\"sorter\" path=\"sis.sortable_name\">Student</vaadin-grid-sorter>\n      </template>\n      <template>\n        <a href$=\"[[basePath]]lrnapp-open-studio/projects?author=[[item.id]]&project=[[activeProject]]\" tabindex=\"-1\" target=\"_blank\" class=\"avatar-link ferpa-protect\">\n          <paper-button class=\"avatar-button\">\n            <lrndesign-avatar label=\"[[item.name]]\" src=\"[[item.avatar]]\"></lrndesign-avatar>\n            <span class=\"avatar-label\">[[item.sis.sortable_name]]</span>\n          </paper-button>\n        </a>\n      </template>\n      <template class=\"footer\">\n        <vaadin-grid-filter aria-label=\"Student\" path=\"sis.sortable_name\" value=\"[[_filterName]]\">\n          <paper-input slot=\"filter\" label=\"Student\" value=\"{{_filterName::input}}\" focus-target></paper-input>\n        </vaadin-grid-filter>\n      </template>\n    </vaadin-grid-column>\n    <template is=\"dom-repeat\" items=\"[[_toArray(assignments)]]\" as=\"assignment\">\n      <vaadin-grid-column resizable>\n        <template class=\"header\">\n          <span>[[assignment.title]]</span>\n        </template>\n        <template>\n          <template is=\"dom-if\" if=\"[[_submissionStatus(item, assignment, dataType)]]\">\n            <template is=\"dom-if\" if=\"[[!dataType]]\">\n              <lrnsys-button icon=\"[[_submissionPiece(item, assignment, 'icon')]]\" id$=\"student-[[item.id]]-assignment-[[assignment.id]]-submission-[[_submissionID(item, assignment)]]\" label=\"[[_submissionPiece(item, assignment, 'title')]]\" on-tap=\"_setActiveSubmission\">\n              </lrnsys-button>\n            </template>\n            <template is=\"dom-if\" if=\"[[dataType]]\">\n              <ul class=\"comment-list\">\n              <template is=\"dom-repeat\" items=\"[[_submissionPiece(item, assignment, 'comments')]]\" as=\"commented\">\n                <li>\n                  <lrnsys-button icon=\"communication:comment\" id$=\"student-[[item.id]]-assignment-[[assignment.id]]-submission-[[commented]]\" label=\"#[[_commentIndex(index)]]\" on-tap=\"_setActiveComment\">\n                  </lrnsys-button>\n                </li>\n              </template>\n              </ul>\n            </template>\n          </template>\n          <template is=\"dom-if\" if=\"[[!_submissionStatus(item, assignment, dataType)]]\">\n            <paper-button disabled class=\"project-button\" id$=\"student-[[item.id]]-assignment-[[assignment.id]]-submission-null\">X</paper-button>\n          </template>\n          <template is=\"dom-if\" if=\"[[_commentCount(item, assignment, dataType)]]\">\n            <paper-badge id$=\"student-[[item.id]]-assignment-[[assignment.id]]-tip\" for=\"student-[[item.id]]-assignment-[[assignment.id]]\" label=\"[[_commentCount(item, assignment, dataType)]]\"></paper-badge>\n            <paper-tooltip for=\"student-[[item.id]]-assignment-[[assignment.id]]-tip\">Comments left on classmates [[assignment.title]]</paper-badge>\n          </template>\n        </template>\n      </vaadin-grid-column>\n    </template>\n  </vaadin-grid>\n  <lrnsys-dialog id=\"dialog\" style=\"overflow: visible;\">\n    <span slot=\"toolbar-primary\">\n      <span style=\"width:15em;\">\n        <paper-icon-button on-tap=\"_changeActiveItem\" id=\"prevstudent\" icon=\"arrow-upward\" title=\"previous student\"></paper-icon-button>\n        <paper-icon-button on-tap=\"_changeActiveItem\" id=\"nextstudent\" icon=\"arrow-downward\" title=\"next student\"></paper-icon-button>\n        <lrndesign-avatar class=\"ferpa-protect\" label=\"[[activeData.student.name]]\" src=\"[[activeData.student.avatar]]\" style=\"display:inline-block;vertical-align:middle;\"></lrndesign-avatar>\n        <span class=\"avatar-label ferpa-protect\" style=\"margin-left:1em;\">[[activeData.student.sis.sortable_name]]</span>\n      </span>\n      <paper-icon-button on-tap=\"_changeActiveItem\" id=\"prevassignment\" icon=\"arrow-back\" title=\"previous assignment\" style=\"margin-left:1em;\"></paper-icon-button>\n      <paper-icon-button on-tap=\"_changeActiveItem\" id=\"nextassignment\" icon=\"arrow-forward\" title=\"next assignment\"></paper-icon-button>\n      <span style=\"font-weight:bold;\">Assignment: [[activeData.assignment.title]]</span>\n    </span>\n    <span slot=\"content\">\n      <template is=\"dom-if\" if=\"[[activeData.submission]]\">\n        <lrnapp-studio-submission-page base-path=\"[[basePath]]\" route=\"{{tail}}\" id=\"[[data.submission]]\" end-point=\"[[basePath]]lrnapp-studio-submission\" csrf-token=\"[[csrfToken]]\" data=\"[[data]]\" hide-menu-bar></lrnapp-studio-submission-page>\n      </template>\n      <template is=\"dom-if\" if=\"[[!activeData.submission]]\">\n        <div>\n          <h3>No submission for this assignment</h3>\n          <p>This student has not submitted anything for this assignment at this time.</p>\n        </div>\n      </template>\n    </span>\n  </lrnsys-dialog>  \n`,\n  is: \"lrnapp-studio-instructor\",\n  observers: [\n    \"_routeChanged(route, endPoint)\",\n    \"_activeDataChanged(activeData.student, activeData.assignment)\"\n  ],\n  properties: {\n    /**\n     * Type of data to display, either submission centric or comment centric.\n     * False = submission, true = comment\n     */\n    dataType: {\n      type: Boolean,\n      value: false,\n      observer: \"_dataTypeChanged\"\n    },\n    dataTypeText: {\n      type: String,\n      value: \"Submissions\"\n    },\n    /**\n     * The projects to render\n     */\n    projects: {\n      type: Object,\n      notify: true\n    },\n    /**\n     * The assignments to render\n     */\n    assignments: {\n      type: Object,\n      notify: true\n    },\n    /**\n     * The submissions to render\n     */\n    students: {\n      type: Object,\n      notify: true,\n      value: false\n    },\n    /**\n     * Internal value for mapping the raw response data.\n     */\n    _projectData: {\n      type: Object,\n      value: {}\n    },\n    /**\n     * studentParams for the request\n     */\n    studentParams: {\n      type: Object,\n      value: {\n        projectId: null,\n        type: \"submission\"\n      }\n    },\n    /**\n     * Internal value for mapping the raw response data.\n     */\n    _studentData: {\n      type: Object\n    },\n    /**\n     * Internal width so they are all unified from editing this\n     */\n    _numWidth: {\n      type: String,\n      value: \"2.25em\"\n    },\n    /**\n     * Endpoint for submission data.\n     */\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    /**\n     * base path for the app\n     */\n    basePath: {\n      type: String,\n      notify: true\n    },\n    /**\n     * routing variable for url\n     */\n    route: {\n      type: String\n    },\n    /**\n     * Security token\n     */\n    csrfToken: {\n      type: String\n    },\n    /**\n     * course\n     */\n    elmslnCourse: {\n      type: String\n    },\n    /**\n     * section\n     */\n    elmslnSection: {\n      type: String\n    },\n    /**\n     * Data binding object for the submission render\n     */\n    data: {\n      type: Object\n    },\n    /**\n     * Internal ID for active project\n     */\n    activeProject: {\n      type: Number,\n      value: false\n    },\n    /**\n     * Active Data based on selection\n     */\n    activeData: {\n      type: Object,\n      value: {\n        student: {},\n        assignment: {},\n        submission: {}\n      }\n    },\n    /**\n     * raw Stats data from backend.\n     */\n    stats: {\n      type: Object,\n      value: {}\n    },\n    /**\n     * Selected chart with data cleaned up to match formatting.\n     */\n    activeChart: {\n      type: Object,\n      value: {}\n    }\n  },\n  /**\n   * Rebuild the chart whenever the select list is changed.\n   */\n  _chartChanged: function(e) {\n    this.set(\"activeChart.title\", e.detail.value);\n    this.notifyPath(\"activeChart.title\");\n    this.set(\n      \"activeChart.description\",\n      \"Chart of values relative to \" + e.detail.value\n    );\n    this.notifyPath(\"activeChart.description\");\n    // calculate the valid charting options relative to selected chart style\n    this.set(\"activeChart.data\", this._formatChartData(e.detail.value));\n    this.notifyPath(\"activeChart.data\");\n  },\n  /**\n   * Format data in a way that chartist likes and that matches\n   * the currently active display mechanism\n   */\n  _formatChartData: function(type) {\n    var labels = [];\n    var series = [[]];\n    const stats = this.stats.stats;\n    const assignments = this._toArray(this.assignments);\n    let parts = type.split(\"-\");\n    if (\n      typeof stats[parts[0]] !== typeof undefined &&\n      typeof stats[parts[0]][parts[1]] !== typeof undefined\n    ) {\n      // make sure the data aligns now w/ the IDs in question\n      // or we'll start mixing up our data.\n      for (var i in assignments) {\n        let title = assignments[i].title;\n        if (\n          typeof stats[parts[0]][parts[1]][assignments[i].id] !==\n          typeof undefined\n        ) {\n          series[0].push(stats[parts[0]][parts[1]][assignments[i].id]);\n          title += ` (${stats[parts[0]][parts[1]][assignments[i].id]})`;\n        } else {\n          series[0].push(0);\n          title += \" (0)\";\n        }\n        labels.push(title);\n      }\n    }\n    return {\n      labels: labels,\n      series: series\n    };\n  },\n  /**\n   * When type changes, make sure we adjust what the request going\n   * out the door will be. For simplicity, false / true for the two\n   * modes are binded to submission (default) and comment methods\n   * of data return. This allows us to leverage the same endpoint\n   * and render things more or less using much of the same code\n   * and event\n   */\n  _dataTypeChanged: function(newValue, oldValue) {\n    // if type changes values and not from undefined to defined\n    // then we should execute the request for data after setting type\n    if (typeof oldValue !== typeof undefined) {\n      if (newValue) {\n        this.dataTypeText = \"Comments (beta)\";\n      } else {\n        this.dataTypeText = \"Submissions\";\n      }\n    }\n  },\n  /**\n   * Stupid thing to make it go from array position 0 to 1.\n   */\n  _commentIndex: function(index) {\n    return index + 1;\n  },\n  /**\n   * If the current route is outside the scope of our app\n   * then allow the website to break out of the single page\n   * application routing\n   */\n  _routeChanged: function(route, endPoint) {\n    if (typeof route.path === \"string\") {\n      if (typeof endPoint === \"string\") {\n        if (route.path.startsWith(endPoint)) {\n          return;\n        }\n      }\n      // reload the page which since route changed will load that page\n      window.location.reload();\n    }\n  },\n  /**\n   * Test if buttons should be visible or not\n   */\n  _activeDataChanged: function(student, assignment) {\n    if (typeof student.id !== typeof undefined) {\n      if (this._getObjectByPosition(this.students, student.id, -1) == -1) {\n        this.$.prevstudent.disabled = true;\n      } else {\n        this.$.prevstudent.disabled = false;\n      }\n      if (this._getObjectByPosition(this.students, student.id, 1) == -1) {\n        this.$.nextstudent.disabled = true;\n      } else {\n        this.$.nextstudent.disabled = false;\n      }\n      if (\n        this._getObjectByPosition(this.assignments, assignment.id, -1) == -1\n      ) {\n        this.$.prevassignment.disabled = true;\n      } else {\n        this.$.prevassignment.disabled = false;\n      }\n      if (this._getObjectByPosition(this.assignments, assignment.id, 1) == -1) {\n        this.$.nextassignment.disabled = true;\n      } else {\n        this.$.nextassignment.disabled = false;\n      }\n    }\n  },\n  /**\n   * Project updated\n   */\n  _projectChanged: function(e) {\n    this.$.loading.hidden = false;\n    // default a11y positioning back to the stats dialog\n    this.__rememberClick = this.$.statsdialog;\n    this.$.statsdialog.disabled = false;\n    this.$.datatype.disabled = false;\n    this.activeProject = e.detail.value;\n    // this should fire off the new request\n    this.studentParams.projectId = this.activeProject;\n    this.$.studentrequest.generateRequest();\n  },\n  /**\n   * attached life cycle\n   */\n  attached: function() {\n    // listen for focus event to have fired\n    document.body.addEventListener(\n      \"lrnsys-dialog-modal-closed\",\n      this._accessibleFocus.bind(this)\n    );\n    this.$.selectedproject.addEventListener(\n      \"change\",\n      this._projectChanged.bind(this)\n    );\n    this.$.selectedchart.addEventListener(\n      \"change\",\n      this._chartChanged.bind(this)\n    );\n  },\n  /**\n   * detached life cycle\n   */\n  detached: function() {\n    // listen for focus event to have fired\n    document.body.removeEventListener(\n      \"lrnsys-dialog-modal-closed\",\n      this._accessibleFocus.bind(this)\n    );\n    this.$.selectedproject.removeEventListener(\n      \"change\",\n      this._projectChanged.bind(this)\n    );\n    this.$.selectedchart.removeEventListener(\n      \"change\",\n      this._chartChanged.bind(this)\n    );\n  },\n  /**\n   * Set ourselves as having focus after the modal closes.\n   */\n  _accessibleFocus: function(e) {\n    document.body.classList.remove(\"scroll-disabled\");\n    // focus on our dialog triggering button\n    this.__rememberClick.focus();\n  },\n  /**\n   * Handle response for the whole projects object.\n   */\n  _handleProjectResponse: function(event) {\n    this.$.loading.hidden = true;\n    this.set(\"projects\", this._projectData.data.projects);\n  },\n  /**\n   * Handle response for the whole projects object.\n   */\n  _handleStudentResponse: function(event) {\n    this.$.loading.hidden = true;\n    this.set(\"students\", []);\n    this.set(\"students\", this._studentData.data.students);\n    this.set(\"assignments\", []);\n    this.set(\"assignments\", this._studentData.data.assignments);\n    this.stats = this._studentData.data.stats;\n    this.set(\n      \"stats.header\",\n      \"Statistics for \" +\n        this.projects[\"project-\" + this.activeProject].attributes.title\n    );\n    // make sure default is asc data\n    setTimeout(() => {\n      this.shadowRoot.querySelector(\"#sorter\").direction = \"asc\";\n    }, 200);\n  },\n  /**\n   * Pie menu operation handler based on which was clicked.\n   */\n  _changeActiveItem: function(e) {\n    document.body.classList.add(\"scroll-disabled\");\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    var newstudent;\n    var newassignment;\n    // use button id in order to move around in the grid as far as active\n    switch (local.id) {\n      case \"prevstudent\":\n        newstudent = this._getObjectByPosition(\n          this.students,\n          this.activeData.student.id,\n          -1\n        );\n        if (\n          newstudent != -1 &&\n          typeof newstudent.assignments[this.activeData.assignment.id] !==\n            typeof undefined\n        ) {\n          this.set(\"activeData.student\", {});\n          this.set(\"activeData.student\", newstudent);\n          this.set(\"activeData.submission\", {});\n          this.set(\n            \"activeData.submission\",\n            newstudent.assignments[this.activeData.assignment.id]\n          );\n          this.set(\n            \"route.path\",\n            this.endPoint + \"/submissions/\" + this.activeData.submission.id\n          );\n        }\n        break;\n      case \"nextstudent\":\n        newstudent = this._getObjectByPosition(\n          this.students,\n          this.activeData.student.id,\n          1\n        );\n        if (\n          newstudent != -1 &&\n          typeof newstudent.assignments[this.activeData.assignment.id] !==\n            typeof undefined\n        ) {\n          this.set(\"activeData.student\", {});\n          this.set(\"activeData.student\", newstudent);\n          this.set(\"activeData.submission\", {});\n          this.set(\n            \"activeData.submission\",\n            newstudent.assignments[this.activeData.assignment.id]\n          );\n          this.set(\n            \"route.path\",\n            this.endPoint + \"/submissions/\" + this.activeData.submission.id\n          );\n        }\n        break;\n      case \"prevassignment\":\n        newassignment = this._getObjectByPosition(\n          this.assignments,\n          this.activeData.assignment.id,\n          -1\n        );\n        if (newassignment != -1) {\n          this.set(\"activeData.assignment\", {});\n          this.set(\"activeData.assignment\", newassignment);\n          if (\n            typeof this.activeData.student.assignments[newassignment.id].id !==\n            typeof undefined\n          ) {\n            this.set(\n              \"activeData.submission\",\n              this.activeData.student.assignments[newassignment.id]\n            );\n            this.set(\"activeData.submission\", {});\n            this.set(\n              \"route.path\",\n              this.endPoint +\n                \"/submissions/\" +\n                this.activeData.student.assignments[newassignment.id].id\n            );\n          } else {\n            this.set(\"activeData.submission\", false);\n          }\n        }\n        break;\n      case \"nextassignment\":\n        newassignment = this._getObjectByPosition(\n          this.assignments,\n          this.activeData.assignment.id,\n          1\n        );\n        if (newassignment != -1) {\n          this.set(\"activeData.assignment\", {});\n          this.set(\"activeData.assignment\", newassignment);\n          if (\n            typeof this.activeData.student.assignments[newassignment.id].id !==\n            typeof undefined\n          ) {\n            this.set(\"activeData.submission\", {});\n            this.set(\n              \"activeData.submission\",\n              this.activeData.student.assignments[newassignment.id]\n            );\n            this.set(\n              \"route.path\",\n              this.endPoint +\n                \"/submissions/\" +\n                this.activeData.student.assignments[newassignment.id].id\n            );\n          } else {\n            this.set(\"activeData.submission\", false);\n          }\n        }\n        break;\n    }\n  },\n  /**\n   * Helper to move back and forth in an object like you can an array\n   */\n  _getObjectByPosition: function(items, key, i) {\n    var keys = Object.keys(items).sort(function(a, b) {\n      if (typeof items[a].sis !== typeof undefined) {\n        if (items[a].sis.sortable_name > items[b].sis.sortable_name) {\n          return 1;\n        } else if (items[a].sis.sortable_name < items[b].sis.sortable_name) {\n          return -1;\n        }\n        return 0;\n      } else {\n        return a - b;\n      }\n    });\n    if (key !== undefined) {\n      key = key.toString();\n    }\n    var index = keys.indexOf(key);\n    // try fallback for type issues\n    if (index == -1) {\n      index = keys.indexOf(parseInt(key));\n    }\n    if ((i == -1 && index > 0) || (i == 1 && index < keys.length - 1)) {\n      return items[keys[index + i]];\n    } else {\n      return -1;\n    }\n  },\n  /**\n   * Test student submission status relative to assignments\n   */\n  _submissionStatus: function(student, assignment, dataType) {\n    if (student != null) {\n      if (\n        !dataType &&\n        typeof student.assignments[assignment.id] !== typeof undefined &&\n        typeof student.assignments[assignment.id].id !== typeof undefined\n      ) {\n        return true;\n      } else if (\n        dataType &&\n        typeof student.assignmentComments[assignment.id] !== typeof undefined &&\n        this._toArray(student.assignmentComments[assignment.id]).length > 0\n      ) {\n        return true;\n      }\n    }\n    return false;\n  },\n  /**\n   * Test student submission status relative to assignments\n   */\n  _submissionID: function(student, assignment) {\n    if (\n      student != null &&\n      typeof student.assignments[assignment.id] !== typeof undefined &&\n      typeof student.assignments[assignment.id].id !== typeof undefined\n    ) {\n      return student.assignments[assignment.id].id;\n    }\n    return false;\n  },\n  /**\n   * Return a piece of the submission needed for visualization bc of template scope\n   */\n  _submissionPiece: function(student, assignment, piece) {\n    if (\n      student != null &&\n      typeof student.assignments[assignment.id] !== typeof undefined &&\n      typeof student.assignments[assignment.id].id !== typeof undefined\n    ) {\n      var submission = student.assignments[assignment.id];\n      switch (piece) {\n        case \"url\":\n          return (\n            this.basePath +\n            \"lrnapp-studio-submission/submissions/\" +\n            submission.id\n          );\n          break;\n        case \"title\":\n          return submission.attributes.title;\n          break;\n        case \"icon\":\n          return submission.meta.state_icon;\n          break;\n        case \"color\":\n          return submission.meta.state_color;\n          break;\n        case \"comments\":\n          return this._toArray(student.assignmentComments[assignment.id]);\n          break;\n      }\n    }\n    return \"\";\n  },\n  /**\n   * Return number of comments on an assignment for display.\n   */\n  _commentCount: function(student, assignment, dataType) {\n    if (\n      !dataType &&\n      student != null &&\n      typeof student.assignmentComments[assignment.id] !== typeof undefined\n    ) {\n      return this._toArray(student.assignmentComments[assignment.id]).length;\n    }\n    return false;\n  },\n  /**\n   * Set route for active submission to load\n   */\n  _setActiveSubmission: function(e) {\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    this.__rememberClick = local;\n    var item = local.id.split(\"-\");\n    // find the active elements\n    this.set(\"activeData.student\", this.students[item[1]]);\n    this.set(\"activeData.assignment\", this.assignments[item[3]]);\n    this.set(\n      \"activeData.submission\",\n      this.students[item[1]].assignments[item[3]]\n    );\n    this.set(\n      \"route.path\",\n      this.endPoint + \"/submissions/\" + item[item.length - 1]\n    );\n    document.body.classList.add(\"scroll-disabled\");\n    this.$.dialog.toggleDialog();\n  },\n  /**\n   * Set route for active submission via comment click\n   */\n  _setActiveComment: function(e) {\n    // disable all buttons for in modal nav\n    this.$.nextassignment.disabled = true;\n    this.$.prevassignment.disabled = true;\n    this.$.nextstudent.disabled = true;\n    this.$.prevstudent.disabled = true;\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    this.__rememberClick = local;\n    var item = local.id.split(\"-\");\n    // find the active elements\n    this.set(\"activeData.student\", this.students[item[1]]);\n    this.set(\"activeData.assignment\", this.assignments[item[3]]);\n    this.set(\n      \"activeData.submission\",\n      this.students[item[1]].assignments[item[3]]\n    );\n    this.set(\n      \"route.path\",\n      this.endPoint + \"/submissions/\" + item[item.length - 1]\n    );\n    document.body.classList.add(\"scroll-disabled\");\n    this.$.dialog.toggleDialog();\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/paper-toast/paper-toast.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\n\n/*\n`lrnapp-studio-project-button`\nAllows users to create new projects.\n\nUsage:\n```\n<lrnapp-studio-project-button classes=\"amber white-text\" icon=\"add\" display-errors=\"true\" end-point=\"[[endPoint]]\" csrf-token=[[csrfToken]]></lrnapp-studio-project-button>\n*/\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n    </style>\n    <template is=\"dom-if\" if=\"[[createProjectsUrl]]\">\n      <lrnsys-button\n        raised=\"\"\n        class\\$=\"[[classes]]\"\n        button-class\\$=\"[[classes]]\"\n        icon=\"[[icon]]\"\n        on-tap=\"_createProject\"\n        label=\"Create project\"\n      ></lrnsys-button>\n      <iron-ajax\n        id=\"ajaxCreateStub\"\n        url=\"[[createProjectsUrl]]\"\n        method=\"POST\"\n        handle-as=\"json\"\n        on-response=\"_ajaxCreateStubHandler\"\n      ></iron-ajax>\n    </template>\n    <template is=\"dom-if\" if=\"[[displayErrors]]\">\n      <paper-toast id=\"toast\"></paper-toast>\n    </template>\n  `,\n\n  is: \"lrnapp-studio-project-button\",\n\n  properties: {\n    auto: {\n      type: Boolean,\n      reflectToAttribute: true,\n      value: false,\n      notify: true\n    },\n    displayErrors: {\n      type: Boolean,\n      value: true\n    },\n    createProjectsUrl: {\n      type: String,\n      value: null\n    },\n    classes: {\n      type: String,\n      value: \"\"\n    },\n    icon: {\n      type: String,\n      value: \"\"\n    }\n  },\n\n  ready: function(e) {\n    this.createProjectsUrl =\n      this.endPoint + \"/api/projects/create-stub?token=\" + this.csrfToken;\n  },\n\n  _createProject: function() {\n    this.shadowRoot.querySelector(\"#ajaxCreateStub\").generateRequest();\n  },\n\n  _ajaxCreateStubHandler: function(e) {\n    var status = e.detail.response.status;\n    var response = e.detail.response;\n    if (status === 201) {\n      var project = e.detail.response.data;\n      if (project) {\n        this.fire(\"project-created\", { project: project });\n      }\n    }\n    // if we have errors to display\n    if (typeof response.errors !== \"undefined\") {\n      var ul = document.createElement(\"ul\");\n      var text = \"\";\n      response.errors.forEach(function(error) {\n        text = text + \" \" + error;\n      });\n      this.shadowRoot.querySelector(\"#toast\").show(text);\n    }\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/paper-toast/paper-toast.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\n/*\n`lrnapp-studio-assignment-button`\nAllows users to either start a assignment or link to a assignment.\n\nUsage:\n```\n<lrnapp-studio-assignment-button assignment-id=\"[[id]]\" assignment-id=\"{{assignmentId}}\" end-point=\"[[endPoint]]\" csrf-token=[[csrfToken]]></lrnapp-studio-assignment-button>\n*/\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n    </style>\n    <lrnsys-button\n      on-tap=\"_createAssignment\"\n      icon-class=\"[[iconClass]]\"\n      alt=\"[[alt]]\"\n      class\\$=\"[[classes]]\"\n      button-class\\$=\"[[classes]]\"\n      hover-class=\"[[hoverClass]]\"\n      icon=\"[[icon]]\"\n    ></lrnsys-button>\n    <iron-ajax\n      id=\"ajaxCreateStub\"\n      url=\"[[createAssignmentUrl]]\"\n      method=\"POST\"\n      body=\"[[projectId]]\"\n      handle-as=\"json\"\n      on-response=\"_ajaxCreateStubHandler\"\n    ></iron-ajax>\n    <template is=\"dom-if\" if=\"[[displayErrors]]\">\n      <paper-toast id=\"toast\"></paper-toast>\n    </template>\n  `,\n\n  is: \"lrnapp-studio-assignment-button\",\n\n  properties: {\n    auto: {\n      type: Boolean,\n      reflectToAttribute: true,\n      value: false,\n      notify: true\n    },\n    displayErrors: {\n      type: Boolean,\n      value: true\n    },\n    projectId: {\n      type: String\n    },\n    createAssignmentUrl: {\n      type: String,\n      value: null\n    },\n    iconClass: {\n      type: String,\n      value: null\n    },\n    alt: {\n      type: String,\n      value: null\n    },\n    classes: {\n      type: String,\n      value: null\n    },\n    hoverClass: {\n      type: String,\n      value: null\n    },\n    icon: {\n      type: String,\n      value: null\n    },\n    endPoint: String,\n    csrfToken: String\n  },\n  ready: function(e) {\n    // @todo need to load a assignment if one exists ahead of time\n    this.createAssignmentUrl =\n      this.endPoint + \"/api/assignments/create-stub?token=\" + this.csrfToken;\n  },\n  _createAssignment: function() {\n    this.shadowRoot.querySelector(\"#ajaxCreateStub\").generateRequest();\n  },\n  _ajaxCreateStubHandler: function(e) {\n    var status = e.detail.response.status;\n    var response = e.detail.response;\n    if (status === 201) {\n      var assignment = e.detail.response.data;\n      if (assignment) {\n        this.fire(\"assignment-created\", { assignment: assignment });\n      }\n    }\n    // if we have errors to display\n    if (typeof response.errors !== \"undefined\") {\n      var ul = document.createElement(\"ul\");\n      var text = \"\";\n      response.errors.forEach(function(error) {\n        text = text + \" \" + error;\n      });\n      this.shadowRoot.querySelector(\"#toast\").show(text);\n    }\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/app-route/app-location.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\nimport \"@polymer/paper-badge/paper-badge.js\";\nimport \"@polymer/paper-toggle-button/paper-toggle-button.js\";\nimport \"@polymer/app-layout/app-toolbar/app-toolbar.js\";\nimport \"@polymer/paper-card/paper-card.js\";\nimport \"@polymer/iron-list/iron-list.js\";\nimport \"@polymer/paper-toast/paper-toast.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@polymer/paper-dialog/paper-dialog.js\";\nimport \"@lrnwebcomponents/lrnsys-render-html/lrnsys-render-html.js\";\nimport \"@lrnwebcomponents/lrnsys-layout/lib/lrnsys-dialog.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nimport \"./lrnapp-studio-project-button.js\";\nimport \"./lrnapp-studio-assignment-button.js\";\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\">\n      :host {\n        display: block;\n      }\n\n      #loading {\n        width: 100%;\n        z-index: 1000;\n        opacity: 0.8;\n        text-align: center;\n        align-content: center;\n        justify-content: center;\n        height: 100vh;\n        position: absolute;\n        background-color: white;\n      }\n\n      .projects-container {\n        -webkit-box-pack: start;\n        -ms-flex-pack: start;\n        justify-content: flex-start;\n        -webkit-box-align: start;\n        -ms-flex-align: start;\n        align-items: flex-start;\n        min-height: 30em;\n        width: 150vw;\n        padding-top: 1em;\n      }\n\n      .projects-window {\n        width: 100vw;\n        overflow-x: scroll;\n        overflow-y: hidden;\n        scrollbar-face-color: #833900;\n        scrollbar-shadow-color: #ffc107;\n        scrollbar-highlight-color: #ffc107;\n        scrollbar-3dlight-color: #ffc107;\n        scrollbar-darkshadow-color: #ffc107;\n        scrollbar-track-color: #ffc107;\n        scrollbar-arrow-color: #ffc107;\n      }\n\n      .projects-window::-webkit-scrollbar-track {\n        background-color: #833900;\n      }\n      /* the new scrollbar will have a flat appearance with the set background color */\n\n      .projects-window::-webkit-scrollbar-thumb {\n        background-color: #ffc107;\n      }\n      /* this will style the thumb, ignoring the track */\n\n      .projects-window::-webkit-scrollbar-button {\n        background-color: #833900;\n      }\n      /* optionally, you can style the top and the bottom buttons (left and right for horizontal bars) */\n\n      .projects-window::-webkit-scrollbar-corner {\n        background-color: #833900;\n      }\n      /* if both the vertical and the horizontal bars appear, then perhaps the right bottom corner*/\n\n      .projects-window::-webkit-scrollbar {\n        width: 1rem;\n        height: 1rem;\n      }\n      /* this targets the default scrollbar (compulsory) */\n\n      paper-button {\n        padding: 0;\n        margin: 0;\n        min-width: 1rem;\n      }\n\n      .project-card {\n        width: 100%;\n        min-width: 20em;\n        max-width: 20em;\n        margin: 0;\n        height: 100%;\n        min-height: 10em;\n      }\n      .project-container {\n        padding: 1em;\n      }\n      .project-card .card-content {\n        height: 100%;\n        min-height: 8em;\n        max-height: 10em;\n        overflow: scroll;\n      }\n\n      .project-operations {\n        position: absolute;\n        top: 0;\n        right: 0;\n        padding: 1em;\n      }\n\n      .project-operations .operation {\n        display: inline-flex;\n        height: 2.5em;\n        width: 2.5em;\n      }\n      .project-operations .operation[hidden] {\n        display: none;\n      }\n\n      .assignment-row {\n        border: 1px solid #000000;\n        background-color: #ffffff;\n      }\n\n      .assignment-row .assignment-row-button.active {\n        background-color: var(--paper-amber-50);\n        font-weight: bold;\n      }\n\n      .assignment-row:hover .assignment-operations {\n        display: block;\n        overflow: visible;\n        margin: 0.2em;\n      }\n\n      .assignment-row-button {\n        width: 100%;\n        justify-content: flex-start;\n        height: 3em;\n        text-transform: none;\n      }\n\n      .status-indicator {\n        border-right: 1px solid grey;\n        padding: 0.5em;\n        margin: 0 0.5em 0 0;\n        display: inline-flex;\n        line-height: 2em;\n        height: 2em;\n        justify-content: center;\n        align-items: center;\n      }\n\n      .button-contents {\n        display: flex;\n        align-content: center;\n      }\n\n      .assignment-title {\n        display: inline-flex;\n        align-items: center;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        line-height: 1em;\n      }\n\n      .assignment-operations {\n        position: absolute;\n        top: 0;\n        right: 0;\n        padding: 0;\n        display: none;\n      }\n\n      .assignment-operations.show {\n        display: block;\n        overflow: visible;\n      }\n\n      .assignment-operations .operation {\n        display: inline-flex;\n        width: 2.5em;\n        height: 2.5em;\n      }\n      .assignment-operations .operation[hidden] {\n        display: none;\n      }\n\n      lrnapp-studio-project-button {\n        margin: 0em auto 1em;\n        max-width: 20em;\n      }\n    </style>\n    <iron-ajax\n      auto=\"\"\n      id=\"projectbackend\"\n      url=\"[[sourcePath]]\"\n      handle-as=\"json\"\n      last-response=\"{{projectResponse}}\"\n      on-response=\"_handleProjectResponse\"\n    >\n    </iron-ajax>\n    <iron-ajax\n      id=\"backend\"\n      url=\"[[sourcePath]]\"\n      params=\"\"\n      handle-as=\"json\"\n      last-response=\"{{backendResponse}}\"\n      on-response=\"_handleUpdateResponse\"\n    >\n    </iron-ajax>\n\n    <app-location\n      route=\"{{route}}\"\n      query-params=\"{{queryParams}}\"\n    ></app-location>\n    <app-route\n      route=\"{{route}}\"\n      pattern=\"[[endPoint]]/:page\"\n      data=\"{{data}}\"\n      tail=\"{{tail}}\"\n      query-params=\"{{queryParams}}\"\n    >\n    </app-route>\n    <div id=\"loading\">\n      <h3>Loading..</h3>\n      <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n    </div>\n    <lrnapp-studio-project-button\n      hidden\\$=\"[[!projectResponse.data.canCreateProjects]]\"\n      classes=\"amber darken-3 white-text\"\n      end-point=\"[[endPoint]]\"\n      csrf-token=\"[[csrfToken]]\"\n      icon=\"add\"\n    ></lrnapp-studio-project-button>\n    <div class=\"projects-window\">\n      <iron-list\n        items=\"[[_toArray(projectResponse.data.projects)]]\"\n        as=\"project\"\n        class=\"projects-container\"\n        grid=\"\"\n      >\n        <template class=\"projects-container-items\">\n          <div class=\"project-container\">\n            <paper-card\n              id\\$=\"project-[[project.id]]\"\n              class=\"project-card grey lighten-3\"\n              heading=\"{{project.attributes.title}}\"\n              elevation=\"2\"\n            >\n              <div class=\"project-operations\">\n                <lrnsys-button\n                  icon-class=\"no-margin\"\n                  id\\$=\"project-[[project.id]]-edit\"\n                  alt=\"Edit project\"\n                  class=\"circle operation\"\n                  hover-class=\"amber lighten-2\"\n                  hidden=\"[[!project.meta.canUpdate]]\"\n                  icon=\"create\"\n                  on-tap=\"_makeProjectEditLink\"\n                >\n                </lrnsys-button>\n                <lrnapp-studio-assignment-button\n                  project-id=\"[[project.id]]\"\n                  icon-class=\"no-margin\"\n                  id\\$=\"project-[[project.id]]-add\"\n                  alt=\"Add assignment\"\n                  class=\"circle operation\"\n                  hover-class=\"amber lighten-2\"\n                  hidden=\"[[!project.meta.canUpdate]]\"\n                  icon=\"add\"\n                  end-point=\"[[endPoint]]\"\n                  csrf-token=\"[[csrfToken]]\"\n                >\n                </lrnapp-studio-assignment-button>\n                <lrnsys-button\n                  id\\$=\"project-[[project.id]]-delete\"\n                  alt=\"Delete project!\"\n                  class=\"circle operation\"\n                  hover-class=\"red darken-2 white-text\"\n                  header=\"Delete project!\"\n                  hidden=\"[[!project.meta.canDelete]]\"\n                  icon=\"delete-forever\"\n                  on-tap=\"_deleteProjectDialog\"\n                  icon-class=\"no-margin\"\n                >\n                </lrnsys-button>\n              </div>\n              <div class=\"card-content\">\n                <iron-list\n                  items=\"[[_toArray(project.relationships.assignments)]]\"\n                  as=\"assignment\"\n                >\n                  <template>\n                    <div class=\"assignment-row\" id=\"assignment\">\n                      <lrnsys-dialog\n                        body-append=\"\"\n                        on-focusin=\"assignmentFocusIn\"\n                        class=\"assignment-row-button\"\n                        id\\$=\"assignment-[[project.id]]-[[assignment.id]]\"\n                        header=\"[[assignment.attributes.title]]\"\n                        hover-class=\"amber lighten-5\"\n                      >\n                        <span slot=\"button\" class=\"button-contents\">\n                          <div\n                            class\\$=\"status-indicator [[assignment.meta.relatedSubmissions.complete.color]]\"\n                          >\n                            <iron-icon\n                              icon=\"[[assignment.meta.relatedSubmissions.complete.icon]]\"\n                              disabled\\$=\"[[!assignment.meta.relatedSubmissions.canCreate]]\"\n                            ></iron-icon>\n                          </div>\n                          <div class=\"assignment-title\">\n                            [[assignment.attributes.title]]\n                          </div>\n                        </span>\n                        <div slot=\"content\">\n                          <app-toolbar\n                            class\\$=\"[[assignment.meta.relatedSubmissions.complete.color]]\"\n                          >\n                            <div>\n                              <iron-icon\n                                icon=\"[[assignment.meta.relatedSubmissions.complete.icon]]\"\n                                disabled\\$=\"[[!assignment.meta.relatedSubmissions.canCreate]]\"\n                              ></iron-icon>\n                              [[assignment.meta.relatedSubmissions.complete.submission.title]]\n                            </div>\n                            <div\n                              spacer=\"\"\n                              class=\"comment-box\"\n                              hidden\\$=\"[[!assignment.meta.relatedSubmissions.complete.submission.id]]\"\n                            >\n                              <paper-button\n                                id\\$=\"assignment-[[project.id]]-[[assignment.id]]-comments\"\n                                style=\"margin:0;padding:.25em;text-transform:none;\"\n                              >\n                                <iron-icon\n                                  icon=\"communication:forum\"\n                                ></iron-icon>\n                                [[assignment.meta.relatedSubmissions.complete.submission.meta.comments.count]]\n                                Comments\n                              </paper-button>\n                              <paper-badge\n                                hidden\\$=\"[[displayNewBadge(assignment.meta.relatedSubmissions.complete.submission.meta.new)]]\"\n                                for\\$=\"assignment-[[project.id]]-[[assignment.id]]-comments\"\n                                label\\$=\"[[assignment.meta.relatedSubmissions.complete.submission.meta.comments.new]]\"\n                              ></paper-badge>\n                            </div>\n\n                            <lrnapp-studio-submission-button\n                              spacer=\"\"\n                              auto=\"\"\n                              assignment-id=\"[[assignment.id]]\"\n                              submission=\"{{submission}}\"\n                              end-point=\"[[buildSubmissionPath(basePath)]]\"\n                              csrf-token=\"[[csrfToken]]\"\n                              submission-id=\"[[assignment.meta.relatedSubmissions.complete.submission.id]]\"\n                            ></lrnapp-studio-submission-button>\n                            <div main-title=\"\"></div>\n                            <paper-toggle-button\n                              id\\$=\"assignment-[[project.id]]-[[assignment.id]]-toggle\"\n                              on-tap=\"statusToggle\"\n                            ></paper-toggle-button>\n                            <span\n                              id\\$=\"assignment-[[project.id]]-[[assignment.id]]-toggle-text\"\n                            ></span>\n                            <div bottom-item=\"\" class=\"status-rationale\">\n                              [[assignment.meta.relatedSubmissions.complete.rationale.text]]\n                            </div>\n                          </app-toolbar>\n                          <lrnsys-render-html\n                            style=\"padding:2em;\"\n                            html=\"[[assignment.attributes.body]]\"\n                          ></lrnsys-render-html>\n                        </div>\n                      </lrnsys-dialog>\n                      <span class=\"assignment-operations\">\n                        <lrnsys-button\n                          id\\$=\"assignment-[[project.id]]-[[assignment.id]]-add-critique\"\n                          icon=\"editor:insert-comment\"\n                          alt=\"Add critique\"\n                          class=\"circle operation\"\n                          hover-class=\"green lighten-2\"\n                          hidden=\"[[!assignment.meta.canCritique]]\"\n                          href\\$=\"[[assignment.meta.critiqueLink]]\"\n                          icon-class=\"no-margin\"\n                        ></lrnsys-button>\n                        <lrnsys-button\n                          id\\$=\"assignment-[[project.id]]-[[assignment.id]]-edit\"\n                          icon=\"editor:mode-edit\"\n                          alt=\"Edit\"\n                          class=\"circle operation\"\n                          hover-class=\"amber lighten-4\"\n                          hidden=\"[[!assignment.meta.canUpdate]]\"\n                          on-tap=\"_makeAssignmentEditLink\"\n                          icon-class=\"no-margin green-text text-darken-4\"\n                        ></lrnsys-button>\n                        <lrnsys-button\n                          id\\$=\"assignment-[[project.id]]-[[assignment.id]]-delete\"\n                          icon=\"delete\"\n                          alt=\"Delete\"\n                          class=\"circle operation\"\n                          hover-class=\"amber lighten-4\"\n                          hidden=\"[[!assignment.meta.canDelete]]\"\n                          on-tap=\"_deleteAssignmentDialog\"\n                          icon-class=\"no-margin red-text text-darken-4\"\n                        ></lrnsys-button>\n                      </span>\n                    </div>\n                  </template>\n                </iron-list>\n              </div>\n            </paper-card>\n          </div>\n        </template>\n      </iron-list>\n    </div>\n    <paper-toast text=\"Updated\" id=\"toast\"></paper-toast>\n    <paper-dialog id=\"delete\" modal=\"\">\n      <h3>[[_deleteTitle]]</h3>\n      <p>[[_deleteText]]</p>\n      <div class=\"buttons\">\n        <paper-button dialog-dismiss=\"\">Decline</paper-button>\n        <paper-button\n          id=\"deleteaccept\"\n          on-tap=\"_handleDelete\"\n          dialog-confirm=\"\"\n          autofocus=\"\"\n          >Accept</paper-button\n        >\n      </div>\n    </paper-dialog>\n  `,\n\n  is: \"lrnapp-studio-kanban\",\n\n  properties: {\n    /**\n     * Tracks the active assignment.\n     */\n    activeAssignment: {\n      type: String,\n      value: null,\n      notify: true\n    },\n    projectToDelete: {\n      type: String,\n      value: null,\n      notify: true\n    },\n    assignmentToDelete: {\n      type: String,\n      value: null,\n      notify: true\n    },\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    /**\n     * Submission for two-way data binding on return from the button being pushed\n     */\n    submission: {\n      type: Object,\n      notify: true\n    },\n    /**\n     * Response from the server.\n     */\n    projectResponse: {\n      type: Object,\n      notify: true\n    },\n    /**\n     * Response from the server for non-project requests.\n     */\n    backendResponse: {\n      type: Object,\n      notify: true\n    }\n  },\n\n  listeners: {\n    \"project-created\": \"_handleProjectCreated\",\n    \"assignment-created\": \"_handleAssignmentCreated\"\n  },\n\n  observers: [\n    \"_routeChanged(route, endPoint)\",\n    \"_deleteToast(queryParams.deletetoast)\"\n  ],\n\n  // If the current route is outside the scope of our app\n  // then allow the website to break out of the single page\n  // application routing\n  _routeChanged: function(route, endPoint) {\n    if (typeof route.path === \"string\") {\n      if (typeof endPoint === \"string\") {\n        if (route.path.startsWith(endPoint)) {\n          return;\n        }\n      }\n      window.location = route.path;\n    }\n  },\n\n  /**\n   * Support having a toast message because of delete or error elsewhere.\n   */\n  _deleteToast: function(deletetoast, old) {\n    if (typeof deletetoast !== typeof undefined) {\n      if (deletetoast == \"error\") {\n        this.$.toast.show(\"That submission on longer exists!\");\n      } else {\n        this.$.toast.show(\"Submission deleted successfully!\");\n      }\n      this.set(\"queryParams.deletetoast\", undefined);\n      this.notifyPath(\"queryParams.deletetoast\");\n    }\n  },\n\n  /**\n   * @todo  remove this once we have a modal for it\n   */\n  _makeProjectEditLink: function(e) {\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    var parts = local.id.split(\"-\");\n    window.location.href =\n      this.basePath +\n      \"../node/\" +\n      parts[1] +\n      \"/edit?destination=apps/lrnapp-studio-kanban\";\n  },\n\n  /**\n   * @todo  remove this once we have a modal for it\n   */\n  _makeAssignmentEditLink: function(e) {\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    var parts = local.id.split(\"-\");\n    window.location.href =\n      this.basePath +\n      \"../node/\" +\n      parts[2] +\n      \"/edit?destination=apps/lrnapp-studio-kanban\";\n  },\n\n  /**\n   * Handle the push to delete a project, pop up the modal.\n   */\n  _deleteProjectDialog: function(e) {\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    var parts = local.id.split(\"-\");\n    // set values so we know what to drop\n    this.projectToDelete = parts[1];\n    this._deleteTitle = \"Delete project\";\n    this._deleteText =\n      \"Are you sure you want to delete this project and all related assignments!?\";\n    this._deleteType = \"project\";\n    this.$.delete.open();\n  },\n\n  /**\n   * Handle the call to delete the assignment specified.\n   */\n  _handleDelete: function() {\n    if (this._deleteType == \"project\") {\n      this.$.backend.method = \"DELETE\";\n      this.$.backend.body = this.projectToDelete;\n      this.$.backend.url =\n        this.endPoint +\n        \"/api/projects/\" +\n        this.projectToDelete +\n        \"?token=\" +\n        this.csrfToken;\n      this.$.backend.generateRequest();\n    } else if (this._deleteType == \"assignment\") {\n      this.$.backend.method = \"DELETE\";\n      this.$.backend.body = this.assignmentToDelete;\n      this.$.backend.url =\n        this.endPoint +\n        \"/api/assignments/\" +\n        this.assignmentToDelete +\n        \"?token=\" +\n        this.csrfToken;\n      this.$.backend.generateRequest();\n    }\n  },\n\n  /**\n   * Handle the push to delete an assignment, pop up the modal.\n   */\n  _deleteAssignmentDialog: function(e) {\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    var parts = local.id.split(\"-\");\n    this.assignmentToDelete = parts[2];\n    // set values so we know what to drop\n    this._deleteTitle = \"Delete assignment\";\n    this._deleteText = \"Are you sure you want to delete this assignment?\";\n    this._deleteType = \"assignment\";\n    this.$.delete.open();\n  },\n\n  /**\n   * if we should show new badge based on new comment count.\n   */\n  displayNewBadge: function(count) {\n    if (count == 0) {\n      return true;\n    }\n    return false;\n  },\n\n  /**\n   * Handle toggling the status for the submission.\n   */\n  statusToggle: function(e) {\n    // find our xhr for callbacks\n    var xhr = this.$.backend;\n    // break the id out into project and assignment\n    var parts = this.activeAssignment.split(\"-\");\n    // focus in on the submissions / assignment meta\n    var submission = this.projectResponse.data.projects[\"project-\" + parts[1]]\n      .relationships.assignments[\"assignment-\" + parts[2]].meta\n      .relatedSubmissions.complete;\n    // ensure this isn't disabled though it shouldn't be possible\n    if (\n      !this.shadowRoot.querySelector(\"#\" + this.activeAssignment + \"-toggle\")\n        .disabled\n    ) {\n      // hide the loading screen\n      this.$.loading.hidden = false;\n      // queue of the request parameters\n      xhr.params = {\n        submissionid: submission.submission.id,\n        status: this.shadowRoot.querySelector(\n          \"#\" + this.activeAssignment + \"-toggle\"\n        ).checked\n      };\n      // send the request\n      xhr.generateRequest();\n    }\n  },\n\n  /**\n   * Handle toggle for mouse class and manage classList array for paper-button.\n   */\n  assignmentFocusIn: function(e) {\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    if (this.activeAssignment != null && this.activeAssignment != local.id) {\n      this.shadowRoot\n        .querySelector(\"#\" + this.activeAssignment)\n        .nextElementSibling.classList.remove(\"show\");\n      this.shadowRoot\n        .querySelector(\"#\" + this.activeAssignment)\n        .classList.remove(\"active\");\n    }\n    this.activeAssignment = local.id;\n    this._setToggle(false);\n    local.nextElementSibling.classList.add(\"show\");\n    local.classList.add(\"active\");\n  },\n\n  /**\n   * Handle response for the whole projects object.\n   */\n  _handleProjectResponse: function(event) {\n    this.$.loading.hidden = true;\n    this._setToggle(true);\n  },\n\n  /**\n   * buildSubmissionPath for generating a new submission or linking to existing.\n   */\n  buildSubmissionPath: function(path) {\n    return path + \"lrnapp-studio-submission\";\n  },\n\n  /**\n   * Handle a response from updating an item\n   */\n  _handleUpdateResponse: function(event) {\n    if (this.backendResponse.status == 200) {\n      this.$.toast.text = \"Updated successfully\";\n      this.$.toast.toggle();\n      this.$.projectbackend.generateRequest();\n    } else {\n      // this would imply an error\n      this.$.loading.hidden = true;\n    }\n  },\n\n  /**\n   * set the toggle state when assignment gets focus\n   */\n  _setToggle: function(update) {\n    if (this.activeAssignment != null) {\n      var parts = this.activeAssignment.split(\"-\");\n      // focus in on the submissions / assignment meta\n      var submission = this.projectResponse.data.projects[\"project-\" + parts[1]]\n        .relationships.assignments[\"assignment-\" + parts[2]].meta\n        .relatedSubmissions.complete;\n      // not finished but also not started\n      if (submission.status == 0 && submission.submission.length == 0) {\n        if (!update) {\n          this.shadowRoot.querySelector(\n            \"#\" + this.activeAssignment + \"-toggle\"\n          ).disabled = true;\n          this.shadowRoot.querySelector(\n            \"#\" + this.activeAssignment + \"-toggle\"\n          ).checked = false;\n        }\n        this.shadowRoot.querySelector(\n          \"#\" + this.activeAssignment + \"-toggle\"\n        ).title = \"Submission not started\";\n        this.shadowRoot.querySelector(\n          \"#\" + this.activeAssignment + \"-toggle-text\"\n        ).textContent = \"Submission not started\";\n      } else if (submission.status == 0) {\n        if (!update) {\n          this.shadowRoot.querySelector(\n            \"#\" + this.activeAssignment + \"-toggle\"\n          ).disabled = false;\n          this.shadowRoot.querySelector(\n            \"#\" + this.activeAssignment + \"-toggle\"\n          ).checked = false;\n        }\n        this.shadowRoot.querySelector(\n          \"#\" + this.activeAssignment + \"-toggle\"\n        ).title = \"Submission started\";\n        this.shadowRoot.querySelector(\n          \"#\" + this.activeAssignment + \"-toggle-text\"\n        ).textContent = \"Submission in progress\";\n      } else {\n        if (!update) {\n          this.shadowRoot.querySelector(\n            \"#\" + this.activeAssignment + \"-toggle\"\n          ).disabled = false;\n          this.shadowRoot.querySelector(\n            \"#\" + this.activeAssignment + \"-toggle\"\n          ).checked = true;\n        }\n        this.shadowRoot.querySelector(\n          \"#\" + this.activeAssignment + \"-toggle\"\n        ).title = \"Submission ready\";\n        this.shadowRoot.querySelector(\n          \"#\" + this.activeAssignment + \"-toggle-text\"\n        ).textContent = \"Submission ready\";\n      }\n    }\n  },\n\n  /**\n   * Event came from the project button to indicate it was successful.\n   */\n  _handleProjectCreated: function(e) {\n    this.$.toast.text = \"Project added\";\n    this.$.toast.toggle();\n    this.$.projectbackend.generateRequest();\n  },\n\n  /**\n   * Event came from the assignment button to indicate it was successful.\n   */\n  _handleAssignmentCreated: function(e) {\n    this.$.toast.text = \"Assignment added\";\n    this.$.toast.toggle();\n    this.$.projectbackend.generateRequest();\n  },\n\n  /*\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/app-route/app-location.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\nimport \"@polymer/iron-list/iron-list.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/paper-card/paper-card.js\";\nimport \"@polymer/iron-selector/iron-selector.js\";\nimport \"@polymer/iron-pages/iron-pages.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/elmsln-apps/lib/lrnapp-studio-dashboard/lrnapp-studio-dashboard.js\";\nimport \"@lrnwebcomponents/elmsln-apps/lib/lrnapp-studio-kanban/lrnapp-studio-kanban.js\";\nimport \"@lrnwebcomponents/elmsln-apps/lib/lrnapp-open-studio/lrnapp-open-studio.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n    </style>\n\n    <app-location\n      route=\"{{route}}\"\n      query-params=\"{{queryParams}}\"\n    ></app-location>\n    <app-route\n      route=\"{{route}}\"\n      pattern=\"[[basePath]]/:page\"\n      data=\"{{data}}\"\n      tail=\"{{tail}}\"\n      query-params=\"{{queryParams}}\"\n    >\n    </app-route>\n\n    <iron-selector\n      selected=\"{{data.page}}\"\n      attr-for-selected=\"name\"\n      role=\"navigation\"\n    >\n      <a tabindex=\"-1\" name=\"lrnapp-studio-dashboard\" on-tap=\"_dashboardClicked\"\n        >A</a\n      >\n      <a tabindex=\"-1\" name=\"lrnapp-studio-kanban\" on-tap=\"_kanbanClicked\">B</a>\n      <a tabindex=\"-1\" name=\"lrnapp-open-studio\" on-tap=\"_openstudioClicked\"\n        >C</a\n      >\n    </iron-selector>\n\n    <iron-pages\n      selected=\"{{data.page}}\"\n      attr-for-selected=\"name\"\n      fallback-selection=\"lrnapp-studio-dashboard\"\n      role=\"main\"\n    >\n      <lrnapp-studio-dashboard\n        name=\"lrnapp-studio-dashboard\"\n        csrf-token=\"[[csrfToken]]\"\n        end-point=\"[[_endPoint('lrnapp-studio-dashboard')]]\"\n        base-path=\"[[basePath]]\"\n        elmsln-course=\"[[elmslnCourse]]\"\n        elmsln-section=\"[[elmslnSection]]\"\n        route=\"[[tail]]\"\n      >\n      </lrnapp-studio-dashboard>\n      <lrnapp-studio-kanban\n        name=\"lrnapp-studio-kanban\"\n        csrf-token=\"[[csrfToken]]\"\n        end-point=\"[[_endPoint('lrnapp-studio-dashboard')]]\"\n        base-path=\"[[basePath]]\"\n        source-path=\"[[_sourcePath('lrnapp-studio-kanban/kanban-data')]]\"\n        elmsln-course=\"[[elmslnCourse]]\"\n        elmsln-section=\"[[elmslnSection]]\"\n        route=\"[[tail]]\"\n      ></lrnapp-studio-kanban>\n      <lrnapp-open-studio\n        name=\"lrnapp-open-studio\"\n        csrf-token=\"[[csrfToken]]\"\n        end-point=\"[[_endPoint('lrnapp-open-studio')]]\"\n        base-path=\"[[basePath]]\"\n        source-path=\"[[_sourcePath('lrnapp-open-studio/data')]]\"\n        elmsln-course=\"[[elmslnCourse]]\"\n        elmsln-section=\"[[elmslnSection]]\"\n        route=\"[[tail]]\"\n      >\n      </lrnapp-open-studio>\n    </iron-pages>\n  `,\n  is: \"lrnapp-studio-root\",\n  properties: {\n    /**\n     * sourcePath for submission data.\n     */\n    sourcePath: {\n      type: String,\n      notify: true,\n      reflectToAttribute: true\n    },\n    elmslnSection: {\n      type: String,\n      notify: true,\n      reflectToAttribute: true\n    },\n    elmslnCourse: {\n      type: String,\n      notify: true,\n      reflectToAttribute: true\n    },\n    csrfToken: {\n      type: String,\n      notify: true,\n      reflectToAttribute: true\n    },\n    /**\n     * base path for the app\n     */\n    basePath: {\n      type: String,\n      notify: true\n    },\n    _endPoint: function(path) {\n      return this.basePath + path;\n    },\n    _sourcePath: function(path) {\n      return this.basePath + path + \"?token=\" + this.csrfToken;\n    },\n    listeners: {\n      \"route-change\": \"_routeChange\"\n    },\n    observers: [\n      \"_routeChanged(route, basePath)\",\n      \"_deleteToast(queryParams.deletetoast)\"\n    ],\n    // If the current route is outside the scope of our app\n    // then allow the website to break out of the single page\n    // application routing\n    _routeChanged: function(route, basePath) {\n      if (typeof route.path === \"string\") {\n        if (typeof basePath === \"string\") {\n          if (route.path.startsWith(basePath)) {\n            return;\n          }\n        }\n        // reload the page which since route changed will load that page\n        window.location.reload();\n      }\n    },\n    /**\n     * Change route from deeper in the app.\n     */\n    _routeChange: function(e) {\n      var details = e.detail;\n      if (typeof details.queryParams.assignment !== typeof undefined) {\n        this.set(\"queryParams.assignment\", details.queryParams.assignment);\n        this.notifyPath(\"queryParams.assignment\");\n      }\n      if (typeof details.queryParams.project !== typeof undefined) {\n        this.set(\"queryParams.project\", details.queryParams.project);\n        this.notifyPath(\"queryParams.project\");\n      }\n      if (typeof details.queryParams.author !== typeof undefined) {\n        this.set(\"queryParams.author\", details.queryParams.author);\n        this.notifyPath(\"queryParams.author\");\n      }\n      if (typeof details.data.page !== typeof undefined) {\n        this.set(\"data.page\", details.data.page);\n        this.notifyPath(\"data.path\");\n      }\n    },\n    /**\n     * Support having a toast message because of delete or error elsewhere.\n     */\n    _deleteToast: function(deletetoast, old) {\n      if (typeof deletetoast !== typeof undefined) {\n        if (deletetoast == \"error\") {\n          this.$.toast.show(\"That submission on longer exists!\");\n        } else {\n          this.$.toast.show(\"Submission deleted successfully!\");\n        }\n        this.set(\"queryParams.deletetoast\", undefined);\n        this.notifyPath(\"queryParams.deletetoast\");\n      }\n    },\n    _dashboardClicked: function(e) {\n      this.set(\"route.path\", this.basePath + \"/lrnapp-studio-dashboard\");\n      this.notifyPath(\"route.path\");\n    },\n    _kanbanClicked: function(e) {\n      this.set(\"route.path\", this.basePath + \"/lrnapp-studio-kanban\");\n      this.notifyPath(\"route.path\");\n    },\n    _openstudioClicked: function(e) {\n      this.set(\"route.path\", this.basePath + \"/lrnapp-open-studio\");\n      this.notifyPath(\"route.path\");\n    },\n    /**\n     * Simple way to convert from object to array.\n     */\n    _toArray: function(obj) {\n      return Object.keys(obj).map(function(key) {\n        return obj[key];\n      });\n    }\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-card/paper-card.js\";\nimport \"@polymer/marked-element/marked-element.js\";\nimport \"@polymer/iron-image/iron-image.js\";\nimport \"@lrnwebcomponents/image-inspector/image-inspector.js\";\nimport \"@lrnwebcomponents/lrndesign-avatar/lrndesign-avatar.js\";\nimport \"@lrnwebcomponents/word-count/word-count.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"@lrnwebcomponents/lrndesign-contentblock/lrndesign-contentblock.js\";\nimport \"@lrnwebcomponents/lrnsys-layout/lib/lrnsys-dialog.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n      p {\n        font-size: 14px;\n        line-height: 18px;\n      }\n      h1,\n      h2,\n      h3 {\n        margin: 0;\n        text-align: left;\n      }\n      iron-selector {\n        line-height: 1em;\n      }\n      iron-selector lrnsys-button {\n        display: inline-flex;\n      }\n      marked-element {\n        display: block;\n        margin: 0 5em 0 5em;\n      }\n      iron-image {\n        margin: 0 0.5em;\n      }\n      lrnsys-dialog {\n        display: inline;\n      }\n      .contain {\n        width: 10em;\n        height: 10em;\n        background: #ddd;\n      }\n      .center {\n        margin: auto;\n        width: 100%;\n      }\n      .title {\n        color: #222;\n        font-size: 2rem;\n        font-weight: 600;\n        line-height: 2.5rem;\n        padding: 0.25rem 0;\n        white-space: nowrap;\n        overflow-x: hidden;\n        text-overflow: ellipsis;\n        margin-top: 1rem;\n        text-align: center;\n      }\n      .author {\n        color: #555;\n        font-size: 1rem;\n        font-weight: 500;\n        font-style: normal;\n        line-height: 1rem;\n        padding: 0.25rem 0 0.5rem 0;\n        margin: 0;\n        text-transform: capitalize;\n      }\n      .date {\n        color: #555;\n        font-size: 16px;\n        font-style: normal;\n        padding: 0.25rem 0 0.5rem 0;\n        margin: 0;\n      }\n      .flex-wrap {\n        display: flex;\n      }\n      .submission-page-card {\n        width: 100%;\n        margin: 0;\n      }\n      :host([edit-page]) .submission-page {\n        width: 100%;\n      }\n      .image-dialog-header {\n        display: flex;\n      }\n      app-toolbar {\n        width: 36em;\n        background: #ddd;\n      }\n      lrnsys-button {\n        padding: 0.75em;\n      }\n      .top {\n        top: 8em;\n      }\n    </style>\n    <div class=\"submission-page\">\n      <paper-card class=\"submission-page-card ferpa-protect\">\n        <div class=\"card-content\">\n          <lrndesign-avatar\n            class=\"center\"\n            label=\"{{submission.relationships.author.data.name}}\"\n            src=\"{{submission.relationships.author.data.avatar}}\"\n          ></lrndesign-avatar>\n          <div class=\"author center\">\n            {{submission.relationships.author.data.display_name}}\n          </div>\n          <h2 class=\"title center\">{{submission.attributes.title}}</h2>\n          <div class=\"date center\">\n            Created: [[date(submission.meta.created)]]\n          </div>\n          <div class=\"date center\">\n            Last updated: [[date(submission.meta.changed)]]\n          </div>\n          <!-- ----- Text Submission ----- -->\n          <template is=\"dom-if\" if=\"[[submission.attributes.body]]\">\n            <word-count\n              ><marked-element\n                markdown=\"[[submission.attributes.body]]\"\n              ></marked-element\n            ></word-count>\n          </template>\n          <!-- ----- Images Submission ----- -->\n          <template is=\"dom-if\" if=\"[[submission.attributes.images]]\">\n            <lrndesign-contentblock class=\"center\">\n              <template\n                is=\"dom-repeat\"\n                items=\"[[_toArray(submission.attributes.images)]]\"\n                as=\"image\"\n              >\n                <lrnsys-dialog alt=\"View Image\" dynamic-images=\"\">\n                  <div class=\"image-dialog-header\"></div>\n                  <span slot=\"button\">\n                    <iron-image\n                      style=\"width:200px; height:200px; background-color: lightgray;\"\n                      sizing=\"contain\"\n                      class=\"contain\"\n                      src=\"[[image.thumbnail]]\"\n                      preload=\"\"\n                      fade=\"\"\n                    ></iron-image>\n                  </span>\n                  <div style=\"text-align: center;\">\n                    <template is=\"dom-if\" if=\"[[!_isGif(image.url)]]\">\n                      <image-inspector src=\"[[image.url]]\">\n                        <span slot=\"toolbar\">\n                          <lrnsys-button\n                            alt=\"Download all images\"\n                            icon=\"icons:file-download\"\n                            href=\"[[submission.attributes.download_files]]\"\n                            target=\"_blank\"\n                          ></lrnsys-button>\n                        </span>\n                      </image-inspector>\n                    </template>\n                    <template is=\"dom-if\" if=\"[[_isGif(image.url)]]\">\n                      <iron-image\n                        style=\"width:500px; height:500px; background-color: lightgray;\"\n                        sizing=\"contain\"\n                        class=\"contain\"\n                        src=\"[[image.url]]\"\n                        preload=\"\"\n                        fade=\"\"\n                      ></iron-image>\n                    </template>\n                  </div>\n                </lrnsys-dialog>\n              </template>\n            </lrndesign-contentblock>\n          </template>\n          <!-- ----- Video Submission ----- -->\n          <template is=\"dom-if\" if=\"[[submission.attributes.video]]\">\n            <lrndesign-contentblock class=\"center\">\n              <template\n                is=\"dom-repeat\"\n                items=\"[[_toArray(submission.attributes.video)]]\"\n                as=\"video\"\n              >\n                <iframe\n                  width=\"460\"\n                  height=\"249\"\n                  src=\"[[video.video_src]]\"\n                ></iframe>\n              </template>\n            </lrndesign-contentblock>\n          </template>\n          <!-- ----- Links Submission ----- -->\n          <template is=\"dom-if\" if=\"[[submission.attributes.links]]\">\n            <lrndesign-contentblock>\n              <template\n                is=\"dom-repeat\"\n                items=\"[[_toArray(submission.attributes.links)]]\"\n                as=\"link\"\n              >\n                <p>\n                  <strong>[[link.title]]:</strong>\n                  <a class=\"link\" href=\"[[link.url]]\" target=\"_blank\"\n                    >[[link.url]]</a\n                  >\n                </p>\n              </template>\n            </lrndesign-contentblock>\n          </template>\n          <!-- ----- Files Submission ----- -->\n          <template is=\"dom-if\" if=\"[[submission.attributes.files]]\">\n            <lrndesign-contentblock title=\"Files Submitted\">\n              <template\n                is=\"dom-repeat\"\n                items=\"[[_toArray(submission.attributes.files)]]\"\n                as=\"file\"\n              >\n                <p>\n                  <strong>[[file.filename]]:</strong>\n                  <a class=\"link\" href=\"[[file.url]]\" target=\"_blank\"\n                    >[[file.url]]</a\n                  >\n                </p>\n              </template>\n            </lrndesign-contentblock>\n          </template>\n        </div>\n      </paper-card>\n    </div>\n  `,\n  is: \"lrnapp-studio-submission-display\",\n  properties: {\n    /**\n     * Object that has all the details of a submission that\n     * is being viewed.\n     */\n    submission: {\n      type: Object,\n      notify: true\n    }\n  },\n  date: function(time) {\n    if (time) {\n      var parts = time.split(\"-\");\n      let times = time.split(\"T\");\n      let month = parts[2].split(\"T\");\n      times = times[1].split(\"-\");\n      return parts[1] + \"/\" + month[0] + \" - \" + times[0];\n    }\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    if (typeof obj === \"object\" && obj !== null) {\n      return Object.keys(obj).map(function(key) {\n        return obj[key];\n      });\n    }\n    return [];\n  },\n  /**\n   * See if this is a GIF, if it is then report back so we\n   * know which player to display.\n   */\n  _isGif: function(url) {\n    if (url.indexOf(\".gif\") != -1) {\n      return true;\n    }\n    return false;\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-icon-button/paper-icon-button.js\";\nimport \"@polymer/paper-ripple/paper-ripple.js\";\nimport \"@polymer/paper-dialog/paper-dialog.js\";\nimport \"@polymer/paper-dialog-scrollable/paper-dialog-scrollable.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: flex;\n        align-items: stretch;\n        justify-content: stretch;\n      }\n\n      .wrapper {\n        position: relative;\n        z-index: 1;\n        overflow: hidden;\n        display: flex;\n        align-items: center;\n      }\n\n      .actions {\n        overflow: hidden;\n        position: absolute;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        top: 0;\n        left: 0;\n        z-index: 5;\n        color: white;\n        background: rgba(0, 0, 0, 0.7);\n        height: 100%;\n        width: 100%;\n        transition: all 0.2s ease-in-out;\n        transform: translateY(-100%);\n      }\n\n      .wrapper:hover .actions {\n        transform: translateY(0);\n      }\n\n      paper-dialog {\n        width: 50%;\n        width: 50vmax;\n        padding: 1em;\n      }\n    </style>\n\n    <div class=\"wrapper\">\n      <slot></slot>\n      <div class=\"actions\">\n        <template is=\"dom-if\" if=\"[[embedcode]]\">\n          <paper-icon-button\n            icon=\"code\"\n            class=\"embed\"\n            on-click=\"_embedClicked\"\n          ></paper-icon-button>\n        </template>\n        <paper-icon-button\n          icon=\"delete\"\n          class=\"delete\"\n          on-click=\"_deleteClicked\"\n        ></paper-icon-button>\n        <paper-ripple></paper-ripple>\n      </div>\n    </div>\n\n    <template is=\"dom-if\" if=\"[[embedcode]]\">\n      <paper-dialog\n        id=\"dialog\"\n        entry-animation=\"scale-up-animation\"\n        exit-animation=\"fade-out-animation\"\n        with-backdrop=\"\"\n      >\n        <h2>Embed Code</h2>\n        <p>Paste this into the text area and your image will appear.</p>\n        <paper-dialog-scrollable>\n          <pre>{{embedcode}}</pre>\n        </paper-dialog-scrollable>\n      </paper-dialog>\n    </template>\n  `,\n\n  is: \"lrnapp-studio-submission-media-editoverlay\",\n\n  properties: {\n    embedcode: {\n      type: String\n    }\n  },\n\n  _embedClicked: function(e) {\n    // @todo switch to singleton\n    this.shadowRoot.querySelector(\"#dialog\").open();\n  },\n\n  _deleteClicked: function(e) {\n    this.fire(\"delete\");\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\nimport \"@polymer/paper-ripple/paper-ripple.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        cursor: pointer;\n      }\n      :host([display=\"box\"]) {\n        display: block;\n        width: 200px;\n        height: 200px;\n        background: lightgray;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        position: relative;\n      }\n      :host([display=\"pill\"]) {\n        display: block;\n        background: lightgray;\n        display: inline-flex;\n        align-items: center;\n        justify-content: center;\n        position: relative;\n      }\n      iron-icon {\n        color: gray;\n        --iron-icon-height: 50px;\n        --iron-icon-width: 50px;\n      }\n      :host([display=\"pill\"]) iron-icon {\n        --iron-icon-height: 50px;\n        --iron-icon-width: 50px;\n      }\n    </style>\n    <paper-button>\n      <iron-icon icon=\"[[icon]]\"></iron-icon>\n      <paper-ripple></paper-ripple>\n    </paper-button>\n  `,\n\n  is: \"lrnapp-studio-submission-edit-add-asset\",\n\n  properties: {\n    icon: {\n      type: String,\n      value: \"add\"\n    },\n    /**\n     * Change the display of the add asset element\n     *\n     * @type String Options: 'box', 'pill'\n     */\n    display: {\n      type: String,\n      value: \"box\",\n      reflectToAttribute: true\n    }\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-image/iron-image.js\";\nimport \"./lrnapp-studio-submission-media-editoverlay.js\";\nPolymer({\n  _template: html`\n    <custom-style>\n      <style is=\"custom-style\">\n        :host {\n          display: inline-flex;\n          justify-content: space-around;\n          min-height: 100px;\n          position: relative;\n        }\n\n        iron-image {\n          --iron-image-height: 200px;\n          display: block;\n        }\n      </style>\n    </custom-style>\n    <lrnapp-studio-submission-media-editoverlay\n      on-delete=\"_delete\"\n      data-index\\$=\"[[index]]\"\n      embedcode=\"{{embedcode}}\"\n    >\n      <iron-image\n        src=\"[[thumbnail]]\"\n        style=\"width:200px; height:200px; background-color: lightgray;\"\n        sizing=\"contain\"\n        class=\"contain\"\n        preload=\"\"\n        fade=\"\"\n      ></iron-image>\n    </lrnapp-studio-submission-media-editoverlay>\n  `,\n\n  is: \"lrnapp-studio-submission-edit-image\",\n\n  properties: {\n    image: {\n      type: Object,\n      notify: true\n    },\n    thumbnail: {\n      type: String,\n      notify: true,\n      computed: \"_getThumbnail(image)\"\n    },\n    embedcode: {\n      type: String,\n      computed: \"_computeEmbedCode(image)\"\n    }\n  },\n\n  _getThumbnail: function(image) {\n    return image.url;\n  },\n\n  _computeEmbedCode: function(image) {\n    return \"![Alternative Text Here](\" + image.url + \")\";\n  },\n\n  _delete: function(e) {\n    this.fire(\"deleted\");\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-dialog/paper-dialog.js\";\nimport \"@polymer/paper-dialog-scrollable/paper-dialog-scrollable.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@vaadin/vaadin-upload/vaadin-upload.js\";\nimport \"@lrnwebcomponents/secure-request/secure-request.js\";\nimport \"./lrnapp-studio-submission-edit-add-asset.js\";\nimport \"./lrnapp-studio-submission-edit-image.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n        position: relative;\n        min-height: 200px;\n      }\n      #pages {\n        display: block;\n      }\n      .images__images {\n        display: flex;\n        flex-wrap: wrap;\n      }\n      .images__images > * {\n        margin-right: 16px;\n        min-width: 200px;\n      }\n      neon-animated-pages .iron-selected {\n        position: static;\n      }\n      paper-dialog {\n        width: 50%;\n        width: 50vmax;\n        padding: 16px;\n      }\n    </style>\n    <div class=\"images__images\">\n      <template is=\"dom-repeat\" items=\"{{images}}\" as=\"image\">\n        <lrnapp-studio-submission-edit-image\n          image=\"{{image}}\"\n          on-deleted=\"_deleteImage\"\n          data-index\\$=\"[[index]]\"\n        ></lrnapp-studio-submission-edit-image>\n      </template>\n      <lrnapp-studio-submission-edit-add-asset\n        on-click=\"_addImage\"\n        icon=\"image:photo-library\"\n      ></lrnapp-studio-submission-edit-add-asset>\n    </div>\n    <paper-dialog\n      id=\"dialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n      with-backdrop=\"\"\n    >\n      <h2>Add Image(s)</h2>\n      <paper-dialog-scrollable>\n        <div class=\"images__upload\">\n          <template is=\"dom-if\" if=\"[[uploadUrl]]\">\n            <vaadin-upload\n              accept=\"[[fileTypes]]\"\n              target=\"[[uploadUrl]]\"\n              method=\"POST\"\n              form-data-name=\"file-upload\"\n              on-upload-success=\"_handleImageUploadSuccess\"\n            >\n              <div class=\"images__drop-label\">\n                <iron-icon icon=\"description\"></iron-icon>\n                Upload files here:\n              </div>\n            </vaadin-upload>\n          </template>\n        </div>\n      </paper-dialog-scrollable>\n      <div class=\"buttons\">\n        <paper-button dialog-dismiss=\"\">Cancel</paper-button>\n      </div>\n    </paper-dialog>\n  `,\n\n  is: \"lrnapp-studio-submission-edit-images\",\n  behaviors: [SecureRequest.xhr],\n\n  properties: {\n    images: {\n      type: Array,\n      notify: true,\n      value: []\n    },\n    selectedPage: {\n      type: String,\n      value: 0\n    },\n    uploadUrl: {\n      type: String,\n      value: null\n    }\n  },\n\n  _addImage: function(e) {\n    // @todo switch to singleton\n    this.$.dialog.open();\n  },\n\n  _selectPage: function(e) {\n    var normalizedEvent = dom(e);\n    var page = normalizedEvent.localTarget.getAttribute(\"data-page\");\n    this.set(\"selectedPage\", page);\n  },\n\n  _handleImageUploadSuccess: function(e) {\n    this.set(\"selectedPage\", 0);\n    var images = [];\n    var response = e.detail.xhr.response;\n    // normalize response string\n    var response = JSON.parse(response);\n    // get the newely created file\n    if (response.data.file) {\n      var file = response.data.file;\n      // add it to the list of submission images.\n      // find out if the image is already referenced in the submission\n      // images array and if it is replace it.\n      var replacement = false;\n      if (this.images) {\n        images = this.images.map(function(image) {\n          if (image.fid === file.fid) {\n            replacement = true;\n            return file;\n          } else {\n            return image;\n          }\n        });\n      }\n      // if the image was not a replacement then add it to the array\n      if (!replacement) {\n        images.push(file);\n      }\n      this.set(\"images\", []);\n      this.set(\"images\", images);\n      this.$.dialog.close();\n    }\n  },\n\n  _deleteImage: function(e) {\n    var normalizedEvent = dom(e);\n    // console.log(normalizedEvent.localTarget);\n    var deleteIndex = normalizedEvent.localTarget.getAttribute(\"data-index\");\n    // console.log(deleteIndex);\n    this.splice(\"images\", deleteIndex, 1);\n  },\n  /**\n   * attached life cycle\n   */\n  attached: function() {\n    const uploadUrl = this.generateUrl(\"/api/files\");\n    if (uploadUrl !== null) {\n      this.set(\"uploadUrl\", uploadUrl);\n    }\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"./lrnapp-studio-submission-media-editoverlay.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: inline-flex;\n        justify-content: space-around;\n        align-items: stretch;\n        min-height: 100px;\n        width: 100px;\n        position: relative;\n        background: lightgray;\n        color: #333333;\n      }\n\n      lrnapp-studio-submission-media-editoverlay {\n        display: flex;\n      }\n\n      .file_url {\n        margin: 1em;\n      }\n    </style>\n\n    <lrnapp-studio-submission-media-editoverlay\n      on-delete=\"_delete\"\n      data-index\\$=\"[[index]]\"\n      embedcode=\"{{embedcode}}\"\n    >\n      <div class=\"file_url\">[[file.filename]]</div>\n    </lrnapp-studio-submission-media-editoverlay>\n  `,\n\n  is: \"lrnapp-studio-submission-edit-file\",\n\n  properties: {\n    file: {\n      type: Object\n    },\n    embedcode: {\n      type: String,\n      computed: \"_computeEmbedCode(file)\"\n    }\n  },\n\n  observers: [],\n\n  _computeEmbedCode: function(file) {\n    return \"[Alternative Text Here](\" + file.url + \")\";\n  },\n\n  _delete: function(e) {\n    this.fire(\"deleted\");\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-dialog/paper-dialog.js\";\nimport \"@polymer/paper-dialog-scrollable/paper-dialog-scrollable.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@vaadin/vaadin-upload/vaadin-upload.js\";\nimport \"@lrnwebcomponents/secure-request/secure-request.js\";\nimport \"./lrnapp-studio-submission-edit-add-asset.js\";\nimport \"./lrnapp-studio-submission-edit-file.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n        position: relative;\n        min-height: 200px;\n      }\n\n      #pages {\n        display: block;\n      }\n\n      .files__files {\n        display: flex;\n        flex-wrap: wrap;\n      }\n\n      .files__files > * {\n        margin-right: 16px;\n        min-width: 200px;\n      }\n\n      neon-animated-pages .iron-selected {\n        position: static;\n      }\n\n      paper-dialog {\n        width: 50%;\n        width: 50vmax;\n        padding: 16px;\n      }\n    </style>\n\n    <div class=\"files__files\">\n      <template is=\"dom-repeat\" items=\"{{files}}\" as=\"file\">\n        <lrnapp-studio-submission-edit-file\n          file=\"{{file}}\"\n          on-deleted=\"_deleteImage\"\n          data-index\\$=\"[[index]]\"\n        ></lrnapp-studio-submission-edit-file>\n      </template>\n      <lrnapp-studio-submission-edit-add-asset\n        on-click=\"_addImage\"\n        icon=\"editor:attach-file\"\n      ></lrnapp-studio-submission-edit-add-asset>\n    </div>\n\n    <paper-dialog\n      id=\"dialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n      with-backdrop=\"\"\n    >\n      <h2>Add Files(s)</h2>\n      <paper-dialog-scrollable>\n        <div class=\"files__upload\">\n          <template is=\"dom-if\" if=\"[[uploadUrl]]\">\n            <vaadin-upload\n              accept=\"[[fileTypes]]\"\n              target=\"[[uploadUrl]]\"\n              method=\"POST\"\n              form-data-name=\"file-upload\"\n              on-upload-success=\"_handleImageUploadSuccess\"\n            >\n              <div class=\"files__drop-label\">\n                <iron-icon icon=\"description\"></iron-icon>\n                Upload files here:\n              </div>\n            </vaadin-upload>\n          </template>\n        </div>\n      </paper-dialog-scrollable>\n      <div class=\"buttons\">\n        <paper-button dialog-dismiss=\"\">Cancel</paper-button>\n      </div>\n    </paper-dialog>\n  `,\n\n  is: \"lrnapp-studio-submission-edit-files\",\n  behaviors: [SecureRequest.xhr],\n\n  properties: {\n    files: {\n      type: Array,\n      notify: true,\n      value: null\n    },\n    selectedPage: {\n      type: String,\n      value: 0\n    },\n    uploadUrl: {\n      type: String,\n      value: null,\n      observer: \"log\"\n    },\n    fileTypes: {\n      type: String,\n      value: \"\"\n    }\n  },\n\n  observers: [\"_filesChanged(files)\"],\n\n  _filesChanged: function(files) {},\n\n  _addImage: function(e) {\n    // @todo switch to singleton\n    this.$.dialog.open();\n  },\n\n  _selectPage: function(e) {\n    var normalizedEvent = dom(e);\n    var page = normalizedEvent.localTarget.getAttribute(\"data-page\");\n    this.set(\"selectedPage\", page);\n  },\n\n  _handleImageUploadSuccess: function(e) {\n    this.set(\"selectedPage\", 0);\n    var files = [];\n    var response = e.detail.xhr.response;\n    // normalize response string\n    var response = JSON.parse(response);\n    // get the newely created file\n    if (response.data.file) {\n      var file = response.data.file;\n      if (this.files === null) {\n        this.set(\"files\", []);\n      }\n      this.push(\"files\", file);\n      this.$.dialog.close();\n    }\n  },\n\n  _deleteImage: function(e) {\n    var normalizedEvent = dom(e);\n    var deleteIndex = normalizedEvent.localTarget.getAttribute(\"data-index\");\n    this.splice(\"files\", Number(deleteIndex), 1);\n  },\n\n  _canUpload: function() {\n    const uploadUrl = this.uploadUrl;\n    if (uploadUrl !== null) {\n      return true;\n    } else {\n      return false;\n    }\n  },\n\n  log: function(property) {},\n  /**\n   * attached life cycle\n   */\n  attached: function() {\n    const uploadUrl = this.generateUrl(\"/api/files\");\n    if (uploadUrl !== null) {\n      this.set(\"uploadUrl\", uploadUrl);\n    }\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-dialog/paper-dialog.js\";\nimport \"@polymer/paper-dialog-scrollable/paper-dialog-scrollable.js\";\nimport \"@polymer/paper-input/paper-input.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@lrnwebcomponents/secure-request/secure-request.js\";\nimport \"./lrnapp-studio-submission-edit-add-asset.js\";\nimport \"./lrnapp-studio-submission-media-editoverlay.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: flex;\n        position: relative;\n        align-items: stretch;\n      }\n\n      :host * {\n        background: lightgray;\n        display: flex;\n        align-items: center;\n        margin-right: 1em;\n      }\n\n      iframe {\n        display: block;\n      }\n\n      .videosfield__create {\n        display: block;\n        height: 250px;\n        width: 300px;\n      }\n\n      paper-dialog {\n        width: 50%;\n        width: 50vmax;\n        padding: 1em;\n      }\n    </style>\n\n    <template is=\"dom-repeat\" items=\"{{videos}}\" as=\"video\">\n      <lrnapp-studio-submission-media-editoverlay\n        on-delete=\"_videoDelete\"\n        data-index\\$=\"[[index]]\"\n      >\n        <iframe class=\"videosfield__iframe\" src=\"{{video.video_src}}\"></iframe>\n      </lrnapp-studio-submission-media-editoverlay>\n    </template>\n\n    <lrnapp-studio-submission-edit-add-asset\n      icon=\"av:video-library\"\n      on-click=\"_openDialog\"\n    ></lrnapp-studio-submission-edit-add-asset>\n\n    <paper-dialog\n      id=\"dialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n      with-backdrop=\"\"\n    >\n      <h2>Add Video</h2>\n      <paper-dialog-scrollable>\n        <paper-input label=\"Video URL\" value=\"{{newvideo}}\"></paper-input>\n      </paper-dialog-scrollable>\n      <div class=\"buttons\">\n        <paper-button dialog-dismiss=\"\">Cancel</paper-button>\n        <paper-button dialog-confirm=\"\" on-click=\"_addImage\"\n          >Add Video</paper-button\n        >\n      </div>\n    </paper-dialog>\n\n    <template is=\"dom-if\" if=\"[[videoGenerateSourceUrl]]\">\n      <!-- Generate Video Source Url for preview -->\n      <iron-ajax\n        id=\"videoGenerateSourceUrl\"\n        url=\"[[videoGenerateSourceUrl]]\"\n        method=\"POST\"\n        body=\"[[newvideo]]\"\n        content-type=\"application/json\"\n        handle-as=\"json\"\n        on-response=\"_addImage\"\n      ></iron-ajax>\n    </template>\n  `,\n\n  is: \"lrnapp-studio-submission-edit-video\",\n  behaviors: [SecureRequest.xhr],\n\n  properties: {\n    videos: {\n      type: Array,\n      value: [],\n      notify: true\n    },\n    selectedPage: {\n      type: String,\n      value: \"0\"\n    },\n    newvideo: {\n      type: String,\n      value: \"\"\n    },\n    videoGenerateSourceUrl: {\n      type: String,\n      value: null\n    }\n  },\n  _openDialog: function(e) {\n    // @todo use singleton\n    this.$.dialog.open();\n  },\n\n  _addImage: function(e) {\n    var video_url = this.newvideo;\n    var normalizedEvent = dom(e);\n    var tagname = normalizedEvent.localTarget.tagName;\n    // find out if the component that called this function\n    // if it's the iron-ajax then that means we have what we\n    // need to add this new video to the array.\n    if (tagname === \"IRON-AJAX\") {\n      var video_src = e.detail.response.data;\n      // make sure we upgrade from NULL to an array if needed\n      if (Object.prototype.toString.call(this.videos) != \"[object Array]\") {\n        this.videos = [];\n      }\n      this.push(\"videos\", { video_url: this.newvideo, video_src: video_src });\n      this.newvideo = \"\";\n    }\n    // if it wasn't iron ajax, then we need to go get the\n    // newvideo's source url from the api\n    else {\n      this.shadowRoot\n        .querySelector(\"#videoGenerateSourceUrl\")\n        .generateRequest();\n    }\n  },\n\n  _videoDelete: function(e) {\n    var normalizedEvent = dom(e);\n    var deleteIndex = normalizedEvent.localTarget.getAttribute(\"data-index\");\n    this.splice(\"videos\", deleteIndex, 1);\n  },\n\n  ready: function() {\n    const url = this.generateUrl(\"/api/video/generate-source-url\");\n    this.set(\"videoGenerateSourceUrl\", url);\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-icon-button/paper-icon-button.js\";\nimport \"@polymer/paper-dialog/paper-dialog.js\";\nimport \"@polymer/paper-dialog-scrollable/paper-dialog-scrollable.js\";\nimport \"@polymer/paper-input/paper-input.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"./lrnapp-studio-submission-edit-add-asset.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n\n      .item {\n        display: flex;\n        margin: auto;\n      }\n\n      .info {\n        flex: 1 1 auto;\n      }\n\n      .create {\n        display: flex;\n        align-items: center;\n      }\n\n      .input {\n        flex: 1 1 auto;\n      }\n\n      paper-dialog {\n        width: 50%;\n        width: 50vmax;\n        padding: 1em;\n      }\n    </style>\n\n    <template is=\"dom-repeat\" items=\"{{links}}\" as=\"link\">\n      <div class=\"item\">\n        <div class=\"info\"><div class=\"linksfield__url\">{{link.url}}</div></div>\n        <div class=\"linksfield__actions\">\n          <paper-icon-button\n            icon=\"delete\"\n            class=\"linksfield__delete\"\n            data-index\\$=\"{{index}}\"\n            on-click=\"_deleteLink\"\n          ></paper-icon-button>\n        </div>\n      </div>\n    </template>\n    <lrnapp-studio-submission-edit-add-asset\n      icon=\"link\"\n      display=\"pill\"\n      on-click=\"_openDialog\"\n    ></lrnapp-studio-submission-edit-add-asset>\n\n    <paper-dialog\n      id=\"dialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n      with-backdrop=\"\"\n    >\n      <h2>Add Link</h2>\n      <paper-dialog-scrollable>\n        <paper-input\n          id=\"link-input\"\n          class=\"input\"\n          label=\"URL\"\n          value=\"{{newlink}}\"\n        ></paper-input>\n      </paper-dialog-scrollable>\n      <div class=\"buttons\">\n        <paper-button dialog-dismiss=\"\">Cancel</paper-button>\n        <paper-button dialog-confirm=\"\" on-click=\"_createLink\"\n          >Add Link</paper-button\n        >\n      </div>\n    </paper-dialog>\n  `,\n\n  is: \"lrnapp-studio-submission-edit-links\",\n\n  properties: {\n    links: {\n      type: Array,\n      value: null,\n      notify: true\n    },\n    newlink: {\n      type: String,\n      value: \"\"\n    }\n  },\n\n  _openDialog: function() {\n    // @todo switch to singleton\n    this.$.dialog.open();\n  },\n\n  _createLink: function(e) {\n    var links = this.links;\n    if (links === null) {\n      this.set(\"links\", []);\n    }\n    this.push(\"links\", { url: this.newlink });\n    this.newlink = \"\";\n  },\n\n  _deleteLink: function(e) {\n    var normalizedEvent = dom(e);\n    var deleteIndex = normalizedEvent.localTarget.getAttribute(\"data-index\");\n    this.splice(\"links\", deleteIndex, 1);\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@lrnwebcomponents/lrn-markdown-editor/lrn-markdown-editor.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n    </style>\n    <lrn-markdown-editor content=\"{{content}}\"></lrn-markdown-editor>\n  `,\n\n  is: \"lrnapp-studio-submission-edit-textarea\",\n\n  properties: {\n    content: {\n      type: String,\n      notify: true\n    }\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-input/paper-input.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"./lrnapp-studio-submission-media-editoverlay.js\";\nimport \"./lrnapp-studio-submission-edit-images.js\";\nimport \"./lrnapp-studio-submission-edit-files.js\";\nimport \"./lrnapp-studio-submission-edit-video.js\";\nimport \"./lrnapp-studio-submission-edit-links.js\";\nimport \"./lrnapp-studio-submission-edit-textarea.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n        padding: 16px;\n      }\n      .field {\n        padding-bottom: 16px;\n      }\n      .actions {\n        display: flex;\n        border-top: 2px solid gainsboro;\n        margin-top: 16px;\n      }\n      .actions .spacer {\n        flex: 1 1 auto;\n      }\n      iron-icon {\n        margin-right: 6px;\n        --iron-icon-height: 32px;\n        --iron-icon-width: 32px;\n      }\n      .imagesfiled__image_delete {\n        position: absolute;\n        top: 0;\n        right: 0;\n      }\n    </style>\n    <template is=\"dom-if\" if=\"{{submission}}\">\n      <div class=\"field\">\n        <paper-input\n          label=\"Title\"\n          value=\"{{submission.attributes.title}}\"\n        ></paper-input>\n      </div>\n      <!-- Body -->\n      <div class=\"field\">\n        <label>Submission Text</label>\n        <lrnapp-studio-submission-edit-textarea\n          content=\"{{submission.attributes.body}}\"\n        ></lrnapp-studio-submission-edit-textarea>\n      </div>\n\n      <!-- Images -->\n      <div class=\"imagesfield field\">\n        <label for=\"image-upload\">Images</label>\n        <lrnapp-studio-submission-edit-images\n          images=\"{{submission.attributes.images}}\"\n          file-types=\"[[submission.meta.imagefieldTypes]]\"\n        ></lrnapp-studio-submission-edit-images>\n      </div>\n\n      <!-- Files -->\n      <div class=\"filesfield field\">\n        <label for=\"file-upload\">Files</label>\n        <lrnapp-studio-submission-edit-files\n          files=\"{{submission.attributes.files}}\"\n          file-types=\"[[submission.meta.filefieldTypes]]\"\n        >\n        </lrnapp-studio-submission-edit-files>\n      </div>\n\n      <!-- Links -->\n      <div id=\"linksfield\" class=\"linksfield field\">\n        <label for=\"links-input\">Links</label>\n        <lrnapp-studio-submission-edit-links\n          links=\"{{submission.attributes.links}}\"\n        ></lrnapp-studio-submission-edit-links>\n      </div>\n\n      <!-- Videos -->\n      <div id=\"videosfield\" class=\"videosfield field\">\n        <label for=\"videos-input\">Videos</label>\n        <lrnapp-studio-submission-edit-video\n          videos=\"{{submission.attributes.video}}\"\n          end-point=\"[[endPoint]]\"\n          csrf-token=\"[[csrfToken]]\"\n        ></lrnapp-studio-submission-edit-video>\n      </div>\n\n      <div class=\"actions\">\n        <lrnsys-button\n          id=\"publish\"\n          icon=\"check\"\n          label=\"Publish to Studio\"\n          on-click=\"_publishClicked\"\n          hover-class=\"amber lighten-5 green-text text-darken-4\"\n          icon-class=\"green-text\"\n        ></lrnsys-button>\n        <lrnsys-button\n          id=\"save-draft\"\n          icon=\"drafts\"\n          label=\"Save Draft\"\n          on-click=\"_saveDraftClicked\"\n          hover-class=\"amber lighten-5 amber-text text-darken-4\"\n          icon-class=\"amber-text text-darken-4\"\n        ></lrnsys-button>\n        <span class=\"spacer\"></span>\n        <lrnsys-button\n          id=\"delete\"\n          label=\"Delete\"\n          icon=\"delete\"\n          on-click=\"_deleteClicked\"\n          hover-class=\"amber lighten-5 red-text\"\n          icon-class=\"red-text text-darken-4\"\n        >\n        </lrnsys-button>\n      </div>\n    </template>\n  `,\n  is: \"lrnapp-studio-submission-edit\",\n  properties: {\n    submission: {\n      type: Object,\n      notify: true\n    },\n    uploadFilesUrl: {\n      type: String\n    },\n    newlink: {\n      type: String\n    },\n    newvideo: {\n      type: String\n    },\n    videoGenerateSourceUrl: {\n      type: String\n    },\n    submission: {\n      type: Object,\n      notify: true\n    }\n  },\n\n  observers: [\"_bodyChanged(title)\"],\n  _publishClicked: function(e) {\n    this.set(\"submission.attributes.state\", \"submission_ready\");\n    this.notifyPath(\"submission.attributes.state\");\n    this.fire(\"submissionPublishClicked\");\n  },\n\n  _saveDraftClicked: function(e) {\n    this.set(\"submission.attributes.state\", \"submission_in_progress\");\n    this.notifyPath(\"submission.attributes.state\");\n    this.fire(\"submissionSaveDraftClicked\");\n  },\n\n  _deleteClicked: function(e) {\n    this.fire(\"submissionDeleteClicked\");\n  },\n\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n        font-size: 12px;\n      }\n      .studio-block__header {\n        padding: 16px;\n        display: flex;\n        align-items: center;\n        justify-content: flex-start;\n        border: 1px solid lightgray;\n        border-bottom: none;\n      }\n      .studio-block__content {\n        padding: 0 16px;\n        border: 1px solid lightgray;\n      }\n      .studio-block__icon-wrapper {\n        width: 32px;\n      }\n      .studio-block__header h3 {\n        margin: 0;\n        font-style: none;\n        font-size: inherit;\n      }\n    </style>\n    <div class=\"studio-block__header\">\n      <div class=\"studio-block__icon-wrapper\">\n        <iron-icon icon=\"[[icon]]\" hidden\\$=\"[[!icon]]\"></iron-icon>\n      </div>\n      <h3 hidden\\$=\"[[!title]]\">[[title]]</h3>\n    </div>\n    <div class=\"studio-block__content\"><slot></slot></div>\n  `,\n\n  is: \"lrnapp-studio-block\",\n\n  properties: {\n    title: {\n      type: String,\n      value: null\n    },\n    icons: {\n      type: String,\n      value: null\n    }\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/marked-element/marked-element.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"./lrnapp-studio-block.js\";\nimport \"./lrnapp-studio-submission-edit-textarea.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n      .field {\n        padding-top: 32px;\n        padding-bottom: 32px;\n      }\n\n      .actions {\n        display: flex;\n        border-top: 2px solid gainsboro;\n        margin-top: 16px;\n        font-size: 14px;\n      }\n\n      .actions .spacer {\n        flex: 1 1 auto;\n      }\n\n      .submission-critique-outline + .submission-critique-outline {\n        margin-top: 16px;\n      }\n\n      :host([edit]) .submission-critique-outline--feedback lrnapp-studio-block {\n        padding: 0;\n      }\n    </style>\n    <!-- Body -->\n    <div class=\"field\">\n      <div class=\"submission-critique-outline\">\n        <lrnapp-studio-block title=\"Directions\" icon=\"info-outline\">\n          <marked-element\n            markdown=\"[[submission.relationships.assignment.attributes.critiqueOutline]]\"\n          ></marked-element>\n        </lrnapp-studio-block>\n      </div>\n      <div\n        class=\"submission-critique-outline submission-critique-outline--feedback\"\n      >\n        <lrnapp-studio-block title=\"Feedback\" icon=\"communication:comment\">\n          <template is=\"dom-if\" if=\"[[edit]]\">\n            <lrnapp-studio-submission-edit-textarea\n              content=\"{{submission.attributes.body}}\"\n            ></lrnapp-studio-submission-edit-textarea>\n          </template>\n          <template is=\"dom-if\" if=\"[[!edit]]\">\n            <marked-element\n              markdown=\"{{submission.attributes.body}}\"\n            ></marked-element>\n          </template>\n        </lrnapp-studio-block>\n      </div>\n    </div>\n    <template is=\"dom-if\" if=\"[[edit]]\">\n      <div class=\"actions\">\n        <lrnsys-button\n          id=\"publish\"\n          icon=\"check\"\n          label=\"Publish Feedback\"\n          on-click=\"_publishClicked\"\n          hover-class=\"amber lighten-5 green-text text-darken-4\"\n          icon-class=\"green-text\"\n        ></lrnsys-button>\n        <lrnsys-button\n          id=\"save-draft\"\n          icon=\"drafts\"\n          label=\"Save Draft\"\n          on-click=\"_saveDraftClicked\"\n          hover-class=\"amber lighten-5 amber-text text-darken-4\"\n          icon-class=\"amber-text text-darken-4\"\n        ></lrnsys-button>\n        <span class=\"spacer\"></span>\n        <lrnsys-button\n          id=\"delete\"\n          label=\"Delete Feedback\"\n          icon=\"delete\"\n          on-click=\"_deleteClicked\"\n          hover-class=\"amber lighten-5 red-text\"\n          icon-class=\"red-text text-darken-4\"\n        >\n        </lrnsys-button>\n      </div>\n    </template>\n  `,\n  is: \"lrnapp-studio-submission-critique-panel\",\n  properties: {\n    submission: {\n      type: Object,\n      notify: true\n    },\n    edit: {\n      type: Boolean,\n      value: false,\n      reflectToAttribute: true\n    }\n  },\n  _publishClicked: function(e) {\n    this.set(\"submission.attributes.state\", \"submission_ready\");\n    this.notifyPath(\"submission.attributes.state\");\n    this.fire(\"submissionPublishClicked\");\n  },\n  _saveDraftClicked: function(e) {\n    this.set(\"submission.attributes.state\", \"submission_in_progress\");\n    this.notifyPath(\"submission.attributes.state\");\n    this.fire(\"submissionSaveDraftClicked\");\n  },\n  _deleteClicked: function(e) {\n    this.fire(\"submissionDeleteClicked\");\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@vaadin/vaadin-split-layout/vaadin-split-layout.js\";\nimport \"./lrnapp-studio-submission-media-editoverlay.js\";\nimport \"./lrnapp-studio-submission-edit-images.js\";\nimport \"./lrnapp-studio-submission-edit-files.js\";\nimport \"./lrnapp-studio-submission-edit-video.js\";\nimport \"./lrnapp-studio-submission-edit-links.js\";\nimport \"./lrnapp-studio-submission-display.js\";\nimport \"./lrnapp-studio-submission-edit-textarea.js\";\nimport \"./lrnapp-studio-block.js\";\nimport \"./lrnapp-studio-submission-critique-panel.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n\n      .submission-critique {\n        display: flex;\n        justify-content: space-around;\n      }\n\n      .submission-critique-panel {\n        flex: 1 1 auto;\n        width: 100%;\n        flex-wrap: nowrap;\n        margin: 0.3em;\n      }\n    </style>\n    <template is=\"dom-if\" if=\"{{submission}}\">\n      <template is=\"dom-if\" if=\"[[!edit]]\">\n        <div class=\"submission-critique\">\n          <!-- critique panel -->\n          <div class=\"submission-critique-panel\" id=\"crititque-panel\">\n            <lrnapp-studio-submission-display\n              submission=\"[[submission.relationships.relatedSubmission]]\"\n            ></lrnapp-studio-submission-display>\n          </div>\n          <!-- critique panel -->\n          <div class=\"submission-critique-panel\">\n            <lrnapp-studio-submission-critique-panel\n              submission=\"[[submission]]\"\n              edit=\"[[edit]]\"\n            ></lrnapp-studio-submission-critique-panel>\n          </div>\n        </div>\n      </template>\n      <template is=\"dom-if\" if=\"[[edit]]\">\n        <vaadin-split-layout class=\"submission-critique\">\n          <!-- critique panel -->\n          <div class=\"submission-critique-panel\" id=\"crititque-panel\">\n            <lrnapp-studio-submission-display\n              submission=\"[[submission.relationships.relatedSubmission]]\"\n            ></lrnapp-studio-submission-display>\n          </div>\n          <!-- critique panel -->\n          <div class=\"submission-critique-panel\">\n            <lrnapp-studio-submission-critique-panel\n              submission=\"{{submission}}\"\n              edit=\"[[edit]]\"\n            ></lrnapp-studio-submission-critique-panel>\n          </div>\n        </vaadin-split-layout>\n      </template>\n    </template>\n  `,\n\n  is: \"lrnapp-studio-submission-critique\",\n\n  properties: {\n    submission: {\n      type: Object,\n      notify: true\n    },\n    edit: {\n      type: Boolean,\n      value: false,\n      reflectToAttribute: true\n    }\n  },\n\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-pages/iron-pages.js\";\nimport \"./lrnapp-studio-submission-display.js\";\nimport \"./lrnapp-studio-submission-edit.js\";\nimport \"./lrnapp-studio-submission-critique.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n    </style>\n    <iron-pages selected=\"[[selectedPage]]\">\n      <lrnapp-studio-submission-display\n        submission=\"{{submission}}\"\n      ></lrnapp-studio-submission-display>\n      <lrnapp-studio-submission-edit\n        submission=\"{{submission}}\"\n      ></lrnapp-studio-submission-edit>\n      <lrnapp-studio-submission-critique\n        submission=\"{{submission}}\"\n        edit=\"[[edit]]\"\n      ></lrnapp-studio-submission-critique>\n    </iron-pages>\n  `,\n  is: \"lrnapp-studio-submission-object\",\n  properties: {\n    submission: {\n      type: Object,\n      value: null,\n      notify: true\n    },\n    edit: {\n      type: Boolean,\n      value: false\n    },\n    selectedPage: {\n      type: Number,\n      value: 0\n    }\n  },\n\n  observers: [\"_selectedPageChanged(edit, submission.meta.submissionType)\"],\n\n  _selectedPageChanged: function(edit, type) {\n    var selected = 0;\n    if (edit) {\n      switch (type) {\n        case \"default\":\n          selected = 1;\n          break;\n        case \"critique\":\n          selected = 2;\n          break;\n      }\n    } else {\n      switch (type) {\n        case \"default\":\n          selected = 0;\n          break;\n        case \"critique\":\n          selected = 2;\n          break;\n      }\n    }\n    this.set(\"selectedPage\", selected);\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-card/paper-card.js\";\nimport \"@polymer/paper-icon-button/paper-icon-button.js\";\nimport \"@polymer/paper-tooltip/paper-tooltip.js\";\nimport \"@lrnwebcomponents/word-count/word-count.js\";\nimport \"@lrnwebcomponents/lrndesign-avatar/lrndesign-avatar.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: flex;\n      }\n      paper-card {\n        margin: 20px;\n        padding: 16px;\n      }\n      h1,\n      h2,\n      h3,\n      h4 {\n        text-align: left;\n      }\n      p {\n        font-size: 14px;\n        line-height: 18px;\n        text-align: left;\n      }\n      .nowrap p {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n      .right-actions {\n        float: right;\n      }\n      .paper-card-length-1 {\n        width: 85%;\n        margin-bottom: 8px;\n      }\n      .paper-card-length-2 {\n        width: 81%;\n        margin-top: 0;\n        margin-bottom: 8px;\n      }\n      .paper-card-length-3 {\n        width: 77%;\n        margin-top: 0;\n        margin-bottom: 8px;\n      }\n      .comment-depth-2 {\n        margin: 8px;\n      }\n      .comment-depth-3 {\n        margin: 16px;\n      }\n      .comment-depth-4 {\n        margin: 16px;\n      }\n      .comment-depth-5 {\n        margin: 16px;\n      }\n      .comment-depth-6 {\n        margin: 16px;\n      }\n      .center {\n        padding: 0;\n      }\n    </style>\n    <div class\\$=\"center comment-depth-[[comment.attributes.threadDepth]]\">\n      <lrndesign-avatar\n        label=\"[[comment.relationships.author.data.name]]\"\n        class=\"float-left\"\n      ></lrndesign-avatar>\n    </div>\n    <paper-card class\\$=\"paper-card-length-[[comment.attributes.threadDepth]]\">\n      <div id=\"body\" class=\"comment-body nowrap\">\n        <h4>\n          [[comment.relationships.author.data.name]]\n          <span class=\"grey-said\"> said:</span>\n        </h4>\n        <word-count>[[comment.attributes.body]]</word-count>\n      </div>\n      <div class\\$=\"card-actions\">\n        <paper-icon-button\n          class=\"right-actions\"\n          id=\"reply\"\n          icon=\"icons:reply\"\n        ></paper-icon-button>\n        <paper-tooltip for=\"reply\" animation-delay=\"0\">Reply</paper-tooltip>\n        <paper-icon-button\n          class=\"right-actions\"\n          id=\"edit\"\n          icon=\"icons:create\"\n        ></paper-icon-button>\n        <paper-tooltip for=\"edit\" animation-delay=\"0\">Edit</paper-tooltip>\n        <paper-icon-button\n          class=\"right-actions\"\n          id=\"delete\"\n          icon=\"icons:delete-forever\"\n        ></paper-icon-button>\n        <paper-tooltip for=\"delete\" animation-delay=\"0\">Delete</paper-tooltip>\n      </div>\n    </paper-card>\n  `,\n  is: \"lrnapp-studio-submission-comment\",\n  properties: {\n    comment: {\n      type: Object\n    }\n  },\n  /**\n   * attached life cycle\n   */\n  attached: function() {\n    this.$.body.addEventListener(\"click\", e => {\n      this.$.body.classList.toggle(\"nowrap\");\n    });\n  },\n  /**\n   * detached life cycle\n   */\n  detached: function() {\n    this.$.body.removeEventListener(\"click\", e => {\n      this.$.body.classList.toggle(\"nowrap\");\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"./lrnapp-studio-submission-comment.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n    </style>\n    <template is=\"dom-if\" if=\"[[submission.relationships.comments]]\">\n      <template\n        is=\"dom-repeat\"\n        items=\"[[_toArray(submission.relationships.comments.data)]]\"\n        as=\"comment\"\n      >\n        <lrnapp-studio-submission-comment\n          comment=\"{{comment}}\"\n        ></lrnapp-studio-submission-comment>\n      </template>\n    </template>\n  `,\n  is: \"lrnapp-studio-submission-comments\",\n  properties: {\n    submission: {\n      type: Object\n    }\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport * as async from \"@polymer/polymer/lib/utils/async.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/app-layout/app-toolbar/app-toolbar.js\";\nimport \"@polymer/marked-element/marked-element.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\nimport \"@polymer/paper-dialog/paper-dialog.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@polymer/paper-badge/paper-badge.js\";\nimport \"@polymer/paper-toast/paper-toast.js\";\nimport \"@vaadin/vaadin-split-layout/vaadin-split-layout.js\";\nimport \"@lrnwebcomponents/lrnsys-layout/lib/lrnsys-dialog.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"@lrnwebcomponents/lrnsys-comment/lib/lrnsys-comment-list.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"./lrnapp-studio-submission-object.js\";\nimport \"./lrnapp-studio-submission-comments.js\";\nimport \"./lrnapp-studio-submission-comment.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n        position: relative;\n      }\n\n      p {\n        font-size: 14px;\n        line-height: 18px;\n      }\n\n      h1 {\n        margin: 0;\n        text-align: left;\n      }\n\n      iron-selector {\n        line-height: 1em;\n      }\n\n      iron-selector lrnsys-button {\n        display: inline-flex;\n      }\n\n      iron-image {\n        margin: 0 0.5em;\n      }\n\n      lrnsys-dialog {\n        display: inline;\n      }\n\n      .contain {\n        width: 10em;\n        height: 10em;\n        background: #ddd;\n      }\n\n      .center {\n        margin: auto;\n        width: 100%;\n      }\n\n      .title {\n        color: #222;\n        font-size: 2rem;\n        font-weight: 600;\n        line-height: 2.5rem;\n        padding: 0.25rem 0;\n        white-space: nowrap;\n        overflow-x: hidden;\n        text-overflow: ellipsis;\n        margin-top: 1rem;\n        text-transform: uppercase;\n        text-align: left;\n      }\n\n      .author {\n        color: #555;\n        font-size: 1rem;\n        font-weight: 500;\n        font-style: normal;\n        line-height: 1rem;\n        padding: 0.25rem 0 0.5rem 0;\n        margin: 0;\n        text-transform: capitalize;\n      }\n\n      .comments {\n        text-align: right;\n        margin: 0;\n        font-size: 1.5em;\n      }\n\n      .submission-page-wrapper {\n        padding: 0;\n        --vaadin-split-layout-splitter: {\n          min-width: 0.4em;\n          background: var(--paper-amber-200);\n        }\n      }\n\n      .submission-page {\n        width: 70vw;\n      }\n\n      .submission-page-card {\n        width: 100%;\n        margin: 0;\n        padding: 0 0 2em 1em;\n      }\n\n      .submission-comments {\n        overflow-y: hidden;\n        padding: 0;\n        margin: 0;\n      }\n\n      elmsln-loading {\n        position: absolute;\n        display: none;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(255, 255, 255, 0.8);\n        z-index: 10;\n        align-items: flex-end;\n        justify-content: center;\n      }\n\n      :host([saving]) elmsln-loading {\n        display: block;\n      }\n\n      elmsln-loading {\n        top: calc(50% - 5vmax);\n        left: calc(50% - 5vmax);\n        position: fixed;\n        transform-origin: center center;\n        width: 10vmax !important;\n        height: 10vmax !important;\n      }\n\n      iron-pages {\n        width: 100%;\n      }\n\n      paper-dialog {\n        width: 50%;\n        width: 50vmax;\n        padding: 1em;\n        z-index: 99999;\n      }\n\n      lrnapp-studio-submission-object {\n        width: 100%;\n      }\n\n      .assignment-body {\n        padding: 2em;\n      }\n\n      iron-icon {\n        margin: 0.2em;\n      }\n    </style>\n\n    <app-route\n      route=\"{{route}}\"\n      pattern=\"/edit\"\n      tail=\"{{tail}}\"\n      active=\"{{editPage}}\"\n    >\n    </app-route>\n\n    <iron-ajax\n      id=\"ajaxRequest\"\n      auto=\"\"\n      url=\"[[reqUrl]]\"\n      method=\"GET\"\n      params=\"[[reqParams]]\"\n      content-type=\"application/json\"\n      handle-as=\"json\"\n      on-response=\"_handleResponse\"\n    ></iron-ajax>\n    <!-- Update Submission Node -->\n    <iron-ajax\n      id=\"ajaxUpdateRequest\"\n      url=\"[[reqUrl]]\"\n      method=\"PUT\"\n      body=\"[[submission]]\"\n      params=\"[[reqParams]]\"\n      content-type=\"application/json\"\n      handle-as=\"json\"\n      on-response=\"_handleUpdateResponse\"\n    ></iron-ajax>\n    <!-- Delete Submission Node -->\n    <iron-ajax\n      id=\"ajaxDeleteRequest\"\n      url=\"[[reqUrl]]\"\n      method=\"DELETE\"\n      params=\"[[reqParams]]\"\n      content-type=\"application/json\"\n      handle-as=\"json\"\n      on-response=\"_handleDeleteResponse\"\n    ></iron-ajax>\n\n    <app-toolbar class=\"amber lighten-3\" hidden\\$=\"[[hideMenuBar]]\">\n      <template is=\"dom-if\" if=\"[[showComments]]\">\n        <lrnsys-button\n          on-tap=\"_backToStudio\"\n          icon=\"arrow-back\"\n          label=\"See in studio\"\n          hover-class=\"amber darken-4 white-text\"\n        ></lrnsys-button>\n      </template>\n      <template is=\"dom-if\" if=\"[[!showComments]]\">\n        <lrnsys-button\n          on-tap=\"_backToKanban\"\n          icon=\"arrow-back\"\n          label=\"Back to project management\"\n          hover-class=\"amber darken-4 white-text\"\n        ></lrnsys-button>\n      </template>\n      <div spacer=\"\" main-title=\"\">[[submission.attributes.title]]</div>\n      <div spacer=\"\">\n        <lrnsys-dialog\n          body-append=\"\"\n          header=\"[[submission.relationships.assignment.attributes.title]]\"\n        >\n          <span slot=\"button\"\n            ><iron-icon icon=\"icons:assignment\"></iron-icon>Assignment\n            Details</span\n          >\n          <div class=\"assignment-body\">\n            <marked-element\n              id=\"assignment-body\"\n              markdown=\"[[submission.relationships.assignment.attributes.body]]\"\n            ></marked-element>\n          </div>\n        </lrnsys-dialog>\n      </div>\n      <div>\n        <paper-button\n          id=\"comment-count\"\n          style=\"margin:0;padding:.25em;text-transform:none;\"\n        >\n          <iron-icon icon=\"communication:forum\"></iron-icon>\n          [[submission.meta.comment_count]] Comments\n        </paper-button>\n        <paper-badge\n          hidden\\$=\"[[displayNewBadge(submission.meta.comment_new)]]\"\n          for=\"comment-count\"\n          label\\$=\"[[submission.meta.comment_new]]\"\n        ></paper-badge>\n      </div>\n      <div hidden\\$=\"[[editPage]]\">\n        <lrnsys-button\n          on-tap=\"_setEditRoute\"\n          icon=\"create\"\n          label=\"Edit\"\n          hover-class=\"amber darken-4 white-text\"\n          hidden\\$=\"[[!submission.meta.canUpdate]]\"\n        ></lrnsys-button>\n      </div>\n      <div hidden\\$=\"[[!editPage]]\">\n        <lrnsys-button\n          on-tap=\"_resetRoute\"\n          icon=\"cancel\"\n          label=\"Cancel\"\n          hover-class=\"amber darken-4 white-text\"\n          hidden\\$=\"[[!submission.meta.canUpdate]]\"\n        ></lrnsys-button>\n      </div>\n    </app-toolbar>\n\n    <vaadin-split-layout class=\"submission-page-wrapper\">\n      <div\n        id=\"commentcolumn\"\n        class=\"submission-comments\"\n        style=\"min-width: 25%; max-width: 40%; width:30%;\"\n      >\n        <template is=\"dom-if\" if=\"[[showComments]]\">\n          <lrnsys-comment-list\n            comment-ops-base=\"{{commentOpsBase}}\"\n            csrf-token=\"[[csrfToken]]\"\n            source-path=\"{{commentsUrl}}\"\n            create-stub-url=\"{{createStubUrl}}\"\n          ></lrnsys-comment-list>\n        </template>\n      </div>\n      <div id=\"submissioncolumn\" style=\"width:70%;\">\n        <lrnapp-studio-submission-object\n          submission=\"{{submission}}\"\n          edit=\"[[editPage]]\"\n        ></lrnapp-studio-submission-object>\n      </div>\n      <iron-icon class=\"splitter-handle\" icon=\"more-vert\"></iron-icon>\n    </vaadin-split-layout>\n\n    <elmsln-loading></elmsln-loading>\n\n    <paper-dialog\n      id=\"deletedialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n      with-backdrop=\"\"\n    >\n      <h2>Delete submission?</h2>\n      <p>Are you sure you want to delete this submission?</p>\n      <div class=\"buttons\">\n        <paper-button dialog-dismiss=\"\">Cancel</paper-button>\n        <paper-button dialog-confirm=\"\" on-click=\"_submissionDeleteConfirmed\"\n          >Delete</paper-button\n        >\n      </div>\n    </paper-dialog>\n    <paper-dialog\n      id=\"publishdialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n      with-backdrop=\"\"\n    >\n      <h2>Ready to publish?</h2>\n      <p>\n        By publishing, the author of this submission will be able to view your\n        feedback. Are you ready to publish?\n      </p>\n      <div class=\"buttons\">\n        <paper-button dialog-dismiss=\"\">Cancel</paper-button>\n        <paper-button dialog-confirm=\"\" on-click=\"_submissionPublishConfirmed\"\n          >Yes Publish</paper-button\n        >\n      </div>\n    </paper-dialog>\n\n    <paper-toast id=\"toast\"></paper-toast>\n  `,\n\n  is: \"lrnapp-studio-submission-page\",\n\n  properties: {\n    id: {\n      type: String\n    },\n    hideMenuBar: {\n      type: Boolean,\n      value: false\n    },\n    endPoint: {\n      type: String\n    },\n    basePath: {\n      type: String\n    },\n    csrfToken: {\n      type: String\n    },\n    reqUrl: {\n      type: String\n    },\n    reqParams: {\n      type: Object\n    },\n    submission: {\n      type: Object\n    },\n    commentsUrl: {\n      type: String,\n      computed: \"_computeCommentsUrl(id, endPoint, csrfToken)\"\n    },\n    createStubUrl: {\n      type: String,\n      computed: \"_computeCommentsStubUrl(id, endPoint, csrfToken)\"\n    },\n    commentOpsBase: {\n      type: String,\n      computed: \"_computeCommentsOpsUrl(id, endPoint, csrfToken)\"\n    },\n    editPage: {\n      type: Boolean,\n      reflectToAttribute: true\n    },\n    saving: {\n      type: Boolean,\n      value: false,\n      notify: true,\n      reflectToAttribute: true\n    },\n    showComments: {\n      type: Boolean,\n      computed: \"_computeShowComments(submission)\"\n    }\n  },\n\n  observers: [\n    \"_urlVarsChanged(id, endPoint)\",\n    \"_paramsChanged(csrfToken)\",\n    \"_bodyChanged(title)\"\n  ],\n\n  listeners: {\n    submissionDeleteClicked: \"_submissionDeleteClicked\",\n    submissionPublishClicked: \"_submissionPublishClicked\",\n    submissionSaveDraftClicked: \"_submissionSaveDraftClicked\"\n  },\n\n  /**\n   * Go back to the studio relative to the app's path.\n   */\n  _backToStudio: function(e) {\n    window.location.href = this.basePath + \"lrnapp-open-studio\";\n  },\n\n  /**\n   * Go back to the studio relative to the app's path.\n   */\n  _backToKanban: function(e) {\n    window.location.href = this.basePath + \"lrnapp-studio-kanban\";\n  },\n\n  /**\n   * Trigger the page router to invoke edit state.\n   */\n  _setEditRoute: function(e) {\n    this.set(\"route.path\", \"edit\");\n    this.notifyPath(\"route.path\");\n  },\n\n  /**\n   * Trigger the page router to invoke edit state.\n   */\n  _resetRoute: function(e) {\n    this.set(\"route.path\", \"\");\n    this.notifyPath(\"route.path\");\n  },\n\n  /**\n   * if we should show new badge based on new comment count.\n   */\n  displayNewBadge: function(count) {\n    if (count == 0) {\n      return true;\n    }\n    return false;\n  },\n\n  _computeCommentsUrl: function(id, endPoint, csrfToken) {\n    return endPoint + \"/api/submissions/\" + id + \"/comments?token=\" + csrfToken;\n  },\n\n  _computeCommentsOpsUrl: function(id, endPoint, csrfToken) {\n    return endPoint + \"/api/submissions/\" + id + \"/comments\";\n  },\n\n  _computeCommentsStubUrl: function(id, endPoint, csrfToken) {\n    return (\n      endPoint +\n      \"/api/submissions/\" +\n      id +\n      \"/comments/create-stub?token=\" +\n      csrfToken\n    );\n  },\n\n  _urlVarsChanged: function(id, endPoint) {\n    this.reqUrl = endPoint + \"/api/submissions/\" + id;\n  },\n\n  _paramsChanged: function(csrfToken) {\n    var params = this.reqParams || {};\n    params.token = csrfToken;\n    this.reqParams = params;\n  },\n\n  _handleResponse: function(data) {\n    // empty response means no access or deleted item\n    if (data.detail.response.data) {\n      this.set(\"submission\", []);\n      this.set(\"submission\", data.detail.response.data);\n      async.microTask.run(() => {\n        window.dispatchEvent(new Event(\"resize\"));\n      });\n    }\n  },\n\n  _isReply: function(data) {\n    this.thread = submission.relationships.comments.data.attributes.thread;\n  },\n\n  _submissionSaveDraftClicked: function(e) {\n    this.saving = true;\n    this.shadowRoot.querySelector(\"#ajaxUpdateRequest\").generateRequest();\n  },\n\n  _submissionPublishClicked: function(e) {\n    this.shadowRoot.querySelector(\"#publishdialog\").open();\n  },\n\n  _submissionPublishConfirmed: function(e) {\n    this.saving = true;\n    this.shadowRoot.querySelector(\"#ajaxUpdateRequest\").generateRequest();\n  },\n\n  _submissionDeleteClicked: function(e) {\n    this.shadowRoot.querySelector(\"#deletedialog\").open();\n  },\n\n  _submissionDeleteConfirmed: function(e) {\n    this.saving = true;\n    this.$.ajaxDeleteRequest.generateRequest();\n  },\n\n  _handleUpdateResponse: function(res) {\n    var root = this;\n    var status = res.detail.response.status;\n    var submission = res.detail.response.data;\n    root.saving = false;\n    if (status === 200) {\n      root.set(\"submission\", {});\n      root.set(\"submission\", submission);\n      root.set(\"route.path\", \"\");\n      // display a submission published notification\n      if (submission.attributes.state === \"submission_ready\") {\n        this.$.toast.show(\"Published!\");\n      }\n      // @todo replace this with the page just being there once we fix the lazy load dilema\n      window.location.href = this.endPoint + \"/submissions/\" + submission.id;\n    }\n  },\n\n  _handleDeleteResponse: function(res) {\n    var root = this;\n    var status = res.detail.response.status;\n    root.saving = false;\n    if (status === 200) {\n      window.location.href = this.basePath + \"lrnapp-studio-kanban?deletetoast\";\n    }\n  },\n\n  _computeShowComments: function(submission) {\n    try {\n      var type = submission.meta.submissionType;\n      if (\n        type !== \"critique\" &&\n        submission.attributes.state == \"submission_ready\"\n      ) {\n        return true;\n      }\n    } catch (error) {}\n    return false;\n  },\n\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    if (typeof obj === \"object\" && obj !== null) {\n      return Object.keys(obj).map(function(key) {\n        return obj[key];\n      });\n    }\n    return [];\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/paper-toast/paper-toast.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\n/*\n`lrnapp-studio-submission-button`\nAllows users to either start a submission or link to a submission.\n\nUsage:\n```\n<lrnapp-studio-submission-button assignment-id=\"[[id]]\" submission-id=\"{{submissionId}}\" end-point=\"[[endPoint]]\" csrf-token=[[csrfToken]]></lrnapp-studio-submission-button>\n*/\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n    </style>\n\n    <template is=\"dom-if\" if=\"[[!submissionId]]\">\n      <lrnsys-button\n        raised=\"\"\n        on-tap=\"_createSubmission\"\n        label=\"Create submission\"\n      ></lrnsys-button>\n      <iron-ajax\n        id=\"ajaxCreateStub\"\n        url=\"[[createStubUrl]]\"\n        method=\"POST\"\n        body=\"[[assignmentId]]\"\n        handle-as=\"json\"\n        on-response=\"_ajaxCreateStubHandler\"\n      ></iron-ajax>\n    </template>\n    <template is=\"dom-if\" if=\"[[submissionId]]\">\n      <lrnsys-button\n        raised=\"\"\n        label=\"View submission\"\n        show-href=\"[[_submissionUrl(submissionId)]]\"\n        href=\"[[_submissionUrl(submissionId)]]\"\n      ></lrnsys-button>\n    </template>\n\n    <template is=\"dom-if\" if=\"[[displayErrors]]\">\n      <paper-toast id=\"toast\"></paper-toast>\n    </template>\n  `,\n\n  is: \"lrnapp-studio-submission-button\",\n\n  properties: {\n    auto: {\n      type: Boolean,\n      reflectToAttribute: true,\n      value: false,\n      notify: true\n    },\n    assignmentId: {\n      type: String,\n      reflectToAttribute: true\n    },\n    submissionId: {\n      type: String,\n      value: false,\n      reflectToAttribute: true\n    },\n    endPoint: String,\n    csrfToken: String,\n    displayErrors: {\n      type: Boolean,\n      value: true\n    }\n  },\n\n  observers: [\"_requestUrlChanged(endPoint, csrfToken)\"],\n\n  _requestUrlChanged: function(endPoint, csrfToken) {\n    this.createStubUrl =\n      endPoint + \"/api/submissions/create-stub?token=\" + csrfToken;\n  },\n\n  _createSubmission: function() {\n    this.shadowRoot.querySelector(\"#ajaxCreateStub\").generateRequest();\n  },\n\n  _ajaxCreateStubHandler: function(e) {\n    var status = e.detail.response.status;\n    var response = e.detail.response;\n    if (status === 201) {\n      var submissionId = e.detail.response.data.id;\n      if (submissionId) {\n        this.submissionId = submissionId;\n        // auto implies we should just go there to the edit form after creation\n        if (this.auto) {\n          window.location.href = this._submissionUrl(submissionId) + \"/edit\";\n        }\n      }\n    }\n    // if we have errors to display\n    if (typeof response.errors !== \"undefined\") {\n      var ul = document.createElement(\"ul\");\n      var text = \"\";\n      response.errors.forEach(function(error) {\n        text = text + \" \" + error;\n      });\n      this.shadowRoot.querySelector(\"#toast\").show(text);\n    }\n  },\n\n  _submissionUrl: function(id) {\n    return this.endPoint + \"/submissions/\" + id;\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/app-route/app-location.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@polymer/paper-toast/paper-toast.js\";\nimport \"./lrnapp-studio-submission-page.js\";\nimport \"./lrnapp-studio-submission-button.js\";\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\">\n      :host {\n        display: block;\n      }\n      paper-button {\n        padding: 0;\n        margin: 0;\n        min-width: 1rem;\n      }\n    </style>\n    <app-location route=\"{{route}}\"></app-location>\n    <app-route\n      route=\"{{route}}\"\n      pattern=\"[[endPoint]]/submissions/:submission\"\n      data=\"{{data}}\"\n      tail=\"{{tail}}\"\n    >\n    </app-route>\n\n    <template is=\"dom-if\" if=\"[[data.submission]]\">\n      <lrnapp-studio-submission-page\n        base-path=\"{{basePath}}\"\n        route=\"{{tail}}\"\n        id=\"[[data.submission]]\"\n        end-point=\"[[endPoint]]\"\n        csrf-token=\"[[csrfToken]]\"\n        data=\"{{data}}\"\n      ></lrnapp-studio-submission-page>\n    </template>\n    <template is=\"dom-if\" if=\"[[!data.submission]]\">\n      This is the lrnapp-studio-submission page.\n    </template>\n\n    <paper-toast id=\"toast\"></paper-toast>\n  `,\n\n  is: \"lrnapp-studio-submission\",\n  behaviors: [SecureRequest.xhr],\n\n  properties: {\n    activePage: {\n      type: String\n    },\n    basePath: {\n      type: String\n    },\n    endPoint: {\n      type: String\n    },\n    csrfToken: {\n      type: String\n    }\n  },\n\n  observers: [\n    \"_routeChanged(route, endPoint)\",\n    \"_updateCookies(endPoint, csrfToken)\"\n  ],\n\n  listeners: {\n    submissionDeleted: \"_handleSubmissionDeletion\",\n    displaymessage: \"_handleDisplayMessage\"\n  },\n\n  _handleRouteChange: function(event) {\n    var path = event.detail.path;\n    if (path) {\n      this.set(\"route.path\", path);\n      this.notifyPath(\"route.path\");\n    }\n  },\n\n  // If the current route is outside the scope of our app\n  // then allow the website to break out of the single page\n  // application routing\n  _routeChanged: function(route, endPoint) {\n    if (typeof route.path === \"string\") {\n      if (typeof endPoint === \"string\") {\n        if (route.path.startsWith(endPoint)) {\n          return;\n        }\n      }\n      // reload the page which since route changed will load that page\n      window.location.reload();\n    }\n  },\n\n  _handleSubmissionDeletion: function(e) {\n    var submission = e.detail.submission;\n    if (submission) {\n      this.set(\"route.path\", this.endPoint);\n      this.notifyPath(\"route.path\");\n      this.$.toast.show(\"Submission has been deleted.\");\n    }\n  },\n\n  _updateCookies: function(endPoint, csrfToken) {\n    if (endPoint && csrfToken) {\n      this.setCookies(endPoint, csrfToken);\n    }\n  },\n\n  _handleDisplayMessage: function(e, detail) {\n    if (typeof e.detail.messsage !== \"undefined\") {\n      this.$.toast.show(e.detail.message);\n    }\n  },\n\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport * as async from \"@polymer/polymer/lib/utils/async.js\";\nimport \"@polymer/iron-icons/iron-icons.js\";\nimport \"@polymer/iron-icons/hardware-icons.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/paper-icon-button/paper-icon-button.js\";\nimport \"@polymer/paper-styles/color.js\";\nimport \"@polymer/paper-tooltip/paper-tooltip.js\";\nimport \"@polymer/app-route/app-location.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@lrnwebcomponents/grid-plate/grid-plate.js\";\nimport \"@lrnwebcomponents/responsive-grid/lib/responsive-grid-row.js\";\nimport \"@lrnwebcomponents/responsive-grid/lib/responsive-grid-col.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\n/**\n * `lrnapp-book`\n * A LRN element\n *\n * @demo demo/index.html\n * @microcopy\n * - node / circle - A progress circle on the line\n * - nodes / items - the list of items in the progress bar\n * - bubble - reserved for when events fire out of an element or value is tracking events\n * - percentage - amount complete either in the bar or the nodes themselves\n * - bar - the underlayed bar that's tracking overall progression\n * - author mode - authoring mode\n */\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\">\n      :host {\n        display: block;\n        font-size: 16px;\n        box-sizing: content-box;\n      }\n      :host([loading]) #content {\n        opacity: .2;\n      }\n      #content {\n        opacity: 1;\n        visibility: visible;\n        transition: all .4s ease;\n      }\n    </style>\n    <div id=\"hackycontainer\"><style id=\"hackycsspotterhates\"></style></div>\n    <iron-ajax\n      id=\"fulloutlinepath\"\n      url=\"[[fullOutlinePath]]\"\n      handle-as=\"json\"\n      on-response=\"handleOutlineResponse\"\n      last-response=\"{{outlineData}}\"></iron-ajax>\n    <iron-ajax\n      id=\"pageajax\"\n      params=\"[[requestParams]]\"\n      url=\"[[sourcePath]]\"\n      handle-as=\"json\"\n      on-response=\"handleResponse\"\n      last-response=\"{{pageData}}\"\n      loading=\"{{_loading}}\"></iron-ajax>\n    <app-location route=\"{{route}}\" query-params=\"{{queryParams}}\"></app-location>\n    <app-route\n      route=\"{{route}}\"\n      pattern=\"[[endPoint]]/:type/:id\"\n      data=\"{{data}}\"\n      tail=\"{{tail}}\"\n      query-params=\"{{queryParams}}\">\n    </app-route>\n    <main id=\"etb-tool-nav\" data-offcanvas=\"\">\n      <div id=\"anchor\"></div>\n      <div class=\"inner-wrap\">\n        <section class=\"main-section etb-book\" style=\"min-height: 318px;\">\n          <h2 class=\"element-invisible\">Content navigation</h2>\n          <div class=\"r-header row\">\n            <div class=\"r-header__left\">\n              <div class=\"book-navigation-header book-sibling-nav-container book-navigation-header-2\">\n                <div class=\"book-navigation-header book-sibling-nav-container book-navigation-header-<?php print $count ?>\">\n                  <lrnsys-dialog id=\"outlinepopover\" data-voicecommand=\"open outline\" class=\"black-text\" hover-class=\"grey darken-3 white-text\" label=\"Outline\" header=\"Outline\">\n                    <span slot=\"button\">\n                      <iron-icon icon=\"explore\"></iron-icon>\n                      Outline\n                    </span>\n                    <div class=\"elmsln-modal-content\" id=\"block-mooc-helper-mooc-helper-toc-nav-modal\">\n                      <div id=\"outlinemodal\" on-tap=\"_modalTap\"><slot name=\"outlinemodal\"></slot></div>\n                    </div>\n                  </lrnsys-dialog>\n                  <div id=\"navigation\"><slot name=\"navigation\"></slot></div>\n                </div>\n              </div>\n            </div>\n            <div id=\"options\" class=\"r-header__right\">\n              <slot name=\"options\"></slot>\n            </div>\n          </div>\n          <div class=\"elmsln-content-wrap\" role=\"main\">\n          <responsive-grid-row gutter=\"4\">\n            <responsive-grid-col xl=\"3\" lg=\"3\" md=\"3\" sm=\"4\" xs=\"12\">\n              <section id=\"block-mooc-nav-block-mooc-nav-nav\" class=\"mooc-nav-block-left block block-mooc-nav-block contextual-links-region block-mooc-nav-block-mooc-nav column\" role=\"navigation\" aria-label$=\"[[outlineTitle]]\">\n                <div class=\"block-mooc-nav-block-mooc-title black white-text\">[[outlineTitle]]</div>\n                <div id=\"outline\"><slot name=\"outline\"></slot></div>\n              </section>\n              <div id=\"blocks\"><slot name=\"blocks\"></slot></div>\n            </responsive-grid-col>\n            <responsive-grid-col xl=\"8\" lg=\"8\" md=\"9\" sm=\"7\" xs=\"12\">\n              <a id=\"main-content\" class=\"scrollspy\" data-scrollspy=\"scrollspy\"></a>\n              <div class=\"column\">\n                <div id=\"content\"><slot name=\"content\"></slot></div>\n              </div>\n            </responsive-grid-col>\n          </responsive-grid-row>\n        </section>\n        <a class=\"exit-off-canvas\"></a>\n      </div>\n    </main>`,\n  is: \"mooc-content\",\n  observers: [\"_routeChanged(data, route, endPoint)\"],\n  properties: {\n    /**\n     * Source of data\n     */\n    sourcePath: {\n      type: String\n    },\n    /**\n     * Full outline path\n     */\n    fullOutlinePath: {\n      type: String\n    },\n    /**\n     * App route tracking.\n     */\n    route: {\n      type: Object,\n      notify: true\n    },\n    /**\n     * Title for the content\n     */\n    currentTitle: {\n      type: String\n    },\n    /**\n     * Params for the request for outline/book to load.\n     */\n    requestParams: {\n      type: Object,\n      notify: true,\n      value: {\n        node: null\n      }\n    },\n    /**\n     * Returned data for processing.\n     */\n    pageData: {\n      type: Object,\n      value: {}\n    },\n    /**\n     * Returned data for processing.\n     */\n    outlineData: {\n      type: Object,\n      value: {}\n    },\n    /**\n     * Ensure scrolling doesn't influence during a transition.\n     */\n    resetScroll: {\n      type: Boolean,\n      value: false\n    },\n    /**\n     * Store current page data.\n     */\n    responseData: {\n      type: Object,\n      value: {}\n    },\n    /**\n     * BasePath from drupal\n     */\n    basePath: {\n      type: String\n    },\n    /**\n     * elmslnCourse from drupal\n     */\n    elmslnCourse: {\n      type: String\n    },\n    /**\n     * nav title\n     */\n    outlineTitle: {\n      type: String\n    },\n    /**\n     * Node ID\n     */\n    nid: {\n      type: Number\n    },\n    /**\n     * loading pegged to the ajax call running\n     */\n    _loading: {\n      type: Boolean,\n      observer: \"_contentLoading\",\n      value: false\n    },\n    /**\n     * loading pegged to the ajax call running\n     */\n    loading: {\n      type: Boolean,\n      reflectToAttribute: true,\n      value: false\n    },\n    /**\n     * Aliases\n     */\n    aliases: {\n      type: Array\n    },\n    /**\n     * active item for tracking reference after clicks.\n     */\n    activeNodeItem: {\n      type: Object,\n      value: null\n    }\n  },\n  /**\n   * Ensure modal is closed on tap of an item.\n   */\n  _modalTap: function _modalTap(e) {\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // verify that it is a buttonß\n    if (local.tagName === \"LRNSYS-BUTTON\") {\n      if (this.activeNodeItem != null) {\n        this.activeNodeItem.classList.remove(\"book-menu-item-active\");\n      }\n      this.activeNodeItem = local;\n      this.activeNodeItem.classList.add(\"book-menu-item-active\");\n      this.$.outlinepopover.toggleDialog();\n    }\n  },\n  /**\n   * Notice loading state has changed.\n   */\n  _contentLoading: function _contentLoading(newValue, oldValue) {\n    var _this = this;\n    if (\n      (typeof newValue === \"undefined\" ? \"undefined\" : typeof newValue) !==\n        (typeof undefined === \"undefined\" ? \"undefined\" : typeof undefined) &&\n      !newValue\n    ) {\n      setTimeout(function() {\n        _this.loading = false;\n        _this._resetScroll(\"anchor\");\n        _this.$[\"main-content\"].focus();\n      }, 500);\n    } else {\n      this.loading = true;\n    }\n  },\n  /**\n   * Callback to push the data into the page.\n   */\n  handleResponse: function handleResponse(e) {\n    // handle the HTML we just got\n    if (\n      typeof this.pageData.data !==\n      (typeof undefined === \"undefined\" ? \"undefined\" : typeof undefined)\n    ) {\n      var data = this.pageData.data;\n      // test for advanced ops\n      if (\n        typeof data.ops.redirect !==\n        (typeof undefined === \"undefined\" ? \"undefined\" : typeof undefined)\n      ) {\n        this.set(\"route.path\", data.ops.redirect);\n        this._routeChanged(this.data, this.route, this.endPoint);\n      } else {\n        this.outlineTitle = data.bookOutline.subject;\n        this.$.content.innerHTML = data.content;\n        this.$.navigation.innerHTML = data.topNavigation;\n        this.$.outline.innerHTML = data.bookOutline.content;\n        this.$.options.innerHTML = data.options;\n        // inject styles, destroying previous ones\n        this.__injectStyle(data.styles);\n        // fire drupal behaviors.. this is evil. Polymer is invoking Drupal behaviors..\n        window.Drupal.attachBehaviors(document, window.Drupal.settings);\n        // first time this fires let's get the outline block in the background\n        if (\n          typeof this.outlineData.data ===\n          (typeof undefined === \"undefined\" ? \"undefined\" : typeof undefined)\n        ) {\n          this.$.fulloutlinepath.generateRequest();\n        }\n        async.microTask.run(() => {\n          window.dispatchEvent(new Event(\"resize\"));\n        });\n      }\n    }\n  },\n  /**\n   * Callback to push the data into the page.\n   */\n  handleOutlineResponse: function handleOutlineResponse(e) {\n    // handle the HTML we just got\n    var data = this.outlineData.data;\n    if (\n      (typeof data === \"undefined\" ? \"undefined\" : typeof data) !==\n      (typeof undefined === \"undefined\" ? \"undefined\" : typeof undefined)\n    ) {\n      this.$.outlinemodal.innerHTML = data.outline;\n      this.aliases = data.aliases;\n    }\n  },\n  /**\n   * If the current route is outside the scope of our app then allow\n   * the website to break out of the single page application routing.\n   *\n   * This is really critical that we get happy paths that don't trigger a redirec\n   * loop so some of the logic will seem a bit repetative but we're trying to trap\n   * may different potentially valid addresses / use-cases which still must trigger\n   * a reload within the app (without looping) and still allow outbound links to go\n   * through as they should.\n   */\n  _routeChanged: function _routeChanged(data, route, endPoint) {\n    if (typeof route.path === \"string\") {\n      // target for url alias that might be delivered into content\n      // and menu items throughout the UI\n      var urlAlias = route.path.replace(\"/\" + this.elmslnCourse + \"/\", \"\");\n      if (route.path.startsWith(\"/\" + this.elmslnCourse + \"/node/\")) {\n        var tmp = route.path.split(\"/\");\n        // ensure this is a number so we know what we're doing\n        if (\n          !isNaN(parseFloat(tmp[tmp.length - 1])) &&\n          isFinite(tmp[tmp.length - 1])\n        ) {\n          this.nid = tmp[tmp.length - 1];\n          // trigger change if data location changed\n          this.requestParams.node = this.nid;\n          // send request out the door to the actual end point\n          this.$.pageajax.generateRequest();\n          // @todo better state management in the modal itself\n          // so that we can detect if it's open or not without\n          // something stupid like this\n          // close outline dialog if it's open\n          if (this.$.outlinepopover.$.modal.opened) {\n            this.$.outlinepopover.$.modal.opened = false;\n          }\n          return;\n        } else if (tmp[tmp.length - 1] == \"edit\") {\n          window.location.reload();\n        }\n      }\n      // test for an node alias, then send off\n      else if (\n        typeof this.aliases[urlAlias] !==\n        (typeof undefined === \"undefined\" ? \"undefined\" : typeof undefined)\n      ) {\n        this.nid = this.aliases[urlAlias].replace(\"node/\", \"\");\n        // trigger change if data location changed\n        this.requestParams.node = this.nid;\n        this.$.pageajax.generateRequest();\n        // @todo better state management in the modal itself\n        // so that we can detect if it's open or not without\n        // something stupid like this\n        if (this.$.outlinepopover.$.modal.opened) {\n          this.$.outlinepopover.$.modal.opened = false;\n        }\n        return;\n      }\n      // implies front page on first load, so fix that\n      else if (urlAlias == \"\") {\n        this.requestParams.node = this.nid;\n        // ensure that we don't see this again\n        this.set(\"route.path\", \"/\" + this.elmslnCourse + \"/node/\" + this.nid);\n        this.$.pageajax.generateRequest();\n        return;\n      }\n    }\n    // ensure nothing went super wrong which may be leading to a busted site\n    // so we can avoid an infinite loop\n    if (this.elmslnCourse != \"\") {\n      // reload the page which since route changed will load that page\n      window.location.reload();\n    }\n  },\n  /**\n   * Reset scroll position visually and internally data wise.\n   */\n  _resetScroll: function _resetScroll() {\n    var item =\n      arguments.length > 0 && arguments[0] !== undefined\n        ? arguments[0]\n        : \"anchor\";\n    this.resetScroll = true;\n    this.$[item].scrollIntoView({ block: \"nearest\", behavior: \"smooth\" });\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function _toArray(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  },\n  /**\n   * Inject styles dynamically from inline CSS blocks.\n   * This is a function and capability that will drive Potter nuts.\n   * Because of this we're using the unheard of ___ convention. This\n   * means that it's such a private function that we wish we'd never\n   * actually have thought of it. Fortunately, it came from a stackoverflow\n   * article so we don't have to take credit for our own undoing with\n   * what this enables.\n   */\n  __injectStyle: function __injectStyle(style) {\n    // target and wipe our id area by force\n    if (this.shadowRoot.querySelector(\"#hackycsspotterhates\") != null) {\n      dom(this.$.hackycontainer).innerHTML = \"\";\n    }\n    // construct a new style tag and inject it overtop of what was there previously\n    var customStyle = document.createElement(\"style\", \"custom-style\");\n    customStyle.id = \"hackycsspotterhates\";\n    // inject our styles\n    customStyle.textContent = style;\n    // we have now successfully ruined something encapsulated and once beautiful\n    dom(this.$.hackycontainer).appendChild(customStyle);\n  }\n});\n"],"names":["Polymer","_template","html","is","properties","form","type","Object","value","observers","_formChanged","path","replace","propValue","fire","selectable","Boolean","reflectToAttribute","String","title","remove","e","this","filters","_filtersArray","Array","computed","_filtersArrayCompute","filtersArray","prop","f","values","split","forEach","push","icon","requestEndPoint","queryParams","_computeRequestEndPoint","endPoint","csrfToken","_filterChanged","newParams","assign","detail","_cleanParams","set","params","x","toggleSearch","searchEnabled","$","haxSource","search","toggleFilters","filterDialog","toggle","removeFilter","currentParams","newValue","_","get","filter","v","join","newCleanParams","ready","addEventListener","_this","detached","removeEventListener","_this2","listeners","uploadPath","notify","uploadTitle","hasLightbox","_uploadSuccess","event","response","JSON","parse","xhr","data","node","content","innerHTML","nid","dialog","open","routeData","observer","requestParams","sourcePath","readTimeData","userData","showProgress","_routeDataChanged","oldValue","_typeof","id","progressChanged","dataajax","generateRequest","_showProgressChanged","handleDataResponse","obj","bodyloading","hidden","userdata","dashboardItems","_toArray","items","keys","map","key","behaviors","HAXCMSBehaviors","Theme","appStoreConnection","url","progressDashboardPath","showSearch","editMode","drawerOpened","currentTitle","outlineTitle","bookTitle","soundFinish","sound","completeSound","finishedSound","scrollPosition","Number","activePage","activeOutline","outlineItems","bookItems","itemResponses","pageParams","load","outlineData","bookData","pageData","outlinePath","bookPath","pagePath","hasPrevPage","prevLabel","hasNextPage","nextLabel","resetScroll","currentPageData","manifest","rebuildOutline","fullWidth","setupHAXTheme","contentcontainer","window","SimpleToast","requestAvailability","setTimeout","_resetScroll","attached","progress","testMilestone","bind","mapmenu","_menuItemClicked","i","findIndex","j","_fullWidthChanged","updateStyles","progressdashboardopen","progressdashboard","_computePageUpdatePath","_computeCreateRequestBody","page","bid","relationships","book","pid","parent","_editModeChanged","currenttitle","contentEditable","CustomEvent","bubbles","cancelable","text","duration","evt","dispatchEvent","_activeOutlineChanged","anchor","scrollIntoView","block","behavior","inline","_activePageChanged","length","_outlineItemsChanged","percentage","console","log","_scrollChanged","metadata","max","_nextBtn","_prevBtn","toggleBook","bookdrawer","opened","_manifestChanged","notifyPath","outlineloading","_currentPageDataUpdated","slot","dom","firstChild","removeChild","tmp","document","createElement","frag","createRange","createContextualFragment","appendChild","tmp2","outerHTML","meta","canUpdate","elmslnCourses","canvasCourses","roster","queryResponse","activeCourse","collapseToggle","target","nextElementSibling","_triggerDialog","shadowRoot","querySelector","toggleDialog","sis_course_id","style","display","handleResponse","loading","handleRosterResponse","mouseenter","mouseleave","size","image","name","color","elevation","_mouseEnter","__oldElevation","_mouseLeave","_cisResponse","_courseResponse","_makeServiceResponse","courses","originalCourses","programs","academics","courseDataPath","makeServicePath","basePath","_routeChanged","route","startsWith","location","reload","_routeChange","details","course","academic","program","_handleMakeServiceResponse","__addServiceLinks","toast","show","message","_handleCourseResponse","loadingCourse","courseObject","topology","Network","services","attributes","machine_name","distro","weight","_exists","sort","a","b","_handleResponse","index","element","_makeService","active","localTarget","getAttribute","service","pop","makeservice","_activeService","confirm","_confirmBuild","body","_accessibleFocus","__rememberClick","focus","_loadCourseUrl","findCourse","_courseDataParams","courserequest","_coursesCompute","filteredCourses","root","ironlist","click","submissions","activeImage","activeTitle","activeAuthor","activeComments","activeUrl","nodeName","src","parentElement","author","comments","openUrl","_loadMoreData","clearTriggers","images","_numWidth","activeSubmission","_loadProjectRoute","local","project","_loadSubmissionUrl","href","projects","renderSubmissions","activeProjectId","activeProject","activeAuthorId","showSubmissions","_renderSubmissionsCompute","parentAssignments","steps","step","submission","includes","assignment","_activeProjectCompute","find","_showSubmissions","_getSubmissionIcon","_getSubmissionClass","_scrollToTarget","assignments","activeAssignmentId","activeAssignment","_activeAssignmentCompute","studioResponse","originalSubmissions","authors","_blockcycle","_submissionsCompute","filteredSubmissions","_deleteToast","deletetoast","old","undefined","_assignmentFilterChanged","_projectFilterChanged","_submissionsClicked","_projectsClicked","_assignmentsClicked","_tableClicked","hasProject","_getHasProject","_getViewLink","IronResizableBehavior","onHeightChange","comment","offsetHeight","btn","classList","commentTitle","actionView","dateUpdated","commentUser","wrapper","inactive","username","_getEndPoint","_getDataSource","dataPoint","dataType","dataTypeText","students","_projectData","studentParams","projectId","_studentData","elmslnCourse","elmslnSection","activeData","student","stats","activeChart","_chartChanged","_formatChartData","labels","series","parts","_dataTypeChanged","_commentIndex","_activeDataChanged","_getObjectByPosition","prevstudent","disabled","nextstudent","prevassignment","nextassignment","_projectChanged","statsdialog","datatype","studentrequest","selectedproject","selectedchart","_handleProjectResponse","_handleStudentResponse","direction","_changeActiveItem","newstudent","newassignment","add","sis","sortable_name","toString","indexOf","parseInt","_submissionStatus","assignmentComments","_submissionID","_submissionPiece","piece","state_icon","state_color","_commentCount","_setActiveSubmission","item","_setActiveComment","auto","displayErrors","createProjectsUrl","classes","_createProject","_ajaxCreateStubHandler","status","errors","error","createAssignmentUrl","iconClass","alt","hoverClass","_createAssignment","projectToDelete","assignmentToDelete","projectResponse","backendResponse","_makeProjectEditLink","_makeAssignmentEditLink","_deleteProjectDialog","_deleteTitle","_deleteText","_deleteType","delete","_handleDelete","backend","method","_deleteAssignmentDialog","displayNewBadge","count","statusToggle","relatedSubmissions","complete","submissionid","checked","assignmentFocusIn","_setToggle","buildSubmissionPath","_handleUpdateResponse","projectbackend","update","textContent","_handleProjectCreated","_handleAssignmentCreated","_endPoint","_sourcePath","_dashboardClicked","_kanbanClicked","_openstudioClicked","date","time","times","month","_isGif","embedcode","_embedClicked","_deleteClicked","thumbnail","_getThumbnail","_computeEmbedCode","_delete","SecureRequest","selectedPage","uploadUrl","_addImage","_selectPage","_handleImageUploadSuccess","file","replacement","fid","close","_deleteImage","deleteIndex","splice","generateUrl","files","fileTypes","_filesChanged","_canUpload","property","videos","newvideo","videoGenerateSourceUrl","_openDialog","tagName","video_src","prototype","call","video_url","_videoDelete","links","newlink","_createLink","_deleteLink","uploadFilesUrl","_publishClicked","_saveDraftClicked","icons","edit","_selectedPageChanged","selected","hideMenuBar","reqUrl","reqParams","commentsUrl","createStubUrl","commentOpsBase","editPage","saving","showComments","submissionDeleteClicked","submissionPublishClicked","submissionSaveDraftClicked","_backToStudio","_backToKanban","_setEditRoute","_resetRoute","_computeCommentsUrl","_computeCommentsOpsUrl","_computeCommentsStubUrl","_urlVarsChanged","_paramsChanged","token","async","run","Event","_isReply","thread","_submissionSaveDraftClicked","_submissionPublishClicked","_submissionPublishConfirmed","_submissionDeleteClicked","_submissionDeleteConfirmed","ajaxDeleteRequest","res","state","_handleDeleteResponse","_computeShowComments","submissionType","assignmentId","submissionId","_requestUrlChanged","_createSubmission","_submissionUrl","submissionDeleted","displaymessage","_handleRouteChange","_handleSubmissionDeletion","_updateCookies","setCookies","_handleDisplayMessage","messsage","fullOutlinePath","responseData","_loading","aliases","activeNodeItem","_modalTap","outlinepopover","_contentLoading","ops","redirect","bookOutline","subject","navigation","topNavigation","outline","options","__injectStyle","styles","Drupal","attachBehaviors","settings","fulloutlinepath","handleOutlineResponse","outlinemodal","urlAlias","isNaN","parseFloat","isFinite","pageajax","modal","arguments","hackycontainer","customStyle"],"mappings":"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"}