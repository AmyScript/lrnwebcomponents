{"version":3,"file":"elmsln-apps.umd.js","sources":["lib/elmsmedia-dashboard/elmsmedia-dashboard-filters.js","lib/elmsmedia-dashboard/paper-chip.js","lib/elmsmedia-dashboard/elmsmedia-dashboard-toolbar-filter.js","lib/elmsmedia-dashboard/elmsmedia-dashboard-toolbar-filters.js","lib/elmsmedia-dashboard/elmsmedia-dashboard-toolbar-button.js","lib/elmsmedia-dashboard/elmsmedia-dashboard.js","lib/elmsmedia-upload/elmsmedia-upload.js","lib/lrnapp-book/lrnapp-book-progress-dashboard.js","lib/lrnapp-book/lrnapp-book.js","lib/lrnapp-canvas-listing/lrnapp-canvas-listing.js","lib/lrnapp-cis/lrnapp-cis-course-card.js","lib/lrnapp-cis/lrnapp-cis.js","lib/lrnapp-gallery-grid/lrnapp-gallery-grid.js","lib/lrnapp-media-grid/lrnapp-media-grid.js","lib/lrnapp-media-management/lrnapp-media-management.js","lib/lrnapp-media-upload/lrnapp-media-upload.js","lib/lrnapp-open-studio/lrnapp-open-studio-table.js","lib/lrnapp-open-studio/lrnapp-open-studio-projects.js","lib/lrnapp-open-studio/lrnapp-open-studio-assignments.js","lib/lrnapp-open-studio/lrnapp-open-studio.js","lib/lrnapp-studio-dashboard/lrnapp-block-recent-project.js","lib/lrnapp-studio-dashboard/lrnapp-block-recent-submissions.js","lib/lrnapp-studio-dashboard/lrnapp-block-recent-comments-comment.js","lib/lrnapp-studio-dashboard/lrnapp-block-recent-comments.js","lib/lrnapp-studio-dashboard/lrnapp-block-need-feedback.js","lib/lrnapp-studio-dashboard/lrnapp-studio-dashboard.js","lib/lrnapp-studio-instructor/lrnapp-studio-instructor.js","lib/lrnapp-studio-kanban/lrnapp-studio-project-button.js","lib/lrnapp-studio-kanban/lrnapp-studio-assignment-button.js","lib/lrnapp-studio-kanban/lrnapp-studio-kanban.js","lib/lrnapp-studio-root/lrnapp-studio-root.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-display.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-media-editoverlay.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-edit-add-asset.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-edit-image.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-edit-images.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-edit-file.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-edit-files.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-edit-video.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-edit-links.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-edit-textarea.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-edit.js","lib/lrnapp-studio-submission/lrnapp-studio-block.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-critique-panel.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-critique.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-object.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-comment.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-comments.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-page.js","lib/lrnapp-studio-submission/lrnapp-studio-submission-button.js","lib/lrnapp-studio-submission/lrnapp-studio-submission.js","lib/mooc-content/mooc-content.js"],"sourcesContent":["import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-icon-button/paper-icon-button.js\";\nimport \"@polymer/paper-dropdown-menu/paper-dropdown-menu.js\";\nimport \"@polymer/paper-listbox/paper-listbox.js\";\nimport \"@polymer/paper-item/paper-item.js\";\nlet ElmsmediaDashboardFilters = Polymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n      paper-dropdown-menu {\n        display: block;\n        width: 100%;\n      }\n    </style>\n\n    <paper-dropdown-menu label=\"Order\">\n      <paper-listbox\n        slot=\"dropdown-content\"\n        attr-for-selected=\"name\"\n        selected=\"{{form.order}}\"\n      >\n        <paper-item name=\"ASC\">Ascending</paper-item>\n        <paper-item name=\"DESC\">Descending</paper-item>\n      </paper-listbox>\n    </paper-dropdown-menu>\n\n    <paper-dropdown-menu label=\"Media Type\">\n      <paper-listbox\n        slot=\"dropdown-content\"\n        attr-for-selected=\"name\"\n        selected=\"{{form.media_type}}\"\n      >\n        <paper-item name=\"elmsmedia_image\">Image</paper-item>\n        <paper-item name=\"h5p\">H5P</paper-item>\n        <paper-item name=\"video\">Video</paper-item>\n        <paper-item name=\"external_video\">External Video</paper-item>\n        <paper-item name=\"audio\">audio</paper-item>\n      </paper-listbox>\n    </paper-dropdown-menu>\n  `,\n\n  is: \"elmsmedia-dashboard-filters\",\n\n  properties: {\n    form: {\n      type: Object,\n      value: {}\n    }\n  },\n\n  observers: [\"_formChanged(form.*)\"],\n\n  _formChanged: function(form) {\n    const path = form.path.replace(\"form.\", \"\");\n    const propValue = form.value;\n    this.fire(\"add-filter\", {\n      path: path,\n      propValue: propValue\n    });\n  }\n});\nexport { ElmsmediaDashboardFilters };\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-styles/color.js\";\nimport \"@polymer/paper-styles/typography.js\";\n/**\nA material design [chip](https://www.google.com/design/spec/components/chips.html)\n### Example\n```html\n<paper-chip>Apples</paper-chip>\n```\n### Styling\nThe following custom properties and mixins are available for styling:\nCustom property | Description | Default\n----------------|-------------|----------\n`--paper-chip-background` | The background color of the chip | `--paper-grey-300`\n`--paper-chip-background-selectable` | The background color hover of the chip | `--paper-grey-600`\n`--paper-chip-color` | The text color | `--primary-text-color`\n`--paper-chip-color-selectable` | The text color hover of the chip | `white`\n@demo demo/chip.html\n*/\nlet PaperChip = Polymer({\n  _template: html`\n    <custom-style>\n      <style is=\"custom-style\">\n        :host {\n          display: inline-block;\n          background-color: var(--paper-chip-background, var(--paper-grey-300));\n          height: 32px;\n          line-height: 32px !important;\n          padding: 0 12px;\n          border-radius: 16px;\n          color: var(--paper-chip-color, var(--primary-text-color));\n          font-size: 13px !important;\n          @apply --paper-font-body1;\n          @apply --paper-chip;\n        }\n        :host([selectable]) {\n          cursor: pointer;\n        }\n        :host([selectable]:hover) {\n          background-color: var(\n            --paper-chip-background-selectable,\n            var(--paper-grey-400)\n          );\n        }\n      </style>\n    </custom-style>\n    <slot></slot>\n  `,\n  is: \"paper-chip\",\n  properties: {\n    selectable: {\n      type: Boolean,\n      value: false,\n      reflectToAttribute: true\n    }\n  }\n});\nexport { PaperChip };\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-icon-button/paper-icon-button.js\";\nimport \"@polymer/paper-tooltip/paper-tooltip.js\";\nimport \"./paper-chip.js\";\nlet ElmsmediaDashboardToolbarFilter = Polymer({\n  _template: html`\n    <custom-style>\n      <style is=\"custom-style\">\n        :host {\n          display: flex;\n          font-size: 0.8em;\n        }\n        paper-icon-button {\n          --paper-icon-button: {\n            height: 30px;\n            width: 30px;\n            margin-right: -12px;\n          }\n        }\n      </style>\n    </custom-style>\n    <paper-chip>\n      [[title]]\n      <paper-icon-button\n        id=\"clear\"\n        icon=\"clear\"\n        title=\"Remove filter\"\n        on-click=\"remove\"\n      ></paper-icon-button>\n    </paper-chip>\n    <paper-tooltip\n      for=\"clear\"\n      position=\"top\"\n      animation-delay=\"100\"\n      margin-top=\"5\"\n      aria-hidden=\"true\"\n      >Remove Filter</paper-tooltip\n    >\n  `,\n  is: \"elmsmedia-dashboard-toolbar-filter\",\n  properties: {\n    path: {\n      type: String,\n      value: \"\"\n    },\n    propValue: {\n      type: String,\n      value: \"\"\n    },\n    title: {\n      type: String,\n      value: \"\"\n    }\n  },\n  remove: function(e) {\n    this.fire(\"remove-filter\", {\n      path: this.path,\n      propValue: this.propValue\n    });\n  }\n});\nexport { ElmsmediaDashboardToolbarFilter };\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"./elmsmedia-dashboard-toolbar-filter.js\";\nlet ElmsmediaDashboardToolbarFilters = Polymer({\n  _template: html`\n    <style>\n      :host {\n        display: flex;\n        align-items: center;\n      }\n      elmsmedia-dashboard-toolbar-filter {\n        margin-right: 4.8px;\n      }\n    </style>\n\n    <template is=\"dom-repeat\" items=\"[[_filtersArray]]\" as=\"item\">\n      <elmsmedia-dashboard-toolbar-filter\n        path=\"[[item.path]]\"\n        prop-value=\"[[item.propValue]]\"\n        title=\"[[item.title]]\"\n      ></elmsmedia-dashboard-toolbar-filter>\n    </template>\n  `,\n\n  is: \"elmsmedia-dashboard-toolbar-filters\",\n\n  properties: {\n    filters: {\n      type: Object,\n      value: {}\n    },\n    _filtersArray: {\n      type: Array,\n      computed: \"_filtersArrayCompute(filters, filters.*)\"\n    }\n  },\n\n  _filtersArrayCompute: function(filters) {\n    let filtersArray = [];\n    for (f in filters) {\n      const prop = f;\n      // account for mulitple filter values\n      const values = filters[f].split(\",\");\n      // ignore the page property\n      if (prop !== \"page\") {\n        values.forEach(value => {\n          filtersArray.push({\n            path: prop,\n            propValue: value,\n            title: `${prop}: ${value}`\n          });\n        });\n      }\n    }\n    return filtersArray;\n  }\n});\nexport { ElmsmediaDashboardToolbarFilters };\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\nlet ElmsmediaDashboardToolbarButton = Polymer({\n  _template: html`\n    <style>\n      :host {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        opacity: 0.7;\n      }\n      #title {\n        font-size: 1em;\n        margin: 0;\n        margin-right: 0.3em;\n        padding: 0;\n      }\n    </style>\n    <paper-button id=\"button\">\n      <h3 id=\"title\">[[title]]</h3>\n      <iron-icon id=\"icon\" icon=\"[[icon]]\"></iron-icon>\n    </paper-button>\n  `,\n\n  is: \"elmsmedia-dashboard-toolbar-button\",\n\n  properties: {\n    title: {\n      type: String,\n      value: \"\"\n    },\n    icon: {\n      type: String,\n      value: \"\"\n    }\n  }\n});\nexport { ElmsmediaDashboardToolbarButton };\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@polymer/app-route/app-location.js\";\nimport \"@polymer/paper-dialog/paper-dialog.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@lrnwebcomponents/hax-body/lib/hax-app.js\";\nimport \"./elmsmedia-dashboard-filters.js\";\nimport \"./elmsmedia-dashboard-toolbar-filters.js\";\nimport \"./elmsmedia-dashboard-toolbar-button.js\";\nlet ElmsmediaDashboard = Polymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n      paper-dialog {\n        padding: 1em;\n      }\n      #toolbar {\n        display: flex;\n        justify-content: flex-end;\n        align-items: center;\n      }\n    </style>\n\n    <app-location route=\"{{route}}\"></app-location>\n    <app-route\n      route=\"{{route}}\"\n      pattern=\"/:page\"\n      data=\"{{data}}\"\n      tail=\"{{tail}}\"\n      query-params=\"{{queryParams}}\"\n    ></app-route>\n\n    <div id=\"toolbar\">\n      <elmsmedia-dashboard-toolbar-filters\n        filters=\"[[queryParams]]\"\n      ></elmsmedia-dashboard-toolbar-filters>\n      <elmsmedia-dashboard-toolbar-button\n        icon=\"filter-list\"\n        title=\"Filter\"\n        on-click=\"toggleFilters\"\n      ></elmsmedia-dashboard-toolbar-button>\n      <elmsmedia-dashboard-toolbar-button\n        icon=\"search\"\n        title=\"Search\"\n        on-click=\"toggleSearch\"\n      ></elmsmedia-dashboard-toolbar-button>\n    </div>\n\n    <paper-dialog id=\"filterDialog\" with-backdrop=\"\">\n      <h3>Filter Media</h3>\n      <elmsmedia-dashboard-filters\n        form=\"{{queryParams}}\"\n        on-filter-changed=\"_filterChanged\"\n      ></elmsmedia-dashboard-filters>\n      <div class=\"buttons\">\n        <paper-button dialog-dismiss=\"\">Dismiss dialog</paper-button>\n      </div>\n    </paper-dialog>\n\n    <hax-app\n      id=\"haxSource\"\n      auto=\"\"\n      query-param=\"title\"\n      request-end-point=\"[[requestEndPoint]]\"\n      request-params=\"{{queryParams}}\"\n      data=\"{\n      &quot;root&quot;: &quot;list&quot;,\n      &quot;gizmoType&quot;: &quot;video&quot;,\n      &quot;url&quot;: &quot;http://media.elmsln.local/entity_iframe/node/&quot;,\n      &quot;id&quot;: &quot;id&quot;,\n      &quot;title&quot;: &quot;attributes.title&quot;,\n      &quot;description&quot;: &quot;attributes.body&quot;,\n      &quot;image&quot;: &quot;display.image&quot;,\n      &quot;customGizmoType&quot;: &quot;type&quot;}\"\n    ></hax-app>\n  `,\n\n  is: \"elmsmedia-dashboard\",\n\n  properties: {\n    requestEndPoint: {\n      type: String,\n      value: \"\"\n    },\n    queryParams: {\n      type: Object,\n      value: {}\n    }\n  },\n\n  _computeRequestEndPoint: function(endPoint, csrfToken) {\n    return `${endPoint}/api/data?token=${csrfToken}`;\n  },\n\n  /**\n   * Listen for filter changes and reset the page count\n   * @todo unsetting this object does not always work\n   */\n  _filterChanged: function(e) {\n    let newParams = Object.assign({}, e.detail);\n    newParams = this._cleanParams(newParams);\n    this.set(\"queryParams\", {});\n    this.set(\"queryParams\", newParams);\n  },\n\n  /**\n   * Helper function to prepare parameters object for the url\n   * @todo this is horribly written\n   */\n  _cleanParams: function(params) {\n    let newParams = {};\n    for (x in params) {\n      const prop = x;\n      const value = params[x];\n      if (value === \"\" || value === null || value === undefined) {\n        // do nothing\n      } else {\n        // add the clean property to the new params object\n        newParams[prop] = value;\n      }\n    }\n    return newParams;\n  },\n\n  toggleSearch: function(e) {\n    const searchEnabled = this.$.haxSource.search;\n    this.$.haxSource.search = !searchEnabled;\n  },\n\n  toggleFilters: function(e) {\n    this.$.filterDialog.toggle();\n  },\n\n  removeFilter: function(path, propValue) {\n    const currentParams = Object.assign({}, this.queryParams);\n    // get the current value of the filter\n    const currentValue = _.get(currentParams, path);\n    // remove the specified filter from the current value\n    // by converting to an array and filtering it\n    const newValue = currentValue\n      .split(\",\")\n      .filter(v => v !== propValue)\n      .join(\",\");\n    const newParams = _.set(currentParams, path, newValue);\n    const newCleanParams = this._cleanParams(newParams);\n    this.set(\"queryParams\", {});\n    this.set(\"queryParams\", newCleanParams);\n  },\n\n  ready: function() {\n    this.addEventListener(\"remove-filter\", e => {\n      this.removeFilter(e.detail.path, e.detail.propValue);\n    });\n  },\n  detached: function() {\n    this.removeEventListener(\"remove-filter\", e => {\n      this.removeFilter(e.detail.path, e.detail.propValue);\n    });\n  }\n});\nexport { ElmsmediaDashboard };\n","/**\n * Copyright 2018 The Pennsylvania State University\n * @license Apache-2.0, see License.md for full text.\n */\nimport { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@vaadin/vaadin-upload/vaadin-upload.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nimport \"@polymer/paper-dialog/paper-dialog.js\";\nimport \"@polymer/app-layout/app-toolbar/app-toolbar.js\";\nimport \"@polymer/paper-dropdown-menu/paper-dropdown-menu.js\";\nimport \"@polymer/paper-listbox/paper-listbox.js\";\nimport \"@polymer/paper-item/paper-item.js\";\nimport \"@polymer/paper-checkbox/paper-checkbox.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@polymer/paper-input/paper-input.js\";\nlet ElmsMediaUpload = Polymer({\n  _template: html`\n    <custom-style>\n      <style is=\"custom-style\" include=\"materializecss-styles\">\n        :host {\n          display: block;\n        }\n        paper-button {\n          padding: 0;\n          margin: 0;\n          min-width: 1rem;\n        }\n        vaadin-upload.thick-border {\n          --primary-color: #396;\n          --dark-primary-color: #063;\n          --light-primary-color: #6c9;\n          --error-color: darkred;\n          border: 2px solid #ccc;\n          padding: 14px;\n          background: #eee;\n          border-radius: 0;\n        }\n        vaadin-upload.thick-border[dragover] {\n          border-color: #396;\n        }\n      </style>\n    </custom-style>\n    <vaadin-upload\n      target\\$=\"{{uploadPath}}\"\n      method=\"POST\"\n      form-data-name=\"file-upload\"\n      timeout=\"0\"\n      accept=\"video/mp4,image/*,audio/*,application/pdf,application/zip\"\n    ></vaadin-upload>\n    <paper-dialog\n      id=\"dialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n      with-backdrop=\"\"\n    >\n      <app-toolbar>\n        <paper-dropdown-menu label=\"Display style\">\n          <paper-listbox slot=\"dropdown-content\" class=\"dropdown-content\">\n            <paper-item value=\"image\">Image</paper-item>\n            <paper-item value=\"image__circle\">Circle</paper-item>\n          </paper-listbox>\n        </paper-dropdown-menu>\n        <paper-checkbox class=\"styled\" checked=\"{{hasLightbox}}\">\n          Lightbox <span class=\"subtitle\"> Users can click to expand </span>\n        </paper-checkbox>\n        <paper-button raised=\"\" class=\"green\">Save</paper-button>\n      </app-toolbar>\n      <h2 id=\"title\">{{uploadTitle}}</h2>\n      <paper-input\n        label=\"Title\"\n        placeholder=\"Title\"\n        value=\"{{uploadTitle}}\"\n      ></paper-input>\n      <div id=\"content\"></div>\n    </paper-dialog>\n  `,\n\n  is: \"elmsmedia-upload\",\n\n  listeners: {\n    \"upload-success\": \"_uploadSuccess\"\n  },\n\n  properties: {\n    uploadPath: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    uploadTitle: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    hasLightbox: {\n      type: Boolean,\n      reflectToAttribute: true,\n      notify: true\n    }\n  },\n\n  /**\n   * _uploadSuccess triggered after an event of a successful upload goes through\n   */\n  _uploadSuccess: function(event) {\n    // parse the raw response cause it won't be natively\n    // since event wants to tell you about the file generally\n    var response = JSON.parse(event.detail.xhr.response);\n    this.uploadTitle = response.data.node.title;\n    this.$.content.innerHTML = response.data.node.nid;\n    this.$.dialog.open();\n  }\n});\nexport { ElmsMediaUpload };\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-icons/iron-icons.js\";\nimport \"@polymer/iron-icons/hardware-icons.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/paper-icon-button/paper-icon-button.js\";\nimport \"@polymer/paper-styles/color.js\";\nimport \"@lrnwebcomponents/paper-search/lib/paper-search-bar.js\";\nimport \"@polymer/paper-tooltip/paper-tooltip.js\";\nimport \"@polymer/paper-slider/paper-slider.js\";\nimport \"@polymer/app-layout/app-layout.js\";\nimport \"@polymer/app-layout/app-drawer/app-drawer.js\";\nimport \"@polymer/app-layout/app-header/app-header.js\";\nimport \"@polymer/app-layout/app-toolbar/app-toolbar.js\";\nimport \"@polymer/app-layout/app-scroll-effects/app-scroll-effects.js\";\nimport \"@polymer/app-route/app-location.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nimport \"@lrnwebcomponents/lrndesign-stepper/lrndesign-stepper.js\";\nimport \"@lrnwebcomponents/lrnsys-progress/lrnsys-progress.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/page-scroll-position/page-scroll-position.js\";\nimport \"@lrnwebcomponents/hax-body/hax-body.js\";\nimport \"@lrnwebcomponents/material-progress/material-progress.js\";\nimport \"@lrnwebcomponents/lrndesign-mapmenu/lrndesign-mapmenu.js\";\n\n/**\n`lrnapp-book-progress-dashboard`\nA LRN element\n\n@demo demo/index.html\n\n@microcopy\n  progress - the amount the student has moved through the active item(s)\n  active item - pages of content the user is engaging with\n  stats\n\n*/\nPolymer({\n  _template: html`\n    <custom-style>\n      <style is=\"custom-style\" include=\"materializecss-styles\">\n        :host {\n          display: block;\n        }\n        paper-progress {\n          --paper-progress-active-color: var(--paper-blue-300, blue);\n          --paper-progress-secondary-color: var(--paper-yellow-300, yellow);\n          --paper-progress-container-color: var(--paper-green-300, green);\n          height: 1.5em;\n          display: inline-block;\n          vertical-align: text-top;\n        }\n        lrndesign-avatar {\n          display: inline-block;\n        }\n        lrnsys-progress-circle {\n          font-size: 4em;\n        }\n        .progress-icon {\n          height: 2.5em;\n          width: 2.5em;\n          padding: 0.25em;\n          display: inline-block;\n          color: white;\n          background-color: var(--paper-gray-300, gray);\n          border-radius: 50%;\n        }\n        .progress-row {\n          display: block;\n          width: 100%;\n        }\n        .progress-left,\n        .progress-right {\n          padding: 1em;\n          display: inline-block;\n          height: 10em;\n          vertical-align: text-top;\n        }\n        material-progress-histo {\n          width: 100%;\n          @apply (--paper-font-body2);\n        }\n        material-progress-bars {\n          width: 100%;\n          @apply (--paper-font-body2);\n        }\n        material-progress-bars > .bar > span {\n          text-align: end;\n          font-size: 0.9em;\n          @apply (--layout-flex);\n        }\n        .bar {\n          background-color: var(--paper-deep-orange-500);\n        }\n        .bar.run {\n          background-color: var(--paper-purple-500);\n        }\n        .bar.hello {\n          background-color: var(--paper-cyan-500);\n        }\n        .bar.world {\n          background-color: var(--paper-orange-500);\n        }\n      </style>\n    </custom-style>\n    <iron-ajax\n      id=\"dataajax\"\n      url=\"[[sourcePath]]\"\n      params=\"[[requestParams]]\"\n      handle-as=\"json\"\n      on-response=\"handleDataResponse\"\n      last-response=\"{{readTimeData}}\"\n    ></iron-ajax>\n\n    <div id=\"bodyloading\" class=\"loading\">\n      <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n      <h3 class=\"loading-text\">Loading content..</h3>\n    </div>\n    <div>\n      <material-progress-bars max=\"128\" bar-height=\"22\" animated=\"\">\n        <div class=\"bar\" data-value=\"21\">\n          <iron-icon icon=\"av:video-library\"></iron-icon>\n        </div>\n        <div class=\"bar run\" data-value=\"13\">\n          <iron-icon icon=\"maps:directions-run\"></iron-icon>\n        </div>\n        <div class=\"bar hello\" data-value=\"50\">\n          <iron-icon icon=\"maps:directions-bike\"></iron-icon>\n          <span>Hello</span>\n        </div>\n        <div class=\"bar world\" data-value=\"30\"><span>World</span></div>\n      </material-progress-bars>\n      <material-progress-histo bar-height=\"22\" animated=\"\">\n        <div class=\"bar\" data-value=\"21\">\n          <iron-icon icon=\"maps:directions-walk\"></iron-icon>\n        </div>\n        <div class=\"bar run\" data-value=\"13\">\n          <iron-icon icon=\"maps:directions-run\"></iron-icon>\n        </div>\n        <div class=\"bar hello\" data-value=\"50\">\n          <iron-icon icon=\"maps:directions-bike\"></iron-icon>\n          <span>Hello</span>\n        </div>\n        <div class=\"bar world\" data-value=\"30\"><span>World</span></div>\n      </material-progress-histo>\n      <template is=\"dom-repeat\" items=\"[[dashboardItems]]\" as=\"item\">\n        <div class=\"progress-row\">\n          <div class=\"progress-left\">\n            <lrnsys-progress-circle\n              status=\"disabled\"\n              class=\"flex\"\n              icon=\"[[item.meta.icon]]\"\n            ></lrnsys-progress-circle>\n          </div>\n          <div class=\"progress-right\">\n            <h3 class=\"progress-item-title\">[[item.attributes.title]]</h3>\n            <div class=\"description-content\">\n              <div>\n                <lrn-icon icon=\"network\" class=\"progress-icon\"></lrn-icon>\n                <paper-progress\n                  value=\"70\"\n                  secondary-progress=\"80\"\n                ></paper-progress>\n              </div>\n              <div>\n                <lrndesign-avatar\n                  src=\"[[userData.user.avatar]]\"\n                  label=\"[[userData.user.display_name]]\"\n                ></lrndesign-avatar>\n                <paper-progress\n                  value=\"70\"\n                  secondary-progress=\"80\"\n                ></paper-progress>\n              </div>\n            </div>\n          </div>\n        </div>\n      </template>\n    </div>\n  `,\n\n  is: \"lrnapp-book-progress-dashboard\",\n\n  properties: {\n    /**\n     * Data about the active route; this includes item type and id.\n     */\n    routeData: {\n      type: Object,\n      observer: \"_routeDataChanged\"\n    },\n    /**\n     * Params for the request for outline/book to load.\n     */\n    requestParams: {\n      type: Object,\n      value: {\n        node: null\n      }\n    },\n    /**\n     * Path to get data into the UI\n     */\n    sourcePath: {\n      type: String\n    },\n    /**\n     * Read time data\n     */\n    readTimeData: {\n      type: Object,\n      value: []\n    },\n    /**\n     * User data.\n     */\n    userData: {\n      type: Object,\n      value: []\n    },\n    /**\n     * If this is visible; useful for toggling / activating.\n     */\n    showProgress: {\n      type: Boolean,\n      value: false,\n      reflectToAttribute: true,\n      observer: \"_showProgressChanged\"\n    }\n  },\n\n  /**\n   * Notice route data has changed.\n   */\n  _routeDataChanged: function(newValue, oldValue) {\n    if (typeof newValue !== typeof undefined) {\n      this.requestParams[newValue.type] = newValue.id;\n      // if we're visible kick off the call\n      if (this.progressChanged) {\n        this.$.dataajax.generateRequest();\n      }\n    }\n  },\n\n  /**\n   * Showing element state has changed\n   */\n  _showProgressChanged: function(newValue, oldValue) {\n    // ensure we are visible\n    if (newValue && typeof this.routeData !== typeof undefined) {\n      this.$.dataajax.generateRequest();\n    }\n  },\n\n  /**\n   * Response data.\n   */\n  handleDataResponse: function(obj) {\n    let response = obj.detail.response.data;\n    // show the info\n    this.$.bodyloading.hidden = true;\n    // split the data into two sets\n    this.userData = response.userdata;\n    this.dashboardItems = this._toArray(response.items);\n  },\n\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","/**\n * Copyright 2018 The Pennsylvania State University\n * @license Apache-2.0, see License.md for full text.\n */\nimport { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport { updateStyles } from \"@polymer/polymer/lib/mixins/element-mixin.js\";\nimport \"@polymer/iron-icons/iron-icons.js\";\nimport \"@polymer/iron-icons/hardware-icons.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/paper-icon-button/paper-icon-button.js\";\nimport \"@polymer/paper-styles/color.js\";\nimport \"@lrnwebcomponents/paper-search/lib/paper-search-bar.js\";\nimport \"@polymer/paper-tooltip/paper-tooltip.js\";\nimport \"@polymer/paper-slider/paper-slider.js\";\nimport \"@polymer/app-layout/app-layout.js\";\nimport \"@polymer/app-layout/app-drawer/app-drawer.js\";\nimport \"@polymer/app-layout/app-header/app-header.js\";\nimport \"@polymer/app-layout/app-toolbar/app-toolbar.js\";\nimport \"@polymer/app-layout/app-scroll-effects/app-scroll-effects.js\";\nimport \"@polymer/app-route/app-location.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nimport \"@lrnwebcomponents/lrndesign-stepper/lrndesign-stepper.js\";\nimport \"@lrnwebcomponents/lrnsys-progress/lrnsys-progress.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/page-scroll-position/page-scroll-position.js\";\nimport \"@lrnwebcomponents/hax-body/hax-body.js\";\nimport \"@lrnwebcomponents/material-progress/material-progress.js\";\nimport \"@lrnwebcomponents/lrndesign-mapmenu/lrndesign-mapmenu.js\";\nimport \"./lrnapp-book-progress-dashboard.js\";\n/**\n`lrnapp-book`\nA LRN element\n\n@demo demo/index.html\n\n@microcopy\n  node / circle - A progress circle on the line\n  nodes / items - the list of items in the progress bar\n  bubble - reserved for when events fire out of an element or value is tracking events\n  percentage - amount complete either in the bar or the nodes themselves\n  bar - the underlayed bar that's tracking overall progression\n  author mode - authoring mode\n*/\nPolymer({\n  _template: html`\n    <custom-style>\n      <style is=\"custom-style\" include=\"materializecss-styles\">\n        :host {\n          display: block;\n          font-size: 16px;\n          box-sizing: content-box;\n        }\n        #toolbar {\n          color: gray;\n          background-color: white;\n          padding: 0 8px;\n          margin: 0;\n          height: auto;\n          box-sizing: content-box;\n          transition: all 0.4s ease;\n        }\n        paper-button {\n          padding: 0;\n          margin: 0;\n          min-width: 16px;\n        }\n        app-drawer {\n          padding: 0;\n          top: 0;\n          bottom: 0;\n          z-index: 1;\n          position: absolute;\n          box-sizing: content-box;\n          --app-drawer-content-container: {\n            background-color: #fafafa;\n            padding: 0;\n            border-right: 1px solid #c8c8c8;\n            overflow-y: scroll;\n            width: 300px !important;\n            box-shadow: 0 76px 8px 0 rgba(0, 0, 0, 0.4);\n            height: 100vh;\n            top: 0;\n            position: sticky;\n          }\n        }\n        lrndesign-stepper-button {\n          --lrndesign-stepper-btn-active: #f6f7f7;\n        }\n        lrndesign-stepper-button ::slotted(paper-button) {\n          margin: 0;\n          height: 48px;\n        }\n        lrndesign-stepper-button ::slotted(.title-container) {\n          padding: 0;\n          width: 100%;\n          right: unset;\n        }\n        lrndesign-stepper-button ::slotted(.node-title) {\n          font-size: 15px;\n          line-height: 24px;\n        }\n\n        .loading {\n          width: 100%;\n          z-index: 1000;\n          opacity: 0.9;\n          text-align: center;\n          align-content: space-around;\n          justify-content: center;\n          position: absolute;\n          background-color: white;\n          padding: 0;\n          margin: 0;\n          display: flex;\n          margin: 0 auto;\n          visibility: visible;\n          transition: visibility 1s, opacity 1s ease;\n        }\n        .loading elmsln-loading {\n          margin: 0 5em;\n          display: inline-flex;\n        }\n        #bodyloading {\n          height: 100%;\n          display: flex;\n          justify-content: center;\n        }\n        #bodyloading .loading,\n        #bodyloading elmsln-loading {\n          display: block;\n          height: 5em;\n        }\n        .outline-title {\n          margin-left: 0.5em;\n          max-width: 50%;\n        }\n        .content-nav-buttons {\n          top: 60%;\n          position: fixed;\n          opacity: 0.8;\n          padding: 0 0.25em;\n          height: 40%;\n          padding-top: 15%;\n          margin-top: -15%;\n        }\n        .content-nav-buttons:hover {\n          opacity: 1;\n        }\n        .prev {\n          left: 0;\n          order: 1;\n        }\n        .next {\n          right: 0;\n          transition: right 0.2s ease;\n          order: 2;\n        }\n        app-header {\n          width: 100%;\n          left: 0 !important;\n          z-index: 2 !important;\n          position: sticky !important;\n        }\n        app-header-layout {\n          margin: 0;\n          padding: 0;\n          width: 100%;\n        }\n        .content-body {\n          position: relative;\n          padding: 0;\n          margin: -3em 4em 5em 4em;\n          font-size: 1.1em;\n          transition: margin 0.4s ease, width 0.4s ease;\n        }\n\n        .content-nav-buttons paper-icon-button {\n          width: 4em;\n          height: 4em;\n          opacity: 0.4;\n          display: block;\n          visibility: visible;\n          transition: opacity 0.4s linear, visibility 1s linear,\n            height 0.4s ease, width 0.4s ease;\n        }\n        .content-nav-buttons paper-icon-button:hover {\n          opacity: 1;\n        }\n        paper-tooltip {\n          --paper-tooltip-opacity: 0.96;\n        }\n        :host([drawer-opened]) .content-nav-buttons paper-icon-button {\n          width: 2.5em;\n          height: 2.5em;\n        }\n        :host([edit-mode]) .content-nav-buttons {\n          opacity: 0;\n          pointer-events: none;\n          visibility: hidden;\n        }\n        .content-title {\n          font-size: 1.4em;\n          margin: 0;\n          padding: 0.25em 0;\n          background-color: white;\n          top: 70px;\n          position: sticky;\n        }\n        .content-current {\n          min-height: 100vh;\n        }\n        .content-next {\n          background-color: grey;\n          opacity: 0.8;\n        }\n        #header {\n          position: sticky;\n          top: 0;\n          left: 0;\n          width: 100%;\n          color: black;\n          background-color: white;\n          z-index: 2;\n          padding: 0;\n          margin: 0;\n          opacity: 1;\n          box-sizing: content-box;\n          transition: all 0.4s ease;\n        }\n        app-drawer-layout {\n          font-family: sans-serif;\n        }\n        :host {\n          --app-drawer-width: 300px;\n        }\n        :host([full-width]) {\n          --app-drawer-width: 0px;\n        }\n        :host([drawer-opened]) .prev,\n        :host([edit-mode]) .prev {\n          left: 17em;\n        }\n        .progress-container {\n          width: 90%;\n          padding: 0;\n          margin: 0 0 0 1em;\n          overflow: visible;\n        }\n\n        [main-title] {\n          font-weight: lighter;\n          padding: 0.6em 0 0 0;\n          margin: 0;\n          height: 3em;\n          overflow-y: scroll;\n        }\n        [hidden] {\n          visibility: hidden !important;\n          opacity: 0 !important;\n          display: block !important;\n        }\n        paper-search-bar[hidden] {\n          display: none !important;\n        }\n        lrnsys-progress {\n          margin-top: 0.5em;\n          padding: 0.2em 0 0 0;\n          box-sizing: content-box;\n        }\n        lrnsys-progress lrnsys-progress-circle {\n          list-style-type: none;\n          box-sizing: content-box;\n        }\n\n        #bookdrawercontent {\n          overflow: scroll;\n          visibility: visible;\n          display: block;\n          opacity: 1;\n          transition: visibility 1s linear, opacity 1s linear;\n        }\n        @media (max-width: 1200px) {\n          :host .content-body {\n            font-size: 0.94em;\n          }\n        }\n        @media (max-width: 960px) {\n          :host .content-body {\n            font-size: 0.92em;\n          }\n        }\n        @media (max-width: 820px) {\n          :host .content-body {\n            font-size: 0.9em;\n          }\n        }\n        @media (max-width: 700px) {\n          :host .content-body {\n            font-size: 0.9em;\n          }\n        }\n        @media (max-width: 639px) {\n          app-drawer-layout {\n            top: 0;\n          }\n          [main-title] {\n            font-size: 0.8em;\n          }\n          .content-title {\n            font-size: 1.1em;\n          }\n          .outline-title {\n            position: absolute !important;\n            clip: rect(1px 1px 1px 1px); /* IE6, IE7 */\n            clip: rect(1px, 1px, 1px, 1px);\n            overflow: hidden;\n            height: 1px;\n          }\n          :host .content-body {\n            margin: 0 0.5em;\n            font-size: 0.9em;\n            width: 85%;\n          }\n          .content-nav-buttons {\n            position: relative;\n            display: flex;\n            top: unset;\n            padding: 0;\n            opacity: 0.8;\n            height: unset;\n            margin: 0;\n          }\n          .content-nav {\n            width: 100%;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            vertical-align: middle;\n          }\n          .next {\n            right: unset;\n          }\n        }\n        @media (max-width: 500px) {\n          [main-title] {\n            font-size: 0.7em;\n          }\n        }\n        /**\n       * Authoring section\n       */\n        #editbutton {\n          position: fixed;\n          bottom: 0;\n          right: 0;\n          margin: 2em;\n          padding: 0.5em;\n          width: 1.6em;\n          height: 1.6em;\n          visibility: visible;\n          opacity: 1;\n          transition: all 0.4s ease;\n        }\n        :host([edit-mode]) #editbutton {\n          width: 100%;\n          z-index: 100;\n          right: 0;\n          bottom: 0;\n          border-radius: 0;\n          margin: 0;\n          padding: 1em;\n          background-color: var(--paper-blue-500) !important;\n        }\n        :host([edit-mode]) #header {\n          background-color: var(--paper-grey-500);\n        }\n        :host([edit-mode]) #toolbar {\n          opacity: 0.5;\n        }\n        .your-progress-button {\n          padding-right: 1em;\n        }\n        #mapmenu {\n          padding: 1em 0;\n          overflow-x: hidden;\n        }\n        .course-title-drawer {\n          font-size: 1.2em;\n        }\n        hax-autoloader {\n          display: none;\n        }\n      </style>\n    </custom-style>\n    <page-scroll-position value=\"{{scrollPosition}}\"></page-scroll-position>\n    <div id=\"anchor\"></div>\n    <iron-ajax\n      id=\"outlineajax\"\n      params=\"[[requestParams]]\"\n      url=\"[[outlinePath]]\"\n      handle-as=\"json\"\n      on-response=\"handleOutlineResponse\"\n      last-response=\"{{outlineData}}\"\n    ></iron-ajax>\n    <iron-ajax\n      id=\"bookajax\"\n      params=\"[[requestParams]]\"\n      url=\"[[bookPath]]\"\n      handle-as=\"json\"\n      on-response=\"handleBookResponse\"\n      last-response=\"{{bookData}}\"\n    ></iron-ajax>\n    <iron-ajax\n      id=\"pageajax\"\n      url=\"[[pagePath]]\"\n      params=\"[[pageParams]]\"\n      handle-as=\"json\"\n      on-response=\"handlePageResponse\"\n      last-response=\"{{pageData}}\"\n    ></iron-ajax>\n    <iron-ajax\n      id=\"pageupdateajax\"\n      url=\"[[pageUpdatePath]]\"\n      params=\"[[pageParams]]\"\n      method=\"PUT\"\n      body=\"[[updatePageData]]\"\n      content-type=\"application/json\"\n      handle-as=\"json\"\n      on-response=\"_handleUpdateResponse\"\n    ></iron-ajax>\n    <iron-ajax\n      id=\"pagedeleteajax\"\n      url=\"[[pageDeletePath]]\"\n      params=\"[[pageParams]]\"\n      method=\"DELETE\"\n      content-type=\"application/json\"\n      handle-as=\"json\"\n      on-response=\"_handleDeleteResponse\"\n    ></iron-ajax>\n    <iron-ajax\n      id=\"pagecreateajax\"\n      url=\"[[pageCreatePath]]\"\n      method=\"POST\"\n      body=\"[[createRequestBody]]\"\n      handle-as=\"json\"\n      on-response=\"_ajaxCreateStubHandler\"\n    ></iron-ajax>\n\n    <app-location\n      route=\"{{route}}\"\n      query-params=\"{{queryParams}}\"\n    ></app-location>\n    <app-route\n      route=\"{{route}}\"\n      pattern=\"[[endPoint]]/:type/:id\"\n      data=\"{{data}}\"\n      tail=\"{{tail}}\"\n      query-params=\"{{queryParams}}\"\n    >\n    </app-route>\n    <hax-store app-store=\"[[appStoreConnection]]\"></hax-store>\n    <hax-panel\n      id=\"haxpanel\"\n      hide-panel-ops=\"\"\n      hide-export-button=\"\"\n    ></hax-panel>\n    <hax-app-picker></hax-app-picker>\n    <hax-export-dialog></hax-export-dialog>\n    <!-- body where most of the heavy lifting happens -->\n    <app-drawer-layout>\n      <!-- LRNApp book we expect to navigate -->\n      <app-drawer\n        slot=\"drawer\"\n        id=\"bookdrawer\"\n        opened=\"{{drawerOpened}}\"\n        swipe-open=\"\"\n        transition-duration=\"300\"\n      >\n        <div\n          id=\"bookdrawercontent\"\n          style=\"height: 100%; overflow: auto;\"\n          hidden\\$=\"[[!bookItems]]\"\n        >\n          <paper-search-bar\n            hide-filter-button=\"\"\n            hidden\\$=\"[[!showSearch]]\"\n          ></paper-search-bar>\n          <lrndesign-mapmenu id=\"mapmenu\" on-tap=\"_bookOutlineTap\">\n            <!-- Server response will populate this -->\n          </lrndesign-mapmenu>\n        </div>\n      </app-drawer>\n      <app-header-layout>\n        <app-header slot=\"header\" id=\"header\" shadow=\"\" fixed=\"\">\n          <div id=\"outlineloading\" class=\"loading\">\n            <elmsln-loading color=\"grey-text\" size=\"medium\"></elmsln-loading>\n            <elmsln-loading color=\"grey-text\" size=\"medium\"></elmsln-loading>\n            <elmsln-loading color=\"grey-text\" size=\"medium\"></elmsln-loading>\n          </div>\n          <app-toolbar id=\"toolbar\" sticky=\"\" class=\"tall\">\n            <div style=\"pointer-events: auto;\" class=\"menu-btn-wrap\">\n              <paper-icon-button\n                style=\"pointer-events: auto;\"\n                title=\"Content outline\"\n                id=\"menubutton\"\n                icon=\"menu\"\n                on-tap=\"toggleBook\"\n              ></paper-icon-button>\n            </div>\n            <div spacer=\"\" class=\"outline-title\">[[outlineTitle]]</div>\n            <div spacer=\"\" main-title=\"\" style=\"pointer-events: auto;\">\n              <div class=\"progress-container\">\n                <lrnsys-progress\n                  sound-finish=\"[[soundFinish]]\"\n                  sound=\"[[sound]]\"\n                  complete-sound=\"[[completeSound]]\"\n                  finished-sound=\"[[finishedSound]]\"\n                  title=\"The steps to complete this lesson\"\n                  id=\"progress\"\n                  active=\"{{activePage}}\"\n                  items=\"{{outlineItems}}\"\n                  progressive-unlock=\"\"\n                  size=\"small\"\n                ></lrnsys-progress>\n              </div>\n            </div>\n            <!-- <div class=\"your-progress-button\">\n              <lrnsys-dialog body-append modal on-tap=\"progressdashboardopen\" header=\"Your progress\" alt=\"Your progress\">\n                <span slot=\"button\"><iron-icon icon=\"av:equalizer\"></iron-icon></span>\n                <div>\n                  <lrnapp-book-progress-dashboard id=\"progressdashboard\" source-path=\"[[progressDashboardPath]]\" route-data=\"[[data]]\"></lrnapp-book-progress-dashboard>\n                </div>\n              </lrnsys-dialog>\n            </div> -->\n          </app-toolbar>\n        </app-header>\n        <div class=\"content-body\">\n          <div id=\"current\" class=\"content-current\">\n            <h2 id=\"currenttitle\" class=\"content-title\">[[currentTitle]]</h2>\n            <div id=\"bodyloading\" class=\"loading\">\n              <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n              <h3 class=\"loading-text\">Loading content..</h3>\n            </div>\n            <div>\n              <hax-body id=\"haxbody\"> <slot id=\"slottedarea\"></slot> </hax-body>\n            </div>\n          </div>\n        </div>\n        <div class=\"content-nav\">\n          <div class=\"content-nav-buttons next\">\n            <paper-icon-button\n              id=\"next\"\n              title=\"[[nextLabel]]\"\n              on-tap=\"_nextBtn\"\n              icon=\"hardware:keyboard-arrow-right\"\n              data-voicecommand=\"next page\"\n              hidden\\$=\"[[!hasNextPage]]\"\n            ></paper-icon-button>\n            <paper-tooltip\n              for=\"next\"\n              position=\"left\"\n              offset=\"0\"\n              animation-delay=\"100\"\n            >\n              [[nextLabel]]\n            </paper-tooltip>\n          </div>\n          <div class=\"content-nav-buttons prev\">\n            <paper-icon-button\n              id=\"prev\"\n              title=\"[[prevLabel]]\"\n              on-tap=\"_prevBtn\"\n              icon=\"hardware:keyboard-arrow-left\"\n              data-voicecommand=\"previous page\"\n              hidden\\$=\"[[!hasPrevPage]]\"\n            ></paper-icon-button>\n            <paper-tooltip\n              for=\"prev\"\n              position=\"right\"\n              offset=\"0\"\n              animation-delay=\"100\"\n            >\n              [[prevLabel]]\n            </paper-tooltip>\n          </div>\n        </div>\n      </app-header-layout>\n    </app-drawer-layout>\n    <hax-manager></hax-manager>\n    <!-- edit mode if they have permissions -->\n    <paper-fab\n      id=\"editbutton\"\n      icon=\"editor:mode-edit\"\n      class=\"red white-text\"\n      hidden\\$=\"[[!currentPageData.page.meta.canUpdate]]\"\n      data-voicecommand=\"Edit content\"\n      on-tap=\"_toggleEditMode\"\n      title=\"Tap to place content in edit mode.\"\n    ></paper-fab>\n    <paper-tooltip\n      for=\"editbutton\"\n      position=\"bottom\"\n      offset=\"8\"\n      animation-delay=\"100\"\n    >\n      <span id=\"fablabel\">edit mode</span>\n    </paper-tooltip>\n    <paper-toast id=\"toast\" horizontal-align=\"left\"></paper-toast>\n    <hax-autoloader>\n      <magazine-cover></magazine-cover>\n      <video-player></video-player>\n      <lrn-table></lrn-table>\n      <media-image></media-image>\n      <lrndesign-blockquote></lrndesign-blockquote>\n      <meme-maker></meme-maker>\n      <a11y-gif-player></a11y-gif-player>\n      <paper-audio-player></paper-audio-player>\n      <wikipedia-query></wikipedia-query>\n      <wave-player></wave-player>\n      <pdf-element></pdf-element>\n      <place-holder></place-holder>\n      <lrn-vocab></lrn-vocab>\n      <code-editor></code-editor>\n      <lrn-math></lrn-math>\n      <citation-element></citation-element>\n    </hax-autoloader>\n  `,\n\n  is: \"lrnapp-book\",\n  observers: [\"_routeChanged(data, route, endPoint)\"],\n  properties: {\n    /**\n     * App store connection.\n     */\n    appStoreConnection: {\n      type: Object,\n      value: {\n        url:\n          \"/sing100/sites/all/libraries/webcomponents/polymer/apps-src/lrnapp-book/appstore.json\"\n      }\n    },\n    /**\n     * Path for getting progress dashboard data\n     */\n    progressDashboardPath: {\n      type: String\n    },\n    /**\n     * Option to display the search bar.\n     */\n    showSearch: {\n      type: Boolean,\n      reflectToAttribute: true,\n      value: false\n    },\n    /**\n     * Request body parameters for creating a new item.\n     */\n    createRequestBody: {\n      type: Object,\n      computed: \"_computeCreateRequestBody(currentPageData)\"\n    },\n    /**\n     * Data to be shipped off to the update endpoint.\n     */\n    updatePageData: {\n      type: Object,\n      value: {\n        id: null,\n        type: null,\n        attributes: {}\n      }\n    },\n    /**\n     * Path for updating content.\n     */\n    pageUpdatePath: {\n      type: String,\n      computed: \"_computePageUpdatePath(data, sourcePath)\"\n    },\n    /**\n     * Source path to the 'find one' end point\n     */\n    sourcePath: {\n      type: String\n    },\n    /**\n     * Edit / authoring mode.\n     */\n    editMode: {\n      type: Boolean,\n      value: false,\n      reflectToAttribute: true,\n      observer: \"_editModeChanged\"\n    },\n    /**\n     * Binding so we can style based on drawer status\n     * @type {Object}\n     */\n    drawerOpened: {\n      type: Boolean,\n      value: true,\n      reflectToAttribute: true\n    },\n    /**\n     * App route tracking.\n     */\n    route: {\n      type: Object,\n      notify: true\n    },\n    /**\n     * Title for the content\n     */\n    currentTitle: {\n      type: String\n    },\n    /**\n     * Title for the top of the bar\n     */\n    outlineTitle: {\n      type: String\n    },\n    /**\n     * Title for the top of the bar\n     */\n    bookTitle: {\n      type: String,\n      value: \"Course outline\"\n    },\n    /**\n     * If the sound should play on finish.\n     */\n    soundFinish: {\n      type: Boolean,\n      value: true\n    },\n    /**\n     * If the sound should play on complete.\n     */\n    sound: {\n      type: Boolean,\n      value: true\n    },\n    /**\n     * Completing a step sound.\n     */\n    completeSound: {\n      type: String,\n      value: \"\"\n    },\n    /**\n     * Finished sound file.\n     */\n    finishedSound: {\n      type: String,\n      value: \"\"\n    },\n    /**\n     * Distance through the present document so we can visualize\n     */\n    scrollPosition: {\n      type: Number,\n      value: 0,\n      observer: \"_scrollChanged\"\n    },\n    /**\n     * Track the active page exposed from the progress bar.\n     */\n    activePage: {\n      type: Number,\n      value: 0,\n      observer: \"_activePageChanged\"\n    },\n    /**\n     * Track the active outline to load data for the progress bar.\n     */\n    activeOutline: {\n      type: Number,\n      value: 0,\n      observer: \"_activeOutlineChanged\"\n    },\n    /**\n     * List of items in our outline presently.\n     */\n    outlineItems: {\n      type: Array,\n      value: [],\n      notify: true,\n      observer: \"_outlineItemsChanged\"\n    },\n    /**\n     * List of items in our book presently.\n     */\n    bookItems: {\n      type: Array,\n      value: [],\n      notify: true\n    },\n    /**\n     * Item responses.\n     */\n    itemResponses: {\n      type: Array,\n      value: []\n    },\n    /**\n     * Params for the request for outline/book to load.\n     */\n    requestParams: {\n      type: Object,\n      notify: true,\n      value: {\n        node: null\n      }\n    },\n    /**\n     * Params for the request for content to load.\n     */\n    pageParams: {\n      type: Object,\n      notify: true,\n      value: {\n        load: false\n      }\n    },\n    /**\n     * Returned data for processing.\n     */\n    outlineData: {\n      type: Object,\n      notify: true\n    },\n    /**\n     * Returned data for processing.\n     */\n    bookData: {\n      type: Object,\n      notify: true\n    },\n    /**\n     * Returned data for processing.\n     */\n    pageData: {\n      type: Object,\n      notify: true\n    },\n    /**\n     * data pathway that expects the present outline returned.\n     */\n    outlinePath: {\n      type: String\n    },\n    /**\n     * data pathway that expects the book chapters returned.\n     */\n    bookPath: {\n      type: String\n    },\n    /**\n     * data pathway that expects the book chapters returned.\n     */\n    pagePath: {\n      type: String\n    },\n    /**\n     * Simple flag for having the previous button show.\n     */\n    hasPrevPage: {\n      type: Boolean,\n      notify: true\n    },\n    /**\n     * Previous page title.\n     */\n    prevLabel: {\n      type: String\n    },\n    /**\n     * Simple flag for having the next button show.\n     */\n    hasNextPage: {\n      type: Boolean,\n      notify: true\n    },\n    /**\n     * Next page title.\n     */\n    nextLabel: {\n      type: String\n    },\n    /**\n     * Ensure scrolling doesn't influence during a transition.\n     */\n    resetScroll: {\n      type: Boolean,\n      value: false\n    },\n    /**\n     * Store current page data.\n     */\n    currentPageData: {\n      type: Object,\n      value: {},\n      observer: \"_currentPageDataUpdated\"\n    },\n    /**\n     * Store current page data.\n     */\n    responseData: {\n      type: Object,\n      value: {}\n    },\n    /**\n     * Rebuild outline flag so we know to call it on page build.\n     */\n    rebuildOutline: {\n      type: Boolean,\n      value: false\n    },\n    /**\n     * Track if we should go full width or not.\n     */\n    fullWidth: {\n      type: Boolean,\n      reflectToAttribute: true,\n      value: false,\n      observer: \"_fullWidthChanged\"\n    }\n  },\n\n  /**\n   * Ready event.\n   */\n  ready: function(e) {\n    this.$.bodyloading.hidden = true;\n    // fire an outline request to kick things off!\n    this.$.outlineajax.generateRequest();\n\n    // scroll top into view\n    setTimeout(() => {\n      this._resetScroll();\n    }, 500);\n  },\n  /**\n   * attached life cycle\n   */\n  attached: function() {\n    this.$.progress.addEventListener(\n      \"node-percent-milestone\",\n      this.testMilestone.bind(this)\n    );\n    this.$.haxpanel.addEventListener(\n      \"hax-content-insert\",\n      this._haxContentInsert.bind(this)\n    );\n    this.addEventListener(\"route-change\", this._routeChange.bind(this));\n  },\n  /**\n   * detached life cycle\n   */\n  detached: function() {\n    this.$.progress.removeEventListener(\n      \"node-percent-milestone\",\n      this.testMilestone.bind(this)\n    );\n    this.$.haxpanel.removeEventListener(\n      \"hax-content-insert\",\n      this._haxContentInsert.bind(this)\n    );\n    this.removeEventListener(\"route-change\", this._routeChange.bind(this));\n  },\n  /**\n   * When element is told to be full width it'll close things.\n   */\n  _fullWidthChanged: function(newValue, oldValue) {\n    this.updateStyles();\n  },\n  /**\n   * Handle click on dashboard to trigger loading data.\n   */\n  progressdashboardopen: function(e) {\n    this.$.progressdashboard.showProgress = true;\n  },\n\n  /**\n   * Generate path to point to the right endpoint for updating items.\n   */\n  _computePageUpdatePath: function(data, sourcePath) {\n    return sourcePath.replace(\"%\", data.id);\n  },\n\n  /**\n   * HAX Content Insert.\n   */\n  _haxContentInsert: function(e) {\n    var properties = {};\n    // support for properties to be set automatically optionally\n    if (typeof e.detail.properties !== typeof undefined) {\n      properties = e.detail.properties;\n    }\n    this.$.haxbody.haxInsert(e.detail.tag, e.detail.content, properties);\n  },\n\n  /**\n   * Calculate what would happen if we added a page here.\n   */\n  _computeCreateRequestBody: function(currentPageData) {\n    if (typeof currentPageData.page !== typeof undefined) {\n      return {\n        bid: currentPageData.page.relationships.book.id,\n        pid: currentPageData.page.relationships.parent.id\n      };\n    }\n  },\n\n  /**\n   * Simple state toggle for edit button being pressed.\n   */\n  _toggleEditMode: function(e) {\n    this.editMode = !this.editMode;\n  },\n\n  /**\n   * React when state changes for editMode\n   */\n  _editModeChanged: function(newValue, oldValue) {\n    if (typeof newValue !== typeof undefined) {\n      if (newValue === true) {\n        // update the button to be for saving state\n        this.$.editbutton.icon = \"save\";\n        this.$.editbutton.title = \"Tap to save content and exit edit mode\";\n        this.$.fablabel = \"save changes\";\n        // open the haxpanel\n        window.HaxStore.write(\"editMode\", this.editMode, this);\n        // play things in an editable state and let hax take over from here\n        this.$.currenttitle.contentEditable = true;\n        // block scroll tracking during edit mode\n        this.resetScroll = true;\n        // notification to user\n        this.$.toast.show(\"Authoring mode active\");\n      } else {\n        // reset visuals\n        this.$.editbutton.icon = \"editor:mode-edit\";\n        this.$.editbutton.title = \"Tap to place content in edit mode.\";\n        this.$.fablabel = \"edit mode\";\n        // open the haxpanel\n        window.HaxStore.write(\"editMode\", this.editMode, this);\n        // play things in an editable state and let hax take over from here\n        this.$.currenttitle.contentEditable = false;\n        // allow scrolling to take place now\n        this.resetScroll = false;\n        // we were in edit mode, now time to save for real\n        if (oldValue === true) {\n          let updated = false;\n          // get computed / cleaned up content area\n          let haxcontent = this.$.haxbody.haxToContent();\n          // see if title changed\n          if (this.$.currenttitle.innerHTML !== this.currentPageData.title) {\n            this.currentPageData.title = this.$.currenttitle.innerHTML;\n            this.updatePageData.attributes.title = this.currentPageData.title;\n          }\n          // see if content updated\n          if (this.currentPageData.content !== haxcontent) {\n            this.currentPageData.content = haxcontent;\n            this.updatePageData.attributes.body = this.currentPageData.content;\n            updated = true;\n          }\n          // see if we've changed anything in order to ship off\n          if (updated) {\n            // set type and id data from routing and ship this off!\n            this.updatePageData.type = this.data.type;\n            this.updatePageData.id = this.data.id;\n            this.$.toast.show(\"Saving...\");\n            this.$.pageupdateajax.generateRequest();\n          }\n        }\n      }\n    }\n  },\n\n  /**\n   * Get response back from the server on updating this content.\n   */\n  _handleUpdateResponse: function(e) {\n    // @todo error checking here\n    this.$.toast.show(\"Saved!\");\n  },\n\n  /**\n   * Change the activeOutline\n   */\n  _bookOutlineTap: function(e) {\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // support switching if the thing clicked has a book index associated\n    if (typeof local.getAttribute(\"data-book-parent\") !== typeof undefined) {\n      this.activeOutline = local.getAttribute(\"data-book-parent\");\n    }\n  },\n\n  /**\n   * A book level button was pressed, we need to invoke a change of\n   * content as well as outline.\n   */\n  _activeOutlineChanged: function(newValue, oldValue) {\n    if (\n      typeof newValue !== typeof undefined &&\n      typeof oldValue !== typeof undefined\n    ) {\n      // trigger loading state\n      this.rebuildOutline = true;\n    }\n  },\n\n  /**\n   * If the current route is outside the scope of our app then allow\n   * the website to break out of the single page application routing.\n   */\n  _routeChanged: function(data, route, endPoint) {\n    if (typeof route.path === \"string\") {\n      if (typeof endPoint === \"string\") {\n        if (route.path.startsWith(endPoint)) {\n          // trigger change if data location changed\n          if (\n            this.pageParams.load != false &&\n            typeof data.type !== typeof undefined &&\n            typeof data.id !== typeof undefined\n          ) {\n            // prime the page request parameters\n            this.pageParams[data.type] = data.id;\n            // test if we already have this request\n            if (\n              typeof this.responseData[data.type + data.id] !== typeof undefined\n            ) {\n              this.set(\n                \"currentPageData\",\n                this.responseData[data.type + data.id]\n              );\n            } else {\n              // trigger loading state\n              this.$.bodyloading.hidden = false;\n              // send request out the door to the actual end point\n              this.$.pageajax.generateRequest();\n            }\n            // support for being told to rebuild the outline\n            if (this.rebuildOutline) {\n              // dirty rebuild of params\n              this.set(\"requestParams\", []);\n              // our page params have the current page in scope\n              this.set(\"requestParams\", this.pageParams);\n              // test if we already have this request\n              if (\n                typeof this.responseData[\n                  data.type + \".\" + data.id + \".outline\"\n                ] !== typeof undefined\n              ) {\n                this.activePage = 0;\n                this.set(\"outlineItems\", []);\n                this.set(\n                  \"outlineItems\",\n                  this._toArray(\n                    this.responseData[data.type + \".\" + data.id + \".outline\"]\n                      .items\n                  )\n                );\n                this.set(\n                  \"outlineTitle\",\n                  this.responseData[data.type + \".\" + data.id + \".outline\"]\n                    .items.outlineTitle\n                );\n              } else {\n                this.$.outlineloading.hidden = false;\n                this.pageParams.load = false;\n                // send request out the door to the actual end point\n                this.$.outlineajax.generateRequest();\n              }\n              this.rebuildOutline = false;\n            }\n          }\n          return;\n        }\n      }\n      // reload the page which since route changed will load that page\n      window.location.reload();\n    }\n  },\n\n  /**\n   * Reset scroll position visually and internally data wise.\n   */\n  _resetScroll: function() {\n    this.resetScroll = true;\n    this.scrollPosition = 0;\n    this.$.anchor.scrollIntoView({\n      block: \"start\",\n      behavior: \"smooth\",\n      inline: \"nearest\"\n    });\n  },\n\n  /**\n   * React to active page being changed.\n   */\n  _activePageChanged: function(newValue, oldValue) {\n    if (typeof newValue !== typeof undefined) {\n      if (typeof this.outlineItems !== typeof undefined) {\n        this.set(\"route.path\", this.outlineItems[newValue].url);\n        // ensure that we clear any previously set update data\n        this.updatePageData.attributes = {};\n        this.updatePageData.id = null;\n        this.updatePageData.type = null;\n      }\n      // scroll into view the container that's about to be swapped out\n      if (typeof oldValue !== typeof undefined) {\n      }\n      // ensure that scrolling percentage doesn't increase the next item\n      // while active is being changed\n      setTimeout(() => {\n        this.resetScroll = false;\n      }, 1000);\n\n      // manage the previous page button on the UI\n      if (newValue == 0) {\n        this.hasPrevPage = false;\n      } else {\n        this.hasPrevPage = true;\n        if (typeof this.outlineItems !== typeof undefined) {\n          this.prevLabel = this.outlineItems[newValue - 1].title;\n        }\n      }\n      // manage next page button on the UI\n      if (\n        typeof this.outlineItems !== typeof undefined &&\n        newValue + 1 == this.outlineItems.length\n      ) {\n        this.hasNextPage = false;\n      } else {\n        this.hasNextPage = true;\n        if (typeof this.outlineItems !== typeof undefined) {\n          this.nextLabel = this.outlineItems[newValue + 1].title;\n        }\n      }\n    }\n  },\n\n  /**\n   * React to items being changed.\n   */\n  _outlineItemsChanged: function(newValue, oldValue) {\n    // these need set immediately\n    if (typeof newValue !== typeof undefined && newValue.length != 0) {\n      // manage the previous page button on the UI\n      if (this.activePage != 0) {\n        this.prevLabel = newValue[this.activePage - 1].title;\n      }\n      // manage next page button on the UI\n      if (this.activePage + 1 != newValue.length) {\n        this.nextLabel = newValue[this.activePage + 1].title;\n      }\n    }\n  },\n\n  /**\n   * Test what milestone has been hit and if we should start to preload\n   * items as a result of it!\n   */\n  testMilestone: function(e) {\n    // we should preload the next page\n    if (e.detail.percentage == 75) {\n      console.log(\n        \"@todo preload the next page and present grayed out right of UI.\"\n      );\n    }\n  },\n\n  /**\n   * Pass down scroll change to the element for progress visualization.\n   */\n  _scrollChanged: function(newValue, oldValue) {\n    // only evaluate scroll if value is greater then previous\n    if (\n      typeof this.outlineItems !== typeof undefined &&\n      typeof this.outlineItems[this.activePage] !== typeof undefined &&\n      newValue > this.outlineItems[this.activePage].value &&\n      !this.resetScroll\n    ) {\n      // once we get 90% of the way through the material consider it finished\n      if (newValue >= 75) {\n        this.outlineItems[this.activePage].value = this.outlineItems[\n          this.activePage\n        ].max;\n        this.set(\n          \"outlineItems.\" + this.activePage + \".value\",\n          this.outlineItems[this.activePage].max\n        );\n      } else {\n        this.outlineItems[this.activePage].value = newValue;\n        this.set(\"outlineItems.\" + this.activePage + \".value\", newValue);\n      }\n    }\n  },\n\n  /**\n   * Pass down the click to the next page if we have one\n   */\n  _nextBtn: function(e) {\n    // make sure we are able to move forward more\n    if (this.activePage < this.outlineItems.length - 1) {\n      this.set(\n        \"outlineItems.\" + this.activePage + \".value\",\n        this.outlineItems[this.activePage].max\n      );\n      this.activePage = this.activePage + 1;\n    }\n  },\n\n  /**\n   * Pass down the click to the prev page if we have one\n   */\n  _prevBtn: function(e) {\n    if (this.activePage > 0) {\n      this.activePage = this.activePage - 1;\n    }\n  },\n\n  /**\n   * Toggle the book drawer\n   */\n  toggleBook: function(e) {\n    // if we are in edit mode then we ned to close this\n    this.$.bookdrawer.toggle();\n    this.fullWidth = !this.$.bookdrawer.opened;\n  },\n\n  /**\n   * Handle the response.\n   */\n  handleOutlineResponse: function(obj) {\n    if (typeof obj !== typeof undefined) {\n      const response = obj.detail.response.data;\n      const items = this._toArray(obj.detail.response.data.items);\n      const outlineTitle = obj.detail.response.data.outlineTitle;\n      // set active to 0 because once we update the outlineItems it will try to\n      // pick a title and be out of sync for a moment in time\n      if (this.activePage !== 0) {\n        this.activePage = 0;\n      }\n      // store the response for the outline object data to skip future calls\n      this.set(\n        \"responseData.\" + this.data.type + \".\" + this.data.id + \".outline\",\n        response\n      );\n      // set outline items to repaint, aggressively\n      this.set(\"outlineItems\", []);\n      this.set(\"outlineItems\", items);\n      // set title to match new parent title\n      this.set(\"outlineTitle\", outlineTitle);\n      var activePage = 0;\n      // see if we can find a match of routing for an active page\n      for (var i in items) {\n        // we have a match; usually this would only happen on initial page load\n        if (\n          this.data.type === items[i].type &&\n          this.data.id === items[i].id &&\n          i !== 0\n        ) {\n          activePage = parseInt(i);\n        }\n      }\n      if (activePage !== 0) {\n        this.activePage = activePage;\n      }\n      this.$.outlineloading.hidden = true;\n      this.pageParams.load = true;\n      // only repopulate the first time\n      if (this.bookItems.length === 0) {\n        this.$.bookajax.generateRequest();\n        // kick off page request to since we paint it into slot early\n        // this allows us to do admin user perm checking on initial load\n        this.pageParams = this.requestParams;\n        this.$.pageajax.generateRequest();\n      }\n    }\n  },\n\n  /**\n   * Handle the response.\n   */\n  handleBookResponse: function(obj) {\n    const response = obj.detail.response.data;\n    this.set(\"bookItems\", this._toArray(response.items));\n    // rip the items into the DOM\n    // @todo might need to do the append HTML trick\n    this.$.mapmenu.innerHTML = response.render;\n  },\n\n  /**\n   * Page response callback.\n   */\n  handlePageResponse: function(obj) {\n    if (typeof obj !== typeof undefined) {\n      const response = obj.detail.response.data;\n      this.set(\"responseData.\" + this.data.type + this.data.id, response);\n      this.set(\"currentPageData\", response);\n    }\n  },\n\n  /**\n   * Handle page object getting updated. This allows\n   * for updating parts of the page either from the localcache\n   * or from the ajax call.\n   */\n  _currentPageDataUpdated: function(newValue, oldValue) {\n    if (\n      typeof newValue !== typeof undefined &&\n      typeof newValue.content !== typeof undefined\n    ) {\n      // set page title; easiest for sure\n      this.set(\"currentTitle\", newValue.title);\n      // when updating data we need to clear the slot's content\n      // while maintaining the data model correctly\n      let slot = dom(this.$.haxbody);\n      while (slot.firstChild !== null) {\n        slot.removeChild(slot.firstChild);\n      }\n      // add HTML to a div which makes it's DOM unpack\n      var tmp = document.createElement(\"div\");\n      let frag = document\n        .createRange()\n        .createContextualFragment(newValue.content);\n      tmp.appendChild(frag);\n      // trap for text without wrapping HTML tags\n      if (tmp.firstChild == null) {\n        var tmp2 = document.createElement(\"p\");\n        tmp2.innerHTML = tmp.innerHTML;\n        tmp = document.createElement(\"div\");\n        tmp.innerHTML = tmp2.outerHTML;\n      } else if (typeof tmp.firstChild.length !== typeof undefined) {\n        var tmp2 = document.createElement(\"p\");\n        tmp2.innerHTML = tmp.innerHTML;\n        tmp = document.createElement(\"div\");\n        tmp.innerHTML = tmp2.outerHTML;\n      }\n      // same as above but in reverse; now take stuf from what\n      // came across and correctly add it into the slot\n      while (tmp.firstChild) {\n        dom(this.$.haxbody).appendChild(tmp.firstChild);\n      }\n      // reset scroll position back to top of this content\n      this._resetScroll();\n      // hide the loading area\n      this.$.bodyloading.hidden = true;\n      // manage state associated w/ edit mode if we were in edit mode previously\n      if (this.editMode && !newValue.page.meta.canUpdate) {\n        this.editMode = false;\n      }\n    }\n  },\n\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-column-group.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-filter.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-sorter.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-selection-column.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/iron-image/iron-image.js\";\nimport \"@polymer/paper-tooltip/paper-tooltip.js\";\nimport \"@lrnwebcomponents/lrnsys-layout/lib/lrnsys-dialog.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/lrndesign-avatar/lrndesign-avatar.js\";\n\nPolymer({\n  _template: html`\n    <custom-style>\n      <style is=\"custom-style\" include=\"materializecss-styles\">\n        :host {\n          display: block;\n          margin: 0 2em;\n        }\n        .loading {\n          width: 100%;\n          z-index: 1000;\n          opacity: 0.8;\n          text-align: center;\n          align-content: center;\n          justify-content: center;\n          height: 100vh;\n          position: absolute;\n          background-color: white;\n        }\n        vaadin-grid#material {\n          height: 75vh;\n          font-family: Roboto, sans-serif;\n          --divider-color: rgba(0, 0, 0, var(--dark-divider-opacity));\n\n          --vaadin-grid-cell: {\n            padding: 0;\n          }\n\n          --vaadin-grid-header-cell: {\n            height: 3.5em;\n            color: rgba(0, 0, 0, var(--dark-secondary-opacity));\n            font-size: 1em;\n          }\n\n          --vaadin-grid-body-cell: {\n            height: 3em;\n            color: rgba(0, 0, 0, var(--dark-primary-opacity));\n            font-size: 0.8em;\n          }\n\n          --vaadin-grid-body-row-hover-cell: {\n            background-color: var(--paper-grey-200);\n          }\n\n          --vaadin-grid-body-row-selected-cell: {\n            background-color: var(--paper-grey-100);\n          }\n\n          --vaadin-grid-focused-cell: {\n            box-shadow: none;\n            font-weight: bold;\n          }\n        }\n\n        vaadin-grid#material .cell {\n          overflow: hidden;\n          text-overflow: ellipsis;\n          padding-right: 56px;\n        }\n\n        vaadin-grid#material .cell.last {\n          padding-right: 24px;\n        }\n\n        vaadin-grid#material .cell.numeric {\n          text-align: right;\n        }\n\n        vaadin-grid#material paper-checkbox {\n          --primary-color: var(--paper-indigo-500);\n          margin: 0 24px;\n        }\n\n        vaadin-grid#material vaadin-grid-sorter {\n          --vaadin-grid-sorter-arrow: {\n            display: none !important;\n          }\n        }\n\n        vaadin-grid#material vaadin-grid-sorter .cell {\n          flex: 1;\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n        }\n\n        vaadin-grid#material vaadin-grid-sorter iron-icon {\n          transform: scale(0.8);\n        }\n\n        vaadin-grid#material vaadin-grid-sorter:not([direction]) iron-icon {\n          color: rgba(0, 0, 0, var(--dark-disabled-opacity));\n        }\n\n        vaadin-grid#material vaadin-grid-sorter[direction] {\n          color: rgba(0, 0, 0, var(--dark-primary-opacity));\n        }\n\n        vaadin-grid#material vaadin-grid-sorter[direction=\"desc\"] iron-icon {\n          transform: scale(0.8) rotate(180deg);\n        }\n        vaadin-grid-sorter {\n          text-align: center;\n        }\n        lrndesign-avatar {\n          display: inline-flex;\n        }\n        lrnsys-dialog {\n          display: inline-flex;\n        }\n        lrnsys-dialog #dialog-trigger span {\n          pointer-events: none;\n        }\n        .avatar-name {\n          line-height: 2em;\n          margin: 0;\n          display: inline-block;\n        }\n        .listing-select {\n          display: block;\n          height: 100%;\n          margin: 0;\n          width: 100%;\n        }\n      </style>\n    </custom-style>\n    <iron-ajax\n      auto\n      url=\"[[sourcePath]]\"\n      params=\"{&quot;return&quot;: &quot;courses&quot;}\"\n      handle-as=\"json\"\n      on-response=\"handleResponse\"\n      last-response=\"{{queryResponse}}\"\n    ></iron-ajax>\n    <div id=\"loading\" class=\"loading\">\n      <h3>Loading..</h3>\n      <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n    </div>\n    <vaadin-grid\n      column-reordering-allowed\n      id=\"material\"\n      aria-label=\"Course list\"\n      items=\"[[_toArray(canvasCourses)]]\"\n    >\n      <vaadin-grid-column width=\"50px\" flex-grow=\"0\">\n        <template class=\"header\"\n          >#</template\n        >\n        <template\n          >[[index]]</template\n        >\n        <template class=\"footer\"\n          >#</template\n        >\n      </vaadin-grid-column>\n      <vaadin-grid-column width=\"200px\" flex-grow=\"0\" resizable>\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"term\">Semester</vaadin-grid-sorter>\n        </template>\n        <template>\n          [[item.term]]\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Semester\"\n            path=\"term\"\n            value=\"[[_filterTerm]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"Semester\"\n              value=\"{{_filterTerm::input}}\"\n              focus-target\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable>\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"name\">Name</vaadin-grid-sorter>\n        </template>\n        <template\n          >[[item.name]]</template\n        >\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Course\"\n            path=\"name\"\n            value=\"[[_filterCourse]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"Course\"\n              value=\"{{_filterCourse::input}}\"\n              focus-target\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable>\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"sis_course_id\">SIS</vaadin-grid-sorter>\n        </template>\n        <template>\n          [[item.sis_course_id]]\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Student information system ID\"\n            path=\"sis_course_id\"\n            value=\"[[_filterSIS]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"SIS\"\n              value=\"{{_filterSIS::input}}\"\n              focus-target\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column width=\"100px\" flex-grow=\"0\" resizable>\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"student_count\">Students</vaadin-grid-sorter>\n        </template>\n        <template\n          >[[item.student_count]]</template\n        >\n      </vaadin-grid-column>\n      <vaadin-grid-column width=\"100px\" flex-grow=\"0\" resizable>\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"workflow_state\">State</vaadin-grid-sorter>\n        </template>\n        <template\n          >[[item.workflow_state]]</template\n        >\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Workflow state\"\n            path=\"workflow_state\"\n            value=\"[[_filterWorkflow]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"State\"\n              value=\"{{_filterWorkflow::input}}\"\n              focus-target\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column>\n        <template class=\"header\"\n          >ELMSLN Course</template\n        >\n        <template>\n          <select\n            name$=\"elmsln--map--:key:[[item.sis_course_id]]:key:[[item.term]]:key:[[item.start]]:key:[[item.end]]\"\n            class=\"listing-select\"\n            value=\"{{item.elmslnCourse::input}}\"\n          >\n            <template is=\"dom-repeat\" items=\"[[elmslnCourses]]\" as=\"elmsCourse\">\n              <option value=\"[[elmsCourse.machineName]]\"\n                >[[elmsCourse.name]] ([[elmsCourse.machineName]])</option\n              >\n            </template>\n          </select>\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Course\"\n            path=\"elmslnCourse\"\n            value=\"[[_filterELMSLNCourse]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"Course\"\n              value=\"{{_filterELMSLNCourse::input}}\"\n              focus-target\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column width=\"100px\" flex-grow=\"0\">\n        <template class=\"header\"></template>\n        <template>\n          <paper-button\n            raised\n            on-click=\"_triggerDialog\"\n            id$=\"{{item.sis_course_id}}\"\n            >Details</paper-button\n          >\n        </template>\n        <template class=\"footer\"></template>\n      </vaadin-grid-column>\n    </vaadin-grid>\n    <iron-ajax\n      id=\"request\"\n      url=\"[[sourcePath]]\"\n      params=\"{&quot;return&quot;: &quot;users&quot;}\"\n      handle-as=\"json\"\n      on-response=\"handleRosterResponse\"\n      last-response=\"{{queryResponse}}\"\n    ></iron-ajax>\n    <lrnsys-dialog\n      tabindex=\"-1\"\n      id=\"details-dialog\"\n      body-append\n      header=\"{{activeCourse.name}}\"\n    >\n      <div slot=\"content\">\n        <template is=\"dom-if\" if=\"{{!roster}}\">\n          <div id=\"loadingRoster\" class=\"loading\">\n            <h3>Loading..</h3>\n            <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n          </div>\n        </template>\n      </div>\n      <div slot=\"header\">\n        <template is=\"dom-if\" if=\"{{roster}}\">\n          <template is=\"dom-if\" if=\"{{activeCourse.image}}\">\n            <iron-image\n              style=\"width:100%; height:200px; background-color: lightgray;\"\n              sizing=\"cover\"\n              preload\n              fade\n              src$=\"{{activeCourse.image}}\"\n            ></iron-image>\n          </template>\n          <span class=\"heading\">\n            <span>Student count: {{activeCourse.student_count}}</span>\n            <span>SIS ID: {{activeCourse.sis_course_id}}</span>\n            <span>Term: {{activeCourse.term}}</span>\n            <span>Workflow: {{activeCourse.workflow_state}}</span>\n          </span>\n        </template>\n      </div>\n      <div id=\"loadingContent\" slot=\"content\">\n        <template is=\"dom-repeat\" items=\"[[_toArray(roster)]]\" as=\"roleList\">\n          <h2>{{roleList.role}}s</h2>\n          <template\n            is=\"dom-repeat\"\n            items=\"[[_toArray(roleList.users)]]\"\n            as=\"user\"\n          >\n            <div class=\"avatar-name\" id$=\"user-{{user.id}}\">\n              <lrndesign-avatar\n                label$=\"{{user.name}}\"\n                src$=\"{{user.picture}}\"\n              ></lrndesign-avatar>\n            </div>\n            <paper-tooltip for$=\"user-{{user.id}}\">{{user.name}}</paper-tooltip>\n          </template>\n        </template>\n      </div>\n    </lrnsys-dialog>\n  `,\n  is: \"lrnapp-canvas-listing\",\n  properties: {\n    elmslnCourses: {\n      type: Array,\n      notify: true\n    },\n    canvasCourses: {\n      type: Array,\n      notify: true\n    },\n    roster: {\n      type: Array,\n      notify: true,\n      value: false\n    },\n    queryResponse: {\n      type: Array,\n      notify: true\n    },\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    activeCourse: {\n      type: String,\n      notify: true,\n      reflectToAttribute: true\n    }\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  },\n  /**\n   * Toggling collapse on an iron element.\n   */\n  collapseToggle: function(e) {\n    e.target.nextElementSibling.toggle();\n  },\n  /**\n   * Trigger the dialog box to opened and kick off request for data.\n   */\n  _triggerDialog: function(e) {\n    let root = this;\n    root.shadowRoot.querySelector(\"#details-dialog\").toggleDialog();\n    root.roster = false;\n    root.activeCourse = root.canvasCourses[e.target.id];\n    root.shadowRoot.querySelector(\"#request\").params[\"sis_course_id\"] =\n      root.activeCourse.sis_course_id;\n    root.shadowRoot.querySelector(\"#request\").generateRequest();\n    root.shadowRoot.querySelector(\"#loadingContent\").style.display = \"none\";\n  },\n  handleResponse: function() {\n    let root = this;\n    root.elmslnCourses = root.queryResponse.data.elmslnCourses;\n    root.canvasCourses = root.queryResponse.data.canvasCourses;\n    root.$.loading.hidden = true;\n  },\n  handleRosterResponse: function() {\n    let root = this;\n    root.roster = root.queryResponse.data;\n    root.shadowRoot.querySelector(\"#loadingContent\").style.display = \"block\";\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-card/paper-card.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\nimport \"@polymer/iron-image/iron-image.js\";\nimport \"@lrnwebcomponents/lrndesign-avatar/lrndesign-avatar.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\n/*\n `lrnapp-cis-course-card`\n Present a course card\n*/\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\">\n      :host {\n        display: inline-flex;\n      }\n      :host([size=\"micro\"]) {\n        transform: scale(0.5);\n      }\n      :host([size=\"small\"]) {\n        transform: scale(0.8);\n      }\n      paper-card {\n        border-radius: 4px;\n        margin: 0;\n        width: 100%;\n      }\n      .card-actions {\n        background-color: #f5f5f5;\n        border-radius: 0 0 4px 4px;\n        padding: 0 8px;\n      }\n      .card-actions .card-action-details {\n        display: inline-block;\n        vertical-align: middle;\n        vertical-align: -webkit-baseline-middle;\n        width: 80%;\n      }\n      #avatar {\n        display: inline-block;\n        vertical-align: text-top;\n        transform: scale(0.8);\n      }\n      .card-control-height {\n        height: 240px;\n      }\n      [elevation=\"0\"] {\n        border: solid 1px #eeeeee;\n      }\n      .text-right {\n        text-align: right;\n      }\n      .text-left {\n        text-align: left;\n      }\n      .name,\n      .title {\n        color: #222;\n        font-size: 14px;\n        font-weight: 600;\n        line-height: 20px;\n        padding: 0 12px;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        margin-top: 8px;\n      }\n      .title {\n        font-size: 12px;\n        font-weight: 400;\n      }\n      .divider {\n        height: 1px;\n        width: 100%;\n        background: #efefef;\n      }\n      .course-icon {\n        --iron-icon-height: 100%;\n        --iron-icon-width: 100%;\n        overflow: hidden;\n        color: grey;\n      }\n      .course-icon:hover,\n      .course-icon:focus {\n        color: black;\n      }\n      .center {\n        margin: auto;\n        width: 80%;\n        padding: 16px;\n      }\n      .link {\n        font-size: 16px;\n        line-height: 16px;\n      }\n      .course-info {\n        width: 100%;\n      }\n      .course-preview {\n        height: 160px;\n      }\n      lrndesign-avatar {\n        margin: -16px 8px 0 0;\n        position: absolute;\n        right: 0;\n      }\n      .card-content {\n        padding: 0;\n        margin: 0;\n        overflow: hidden;\n      }\n      .inline {\n        display: inline;\n      }\n    </style>\n    <paper-card elevation=\"[[elevation]]\">\n      <div class=\"card-content card-control-height card-control-center\">\n        <div class=\"course-preview\">\n          <iron-icon\n            class=\"course-icon\"\n            icon=\"[[icon]]\"\n            hidden\\$=\"[[!icon]]\"\n          ></iron-icon>\n          <iron-image\n            style=\"width:100%; height:100%; background-color: lightgray;\"\n            sizing=\"cover\"\n            preload=\"\"\n            fade=\"\"\n            src=\"[[image]]\"\n            hidden\\$=\"[[!image]]\"\n          ></iron-image>\n        </div>\n        <lrndesign-avatar\n          label=\"[[name]]\"\n          jdenticon=\"\"\n          color=\"[[color]] darken-4\"\n        >\n        </lrndesign-avatar>\n        <div class=\"course-info\">\n          <div class=\"divider\"></div>\n          <div class=\"name\">[[name]]</div>\n          <div class=\"title\">[[title]]</div>\n        </div>\n      </div>\n      <div class=\"card-actions\" hidden=\"\">\n        <div class=\"card-action-details\"></div>\n      </div>\n    </paper-card>\n  `,\n  is: \"lrnapp-cis-course-card\",\n  listeners: {\n    mouseenter: \"_mouseEnter\",\n    mouseleave: \"_mouseLeave\"\n  },\n  properties: {\n    size: {\n      type: String\n    },\n    /**\n     * Cover image src.\n     */\n    image: {\n      type: String\n    },\n    /**\n     * Icon to use if image isn't there.\n     */\n    icon: {\n      type: String,\n      value: false\n    },\n    /**\n     * name of the course like sing100\n     */\n    name: {\n      type: String,\n      value: \"\"\n    },\n    /**\n     * title of the course like Intro to studies\n     */\n    title: {\n      type: String,\n      value: \"\"\n    },\n    /**\n     * color of the course item\n     */\n    color: {\n      type: String,\n      value: \"grey\"\n    },\n    /**\n     * Visual elevation of the item off the UI via paper element height\n     */\n    elevation: {\n      type: Number,\n      value: 1,\n      reflectToAttribute: true\n    }\n  },\n  /**\n   * Increase elevation while hovering.\n   */\n  _mouseEnter: function(e) {\n    this.__oldElevation = this.elevation;\n    if (this.elevation + 2 > 5) {\n      this.elevation = 5;\n    } else {\n      this.elevation += 2;\n    }\n  },\n  /**\n   * Reset the elevation.\n   */\n  _mouseLeave: function(e) {\n    this.elevation = this.__oldElevation;\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/paper-item/paper-item.js\";\nimport \"@polymer/paper-listbox/paper-listbox.js\";\nimport \"@polymer/paper-dropdown-menu/paper-dropdown-menu.js\";\nimport \"@polymer/app-layout/app-toolbar/app-toolbar.js\";\nimport \"@polymer/iron-list/iron-list.js\";\nimport \"@polymer/iron-pages/iron-pages.js\";\nimport \"@polymer/app-route/app-location.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@polymer/paper-toast/paper-toast.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/lrndesign-course-banner/lrndesign-course-banner.js\";\nimport \"@lrnwebcomponents/lrn-icon/lrn-icon.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"@lrnwebcomponents/lrndesign-avatar/lrndesign-avatar.js\";\nimport \"@lrnwebcomponents/lrnsys-layout/lib/lrnsys-dialog.js\";\nimport \"@lrnwebcomponents/responsive-grid/lib/responsive-grid-col.js\";\nimport \"@lrnwebcomponents/responsive-grid/lib/responsive-grid-row.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nimport \"./lrnapp-cis-course-card.js\";\n/**\n `lrnapp-cis`\n A learning application for visualizing course information and listing.\n\n@demo ../../demo/index.html\n\n@microcopy - the mental model for this app\n - cis - Course Information System\n -\n\n*/\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\">\n      :host {\n        display: block;\n        align-content: center;\n      }\n      #loading {\n        width: 100%;\n        z-index: 1000;\n        opacity: 0.9;\n        padding: 4em 0 0 0;\n        text-align: center;\n        align-content: center;\n        justify-content: center;\n        height: 100vh;\n        position: absolute;\n        background-color: white;\n      }\n      iron-selector {\n        line-height: 1em;\n      }\n      iron-selector lrnsys-button {\n        display: inline-flex;\n      }\n      paper-button.coursecard-wrapper {\n        margin: 0;\n        padding: 0;\n      }\n      paper-button.coursecard-wrapper:focus {\n        outline: blue solid 1px;\n      }\n      lrnapp-cis-course-card {\n        padding: 0;\n        margin: 1em;\n        height: 15em;\n        width: 14em;\n      }\n      .courses-grid {\n        margin: 0 auto;\n        width: 95%;\n      }\n      .iron-selected .display-mode {\n        background-color: #ff6f00;\n        color: white;\n      }\n      .iron-list-container {\n        display: flex;\n        flex-direction: column;\n        min-height: 50vh;\n      }\n      iron-list {\n        flex: 1 1 auto;\n      }\n      .dialog-header {\n        height: unset !important;\n        padding: 0 !important;\n      }\n      .course-dialog-heading.lrndesign-course-banner {\n        font-size: 1em;\n        height: 4em !important;\n      }\n      #coursedetails {\n        margin-top: 1em;\n      }\n      #confirm {\n        max-width: 400px;\n        max-height: 300px;\n      }\n      .buttons {\n        text-align: center;\n      }\n      .buttons paper-button {\n        width: 10em;\n        height: 4em;\n      }\n      .dialog-body {\n        padding: 1em;\n        font-size: 1.8em;\n        text-align: center;\n        margin: 0 auto;\n      }\n      .dialog-body lrn-icon.service-confirm-icon {\n        width: 5em;\n        height: 5em;\n      }\n      .dialog-body responsive-grid-col {\n        height: 4.5em;\n      }\n      .dialog-body lrndesign-avatar.service-confirm-icon {\n        display: inline-block;\n      }\n    </style>\n    <iron-ajax\n      auto=\"\"\n      url=\"[[sourcePath]]\"\n      params=\"\"\n      handle-as=\"json\"\n      last-response=\"{{_cisResponse}}\"\n      on-response=\"_handleResponse\"\n    ></iron-ajax>\n    <iron-ajax\n      url=\"[[courseDataPath]]\"\n      params=\"[[_courseDataParams]]\"\n      handle-as=\"json\"\n      id=\"courserequest\"\n      last-response=\"{{_courseResponse}}\"\n      on-response=\"_handleCourseResponse\"\n    ></iron-ajax>\n    <iron-ajax\n      url=\"[[makeServicePath]]\"\n      params=\"\"\n      handle-as=\"json\"\n      id=\"makeservice\"\n      last-response=\"{{_makeServiceResponse}}\"\n      on-response=\"_handleMakeServiceResponse\"\n    ></iron-ajax>\n    <div id=\"loading\">\n      <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n      <h3>Loading..</h3>\n    </div>\n    <app-toolbar class=\"\">\n      <span main-title=\"\"></span>\n      <span\n        top-item=\"\"\n        style=\"text-align:right;font-size:.5em;padding-right:1em;\"\n        >Displaying [[courses.length]] of [[originalCourses.length]]</span\n      >\n      <paper-dropdown-menu label=\"Course\" hidden\\$=\"[[!courses]]\">\n        <paper-listbox\n          slot=\"dropdown-content\"\n          class=\"dropdown-content\"\n          selected=\"{{queryParams.course}}\"\n          attr-for-selected=\"item-id\"\n        >\n          <paper-item>-- Any --</paper-item>\n          <template\n            is=\"dom-repeat\"\n            items=\"[[_toArray(originalCourses)]]\"\n            as=\"course\"\n          >\n            <paper-item item-id=\"[[course.id]]\"\n              >[[course.attributes.name]]</paper-item\n            >\n          </template>\n        </paper-listbox>\n      </paper-dropdown-menu>\n      <paper-dropdown-menu label=\"Program\" hidden\\$=\"[[!programs]]\">\n        <paper-listbox\n          slot=\"dropdown-content\"\n          class=\"dropdown-content\"\n          selected=\"{{queryParams.program}}\"\n          attr-for-selected=\"item-id\"\n        >\n          <paper-item>-- Any --</paper-item>\n          <template is=\"dom-repeat\" items=\"[[_toArray(programs)]]\" as=\"program\">\n            <paper-item item-id=\"[[program.id]]\"\n              >[[program.attributes.name]]</paper-item\n            >\n          </template>\n        </paper-listbox>\n      </paper-dropdown-menu>\n      <paper-dropdown-menu label=\"Academic home\" hidden\\$=\"[[!academics]]\">\n        <paper-listbox\n          slot=\"dropdown-content\"\n          class=\"dropdown-content\"\n          selected=\"{{queryParams.academic}}\"\n          attr-for-selected=\"item-id\"\n        >\n          <paper-item>-- Any --</paper-item>\n          <template\n            is=\"dom-repeat\"\n            items=\"[[_toArray(academics)]]\"\n            as=\"academic\"\n          >\n            <paper-item item-id=\"[[academic.id]]\"\n              >[[academic.attributes.name]]</paper-item\n            >\n          </template>\n        </paper-listbox>\n      </paper-dropdown-menu>\n    </app-toolbar>\n    <div class=\"courses-grid\">\n      <iron-pages\n        selected=\"{{data.page}}\"\n        attr-for-selected=\"name\"\n        fallback-selection=\"courses\"\n        role=\"main\"\n      >\n        <div class=\"iron-list-container\" name=\"courses\">\n          <iron-list id=\"ironlist\" items=\"[[courses]]\" as=\"course\" grid=\"\">\n            <template>\n              <paper-button\n                data-course-id\\$=\"[[course.id]]\"\n                class=\"coursecard-wrapper\"\n                on-tap=\"_loadCourseUrl\"\n              >\n                <lrnapp-cis-course-card\n                  elevation=\"2\"\n                  data-course-id\\$=\"[[course.id]]\"\n                  name=\"[[course.attributes.name]]\"\n                  image=\"[[course.attributes.image]]\"\n                  title=\"[[course.attributes.title]]\"\n                  color=\"[[course.attributes.color]]\"\n                >\n                </lrnapp-cis-course-card>\n              </paper-button>\n            </template>\n          </iron-list>\n        </div>\n      </iron-pages>\n    </div>\n    <app-location\n      route=\"{{route}}\"\n      query-params=\"{{queryParams}}\"\n    ></app-location>\n    <app-route\n      route=\"{{route}}\"\n      pattern=\"[[endPoint]]/:page\"\n      data=\"{{data}}\"\n      tail=\"{{tail}}\"\n      query-params=\"{{queryParams}}\"\n    >\n    </app-route>\n    <lrnsys-dialog tabindex=\"-1\" id=\"dialog\" disable-auto-focus=\"\">\n      <div slot=\"content\">\n        <div id=\"loadingCourse\" class=\"loading\">\n          <h3>Loading..</h3>\n          <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n        </div>\n      </div>\n      <div class=\"dialog-header\" slot=\"header\">\n        <lrndesign-course-banner\n          image=\"[[activeCourse.attributes.image]]\"\n          name=\"[[activeCourse.attributes.name]]\"\n          title=\"[[activeCourse.attributes.title]]\"\n          color=\"[[activeCourse.attributes.color]] darken-4\"\n        >\n        </lrndesign-course-banner>\n      </div>\n      <div id=\"coursedetails\" slot=\"content\">\n        <responsive-grid-row gutter=\"5\">\n          <responsive-grid-col xl=\"6\" lg=\"6\" md=\"6\" sm=\"12\" xs=\"12\">\n            <div class=\"column\">\n              <h4>Details</h4>\n              <ul>\n                <li\n                  hidden\\$=\"[[!activeCourse.relationships.academic.attributes.name]]\"\n                >\n                  Academic unit:\n                  [[activeCourse.relationships.academic.attributes.name]]\n                </li>\n                <li\n                  hidden\\$=\"[[!activeCourse.relationships.program.attributes.name]]\"\n                >\n                  Program:\n                  [[activeCourse.relationships.program.attributes.name]]\n                </li>\n              </ul>\n              <h4>Learning Network</h4>\n              <template\n                is=\"dom-repeat\"\n                items=\"[[activeCourse.topology.Network]]\"\n                as=\"service\"\n              >\n                <template is=\"dom-if\" if=\"[[!service._exists]]\">\n                  <lrnsys-button\n                    raised=\"\"\n                    on-tap=\"_makeService\"\n                    color=\"grey lighten-4\"\n                    icon-class=\"grey lighten-5\"\n                    data-machine-name\\$=\"[[service.machine_name]]\"\n                  >\n                    <lrn-icon\n                      data-machine-name\\$=\"[[service.machine_name]]\"\n                      icon=\"[[service.icon]]\"\n                      class=\"elmsln-hover-icon\"\n                    ></lrn-icon>\n                    <span data-machine-name\\$=\"[[service.machine_name]]\"\n                      >Make the [[service.title]] service</span\n                    >\n                  </lrnsys-button>\n                </template>\n                <template is=\"dom-if\" if=\"[[service._exists]]\">\n                  <lrnsys-button\n                    raised=\"\"\n                    href=\"[[service.url]]\"\n                    hover-class=\"[[service.color]] lighten-4\"\n                  >\n                    <lrn-icon\n                      icon=\"[[service.icon]]\"\n                      class=\"elmsln-hover-icon\"\n                    ></lrn-icon>\n                    <span>[[service.title]]</span>\n                  </lrnsys-button>\n                </template>\n              </template>\n            </div>\n          </responsive-grid-col>\n          <responsive-grid-col xl=\"6\" lg=\"6\" md=\"6\" sm=\"12\" xs=\"12\">\n            <div class=\"column\">\n              <h4>Operations</h4>\n              <template is=\"dom-if\" if=\"[[activeCourse.meta.canUpdate]]\">\n                <lrnsys-button\n                  raised=\"\"\n                  href=\"[[activeCourse.uris.edit]]\"\n                  label=\"Edit\"\n                  hover-class=\"green lighten-4\"\n                  icon=\"create\"\n                ></lrnsys-button>\n                <lrnsys-button\n                  raised=\"\"\n                  href=\"[[activeCourse.uris.addOffering]]\"\n                  label=\"Add offering\"\n                  hover-class=\"amber lighten-3\"\n                  icon=\"icons:add\"\n                ></lrnsys-button>\n              </template>\n              <lrnsys-button\n                raised=\"\"\n                href=\"[[activeCourse.uris.offerings]]\"\n                label=\"Offerings\"\n                hover-class=\"amber lighten-4\"\n                icon=\"social:people\"\n              ></lrnsys-button>\n              <lrnsys-button\n                raised=\"\"\n                href=\"[[activeCourse.uris.sync]]\"\n                label=\"Sync Roster\"\n                hover-class=\"amber lighten-4\"\n                icon=\"notification:sync\"\n              ></lrnsys-button>\n              <lrnsys-button\n                raised=\"\"\n                href=\"[[activeCourse.uris.uri]]\"\n                label=\"Course page (legacy)\"\n                hover-class=\"brown lighten-4\"\n                icon=\"delete\"\n              ></lrnsys-button>\n              <template is=\"dom-if\" if=\"[[activeCourse.meta.canDelete]]\">\n                <div\n                  style=\"padding: 1em;width: 100%;margin: .5em 0;display: block;background-color:#FF2222;color:#ffffff;border: 1px solid #222222;\"\n                >\n                  <h4>Danger zone</h4>\n                  <lrnsys-button\n                    raised=\"\"\n                    href=\"[[activeCourse.uris.delete]]\"\n                    label=\"Delete\"\n                    hover-class=\"red lighten-1\"\n                    color=\"red lighten-3\"\n                    icon=\"delete\"\n                  ></lrnsys-button>\n                </div>\n              </template>\n            </div>\n          </responsive-grid-col>\n        </responsive-grid-row>\n        <p>[[activeCourse.attributes.body]]</p>\n      </div>\n    </lrnsys-dialog>\n    <lrnsys-dialog id=\"confirm\">\n      <div class=\"dialog-header\" slot=\"header\">\n        Add this to the\n        <strong>[[activeCourse.attributes.title]]</strong> network?\n      </div>\n      <div class=\"dialog-body\">\n        <responsive-grid-row gutter=\"5\">\n          <responsive-grid-col\n            xl=\"3\"\n            lg=\"3\"\n            md=\"3\"\n            sm=\"3\"\n            xs=\"3\"\n          ></responsive-grid-col>\n          <responsive-grid-col xl=\"1\" lg=\"1\" md=\"1\" sm=\"1\" xs=\"1\"\n            >Add</responsive-grid-col\n          >\n          <responsive-grid-col xl=\"2\" lg=\"2\" md=\"2\" sm=\"2\" xs=\"2\"\n            ><lrn-icon\n              icon=\"[[_activeService.icon]]\"\n              class\\$=\"[[_activeService.color]]-text elmsln-hover-icon service-confirm-icon\"\n            ></lrn-icon\n          ></responsive-grid-col>\n          <responsive-grid-col xl=\"3\" lg=\"3\" md=\"3\" sm=\"3\" xs=\"3\"\n            ><strong>[[_activeService.title]]</strong></responsive-grid-col\n          >\n          <responsive-grid-col\n            xl=\"3\"\n            lg=\"3\"\n            md=\"3\"\n            sm=\"3\"\n            xs=\"3\"\n          ></responsive-grid-col>\n        </responsive-grid-row>\n        <responsive-grid-row gutter=\"5\">\n          <responsive-grid-col\n            xl=\"3\"\n            lg=\"3\"\n            md=\"3\"\n            sm=\"3\"\n            xs=\"3\"\n          ></responsive-grid-col>\n          <responsive-grid-col xl=\"1\" lg=\"1\" md=\"1\" sm=\"1\" xs=\"1\"\n            >To</responsive-grid-col\n          >\n          <responsive-grid-col xl=\"2\" lg=\"2\" md=\"2\" sm=\"2\" xs=\"2\"\n            ><lrndesign-avatar\n              class=\"service-confirm-icon\"\n              label=\"[[activeCourse.attributes.name]]\"\n              jdenticon=\"\"\n              color=\"[[activeCourse.attributes.color]] darken-4\"\n            >\n            </lrndesign-avatar\n          ></responsive-grid-col>\n          <responsive-grid-col xl=\"3\" lg=\"3\" md=\"3\" sm=\"3\" xs=\"3\"\n            ><strong\n              >[[activeCourse.attributes.title]]</strong\n            ></responsive-grid-col\n          >\n          <responsive-grid-col\n            xl=\"3\"\n            lg=\"3\"\n            md=\"3\"\n            sm=\"3\"\n            xs=\"3\"\n          ></responsive-grid-col>\n        </responsive-grid-row>\n        <div style=\"margin-top:1em;\">This will take a few moments.</div>\n      </div>\n      <div class=\"buttons\">\n        <paper-button\n          raised=\"\"\n          dialog-confirm=\"\"\n          autofocus=\"\"\n          on-tap=\"_confirmBuild\"\n          class=\"green\"\n          >Let's do it!</paper-button\n        >\n        <paper-button dialog-dismiss=\"\" class=\"red-text\"\n          >Oops, go back.</paper-button\n        >\n      </div>\n    </lrnsys-dialog>\n    <paper-toast id=\"toast\"></paper-toast>\n  `,\n\n  is: \"lrnapp-cis\",\n\n  properties: {\n    /**\n     * The load initial data\n     */\n    _cisResponse: {\n      type: Object\n    },\n    /**\n     * Load individual course data\n     */\n    _courseResponse: {\n      type: Object\n    },\n    /**\n     * Load service creation response\n     */\n    _makeServiceResponse: {\n      type: Object\n    },\n    /**\n     * The courses to render; potentially filtered\n     */\n    courses: {\n      type: Array,\n      value: [],\n      computed: \"_coursesCompute(originalCourses, queryParams)\"\n    },\n    /**\n     * The original courses array; used to filter against\n     */\n    originalCourses: {\n      type: Array,\n      value: [],\n      notify: true\n    },\n    /**\n     * The programs to render\n     */\n    programs: {\n      type: Array,\n      value: []\n    },\n    /**\n     * The academics to render\n     */\n    academics: {\n      type: Array,\n      value: []\n    },\n    /**\n     * sourcePath for data.\n     */\n    sourcePath: {\n      type: String\n    },\n    /**\n     * pathway to access info about a single course.\n     */\n    courseDataPath: {\n      type: String\n    },\n    /**\n     * pathway to creating new service instances\n     */\n    makeServicePath: {\n      type: String\n    },\n    /**\n     * Endpoint for data.\n     */\n    endPoint: {\n      type: String,\n      value: \"/\"\n    },\n    /**\n     * base path for the app\n     */\n    basePath: {\n      type: String,\n      value: \"/\"\n    },\n    /**\n     * Active / clicked course.\n     */\n    activeCourse: {\n      type: Array,\n      value: null\n    },\n    queryParams: {\n      type: Object,\n      notify: true\n    }\n  },\n\n  listeners: {\n    \"route-change\": \"_routeChange\"\n  },\n\n  observers: [\"_routeChanged(route, endPoint)\"],\n\n  // If the current route is outside the scope of our app\n  // then allow the website to break out of the single page\n  // application routing\n  _routeChanged: function(route, endPoint) {\n    if (typeof route.path === \"string\") {\n      if (typeof endPoint === \"string\") {\n        // ignore \"home page\" as well since that's our path\n        if (route.path.startsWith(endPoint) || route.path == \"/\") {\n          return;\n        }\n      }\n      this.$.loading.hidden = false;\n      // reload the page which since route changed will load that page\n      window.location.reload();\n    }\n  },\n\n  /**\n   * Change route from deeper in the app.\n   */\n  _routeChange: function(e) {\n    var details = e.detail;\n    if (typeof details.queryParams.course !== typeof undefined) {\n      this.set(\"queryParams.course\", details.queryParams.course);\n    }\n    if (typeof details.queryParams.academic !== typeof undefined) {\n      this.set(\"queryParams.academic\", details.queryParams.academic);\n    }\n    if (typeof details.queryParams.program !== typeof undefined) {\n      this.set(\"queryParams.program\", details.queryParams.program);\n    }\n    if (typeof details.data.page !== typeof undefined) {\n      this.set(\"data.page\", details.data.page);\n    }\n  },\n\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  },\n\n  /**\n   * Handle course response for additional details about the item\n   */\n  _handleMakeServiceResponse: function(event) {\n    // get the CIS response's data and convert to array ahead of time\n    var response = this._makeServiceResponse;\n    let activeCourse = this.__addServiceLinks(response.data.course);\n    this.set(\"activeCourse\", []);\n    this.set(\"activeCourse\", activeCourse);\n    this.$.toast.show(response.message);\n  },\n\n  /**\n   * Handle course response for additional details about the item\n   */\n  _handleCourseResponse: function(event) {\n    // get the CIS response's data and convert to array ahead of time\n    var activeCourse = this._courseResponse.data.course;\n    this.__addServiceLinks(activeCourse);\n    this.set(\"activeCourse\", []);\n    this.set(\"activeCourse\", activeCourse);\n    this.$.loadingCourse.hidden = true;\n  },\n\n  /**\n   * Helper to mash up services that exist with those that could.\n   */\n  __addServiceLinks: function(courseObject) {\n    // ensure there's a part for the Network people can request\n    if (typeof courseObject.topology.Network === typeof undefined) {\n      courseObject.topology.Network = {};\n    }\n    // loop our services to see what we should add as options\n    for (var key in this.services) {\n      // if it's not in the topology that means it can be added\n      if (\n        typeof courseObject.topology.Network[\n          this.services[key].attributes.machine_name\n        ] === typeof undefined\n      ) {\n        // if we get a miss that means we should add a \"Add this\" version\n        courseObject.topology.Network[\n          this.services[key].attributes.machine_name\n        ] = {\n          color: this.services[key].attributes.color,\n          distro: this.services[key].attributes.distro,\n          icon: this.services[key].attributes.icon,\n          machine_name: this.services[key].attributes.machine_name,\n          title: this.services[key].attributes.title,\n          url: this.services[key].attributes.url,\n          weight: this.services[key].attributes.weight,\n          _exists: false\n        };\n      }\n    }\n    // convert to array after keys in place for the object\n    courseObject.topology.Network = this._toArray(\n      courseObject.topology.Network\n    );\n    // sort items based on weight of the things in the network\n    // so we have a consistent order to things\n    courseObject.topology.Network.sort(function(a, b) {\n      return a.weight - b.weight;\n    });\n    return courseObject;\n  },\n\n  /**\n   * Handle response for the whole courses object.\n   */\n  _handleResponse: function(event) {\n    var course = {};\n    var program = {};\n    var academic = {};\n    var tmp = {\n      courses: [],\n      programs: [],\n      academics: []\n    };\n    var programs = [];\n    var academics = [];\n    // get the CIS response's data and convert to array ahead of time\n    var courses = this._toArray(this._cisResponse.data.courses);\n    this.set(\"services\", this._toArray(this._cisResponse.data.services));\n    // original = active off the bat then we apply filters later to chang this\n    this.set(\"originalCourses\", courses);\n    // figure out courses, programs and academics\n    for (var index = 0; index < courses.length; index++) {\n      course = courses[index];\n      program = courses[index].relationships.program;\n      academic = courses[index].relationships.academic;\n      tmp.programs[program.id] = program;\n      tmp.academics[academic.id] = academic;\n      tmp.courses[course.id] = course;\n    }\n    // this is stupid but we have to normalize the IDs or else dom repeats will be screwed up\n    tmp.programs.forEach(function(element) {\n      programs.push(element);\n    });\n    // this is stupid but we have to normalize the IDs or else dom repeats will be screwed up\n    tmp.academics.forEach(function(element) {\n      academics.push(element);\n    });\n    this.$.loading.hidden = true;\n    this.set(\"academics\", academics);\n    this.set(\"programs\", programs);\n  },\n\n  /**\n   * Request a new service to kick off.\n   */\n  _makeService: function(e) {\n    var normalizedEvent = dom(e);\n    let active = normalizedEvent.localTarget.getAttribute(\"data-machine-name\");\n    const network = this.activeCourse.topology.Network;\n    let service = network.filter(service => {\n      if (service.machine_name !== active) {\n        return false;\n      }\n      return true;\n    });\n    // if we found one, make it the top level item\n    if (service.length > 0) {\n      service = service.pop();\n      this.$.makeservice.params = {\n        course: this.activeCourse.attributes.machine_name,\n        service: service.machine_name\n      };\n      this._activeService = service;\n      // confirm via paper prompt\n      this.$.confirm.toggleDialog();\n    } else {\n      console.log(\"that was not a valid service..\");\n    }\n  },\n\n  /**\n   * Confirm of build.\n   */\n  _confirmBuild: function(e) {\n    this.$.makeservice.generateRequest();\n  },\n\n  /**\n   * Attached lifecycle\n   */\n  attached: function() {\n    // listen for focus event to have fired\n    document.body.addEventListener(\n      \"lrnsys-dialog-modal-closed\",\n      this._accessibleFocus.bind(this)\n    );\n  },\n\n  /**\n   * Set ourselves as having focus after the modal closes.\n   */\n  _accessibleFocus: function(e) {\n    // focus on our dialog triggering button\n    this.__rememberClick.focus();\n  },\n\n  /**\n   * Handle tap on paper-button above to redirect to the correct course url.\n   */\n  _loadCourseUrl: function(e) {\n    this.__rememberClick = e.target;\n    // reset dialog to appear to be loading\n    this.$.loadingCourse.hidden = false;\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // this will have the id of the current course\n    var active = local.getAttribute(\"data-course-id\");\n    // find the course by it's unique id and filter just to it\n    let findCourse = this.originalCourses.filter(course => {\n      if (course.id !== active) {\n        return false;\n      }\n      return true;\n    });\n    // if we found one, make it the top level item\n    if (findCourse.length > 0) {\n      findCourse = findCourse.pop();\n    }\n    this.activeCourse = findCourse;\n    // formulate the post data\n    this._courseDataParams = {\n      id: this.activeCourse.id\n    };\n    // @todo look at query cache mechanism to skip calls\n    // if they've already happened. lrnapp-book has some stuff to do this\n    this.$.courserequest.generateRequest();\n    this.$.dialog.toggleDialog();\n  },\n\n  /**\n   * Compute the active list of courses\n   */\n  _coursesCompute: function(originalCourses, queryParams) {\n    // if we don't have an original courses object to work with then we need to bail\n    if (typeof originalCourses === \"undefined\") {\n      return [];\n    }\n    // define vars\n    const root = this;\n    let filteredCourses = [];\n    // filter the courses by the query params\n    filteredCourses = originalCourses.filter(course => {\n      if (typeof root.queryParams.course !== \"undefined\") {\n        if (course.id !== root.queryParams.course) {\n          return false;\n        }\n      }\n      if (typeof root.queryParams.program !== \"undefined\") {\n        if (course.relationships.program.id !== root.queryParams.program) {\n          return false;\n        }\n      }\n      if (typeof root.queryParams.academic !== \"undefined\") {\n        if (course.relationships.academic.id !== root.queryParams.academic) {\n          return false;\n        }\n      }\n      return true;\n    });\n    // delay and repaint, can help with refresh issues\n    setTimeout(() => {\n      this.$.ironlist.fire(\"iron-resize\");\n    }, 200);\n    return filteredCourses;\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/iron-scroll-threshold/iron-scroll-threshold.js\";\nimport \"@polymer/iron-image/iron-image.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\">\n      :host {\n        display: block;\n      }\n      paper-button {\n        padding: 0;\n        margin: 0;\n        min-width: 1rem;\n      }\n      #details {\n        opacity: 0.5;\n        position: absolute;\n        bottom: 0;\n        right: 0;\n        margin: 0 1rem 0 0;\n        background-color: white;\n        padding: 0.5em;\n      }\n      #details:hover {\n        opacity: 1;\n      }\n      #details span {\n        font-size: 0.6em;\n        font-weight: normal;\n      }\n      #details .comment-on-work {\n        font-size: 0.8em;\n        background-color: white;\n      }\n    </style>\n    <iron-ajax\n      id=\"ajax\"\n      url=\"[[sourcePath]]\"\n      params=\"\"\n      handle-as=\"json\"\n      last-response=\"{{submissions}}\"\n    ></iron-ajax>\n    <iron-scroll-threshold on-lower-threshold=\"_loadMoreData\" id=\"threshold\">\n      <iron-list grid items=\"[[_toArray(submissions.data)]]\" as=\"item\">\n        <template is=\"dom-repeat\" items=\"[[_toArray(item.images)]]\" as=\"image\">\n          <paper-button>\n            <iron-image\n              preload\n              open-url=\"{{item.url}}\"\n              title=\"{{item.title}}\"\n              alt=\"{{item.title}}\"\n              src=\"{{image.src}}\"\n              author=\"{{item.author}}\"\n              comments=\"{{item.comments}}\"\n              height=\"{{image.height}}\"\n              width=\"{{image.width}}\"\n            ></iron-image>\n          </paper-button>\n        </template>\n      </iron-list>\n    </iron-scroll-threshold>\n    <paper-dialog\n      id=\"dialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n    >\n      <paper-dialog-scrollable id=\"dialogResponse\">\n        <iron-image src$=\"[[activeImage]]\"></iron-image>\n        <div id=\"details\">\n          <div class=\"title\">\n            <span>Title:</span> <span>{{{activeTitle}}}</span>\n          </div>\n          <div class=\"author\">\n            <span>Author:</span> <span>{{activeAuthor}}</span>\n          </div>\n          <div class=\"comments\">\n            <span>Comments:</span> <span>{{activeComments}}</span>\n          </div>\n          <div class=\"comment-on-work\">\n            <a href$=\"[[activeUrl]]\">\n              <paper-button raised>Comment on this work</paper-button>\n            </a>\n          </div>\n        </div>\n      </paper-dialog-scrollable>\n    </paper-dialog>\n  `,\n  is: \"lrnapp-gallery-grid\",\n  listeners: {\n    click: \"_triggerDialog\"\n  },\n  properties: {\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    submissions: {\n      type: Array,\n      notify: true\n    },\n    activeImage: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    activeTitle: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    activeAuthor: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    activeComments: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    activeUrl: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    }\n  },\n  /**\n   * When someone clicks if there is a url, then we need to\n   * remote load whatever is in that url.\n   */\n  _triggerDialog: function(e) {\n    // make sure we found an image as we're going through here\n    if (e.target.nextElementSibling.nodeName == \"IMG\") {\n      this.activeImage = e.target.nextElementSibling.src;\n      this.activeTitle = e.target.parentElement.title;\n      this.activeAuthor = e.target.parentElement.author;\n      this.activeComments = e.target.parentElement.comments;\n      this.activeUrl = e.target.parentElement.openUrl;\n      this.shadowRoot.querySelector(\"#dialog\").toggle();\n    }\n  },\n  _loadMoreData: function(e) {\n    this.shadowRoot.querySelector(\"#ajax\").generateRequest();\n    this.shadowRoot.querySelector(\"#threshold\").clearTriggers();\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/iron-scroll-threshold/iron-scroll-threshold.js\";\nimport \"@polymer/iron-list/iron-list.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@polymer/iron-image/iron-image.js\";\nimport \"@polymer/paper-dialog/paper-dialog.js\";\nimport \"@polymer/paper-dialog-scrollable/paper-dialog-scrollable.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\">\n      :host {\n        display: block;\n      }\n      paper-button {\n        padding: 0;\n        margin: 0;\n        min-width: 1rem;\n      }\n      #details {\n        opacity: 0.5;\n        position: absolute;\n        bottom: 0;\n        right: 0;\n        margin: 0 1rem 0 0;\n        background-color: white;\n        padding: 0.5em;\n      }\n      #details:hover {\n        opacity: 1;\n      }\n      #details span {\n        font-size: 0.6em;\n        font-weight: normal;\n      }\n      #details .comment-on-work {\n        font-size: 0.8em;\n        background-color: white;\n      }\n    </style>\n    <iron-ajax\n      id=\"ajax\"\n      url=\"[[sourcePath]]\"\n      params=\"\"\n      handle-as=\"json\"\n      last-response=\"{{images}}\"\n    ></iron-ajax>\n    <iron-scroll-threshold on-lower-threshold=\"_loadMoreData\" id=\"threshold\">\n      <iron-list grid items=\"[[_toArray(images.data)]]\" as=\"image\">\n        <template>\n          <paper-button>\n            <iron-image\n              preload=\"\"\n              title=\"{{image.filename}}\"\n              alt=\"{{image.alt}}\"\n              src=\"{{image.src}}\"\n              height=\"{{image.height}}\"\n              width=\"{{image.width}}\"\n            ></iron-image>\n          </paper-button>\n        </template>\n      </iron-list>\n    </iron-scroll-threshold>\n    <paper-dialog\n      id=\"dialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n    >\n      <paper-dialog-scrollable id=\"dialogResponse\">\n        <iron-image src$=\"[[activeImage]]\"></iron-image>\n        <div id=\"details\">\n          <div class=\"title\">\n            <span>Title:</span> <span>[[activeTitle]]</span>\n          </div>\n          <div class=\"comment-on-work\">\n            <a href$=\"[[activeUrl]]\">\n              <paper-button raised=\"\">View media</paper-button>\n            </a>\n          </div>\n        </div>\n      </paper-dialog-scrollable>\n    </paper-dialog>\n  `,\n  is: \"lrnapp-media-grid\",\n  listeners: {\n    click: \"_triggerDialog\"\n  },\n  properties: {\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    images: {\n      type: Array,\n      notify: true\n    },\n    activeImage: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    activeTitle: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    activeUrl: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    }\n  },\n  /**\n   * When someone clicks if there is a url, then we need to\n   * remote load whatever is in that url.\n   */\n  _triggerDialog: function(e) {\n    // make sure we found an image as we're going through here\n    if (e.target.nextElementSibling.nodeName == \"IMG\") {\n      this.activeImage = e.target.nextElementSibling.src;\n      this.activeTitle = e.target.parentElement.title;\n      this.activeUrl = e.target.parentElement.openUrl;\n      this.shadowRoot.querySelector(\"#dialog\").toggle();\n    }\n  },\n  _loadMoreData: function(e) {\n    this.shadowRoot.querySelector(\"#ajax\").generateRequest();\n    this.shadowRoot.querySelector(\"#threshold\").clearTriggers();\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/iron-scroll-threshold/iron-scroll-threshold.js\";\nimport \"@polymer/iron-image/iron-image.js\";\nimport \"@polymer/iron-list/iron-list.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\">\n      :host {\n        display: block;\n      }\n      paper-button {\n        padding: 0;\n        margin: 0;\n        min-width: 16px;\n      }\n      #details {\n        opacity: 0.5;\n        position: absolute;\n        bottom: 0;\n        right: 0;\n        margin: 0 16px 0 0;\n        background-color: white;\n        padding: 8px;\n      }\n      #details:hover {\n        opacity: 1;\n      }\n      #details span {\n        font-size: 10px;\n        font-weight: normal;\n      }\n      #details .comment-on-work {\n        font-size: 12px;\n        background-color: white;\n      }\n    </style>\n    <iron-ajax\n      id=\"ajax\"\n      url=\"[[source-path]]\"\n      params=\"\"\n      handle-as=\"json\"\n      last-response=\"{{submissions}}\"\n    ></iron-ajax>\n    <iron-scroll-threshold on-lower-threshold=\"_loadMoreData\" id=\"threshold\">\n      <iron-list grid items=\"[[_toArray(submissions.data)]]\" as=\"item\">\n        <template>\n          <paper-card\n            heading=\"{{item.title}}\"\n            image=\"\"\n            elevation=\"2\"\n            animated-shadow=\"true\"\n          >\n            <div class=\"card-content\"></div>\n            <div class=\"card-actions\">\n              <a href=\"{{item.url}}\"\n                ><paper-button raised>View</paper-button></a\n              >\n              <a href=\"{{item.edit_url}}\"\n                ><paper-button raised>Edit</paper-button></a\n              >\n            </div>\n          </paper-card>\n        </template>\n      </iron-list>\n    </iron-scroll-threshold>\n    <paper-dialog\n      id=\"dialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n    >\n      <paper-dialog-scrollable id=\"dialogResponse\">\n        <iron-image src=\"{{activeImage}}\"></iron-image>\n        <div id=\"details\">\n          <div class=\"title\">\n            <span>Title:</span> <span>{{activeTitle}}</span>\n          </div>\n          <div class=\"author\">\n            <span>Author:</span> <span>{{activeAuthor}}</span>\n          </div>\n          <div class=\"comments\">\n            <span>Comments:</span> <span>{{activeComments}}</span>\n          </div>\n          <div class=\"comment-on-work\">\n            <a href=\"{{activeUrl}}\">\n              <paper-button raised>Comment on this work</paper-button>\n            </a>\n          </div>\n        </div>\n      </paper-dialog-scrollable>\n    </paper-dialog>\n  `,\n  is: \"lrnapp-media-management\",\n  listeners: {\n    click: \"_triggerDialog\"\n  },\n  properties: {\n    submissions: {\n      type: Array,\n      notify: true\n    },\n    activeImage: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    activeTitle: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    activeAuthor: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    activeComments: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    activeUrl: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    }\n  },\n  /**\n   * When someone clicks if there is a url, then we need to\n   * remote load whatever is in that url.\n   */\n  _triggerDialog: function(e) {\n    let root = this;\n    // make sure we found an image as we're going through here\n    if (e.target.nextElementSibling.nodeName == \"IMG\") {\n      root.activeImage = e.target.nextElementSibling.src;\n      root.activeTitle = e.target.parentElement.title;\n      root.activeAuthor = e.target.parentElement.author;\n      root.activeComments = e.target.parentElement.comments;\n      root.activeUrl = e.target.parentElement.openUrl;\n      this.shadowRoot.querySelector(\"#dialog\").toggle();\n    }\n  },\n  _loadMoreData: function(e) {\n    let root = this;\n    root.shadowRoot.querySelector(\"#ajax\").generateRequest();\n    root.shadowRoot.querySelector(\"#threshold\").clearTriggers();\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","/**\n * Copyright 2018 The Pennsylvania State University\n * @license Apache-2.0, see License.md for full text.\n */\nimport { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@vaadin/vaadin-upload/vaadin-upload.js\";\n/**\n * `lrnapp-media-upload`\n * `Simple media upload wrapper element`\n *\n * @demo demo/index.html\n */\nlet LrnappMediaUpload = Polymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n      paper-button {\n        padding: 0;\n        margin: 0;\n        min-width: 16px;\n      }\n      vaadin-upload.thick-border {\n        --primary-color: #396;\n        --dark-primary-color: #063;\n        --light-primary-color: #6c9;\n        --error-color: darkred;\n\n        border: 2px solid #ccc;\n        padding: 14px;\n        background: #eee;\n        border-radius: 0;\n      }\n      vaadin-upload.thick-border[dragover] {\n        border-color: #396;\n      }\n    </style>\n    <vaadin-upload\n      target\\$=\"{{uploadPath}}\"\n      method=\"POST\"\n      form-data-name=\"file-upload\"\n    ></vaadin-upload>\n  `,\n\n  is: \"lrnapp-media-upload\",\n\n  properties: {\n    uploadPath: {\n      type: String,\n      notify: true,\n      reflectToAttribute: true\n    }\n  }\n});\nexport { LrnappMediaUpload };\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@polymer/paper-input/paper-input.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-column.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-sorter.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-filter.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nimport \"@lrnwebcomponents/elmsln-apps/lib/lrnapp-studio-submission/lrnapp-studio-submission-display.js\";\nPolymer({\n  _template: html`\n    <custom-style>\n      <style is=\"custom-style\" include=\"materializecss-styles\">\n        :host {\n          display: block;\n          align-content: center;\n          padding: 0.8em;\n        }\n        #loading {\n          width: 100%;\n          z-index: 1000;\n          opacity: 0.8;\n          text-align: center;\n          align-content: center;\n          justify-content: center;\n          height: 100vh;\n          position: absolute;\n          background-color: white;\n        }\n        .center-data {\n          text-align: center;\n        }\n        vaadin-grid#material {\n          height: 75vh;\n          font-family: Roboto, sans-serif;\n          --divider-color: rgba(0, 0, 0, var(--dark-divider-opacity));\n\n          --vaadin-grid-cell: {\n            padding: 0;\n          }\n\n          --vaadin-grid-header-cell: {\n            height: 3.5em;\n            color: rgba(0, 0, 0, var(--dark-secondary-opacity));\n            font-size: 1em;\n          }\n\n          --vaadin-grid-body-cell: {\n            height: 3em;\n            color: rgba(0, 0, 0, var(--dark-primary-opacity));\n            font-size: 0.8em;\n          }\n\n          --vaadin-grid-body-row-hover-cell: {\n            background-color: var(--paper-grey-200);\n          }\n\n          --vaadin-grid-body-row-selected-cell: {\n            background-color: var(--paper-grey-100);\n          }\n\n          --vaadin-grid-focused-cell: {\n            box-shadow: none;\n            font-weight: bold;\n          }\n        }\n\n        vaadin-grid#material .cell {\n          overflow: hidden;\n          text-overflow: ellipsis;\n          padding-right: 56px;\n        }\n\n        vaadin-grid#material .cell.last {\n          padding-right: 24px;\n        }\n\n        vaadin-grid#material .cell.numeric {\n          text-align: right;\n        }\n\n        vaadin-grid#material paper-checkbox {\n          --primary-color: var(--paper-indigo-500);\n          margin: 0 24px;\n        }\n\n        vaadin-grid#material vaadin-grid-sorter {\n          --vaadin-grid-sorter-arrow: {\n            display: none !important;\n          }\n        }\n\n        vaadin-grid#material vaadin-grid-sorter .cell {\n          flex: 1;\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n        }\n\n        vaadin-grid#material vaadin-grid-sorter iron-icon {\n          transform: scale(0.8);\n        }\n\n        vaadin-grid#material vaadin-grid-sorter:not([direction]) iron-icon {\n          color: rgba(0, 0, 0, var(--dark-disabled-opacity));\n        }\n\n        vaadin-grid#material vaadin-grid-sorter[direction] {\n          color: rgba(0, 0, 0, var(--dark-primary-opacity));\n        }\n\n        vaadin-grid#material vaadin-grid-sorter[direction=\"desc\"] iron-icon {\n          transform: scale(0.8) rotate(180deg);\n        }\n        vaadin-grid-sorter {\n          text-align: center;\n        }\n      </style>\n    </custom-style>\n    <vaadin-grid\n      column-reordering-allowed=\"\"\n      id=\"material\"\n      aria-label=\"Course list\"\n      items=\"{{submissions}}\"\n    >\n      <vaadin-grid-column resizable=\"\">\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"relationships.project.data.title\"\n            >Project</vaadin-grid-sorter\n          >\n        </template>\n        <template>\n          <lrnsys-button\n            raised=\"\"\n            on-tap=\"_loadProjectRoute\"\n            data-project-id\\$=\"{{item.relationships.project.data.id}}\"\n            data-author-id\\$=\"{{item.relationships.author.data.id}}\"\n            label=\"[[item.relationships.project.data.title]]\"\n            hover-class=\"amber lighten-4\"\n            icon=\"folder\"\n          ></lrnsys-button>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable=\"\">\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"relationships.assignment.data.title\"\n            >Assignment</vaadin-grid-sorter\n          >\n        </template>\n        <template>\n          [[item.relationships.assignment.data.title]]\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable=\"\" width=\"20em\" flex-grow=\"0\">\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"attributes.title\">Title</vaadin-grid-sorter>\n        </template>\n        <template>\n          <lrnsys-button\n            raised=\"\"\n            on-tap=\"_loadSubmissionUrl\"\n            data-submission-id\\$=\"{{item.id}}\"\n            label=\"[[item.attributes.title]]\"\n            hover-class=\"amber lighten-4\"\n            icon=\"assignment\"\n          ></lrnsys-button>\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Title\"\n            path=\"attributes.title\"\n            value=\"[[_filterTitle]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"Title\"\n              value=\"{{_filterTitle::input}}\"\n              focus-target=\"\"\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable=\"\">\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"meta.changed\">Submitted</vaadin-grid-sorter>\n        </template>\n        <template>\n          [[item.meta.humandate]]\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Submitted\"\n            path=\"meta.changed\"\n            value=\"[[_filterSubmitted]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"Submitted\"\n              value=\"{{_filterSubmitted::input}}\"\n              focus-target=\"\"\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable=\"\">\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"relationships.author.data.display_name\"\n            >Author</vaadin-grid-sorter\n          >\n        </template>\n        <template>\n          [[item.relationships.author.data.display_name]]\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable=\"\" width=\"[[_numWidth]]\">\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"meta.comment_count\"\n            >Comments</vaadin-grid-sorter\n          >\n        </template>\n        <template>\n          <span class=\"center-data\">[[item.meta.comment_count]]</span>\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Comments\"\n            path=\"meta.comment_count\"\n            value=\"[[_filterCommentsCount]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"Comments\"\n              value=\"{{_filterCommentsCount::input}}\"\n              focus-target=\"\"\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable=\"\" width=\"[[_numWidth]]\">\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"attributes.images.length\"\n            >Images</vaadin-grid-sorter\n          >\n        </template>\n        <template>\n          <span class=\"center-data\">[[item.attributes.images.length]]</span>\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Images\"\n            path=\"attributes.images.length\"\n            value=\"[[_filterImageCount]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"Images\"\n              value=\"{{_filterImageCount::input}}\"\n              focus-target=\"\"\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable=\"\" width=\"[[_numWidth]]\">\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"attributes.video.length\"\n            >Video</vaadin-grid-sorter\n          >\n        </template>\n        <template>\n          <span class=\"center-data\">[[item.attributes.video.length]]</span>\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Video\"\n            path=\"attributes.video.length\"\n            value=\"[[_filterVideosCount]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"Video\"\n              value=\"{{_filterVideosCount::input}}\"\n              focus-target=\"\"\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable=\"\" width=\"[[_numWidth]]\">\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"attributes.links.length\"\n            >Links</vaadin-grid-sorter\n          >\n        </template>\n        <template>\n          <span class=\"center-data\">[[item.attributes.links.length]]</span>\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Links\"\n            path=\"attributes.links.length\"\n            value=\"[[_filterLinksCount]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"Links\"\n              value=\"{{_filterLinksCount::input}}\"\n              focus-target=\"\"\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n      <vaadin-grid-column resizable=\"\" width=\"[[_numWidth]]\">\n        <template class=\"header\">\n          <vaadin-grid-sorter path=\"attributes.files.length\"\n            >Files</vaadin-grid-sorter\n          >\n        </template>\n        <template>\n          <span class=\"center-data\">[[item.attributes.files.length]]</span>\n        </template>\n        <template class=\"footer\">\n          <vaadin-grid-filter\n            aria-label=\"Files\"\n            path=\"attributes.files.length\"\n            value=\"[[_filterFileCount]]\"\n          >\n            <paper-input\n              slot=\"filter\"\n              label=\"Files\"\n              value=\"{{_filterFileCount::input}}\"\n              focus-target=\"\"\n            ></paper-input>\n          </vaadin-grid-filter>\n        </template>\n      </vaadin-grid-column>\n    </vaadin-grid>\n  `,\n\n  is: \"lrnapp-open-studio-table\",\n\n  properties: {\n    /**\n     * The submissions to render\n     */\n    submissions: {\n      type: Array,\n      notify: true\n    },\n    _numWidth: {\n      type: String,\n      value: \"2.25em\"\n    },\n    /**\n     * Endpoint for submission data.\n     */\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    /**\n     * base path for the app\n     */\n    basePath: {\n      type: String,\n      notify: true\n    },\n    /**\n     * Active / clicked submission.\n     */\n    activeSubmission: {\n      type: String,\n      value: null,\n      notify: true\n    }\n  },\n\n  _loadProjectRoute: function(e) {\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // this will have the id of the current submission\n    var project = local.getAttribute(\"data-project-id\");\n    var author = local.getAttribute(\"data-author-id\");\n    // fire event w/ parts of the route to changes\n    this.fire(\"route-change\", {\n      data: { page: \"projects\" },\n      queryParams: { author: author, project: project }\n    });\n  },\n\n  /**\n   * Handle tap on paper-button above to redirect to the correct submission url.\n   */\n  _loadSubmissionUrl: function(e) {\n    let root = this;\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // this will have the id of the current submission\n    var active = local.getAttribute(\"data-submission-id\");\n    // @todo need a cleaner integration but this at least goes the right place for now\n    window.location.href =\n      this.basePath + \"lrnapp-studio-submission/submissions/\" + active;\n  },\n\n  /**\n   * Handle response for the whole projects object.\n   */\n  _handleResponse: function(event) {\n    this.$.loading.hidden = true;\n  },\n\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nimport \"@lrnwebcomponents/elmsln-apps/lib/lrnapp-studio-submission/lrnapp-studio-submission-display.js\";\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\"></style>\n    <style>\n      :host {\n        display: block;\n        align-content: center;\n      }\n      #loading {\n        width: 100%;\n        z-index: 1000;\n        opacity: 0.8;\n        text-align: center;\n        align-content: center;\n        justify-content: center;\n        height: 100vh;\n        position: absolute;\n        background-color: white;\n      }\n      h1.empty-title,\n      h1.project-title {\n        font-size: 2em;\n      }\n      h2.assignment-title {\n        font-size: 1.5em;\n        font-weight: bold;\n        width: 100%;\n        border-bottom: solid 1px grey;\n      }\n      .project-steps {\n        display: flex;\n        align-items: center;\n      }\n      .project-step {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        word-break: break-all;\n        word-wrap: break-word;\n      }\n    </style>\n    <template is=\"dom-if\" if=\"[[!showSubmissions]]\">\n      <h1 class=\"empty-title black-text\">\n        Please select an Author and Project in order to review their portfolio\n      </h1>\n    </template>\n    <template is=\"dom-if\" if=\"[[showSubmissions]]\">\n      <h1 class=\"project-title black-text\">\n        [[activeProject.attributes.title]]\n      </h1>\n      <div class=\"project-steps\">\n        <template\n          is=\"dom-repeat\"\n          items=\"[[activeProject.attributes.steps]]\"\n          as=\"assignment\"\n        >\n          <lrnsys-button\n            icon\\$=\"[[_getSubmissionIcon(assignment.id)]]\"\n            icon-class\\$=\"[[_getSubmissionClass(assignment.id)]]\"\n            on-tap=\"_scrollToTarget\"\n            label=\"[[assignment.title]]\"\n            data-assignment-id\\$=\"[[assignment.id]]\"\n            class=\"project-step\"\n            hover-class=\"blue white-text\"\n            raised=\"\"\n            hidden\\$=\"[[!assignment.title]]\"\n          ></lrnsys-button>\n        </template>\n      </div>\n      <template is=\"dom-repeat\" items=\"[[renderSubmissions]]\" as=\"submission\">\n        <a\n          name=\"[[submission.relationships.assignment.title]]\"\n          class\\$=\"assignment-[[submission.relationships.assignment.id]]\"\n          ><h2 class=\"assignment-title\">\n            [[submission.relationships.assignment.title]]\n          </h2></a\n        >\n        <lrnapp-studio-submission-display\n          submission=\"[[submission]]\"\n          class=\"ferpa-protect\"\n        ></lrnapp-studio-submission-display>\n      </template>\n    </template>\n  `,\n\n  is: \"lrnapp-open-studio-projects\",\n\n  properties: {\n    /**\n     * The projects that exist so we can make other calls for data\n     */\n    projects: {\n      type: Array,\n      notify: true\n    },\n    /**\n     * The submissions that exist so we can make other calls for data\n     */\n    submissions: {\n      type: Array,\n      notify: true\n    },\n    /**\n     * The renderSubmissions we kick to the screen\n     */\n    renderSubmissions: {\n      type: Array,\n      notify: true,\n      computed:\n        \"_renderSubmissionsCompute(submissions, activeProject, activeAuthorId)\"\n    },\n    activeProjectId: {\n      type: String,\n      reflectToAttribute: true,\n      value: null\n    },\n    activeProject: {\n      type: Object,\n      computed: \"_activeProjectCompute(activeProjectId, projects)\"\n    },\n    activeAuthorId: {\n      type: String,\n      reflectToAttribute: true,\n      value: null\n    },\n    showSubmissions: {\n      type: Boolean,\n      computed: \"_showSubmissions(activeProjectId, activeAuthorId)\",\n      value: false\n    },\n    /**\n     * Endpoint for submission data.\n     */\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    /**\n     * base path for the app\n     */\n    basePath: {\n      type: String,\n      notify: true\n    }\n  },\n\n  _renderSubmissionsCompute: function(\n    submissions,\n    activeProject,\n    activeAuthorId\n  ) {\n    // if we don't have all three variables then we need to bail and set to null\n    if (!submissions || !activeProject || !activeAuthorId) {\n      return null;\n    }\n    let renderSubmissions = [];\n    // make an array of parent assignment ids\n    const parentAssignments = activeProject.attributes.steps.map(\n      step => step.id\n    );\n    // filter the submissions by if they are listed in the active projects steps\n    renderSubmissions = submissions.filter(submission => {\n      return parentAssignments.includes(submission.relationships.assignment.id);\n    });\n    // sort render submissions by how the assignment steps are listed in the active project\n    renderSubmissions.sort(function(a, b) {\n      for (index = 0; index < activeProject.attributes.steps.length; index++) {\n        if (\n          activeProject.attributes.steps[index].id ==\n          a.relationships.assignment.id\n        ) {\n          return -1;\n        }\n        if (\n          activeProject.attributes.steps[index].id ==\n          b.relationships.assignment.id\n        ) {\n          return 1;\n        }\n      }\n      return 0;\n    });\n    return renderSubmissions;\n  },\n\n  _activeProjectCompute: function(activeProjectId, projects) {\n    let activeProject = null;\n    if (projects) {\n      activeProject = projects.find(project => {\n        return project.id === activeProjectId;\n      });\n    }\n    return activeProject;\n  },\n\n  _showSubmissions: function(activeProjectId, activeAuthorId) {\n    if (activeProjectId && activeAuthorId) {\n      return true;\n    }\n    return false;\n  },\n\n  _getSubmissionIcon: function(id) {\n    for (var index = 0; index < this.renderSubmissions.length; index++) {\n      if (this.renderSubmissions[index].relationships.assignment.id == id) {\n        return \"check\";\n      }\n    }\n    return \"assignment\";\n  },\n\n  _getSubmissionClass: function(id) {\n    for (var index = 0; index < this.renderSubmissions.length; index++) {\n      if (this.renderSubmissions[index].relationships.assignment.id == id) {\n        return \"green-text text-darken-2\";\n      }\n    }\n    return \"grey-text\";\n  },\n\n  _scrollToTarget: function(e) {\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // this will have the id of the current submission\n    var active = local.getAttribute(\"data-assignment-id\");\n    this.shadowRoot\n      .querySelector(\".assignment-\" + active)\n      .scrollIntoView({ block: \"end\", behavior: \"smooth\" });\n  },\n\n  /**\n   * Handle response for the whole projects object.\n   */\n  _handleResponse: function(event) {\n    this.$.loading.hidden = true;\n  },\n\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"@lrnwebcomponents/lrndesign-avatar/lrndesign-avatar.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nimport \"@lrnwebcomponents/elmsln-apps/lib/lrnapp-studio-submission/lrnapp-studio-submission-display.js\";\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\"></style>\n    <style>\n      :host {\n        display: block;\n        align-content: center;\n      }\n      #loading {\n        width: 100%;\n        z-index: 1000;\n        opacity: 0.8;\n        text-align: center;\n        align-content: center;\n        justify-content: center;\n        height: 100vh;\n        position: absolute;\n        background-color: white;\n      }\n      h1.empty-title,\n      h1.assignment-title {\n        font-size: 2em;\n      }\n      .submission-title {\n        font-size: 1em;\n        font-weight: bold;\n        width: 100%;\n        margin-bottom: 2rem;\n        text-transform: none;\n      }\n      .submission-list {\n        display: flex;\n        align-items: center;\n      }\n      .submission-list-item {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        word-break: break-all;\n        word-wrap: break-word;\n      }\n    </style>\n    <template is=\"dom-if\" if=\"[[!showSubmissions]]\">\n      <h1 class=\"empty-title black-text\">\n        Please select an Assignment in order to view all submissions\n      </h1>\n    </template>\n    <template is=\"dom-if\" if=\"[[showSubmissions]]\">\n      <h1 class=\"assignment-title black-text\">\n        [[activeAssignment.attributes.title]]\n      </h1>\n      <div class=\"submission-list\">\n        <template is=\"dom-repeat\" items=\"[[submissions]]\" as=\"submission\">\n          <lrnsys-button\n            on-tap=\"_scrollToTarget\"\n            raised=\"\"\n            class=\"submission-list-item\"\n            button-class=\"submission-list-item\"\n            hover-class=\"blue white-text\"\n            data-submission-id\\$=\"[[submission.id]]\"\n          >\n            <span slot=\"button\">\n              <lrndesign-avatar\n                src=\"[[submission.relationships.author.data.avatar]]\"\n                label=\"[[submission.relationships.author.data.name]]\"\n                style=\"display:inline-block;\"\n                data-submission-id\\$=\"[[submission.id]]\"\n              ></lrndesign-avatar>\n            </span>\n            <span slot=\"label\"\n              >[[submission.relationships.author.data.display_name]]</span\n            >\n          </lrnsys-button>\n        </template>\n      </div>\n      <template is=\"dom-repeat\" items=\"[[submissions]]\" as=\"submission\">\n        <lrnapp-studio-submission-display\n          id\\$=\"submission-[[submission.id]]\"\n          submission=\"[[submission]]\"\n          class=\"ferpa-protect\"\n        ></lrnapp-studio-submission-display>\n        <a tabindex=\"-1\"\n          ><paper-button\n            class=\"submission-title ferpa-protect\"\n            on-tap=\"_loadSubmissionUrl\"\n            data-submission-id\\$=\"[[submission.id]]\"\n            >Tap to comment on[[submission.attributes.title]] by\n            [[submission.relationships.author.data.display_name]]</paper-button\n          ></a\n        >\n      </template>\n    </template>\n  `,\n  is: \"lrnapp-open-studio-assignments\",\n  properties: {\n    /**\n     * The assignments that exist so we can make other calls for data\n     */\n    assignments: {\n      type: Array,\n      notify: true\n    },\n    /**\n     * The submissions that exist so we can make other calls for data\n     */\n    submissions: {\n      type: Array,\n      notify: true\n    },\n    activeAssignmentId: {\n      type: String,\n      reflectToAttribute: true,\n      value: null,\n      notify: true\n    },\n    activeAssignment: {\n      type: Object,\n      notify: true,\n      computed: \"_activeAssignmentCompute(activeAssignmentId, assignments)\"\n    },\n    activeAuthorId: {\n      type: String,\n      reflectToAttribute: true,\n      value: null,\n      notify: true\n    },\n    showSubmissions: {\n      type: Boolean,\n      computed: \"_showSubmissions(activeAssignmentId)\",\n      value: false,\n      notify: true\n    },\n    /**\n     * Endpoint for submission data.\n     */\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    /**\n     * base path for the app\n     */\n    basePath: {\n      type: String,\n      notify: true\n    }\n  },\n  /**\n   * Handle tap on paper-button above to redirect to the correct submission url.\n   */\n  _loadSubmissionUrl: function(e) {\n    let root = this;\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // this will have the id of the current submission\n    var active = local.getAttribute(\"data-submission-id\");\n    // @todo need a cleaner integration but this at least goes the right place for now\n    window.location.href =\n      this.basePath + \"lrnapp-studio-submission/submissions/\" + active;\n  },\n  _activeAssignmentCompute: function(activeAssignmentId, assignments) {\n    let activeAssignment = null;\n    if (assignments) {\n      activeAssignment = assignments.find(assignment => {\n        return assignment.id == activeAssignmentId;\n      });\n    }\n    return activeAssignment;\n  },\n  _showSubmissions: function(activeAssignmentId) {\n    if (activeAssignmentId) {\n      return true;\n    }\n    return false;\n  },\n  _scrollToTarget: function(e) {\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // this will have the id of the current submission\n    var active = local.getAttribute(\"data-submission-id\");\n    this.shadowRoot\n      .querySelector(\"#submission-\" + active)\n      .scrollIntoView({ block: \"start\", behavior: \"smooth\" });\n  },\n  /**\n   * Handle response for the whole assignments object.\n   */\n  _handleResponse: function(event) {\n    this.$.loading.hidden = true;\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/iron-list/iron-list.js\";\nimport \"@polymer/iron-pages/iron-pages.js\";\nimport \"@polymer/iron-selector/iron-selector.js\";\nimport \"@polymer/app-layout/app-toolbar/app-toolbar.js\";\nimport \"@polymer/app-route/app-location.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@polymer/paper-dropdown-menu/paper-dropdown-menu.js\";\nimport \"@polymer/paper-listbox/paper-listbox.js\";\nimport \"@polymer/paper-item/paper-item.js\";\nimport \"@polymer/paper-toast/paper-toast.js\";\nimport \"@lrnwebcomponents/lrndesign-gallerycard/lrndesign-gallerycard.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"./lrnapp-open-studio-table.js\";\nimport \"./lrnapp-open-studio-projects.js\";\nimport \"./lrnapp-open-studio-assignments.js\";\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\">\n      :host {\n        display: block;\n        align-content: center;\n      }\n      #loading {\n        width: 100%;\n        z-index: 1000;\n        opacity: 0.8;\n        text-align: center;\n        align-content: center;\n        justify-content: center;\n        height: 100vh;\n        position: absolute;\n        background-color: white;\n      }\n      iron-selector {\n        line-height: 1em;\n      }\n      iron-selector lrnsys-button {\n        display: inline-flex;\n      }\n      paper-button.gallerycard-wrapper {\n        margin: 0;\n        padding: 0;\n      }\n      lrndesign-gallerycard {\n        padding: 0;\n        margin: 1em;\n        height: 15em;\n        width: 14em;\n      }\n      .gallery-grid {\n        margin: 0 auto;\n        width: 95%;\n      }\n      .iron-selected .display-mode {\n        background-color: #ff6f00;\n        color: white;\n      }\n      .iron-list-container {\n        display: flex;\n        flex-direction: column;\n        min-height: 50vh;\n      }\n      iron-list {\n        flex: 1 1 auto;\n      }\n    </style>\n    <iron-ajax\n      auto\n      url=\"[[sourcePath]]\"\n      params=\"\"\n      handle-as=\"json\"\n      last-response=\"{{studioResponse}}\"\n      on-response=\"_handleResponse\"\n    ></iron-ajax>\n\n    <app-location\n      route=\"{{route}}\"\n      query-params=\"{{queryParams}}\"\n    ></app-location>\n    <app-route\n      route=\"{{route}}\"\n      pattern=\"[[endPoint]]/:page\"\n      data=\"{{data}}\"\n      tail=\"{{tail}}\"\n      query-params=\"{{queryParams}}\"\n    >\n    </app-route>\n\n    <div id=\"loading\">\n      <h3>Loading..</h3>\n      <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n    </div>\n    <app-toolbar class=\"amber lighten-3\">\n      <iron-selector\n        selected=\"{{data.page}}\"\n        attr-for-selected=\"name\"\n        role=\"navigation\"\n      >\n        <a tabindex=\"-1\" name=\"submissions\" on-tap=\"_submissionsClicked\"\n          ><lrnsys-button\n            icon=\"apps\"\n            label=\"Submission display\"\n            hover-class=\"amber darken-4 white-text\"\n            class=\"display-mode\"\n            button-class=\"display-mode style-scope lrnapp-open-studio x-scope lrnsys-button-0\"\n          ></lrnsys-button\n        ></a>\n        <a tabindex=\"-1\" name=\"projects\" on-tap=\"_projectsClicked\"\n          ><lrnsys-button\n            icon=\"folder\"\n            label=\"Project board\"\n            hover-class=\"amber darken-4 white-text\"\n            class=\"display-mode\"\n            button-class=\"display-mode style-scope lrnapp-open-studio x-scope lrnsys-button-0\"\n          ></lrnsys-button\n        ></a>\n        <a tabindex=\"-1\" name=\"assignments\" on-tap=\"_assignmentsClicked\"\n          ><lrnsys-button\n            icon=\"list\"\n            label=\"Assignment centric\"\n            hover-class=\"amber darken-4 white-text\"\n            class=\"display-mode\"\n            button-class=\"display-mode style-scope lrnapp-open-studio x-scope lrnsys-button-0\"\n          ></lrnsys-button\n        ></a>\n        <a tabindex=\"-1\" name=\"table\" on-tap=\"_tableClicked\"\n          ><lrnsys-button\n            icon=\"view-list\"\n            label=\"Table view\"\n            hover-class=\"amber darken-4 white-text\"\n            class=\"display-mode\"\n            button-class=\"display-mode style-scope lrnapp-open-studio x-scope lrnsys-button-0\"\n          ></lrnsys-button\n        ></a>\n      </iron-selector>\n      <span main-title></span>\n      <span top-item style=\"text-align:right;font-size:.5em;padding-right:1em;\"\n        >Displaying [[submissions.length]] of\n        [[originalSubmissions.length]]</span\n      >\n      <paper-dropdown-menu label=\"Author\" hidden$=\"[[!authors]]\">\n        <paper-listbox\n          slot=\"dropdown-content\"\n          class=\"dropdown-content\"\n          selected=\"{{queryParams.author}}\"\n          attr-for-selected=\"item-id\"\n        >\n          <paper-item></paper-item>\n          <template is=\"dom-repeat\" items=\"[[_toArray(authors)]]\" as=\"author\">\n            <paper-item item-id=\"[[author.id]]\"\n              >[[author.display_name]]</paper-item\n            >\n          </template>\n        </paper-listbox>\n      </paper-dropdown-menu>\n      <paper-dropdown-menu label=\"Project\" hidden$=\"[[!projects]]\">\n        <paper-listbox\n          slot=\"dropdown-content\"\n          class=\"dropdown-content\"\n          selected=\"{{queryParams.project}}\"\n          attr-for-selected=\"item-id\"\n        >\n          <paper-item></paper-item>\n          <template is=\"dom-repeat\" items=\"[[_toArray(projects)]]\" as=\"project\">\n            <paper-item item-id=\"[[project.id]]\"\n              >[[project.attributes.title]]</paper-item\n            >\n          </template>\n        </paper-listbox>\n      </paper-dropdown-menu>\n      <paper-dropdown-menu label=\"Assignment\" hidden$=\"[[!assignments]]\">\n        <paper-listbox\n          slot=\"dropdown-content\"\n          class=\"dropdown-content\"\n          selected=\"{{queryParams.assignment}}\"\n          attr-for-selected=\"item-id\"\n        >\n          <paper-item></paper-item>\n          <template\n            is=\"dom-repeat\"\n            items=\"[[_toArray(assignments)]]\"\n            as=\"assignment\"\n          >\n            <paper-item item-id=\"[[assignment.id]]\"\n              >[[assignment.attributes.title]]</paper-item\n            >\n          </template>\n        </paper-listbox>\n      </paper-dropdown-menu>\n    </app-toolbar>\n    <div class=\"gallery-grid\">\n      <iron-pages\n        selected=\"{{data.page}}\"\n        attr-for-selected=\"name\"\n        fallback-selection=\"submissions\"\n        role=\"main\"\n      >\n        <div class=\"iron-list-container\" name=\"submissions\">\n          <iron-list id=\"ironlist\" items=\"[[submissions]]\" as=\"item\" grid>\n            <template>\n              <paper-button\n                data-submission-id$=\"[[item.id]]\"\n                class=\"gallerycard-wrapper\"\n                on-tap=\"_loadSubmissionUrl\"\n              >\n                <lrndesign-gallerycard\n                  elevation=\"2\"\n                  data-submission-id$=\"[[item.id]]\"\n                  title=\"[[item.attributes.title]]\"\n                  author=\"[[item.relationships.author.data]]\"\n                  comments=\"[[item.meta.comment_count]]\"\n                  image=\"[[item.display.image]]\"\n                  icon=\"[[item.display.icon]]\"\n                  date=\"[[item.meta.humandate]]\"\n                  class=\"ferpa-protect\"\n                >\n                </lrndesign-gallerycard>\n              </paper-button>\n            </template>\n          </iron-list>\n        </div>\n        <lrnapp-open-studio-assignments\n          name=\"assignments\"\n          base-path=\"[[basePath]]\"\n          submissions=\"[[submissions]]\"\n          assignments=\"[[assignments]]\"\n          active-author-id=\"[[queryParams.author]]\"\n          active-assignment-id=\"[[queryParams.assignment]]\"\n        ></lrnapp-open-studio-assignments>\n        <lrnapp-open-studio-projects\n          name=\"projects\"\n          base-path=\"[[basePath]]\"\n          projects=\"[[projects]]\"\n          submissions=\"[[submissions]]\"\n          assignments=\"[[assignments]]\"\n          active-author-id=\"[[queryParams.author]]\"\n          active-project-id=\"[[queryParams.project]]\"\n        ></lrnapp-open-studio-projects>\n        <lrnapp-open-studio-table\n          name=\"table\"\n          base-path=\"[[basePath]]\"\n          submissions=\"{{submissions}}\"\n        ></lrnapp-open-studio-table>\n      </iron-pages>\n    </div>\n    <paper-toast id=\"toast\"></paper-toast>\n  `,\n  is: \"lrnapp-open-studio\",\n  properties: {\n    /**\n     * The studioResponse from server\n     */\n    studioResponse: {\n      type: Object,\n      notify: true\n    },\n    /**\n     * The submissions to render; potentially filtered\n     */\n    submissions: {\n      type: Object,\n      notify: true,\n      computed: \"_submissionsCompute(originalSubmissions, queryParams)\"\n    },\n    /**\n     * The original submissions array; used to filter against\n     */\n    originalSubmissions: {\n      type: Object,\n      notify: true\n    },\n    /**\n     * The submissions to render\n     */\n    projects: {\n      type: Array,\n      notify: true,\n      value: []\n    },\n    /**\n     * The assignments to render\n     */\n    assignments: {\n      type: Array,\n      notify: true,\n      value: []\n    },\n    /**\n     * The authors to render\n     */\n    authors: {\n      type: Array,\n      notify: true,\n      value: []\n    },\n    /**\n     * sourcePath for submission data.\n     */\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    /**\n     * Endpoint for submission data.\n     */\n    endPoint: {\n      type: String,\n      notify: true\n    },\n    /**\n     * base path for the app\n     */\n    basePath: {\n      type: String,\n      notify: true\n    },\n    /**\n     * Active / clicked submission.\n     */\n    activeSubmission: {\n      type: String,\n      value: null,\n      notify: true\n    },\n    queryParams: {\n      type: Object,\n      notify: true\n    },\n    _blockcycle: {\n      type: Boolean,\n      value: false\n    }\n  },\n  listeners: {\n    \"route-change\": \"_routeChange\"\n  },\n  observers: [\n    \"_routeChanged(route, endPoint)\",\n    \"_deleteToast(queryParams.deletetoast)\",\n    \"_assignmentFilterChanged(queryParams.assignment)\",\n    \"_projectFilterChanged(queryParams.project)\"\n  ],\n  // If the current route is outside the scope of our app\n  // then allow the website to break out of the single page\n  // application routing\n  _routeChanged: function(route, endPoint) {\n    if (typeof route.path === \"string\") {\n      if (typeof endPoint === \"string\") {\n        if (route.path.startsWith(endPoint)) {\n          return;\n        }\n      }\n      // reload the page which since route changed will load that page\n      window.location.reload();\n    }\n  },\n  /**\n   * Change route from deeper in the app.\n   */\n  _routeChange: function(e) {\n    var details = e.detail;\n    if (typeof details.queryParams.assignment !== typeof undefined) {\n      this.set(\"queryParams.assignment\", details.queryParams.assignment);\n    }\n    if (typeof details.queryParams.project !== typeof undefined) {\n      this.set(\"queryParams.project\", details.queryParams.project);\n    }\n    if (typeof details.queryParams.author !== typeof undefined) {\n      this.set(\"queryParams.author\", details.queryParams.author);\n    }\n    if (typeof details.data.page !== typeof undefined) {\n      this.set(\"data.page\", details.data.page);\n    }\n  },\n  _submissionsCompute: function(originalSubmissions, queryParams) {\n    // if we don't have an original submissions object to work with then we need to bail\n    if (typeof originalSubmissions === \"undefined\") {\n      return [];\n    }\n    // define vars\n    const root = this;\n    let filteredSubmissions = [];\n    // filter the submissions by the query params\n    filteredSubmissions = originalSubmissions.filter(submission => {\n      if (typeof root.queryParams.author !== \"undefined\") {\n        if (\n          submission.relationships.author.data.id !== root.queryParams.author\n        ) {\n          return false;\n        }\n      }\n      if (typeof root.queryParams.project !== \"undefined\") {\n        if (\n          submission.relationships.project.data.id !== root.queryParams.project\n        ) {\n          return false;\n        }\n      }\n      if (typeof root.queryParams.assignment !== \"undefined\") {\n        if (\n          submission.relationships.assignment.id !== root.queryParams.assignment\n        ) {\n          return false;\n        }\n      }\n      return true;\n    });\n    // delay and repaint, can help with refresh issues\n    setTimeout(() => {\n      this.$.ironlist.fire(\"iron-resize\");\n    }, 200);\n    return filteredSubmissions;\n  },\n  /**\n   * Support having a toast message because of delete or error elsewhere.\n   */\n  _deleteToast: function(deletetoast, old) {\n    if (typeof deletetoast !== typeof undefined) {\n      if (deletetoast == \"error\") {\n        this.$.toast.show(\"That submission on longer exists!\");\n      } else {\n        this.$.toast.show(\"Submission deleted successfully!\");\n      }\n      this.set(\"queryParams.deletetoast\", undefined);\n      this.notifyPath(\"queryParams.deletetoast\");\n    }\n  },\n  _assignmentFilterChanged: function(assignment) {\n    // if we have a assignment then we need to uncheck project\n    if (typeof assignment !== typeof undefined && !this._blockcycle) {\n      this._blockcycle = true;\n      this.set(\"queryParams.project\", undefined);\n      this.notifyPath(\"queryParams.project\");\n      this.set(\"queryParams.assignment\", assignment);\n      this.notifyPath(\"queryParams.assignment\");\n    } else {\n      this._blockcycle = false;\n    }\n  },\n  _projectFilterChanged: function(project) {\n    // if we have a project then we need to uncheck assignment\n    if (typeof project !== typeof undefined && !this._blockcycle) {\n      this._blockcycle = true;\n      this.set(\"queryParams.project\", project);\n      this.notifyPath(\"queryParams.project\");\n      this.set(\"queryParams.assignment\", undefined);\n      this.notifyPath(\"queryParams.assignment\");\n    } else {\n      this._blockcycle = false;\n    }\n  },\n  /**\n   * Handle tap on paper-button above to redirect to the correct submission url.\n   */\n  _loadSubmissionUrl: function(e) {\n    let root = this;\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // this will have the id of the current submission\n    var active = local.getAttribute(\"data-submission-id\");\n    // @todo need a cleaner integration but this at least goes the right place for now\n    window.location.href =\n      this.basePath + \"lrnapp-studio-submission/submissions/\" + active;\n  },\n  /**\n   * Handle response for the whole projects object.\n   */\n  _handleResponse: function(event) {\n    let root = this;\n    var author = {};\n    var project = {};\n    var tmp = {\n      authors: [],\n      assignments: []\n    };\n    var assignment = {};\n    var assignments = [];\n    var authors = [];\n    // get the submission response's data and convert to array ahead of time\n    var submissions = this._toArray(root.studioResponse.data.submissions);\n    var projects = this._toArray(root.studioResponse.data.projects);\n    this.set(\"projects\", projects);\n    // original = active off the bat then we apply filters later to chang this\n    this.set(\"originalSubmissions\", submissions);\n    // figure out authors and assignments\n    for (var index = 0; index < submissions.length; index++) {\n      author = submissions[index].relationships.author.data;\n      tmp.authors[author.id] = author;\n      project = submissions[index].relationships.project.data;\n      assignment = submissions[index].relationships.assignment;\n      tmp.assignments[assignment.id] = assignment;\n      tmp.assignments[assignment.id].project = project.id;\n    }\n    // this is stupid but we have to normalize the IDs or else dom repeats will be screwed up\n    tmp.authors.forEach(function(element) {\n      authors.push(element);\n    });\n    // this is stupid but we have to normalize the IDs or else dom repeats will be screwed up\n    tmp.assignments.forEach(function(element) {\n      assignments.push(element);\n    });\n    root.$.loading.hidden = true;\n    this.set(\"assignments\", assignments);\n    this.set(\"authors\", authors);\n  },\n  _submissionsClicked: function(e) {\n    this.set(\"route.path\", this.endPoint + \"/submissions\");\n    this.notifyPath(\"route.path\");\n  },\n  _projectsClicked: function(e) {\n    this.set(\"route.path\", this.endPoint + \"/projects\");\n    this.notifyPath(\"route.path\");\n  },\n  _assignmentsClicked: function(e) {\n    this.set(\"route.path\", this.endPoint + \"/assignments\");\n    this.notifyPath(\"route.path\");\n  },\n  _tableClicked: function(e) {\n    this.set(\"route.path\", this.endPoint + \"/table\");\n    this.notifyPath(\"route.path\");\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\nimport \"@polymer/iron-list/iron-list.js\";\nimport \"@polymer/paper-card/paper-card.js\";\nimport \"@polymer/paper-item/paper-item-shared-styles.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles paper-item-styles\">\n      :host {\n        display: block;\n      }\n      #loading {\n        width: 100%;\n        z-index: 1000;\n        opacity: 0.8;\n        text-align: center;\n        align-content: center;\n        justify-content: center;\n        background-color: white;\n      }\n      paper-button {\n        padding: 0;\n        margin: 0;\n        min-width: 1rem;\n        text-transform: unset;\n      }\n      .project-card {\n        width: 100%;\n        min-width: 15em;\n        max-width: 20em;\n        margin: 0 1em;\n      }\n      .button-contents {\n        display: flex;\n        align-content: center;\n      }\n      .assignment-row {\n        border: 1px solid #000000;\n        background-color: #ffffff;\n      }\n      .assignment-row .assignment-row-button.active {\n        background-color: var(--paper-amber-50);\n        font-weight: bold;\n      }\n      .assignment-row:hover .assignment-operations {\n        display: block;\n        overflow: visible;\n        margin: 0.2em;\n      }\n      .assignment-row-button {\n        width: 100%;\n        justify-content: flex-start;\n        height: 3em;\n        text-transform: none;\n      }\n      .assignment-title {\n        display: inline-flex;\n        align-items: center;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        line-height: 1em;\n      }\n      .status-indicator {\n        border-right: 1px solid grey;\n        padding: 0.5em;\n        margin: 0 0.5em 0 0;\n        display: inline-flex;\n        line-height: 3em;\n        height: 3em;\n        justify-content: center;\n        align-items: center;\n      }\n      .whole-project {\n        width: 100%;\n        margin: 0;\n        padding: 0;\n      }\n    </style>\n    <iron-ajax\n      auto=\"\"\n      url=\"{{sourcePath}}\"\n      handle-as=\"json\"\n      last-response=\"{{response}}\"\n      on-response=\"handleResponse\"\n    ></iron-ajax>\n    <div id=\"loading\">\n      <h3>Loading..</h3>\n      <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n    </div>\n    <template is=\"dom-if\" if=\"[[hasProject]]\">\n      <a tabindex=\"-1\" href\\$=\"[[basePath]]lrnapp-studio-kanban\">\n        <paper-button class=\"whole-project ferpa-protect\">\n          <paper-card\n            id\\$=\"project-[[project.id]]\"\n            class=\"project-card grey lighten-3\"\n            heading=\"{{project.attributes.title}}\"\n            elevation=\"2\"\n          >\n            <div class=\"card-content\">\n              <iron-list\n                items=\"[[_toArray(project.relationships.assignments)]]\"\n                as=\"assignment\"\n              >\n                <template>\n                  <div class=\"assignment-row\" id=\"assignment\">\n                    <lrnsys-button\n                      inner-class=\"no-left-padding\"\n                      class=\"assignment-row-button\"\n                      button-class=\"assignment-row-button\"\n                      id\\$=\"assignment-[[project.id]]-[[assignment.id]]\"\n                      hover-class=\"amber lighten-5\"\n                      href\\$=\"[[basePath]]lrnapp-studio-kanban\"\n                    >\n                      <span slot=\"button\" class=\"button-contents\">\n                        <div\n                          class\\$=\"status-indicator [[assignment.metadata.relatedSubmissions.complete.color]]\"\n                        >\n                          <iron-icon\n                            icon=\"[[assignment.metadata.relatedSubmissions.complete.icon]]\"\n                          ></iron-icon>\n                        </div>\n                        <div class=\"assignment-title\">[[assignment.title]]</div>\n                      </span>\n                    </lrnsys-button>\n                  </div>\n                </template>\n              </iron-list>\n            </div>\n          </paper-card>\n        </paper-button>\n      </a>\n    </template>\n    <template is=\"dom-if\" if=\"[[!hasProject]]\">\n      <lrnsys-button\n        inner-class=\"no-left-padding\"\n        button-class=\"assignment-row-button\"\n        class=\"assignment-row-button\"\n        href\\$=\"[[basePath]]lrnapp-studio-kanban\"\n        hover-class=\"amber lighten-5\"\n      >\n        <span slot=\"button\" class=\"button-contents\">\n          <div class=\"status-indicator\">\n            <iron-icon icon=\"assignment\"></iron-icon>\n          </div>\n          <div class=\"assignment-title\">Tap to start your first project!</div>\n        </span>\n      </lrnsys-button>\n    </template>\n  `,\n\n  is: \"lrnapp-block-recent-project\",\n\n  properties: {\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    response: {\n      type: Object,\n      notify: true\n    },\n    project: {\n      type: Object,\n      notify: true\n    },\n    hasProject: {\n      type: Boolean,\n      notify: true,\n      reflectToAttribute: true,\n      computed: \"_getHasProject(project)\"\n    }\n  },\n\n  /**\n   * Generate the correct boolean for having a project.\n   */\n  _getHasProject: function(project) {\n    if (typeof project.id !== typeof undefined) {\n      return true;\n    }\n    return false;\n  },\n\n  /**\n   * Swap off the loading with project data.\n   */\n  handleResponse: function(e) {\n    this.$.loading.hidden = true;\n    this.project = this.response.data;\n  },\n\n  /**\n   * Generate an array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/iron-list/iron-list.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@lrnwebcomponents/lrndesign-gallerycard/lrndesign-gallerycard.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nPolymer({\n  _template: html`\n    <style include=\"paper-item-styles\">\n      :host {\n        display: block;\n      }\n      paper-button {\n        width: 100%;\n      }\n    </style>\n    <iron-ajax\n      auto=\"\"\n      url=\"{{sourcePath}}\"\n      handle-as=\"json\"\n      last-response=\"{{response}}\"\n      on-response=\"handleResponse\"\n    ></iron-ajax>\n    <div id=\"loading\">\n      <h3>Loading..</h3>\n      <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n    </div>\n    <iron-list items=\"[[_toArray(response.data)]]\" as=\"item\">\n      <template>\n        <paper-button on-tap=\"_loadSubmissionUrl\">\n          <lrndesign-gallerycard\n            data-submission-id\\$=\"[[item.id]]\"\n            title=\"[[item.attributes.title]]\"\n            author=\"[[item.relationships.author.data]]\"\n            comments=\"[[item.meta.comment_count]]\"\n            image=\"[[item.display.image]]\"\n            icon=\"[[item.display.icon]]\"\n            class=\"ferpa-protect\"\n          >\n          </lrndesign-gallerycard>\n        </paper-button>\n      </template>\n    </iron-list>\n  `,\n  is: \"lrnapp-block-recent-submissions\",\n  properties: {\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    response: {\n      type: Array,\n      notify: true\n    }\n  },\n  /**\n   * Handle tap on paper-button above to redirect to the correct submission url.\n   */\n  _loadSubmissionUrl: function(e) {\n    let root = this;\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // this will have the id of the current submission\n    var active = local.getAttribute(\"data-submission-id\");\n    // @todo need a cleaner integration but this at least goes the right place for now\n    window.location.href =\n      this.basePath + \"lrnapp-studio-submission/submissions/\" + active;\n  },\n  handleResponse: function(e) {\n    this.$.loading.hidden = true;\n  },\n  _getViewLink: function(nid) {\n    return this.basePath + \"lrnapp-studio-submission/submissions/\" + nid;\n  },\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { IronResizableBehavior } from \"@polymer/iron-resizable-behavior/iron-resizable-behavior.js\";\nimport \"@polymer/paper-card/paper-card.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@lrnwebcomponents/lrn-icon/lrn-icon.js\";\nimport \"@lrnwebcomponents/lrndesign-avatar/lrndesign-avatar.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n\n      paper-card {\n        padding: 2em 2em 0 2em;\n        clear: right;\n      }\n\n      paper-button {\n        background-color: var(--paper-grey-100);\n        margin: 1em;\n      }\n\n      .card-content {\n        padding-left: 2em;\n        padding-right: 2em;\n        width: 100%;\n      }\n\n      .card-actions {\n        width: 100%;\n      }\n\n      .card-actions paper-button {\n        display: flex;\n      }\n\n      lrndesign-avatar {\n        float: left;\n        margin-right: 1em;\n      }\n\n      .flex-wrap {\n        @apply --layout-horizontal;\n        @apply --layout-wrap;\n      }\n\n      .inactive {\n        max-height: 4.6em;\n        overflow: hidden;\n      }\n\n      paper-button {\n        background: white;\n        width: 100%;\n        display: flex;\n      }\n\n      lrn-icon {\n        color: black;\n        width: 100%;\n      }\n\n      .hidden {\n        display: none;\n      }\n    </style>\n    <paper-card elevation=\"3\" class=\"flex-wrap\">\n      <div class=\"card-content\">\n        <lrndesign-avatar\n          label=\"[[commentUser.name]]\"\n          src=\"[[commentUser.avatar]]\"\n        ></lrndesign-avatar>\n        <h3>[[commentUser.display_name]]</h3>\n        <div id=\"wrapper\" class=\"button-wrapper\">\n          <div id=\"comment\" class=\"inactive\"><slot></slot></div>\n          <paper-button id=\"btn\" class=\"hidden\">\n            <lrn-icon icon=\"chevron-down\" id=\"icon\"></lrn-icon>\n          </paper-button>\n        </div>\n      </div>\n      <div class=\"card-actions\">\n        <template is=\"dom-if\" if=\"[[actionView]]\">\n          <a href$=\"[[actionView]]\" tabindex=\"-1\">\n            <paper-button raised=\"\" id=\"view\">View thread</paper-button>\n          </a>\n        </template>\n      </div>\n    </paper-card>\n  `,\n\n  is: \"lrnapp-block-recent-comments-comment\",\n  behaviors: [IronResizableBehavior],\n\n  listeners: {\n    \"iron-resize\": \"onHeightChange\"\n  },\n\n  onHeightChange: function() {\n    var height = this.$.comment.offsetHeight;\n    if (height > 80) {\n      this.$.btn.classList.toggle(\"hidden\", this.hidden);\n    }\n  },\n  properties: {\n    commentTitle: {\n      type: String,\n      value: \"Comment title\",\n      reflectToAttribute: true,\n      notify: true\n    },\n    actionView: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    dateUpdated: {\n      type: String,\n      reflectToAttribute: true,\n      notify: true\n    },\n    commentUser: {\n      type: Object,\n      value: {},\n      reflectToAttribute: true,\n      notify: true\n    }\n  },\n  /**\n   * attached life cycle\n   */\n  attached: function() {\n    this.$.wrapper.addEventListener(\"click\", function(e) {\n      this.$.comment.classList.toggle(\"inactive\", this.inactive);\n    });\n  },\n  /**\n   * detached life cycle\n   */\n  detached: function() {\n    this.$.wrapper.removeEventListener(\"click\", function(e) {\n      this.$.comment.classList.toggle(\"inactive\", this.inactive);\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/paper-item/paper-item.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"./lrnapp-block-recent-comments-comment.js\";\nPolymer({\n  _template: html`\n    <style include=\"paper-item-styles\">\n      :host {\n        display: block;\n      }\n    </style>\n    <div id=\"loading\">\n      <h3>Loading..</h3>\n      <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n    </div>\n    <iron-ajax\n      auto=\"\"\n      url=\"{{sourcePath}}\"\n      handle-as=\"json\"\n      last-response=\"{{response}}\"\n      on-response=\"handleResponse\"\n    ></iron-ajax>\n    <template is=\"dom-repeat\" items=\"[[_toArray(response.data)]]\" as=\"comment\">\n      <lrnapp-block-recent-comments-comment\n        comment-user=\"{{comment.relationships.author.data}}\"\n        comment-title=\"{{comment.attributes.subject}}\"\n        action-view=\"{{_getViewLink(comment.relationships.node.data.id)}}\"\n        date-updated=\"{{comment.attributes.changed}}\"\n        class=\"ferpa-protect\"\n      >\n        [[comment.attributes.body]]\n      </lrnapp-block-recent-comments-comment>\n    </template>\n  `,\n  is: \"lrnapp-block-recent-comments\",\n  properties: {\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    response: {\n      type: Array,\n      notify: true\n    }\n  },\n  handleResponse: function(e) {\n    this.$.loading.hidden = true;\n  },\n  _getViewLink: function(nid) {\n    return this.basePath + \"lrnapp-studio-submission/submissions/\" + nid;\n  },\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/iron-list/iron-list.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/lrndesign-gallerycard/lrndesign-gallerycard.js\";\nPolymer({\n  _template: html`\n    <style include=\"paper-item-styles\">\n      :host {\n        display: block;\n      }\n      paper-button {\n        width: 100%;\n      }\n    </style>\n    <iron-ajax\n      auto=\"\"\n      url=\"{{sourcePath}}\"\n      handle-as=\"json\"\n      last-response=\"{{response}}\"\n      on-response=\"handleResponse\"\n    ></iron-ajax>\n    <div id=\"loading\">\n      <h3>Loading..</h3>\n      <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n    </div>\n    <iron-list items=\"[[_toArray(response.data)]]\" as=\"item\">\n      <template>\n        <paper-button on-tap=\"_loadSubmissionUrl\">\n          <lrndesign-gallerycard\n            data-submission-id\\$=\"[[item.id]]\"\n            title=\"[[item.attributes.title]]\"\n            author=\"[[item.relationships.author.data]]\"\n            comments=\"[[item.meta.comment_count]]\"\n            image=\"[[item.display.image]]\"\n            icon=\"[[item.display.icon]]\"\n            class=\"ferpa-protect\"\n          >\n          </lrndesign-gallerycard>\n        </paper-button>\n      </template>\n    </iron-list>\n  `,\n\n  is: \"lrnapp-block-need-feedback\",\n\n  properties: {\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    response: {\n      type: Array,\n      notify: true\n    }\n  },\n\n  /**\n   * Handle tap on paper-button above to redirect to the correct submission url.\n   */\n  _loadSubmissionUrl: function(e) {\n    let root = this;\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // this will have the id of the current submission\n    var active = local.getAttribute(\"data-submission-id\");\n    // @todo need a cleaner integration but this at least goes the right place for now\n    window.location.href =\n      this.basePath + \"lrnapp-studio-submission/submissions/\" + active;\n  },\n\n  handleResponse: function(e) {\n    this.$.loading.hidden = true;\n  },\n\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-card/paper-card.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nimport \"./lrnapp-block-recent-project.js\";\nimport \"./lrnapp-block-recent-submissions.js\";\nimport \"./lrnapp-block-recent-comments.js\";\nimport \"./lrnapp-block-need-feedback.js\";\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\">\n      :host {\n        display: block;\n        padding: 0 2em;\n      }\n      h1.title {\n        font-size: 2em;\n        color: black;\n        margin: 0;\n        padding: 0.5em 0 0 0;\n        text-transform: none;\n        text-align: left;\n      }\n      p.para {\n        margin: 0;\n        padding: 0.25em 0.5em;\n      }\n      .dashboard-row {\n        width: 100%;\n        display: inline-flex;\n      }\n      .dashboard-item {\n        width: 30%;\n      }\n    </style>\n    <h1 class=\"title\">Welcome back [[username]]!</h1>\n    <p class=\"para\">Here's what's been going on in the studio</p>\n    <div class=\"dashboard-row\">\n      <paper-card heading=\"Your active project\" class=\"dashboard-item\">\n        <div class=\"card-content\">\n          <lrnapp-block-recent-project\n            csrf-token=\"[[csrfToken]]\"\n            end-point=\"[[_getEndPoint(basePath)]]\"\n            base-path=\"[[basePath]]\"\n            source-path=\"[[_getDataSource(csrfToken, basePath,'recent-project')]]\"\n          >\n          </lrnapp-block-recent-project>\n        </div>\n      </paper-card>\n      <paper-card heading=\"Classmates needing feedback\" class=\"dashboard-item\">\n        <div class=\"card-content\">\n          <lrnapp-block-need-feedback\n            csrf-token=\"[[csrfToken]]\"\n            end-point=\"[[_getEndPoint(basePath)]]\"\n            base-path=\"[[basePath]]\"\n            source-path=\"[[_getDataSource(csrfToken, basePath,'need-feedback')]]\"\n          >\n          </lrnapp-block-need-feedback>\n        </div>\n      </paper-card>\n      <paper-card heading=\"Recent Studio submissions\" class=\"dashboard-item\">\n        <div class=\"card-content\">\n          <lrnapp-block-recent-submissions\n            csrf-token=\"[[csrfToken]]\"\n            end-point=\"[[_getEndPoint(basePath)]]\"\n            base-path=\"[[basePath]]\"\n            source-path=\"[[_getDataSource(csrfToken, basePath,'recent-submissions')]]\"\n          >\n          </lrnapp-block-recent-submissions>\n        </div>\n      </paper-card>\n      <paper-card heading=\"Recent Studio comments\" class=\"dashboard-item\">\n        <div class=\"card-content\">\n          <lrnapp-block-recent-comments\n            csrf-token=\"[[csrfToken]]\"\n            end-point=\"[[_getEndPoint(basePath)]]\"\n            base-path=\"[[basePath]]\"\n            source-path=\"[[_getDataSource(csrfToken, basePath,'recent-comments')]]\"\n          >\n          </lrnapp-block-recent-comments>\n        </div>\n      </paper-card>\n    </div>\n  `,\n  is: \"lrnapp-studio-dashboard\",\n  properties: {\n    username: {\n      type: String,\n      reflectToAttribute: true\n    },\n    basePath: {\n      type: String,\n      notify: true,\n      reflectToAttribute: true\n    },\n    csrfToken: {\n      type: String,\n      notify: true,\n      reflectToAttribute: true\n    },\n    sourcePath: {\n      type: String,\n      notify: true,\n      reflectToAttribute: true\n    }\n  },\n  _getEndPoint: function(basePath) {\n    return basePath + \"lrnapp-studio-dashboard/blocks\";\n  },\n  _getDataSource: function(csrfToken, basePath, dataPoint) {\n    return (\n      basePath +\n      \"lrnapp-studio-dashboard/blocks/\" +\n      dataPoint +\n      \"?token=\" +\n      csrfToken\n    );\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@polymer/app-route/app-location.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/paper-toggle-button/paper-toggle-button.js\";\nimport \"@polymer/paper-item/paper-item.js\";\nimport \"@polymer/paper-badge/paper-badge.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@polymer/paper-input/paper-input.js\";\nimport \"@polymer/paper-icon-button/paper-icon-button.js\";\nimport \"@polymer/paper-tooltip/paper-tooltip.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-filter.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-sorter.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-column-group.js\";\nimport \"@vaadin/vaadin-grid/vaadin-grid-selection-column.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/lrndesign-chart/lib/lrndesign-bar.js\";\nimport \"@lrnwebcomponents/lrndesign-chart/lib/lrndesign-line.js\";\nimport \"@lrnwebcomponents/lrndesign-chart/lib/lrndesign-pie.js\";\nimport \"@lrnwebcomponents/dropdown-select/dropdown-select.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"@lrnwebcomponents/lrndesign-avatar/lrndesign-avatar.js\";\nimport \"@lrnwebcomponents/lrnsys-layout/lib/lrnsys-dialog.js\";\nimport \"@lrnwebcomponents/elmsln-apps/lib/lrnapp-studio-submission/lrnapp-studio-submission.js\";\nPolymer({\n  _template: html`\n  <style include=\"materializecss-styles\">\n    :host {\n      display: block;\n      align-content: center;\n      padding: .8em;\n    }\n    vaadin-grid-table-body > vaadin-grid-cell-content {\n      height: unset !important;\n    }\n    lrnsys-dialog-toolbar {\n      top: 0;\n      position: sticky !important;\n      z-index: 1;\n    }\n    #loading {\n      width: 100%;\n      z-index: 1000;\n      opacity: .8;\n      text-align: center;\n      align-content: center;\n      justify-content: center;\n      height: 100vh;\n      position: absolute;\n      background-color: white;\n    }\n    .center-data {\n      text-align: center;\n    }\n    vaadin-grid#material {\n      height: 75vh;\n      font-family: Roboto, sans-serif;\n      --divider-color: rgba(0, 0, 0, var(--dark-divider-opacity));\n\n      --vaadin-grid-cell: {\n        padding: 0;\n      };\n\n      --vaadin-grid-header-cell: {\n        height: 3.5em;\n        color: rgba(0, 0, 0, var(--dark-secondary-opacity));\n        font-size: 1em;\n      };\n\n      --vaadin-grid-body-cell: {\n        height: 3em;\n        color: rgba(0, 0, 0, var(--dark-primary-opacity));\n        font-size: .8em;\n      };\n\n      --vaadin-grid-body-row-hover-cell: {\n        background-color: var(--paper-grey-200);\n      };\n\n      --vaadin-grid-body-row-selected-cell: {\n        background-color: var(--paper-grey-100);\n      };\n\n      --vaadin-grid-focused-cell: {\n        box-shadow: none;\n        font-weight: bold;\n      };\n    }\n\n    vaadin-grid#material .cell {\n      overflow: hidden;\n      text-overflow: ellipsis;\n      padding-right: 56px;\n    }\n\n    vaadin-grid#material .cell.last {\n      padding-right: 24px;\n    }\n\n    vaadin-grid#material .cell.numeric {\n      text-align: right;\n    }\n\n    vaadin-grid#material paper-checkbox {\n      --primary-color: var(--paper-indigo-500);\n      margin: 0 24px;\n    }\n\n    vaadin-grid#material vaadin-grid-sorter .cell {\n      flex: 1;\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n    }\n\n    vaadin-grid#material vaadin-grid-sorter iron-icon {\n      transform: scale(0.8);\n    }\n\n    vaadin-grid#material vaadin-grid-sorter:not([direction]) iron-icon {\n      color: rgba(0, 0, 0, var(--dark-disabled-opacity));\n    }\n\n    vaadin-grid#material vaadin-grid-sorter[direction] {\n      color: rgba(0, 0, 0, var(--dark-primary-opacity));\n    }\n\n    vaadin-grid#material vaadin-grid-sorter[direction=desc] iron-icon {\n      transform: scale(0.8) rotate(180deg);\n    }\n    vaadin-grid-sorter {\n      text-align: center;\n    }\n\n    lrndesign-avatar {\n      display: inline-block;\n    }\n    .avatar-label {\n      display: inline-block;\n      margin-left: .2em;\n    }\n\n    .avatar-button {\n\n    }\n    .assignment-button {\n      height: 1em;\n    }\n    .project-button {\n      height: 1em;\n    }\n    paper-badge {\n      top: 0 !important;\n      left: unset !important;\n      right: 0;\n      z-index: 1;\n    }\n    .avatar-link {\n      color: black;\n    }\n    .avatar-link paper-button {\n      text-transform: unset;\n    }\n    #selectedproject {\n      display: inline-block;\n    }\n    #datatype {\n      display: inline-block;\n      vertical-align: middle;\n      --paper-toggle-button-checked-bar-color:  var(--paper-green-500);\n      --paper-toggle-button-checked-button-color:  var(--paper-green-500);\n      --paper-toggle-button-checked-ink-color: var(--paper-green-500);\n      --paper-toggle-button-unchecked-bar-color:  var(--paper-amber-900);\n      --paper-toggle-button-unchecked-button-color:  var(--paper-amber-900);\n      --paper-toggle-button-unchecked-ink-color: var(--paper-amber-900);\n    }\n    .comment-list {\n      list-style-image: none;\n      display: inline-block;\n      padding: 0;\n      margin: 0;\n    }\n    .stats-text {\n      font-size: .8em;\n      font-style: italic;\n      line-height: 1em;\n      padding: 0 0 0 2em;\n      display: inline-block;\n      text-align: right;\n    }\n  </style>\n  <app-location route=\"{{route}}\"></app-location>\n  <app-route\n      route=\"{{route}}\"\n      pattern=\"[[endPoint]]/submissions/:submission\"\n      data=\"{{data}}\"\n      tail=\"{{tail}}\">\n  </app-route>\n  <iron-ajax auto\n    id=\"projectrequest\"\n    url=\"[[sourceProjectPath]]\"\n    params=\"\"\n    handle-as=\"json\"\n    last-response=\"{{_projectData}}\"\n    on-response=\"_handleProjectResponse\"></iron-ajax>\n  <iron-ajax\n    id=\"studentrequest\"\n    url=\"[[sourceStudentPath]]\"\n    params='[[studentParams]]'\n    handle-as=\"json\"\n    last-response=\"{{_studentData}}\"\n    on-response=\"_handleStudentResponse\"></iron-ajax>\n  <div id=\"loading\">\n    <h3>Loading..</h3>\n    <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n  </div>\n  <div hidden$=\"[[activeProject]]\">Select a project to begin reviewing work</div>\n  <dropdown-select id=\"selectedproject\" label=\"Project\">\n    <template is=\"dom-repeat\" items=\"[[_toArray(projects)]]\" as=\"project\">\n      <paper-item value$=\"[[project.id]]\">[[project.attributes.title]]</paper-item>\n    </template>\n  </dropdown-select>\n  <paper-toggle-button id=\"datatype\" checked=\"{{dataType}}\" disabled>\n    [[dataTypeText]]\n  </paper-toggle-button>\n  <lrnsys-dialog id=\"statsdialog\" disabled>\n    <span slot=\"button\"><iron-icon icon=\"editor:show-chart\"></iron-icon> Statistics (beta)</span>\n    <span slot=\"toolbar-primary\">\n      [[stats.header]]\n    </span>\n  <span slot=\"content\">\n      <div style=\"padding: 2em 4em;\">\n        <span class=\"stats-text\">[[stats.overview]]</span>\n        <dropdown-select id=\"selectedchart\" label=\"Graph style\">\n          <paper-item value=\"byassignment-submissions\">Submissions by Assignment</paper-item>\n          <paper-item value=\"byassignment-comments\">Comments by Assignment</paper-item>\n          <paper-item value=\"byassignment-commenters\">Commenters by Assignment</paper-item>\n        </dropdown-select>\n        <lrndesign-bar chart-title=\"[[activeChart.title]]\" chart-desc=\"[[activeChart.description]]\" data=\"[[activeChart.data]]\"></lrndesign-bar>\n      </div>\n    </span>\n  </lrnsys-dialog>\n  <vaadin-grid hidden$=\"[[!students]]\" id=\"material\" aria-label=\"Student project list\" items=\"[[_toArray(students)]]\">\n    <vaadin-grid-column resizable>\n      <template class=\"header\">\n        <vaadin-grid-sorter id=\"sorter\" path=\"sis.sortable_name\">Student</vaadin-grid-sorter>\n      </template>\n      <template>\n        <a href$=\"[[basePath]]lrnapp-open-studio/projects?author=[[item.id]]&project=[[activeProject]]\" tabindex=\"-1\" target=\"_blank\" class=\"avatar-link ferpa-protect\">\n          <paper-button class=\"avatar-button\">\n            <lrndesign-avatar label=\"[[item.name]]\" src=\"[[item.avatar]]\"></lrndesign-avatar>\n            <span class=\"avatar-label\">[[item.sis.sortable_name]]</span>\n          </paper-button>\n        </a>\n      </template>\n      <template class=\"footer\">\n        <vaadin-grid-filter aria-label=\"Student\" path=\"sis.sortable_name\" value=\"[[_filterName]]\">\n          <paper-input slot=\"filter\" label=\"Student\" value=\"{{_filterName::input}}\" focus-target></paper-input>\n        </vaadin-grid-filter>\n      </template>\n    </vaadin-grid-column>\n    <template is=\"dom-repeat\" items=\"[[_toArray(assignments)]]\" as=\"assignment\">\n      <vaadin-grid-column resizable>\n        <template class=\"header\">\n          <span>[[assignment.title]]</span>\n        </template>\n        <template>\n          <template is=\"dom-if\" if=\"[[_submissionStatus(item, assignment, dataType)]]\">\n            <template is=\"dom-if\" if=\"[[!dataType]]\">\n              <lrnsys-button icon=\"[[_submissionPiece(item, assignment, 'icon')]]\" id$=\"student-[[item.id]]-assignment-[[assignment.id]]-submission-[[_submissionID(item, assignment)]]\" label=\"[[_submissionPiece(item, assignment, 'title')]]\" on-tap=\"_setActiveSubmission\">\n              </lrnsys-button>\n            </template>\n            <template is=\"dom-if\" if=\"[[dataType]]\">\n              <ul class=\"comment-list\">\n              <template is=\"dom-repeat\" items=\"[[_submissionPiece(item, assignment, 'comments')]]\" as=\"commented\">\n                <li>\n                  <lrnsys-button icon=\"communication:comment\" id$=\"student-[[item.id]]-assignment-[[assignment.id]]-submission-[[commented]]\" label=\"#[[_commentIndex(index)]]\" on-tap=\"_setActiveComment\">\n                  </lrnsys-button>\n                </li>\n              </template>\n              </ul>\n            </template>\n          </template>\n          <template is=\"dom-if\" if=\"[[!_submissionStatus(item, assignment, dataType)]]\">\n            <paper-button disabled class=\"project-button\" id$=\"student-[[item.id]]-assignment-[[assignment.id]]-submission-null\">X</paper-button>\n          </template>\n          <template is=\"dom-if\" if=\"[[_commentCount(item, assignment, dataType)]]\">\n            <paper-badge id$=\"student-[[item.id]]-assignment-[[assignment.id]]-tip\" for=\"student-[[item.id]]-assignment-[[assignment.id]]\" label=\"[[_commentCount(item, assignment, dataType)]]\"></paper-badge>\n            <paper-tooltip for=\"student-[[item.id]]-assignment-[[assignment.id]]-tip\">Comments left on classmates [[assignment.title]]</paper-badge>\n          </template>\n        </template>\n      </vaadin-grid-column>\n    </template>\n  </vaadin-grid>\n  <lrnsys-dialog id=\"dialog\" style=\"overflow: visible;\">\n    <span slot=\"toolbar-primary\">\n      <span style=\"width:15em;\">\n        <paper-icon-button on-tap=\"_changeActiveItem\" id=\"prevstudent\" icon=\"arrow-upward\" title=\"previous student\"></paper-icon-button>\n        <paper-icon-button on-tap=\"_changeActiveItem\" id=\"nextstudent\" icon=\"arrow-downward\" title=\"next student\"></paper-icon-button>\n        <lrndesign-avatar class=\"ferpa-protect\" label=\"[[activeData.student.name]]\" src=\"[[activeData.student.avatar]]\" style=\"display:inline-block;vertical-align:middle;\"></lrndesign-avatar>\n        <span class=\"avatar-label ferpa-protect\" style=\"margin-left:1em;\">[[activeData.student.sis.sortable_name]]</span>\n      </span>\n      <paper-icon-button on-tap=\"_changeActiveItem\" id=\"prevassignment\" icon=\"arrow-back\" title=\"previous assignment\" style=\"margin-left:1em;\"></paper-icon-button>\n      <paper-icon-button on-tap=\"_changeActiveItem\" id=\"nextassignment\" icon=\"arrow-forward\" title=\"next assignment\"></paper-icon-button>\n      <span style=\"font-weight:bold;\">Assignment: [[activeData.assignment.title]]</span>\n    </span>\n    <span slot=\"content\">\n      <template is=\"dom-if\" if=\"[[activeData.submission]]\">\n        <lrnapp-studio-submission-page base-path=\"[[basePath]]\" route=\"{{tail}}\" id=\"[[data.submission]]\" end-point=\"[[basePath]]lrnapp-studio-submission\" csrf-token=\"[[csrfToken]]\" data=\"[[data]]\" hide-menu-bar></lrnapp-studio-submission-page>\n      </template>\n      <template is=\"dom-if\" if=\"[[!activeData.submission]]\">\n        <div>\n          <h3>No submission for this assignment</h3>\n          <p>This student has not submitted anything for this assignment at this time.</p>\n        </div>\n      </template>\n    </span>\n  </lrnsys-dialog>  \n`,\n  is: \"lrnapp-studio-instructor\",\n  observers: [\n    \"_routeChanged(route, endPoint)\",\n    \"_activeDataChanged(activeData.student, activeData.assignment)\"\n  ],\n  properties: {\n    /**\n     * Type of data to display, either submission centric or comment centric.\n     * False = submission, true = comment\n     */\n    dataType: {\n      type: Boolean,\n      value: false,\n      observer: \"_dataTypeChanged\"\n    },\n    dataTypeText: {\n      type: String,\n      value: \"Submissions\"\n    },\n    /**\n     * The projects to render\n     */\n    projects: {\n      type: Object,\n      notify: true\n    },\n    /**\n     * The assignments to render\n     */\n    assignments: {\n      type: Object,\n      notify: true\n    },\n    /**\n     * The submissions to render\n     */\n    students: {\n      type: Object,\n      notify: true,\n      value: false\n    },\n    /**\n     * Internal value for mapping the raw response data.\n     */\n    _projectData: {\n      type: Object,\n      value: {}\n    },\n    /**\n     * studentParams for the request\n     */\n    studentParams: {\n      type: Object,\n      value: {\n        projectId: null,\n        type: \"submission\"\n      }\n    },\n    /**\n     * Internal value for mapping the raw response data.\n     */\n    _studentData: {\n      type: Object\n    },\n    /**\n     * Internal width so they are all unified from editing this\n     */\n    _numWidth: {\n      type: String,\n      value: \"2.25em\"\n    },\n    /**\n     * Endpoint for submission data.\n     */\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    /**\n     * base path for the app\n     */\n    basePath: {\n      type: String,\n      notify: true\n    },\n    /**\n     * routing variable for url\n     */\n    route: {\n      type: String\n    },\n    /**\n     * Security token\n     */\n    csrfToken: {\n      type: String\n    },\n    /**\n     * course\n     */\n    elmslnCourse: {\n      type: String\n    },\n    /**\n     * section\n     */\n    elmslnSection: {\n      type: String\n    },\n    /**\n     * Data binding object for the submission render\n     */\n    data: {\n      type: Object\n    },\n    /**\n     * Internal ID for active project\n     */\n    activeProject: {\n      type: Number,\n      value: false\n    },\n    /**\n     * Active Data based on selection\n     */\n    activeData: {\n      type: Object,\n      value: {\n        student: {},\n        assignment: {},\n        submission: {}\n      }\n    },\n    /**\n     * raw Stats data from backend.\n     */\n    stats: {\n      type: Object,\n      value: {}\n    },\n    /**\n     * Selected chart with data cleaned up to match formatting.\n     */\n    activeChart: {\n      type: Object,\n      value: {}\n    }\n  },\n  /**\n   * Rebuild the chart whenever the select list is changed.\n   */\n  _chartChanged: function(e) {\n    this.set(\"activeChart.title\", e.detail.value);\n    this.notifyPath(\"activeChart.title\");\n    this.set(\n      \"activeChart.description\",\n      \"Chart of values relative to \" + e.detail.value\n    );\n    this.notifyPath(\"activeChart.description\");\n    // calculate the valid charting options relative to selected chart style\n    this.set(\"activeChart.data\", this._formatChartData(e.detail.value));\n    this.notifyPath(\"activeChart.data\");\n  },\n  /**\n   * Format data in a way that chartist likes and that matches\n   * the currently active display mechanism\n   */\n  _formatChartData: function(type) {\n    var labels = [];\n    var series = [[]];\n    const stats = this.stats.stats;\n    const assignments = this._toArray(this.assignments);\n    let parts = type.split(\"-\");\n    if (\n      typeof stats[parts[0]] !== typeof undefined &&\n      typeof stats[parts[0]][parts[1]] !== typeof undefined\n    ) {\n      // make sure the data aligns now w/ the IDs in question\n      // or we'll start mixing up our data.\n      for (var i in assignments) {\n        let title = assignments[i].title;\n        if (\n          typeof stats[parts[0]][parts[1]][assignments[i].id] !==\n          typeof undefined\n        ) {\n          series[0].push(stats[parts[0]][parts[1]][assignments[i].id]);\n          title += ` (${stats[parts[0]][parts[1]][assignments[i].id]})`;\n        } else {\n          series[0].push(0);\n          title += \" (0)\";\n        }\n        labels.push(title);\n      }\n    }\n    return {\n      labels: labels,\n      series: series\n    };\n  },\n  /**\n   * When type changes, make sure we adjust what the request going\n   * out the door will be. For simplicity, false / true for the two\n   * modes are binded to submission (default) and comment methods\n   * of data return. This allows us to leverage the same endpoint\n   * and render things more or less using much of the same code\n   * and event\n   */\n  _dataTypeChanged: function(newValue, oldValue) {\n    // if type changes values and not from undefined to defined\n    // then we should execute the request for data after setting type\n    if (typeof oldValue !== typeof undefined) {\n      if (newValue) {\n        this.dataTypeText = \"Comments (beta)\";\n      } else {\n        this.dataTypeText = \"Submissions\";\n      }\n    }\n  },\n  /**\n   * Stupid thing to make it go from array position 0 to 1.\n   */\n  _commentIndex: function(index) {\n    return index + 1;\n  },\n  /**\n   * If the current route is outside the scope of our app\n   * then allow the website to break out of the single page\n   * application routing\n   */\n  _routeChanged: function(route, endPoint) {\n    if (typeof route.path === \"string\") {\n      if (typeof endPoint === \"string\") {\n        if (route.path.startsWith(endPoint)) {\n          return;\n        }\n      }\n      // reload the page which since route changed will load that page\n      window.location.reload();\n    }\n  },\n  /**\n   * Test if buttons should be visible or not\n   */\n  _activeDataChanged: function(student, assignment) {\n    if (typeof student.id !== typeof undefined) {\n      if (this._getObjectByPosition(this.students, student.id, -1) == -1) {\n        this.$.prevstudent.disabled = true;\n      } else {\n        this.$.prevstudent.disabled = false;\n      }\n      if (this._getObjectByPosition(this.students, student.id, 1) == -1) {\n        this.$.nextstudent.disabled = true;\n      } else {\n        this.$.nextstudent.disabled = false;\n      }\n      if (\n        this._getObjectByPosition(this.assignments, assignment.id, -1) == -1\n      ) {\n        this.$.prevassignment.disabled = true;\n      } else {\n        this.$.prevassignment.disabled = false;\n      }\n      if (this._getObjectByPosition(this.assignments, assignment.id, 1) == -1) {\n        this.$.nextassignment.disabled = true;\n      } else {\n        this.$.nextassignment.disabled = false;\n      }\n    }\n  },\n  /**\n   * Project updated\n   */\n  _projectChanged: function(e) {\n    this.$.loading.hidden = false;\n    // default a11y positioning back to the stats dialog\n    this.__rememberClick = this.$.statsdialog;\n    this.$.statsdialog.disabled = false;\n    this.$.datatype.disabled = false;\n    this.activeProject = e.detail.value;\n    // this should fire off the new request\n    this.studentParams.projectId = this.activeProject;\n    this.$.studentrequest.generateRequest();\n  },\n  /**\n   * attached life cycle\n   */\n  attached: function() {\n    // listen for focus event to have fired\n    document.body.addEventListener(\n      \"lrnsys-dialog-modal-closed\",\n      this._accessibleFocus.bind(this)\n    );\n    this.$.selectedproject.addEventListener(\n      \"change\",\n      this._projectChanged.bind(this)\n    );\n    this.$.selectedchart.addEventListener(\n      \"change\",\n      this._chartChanged.bind(this)\n    );\n  },\n  /**\n   * detached life cycle\n   */\n  detached: function() {\n    // listen for focus event to have fired\n    document.body.removeEventListener(\n      \"lrnsys-dialog-modal-closed\",\n      this._accessibleFocus.bind(this)\n    );\n    this.$.selectedproject.removeEventListener(\n      \"change\",\n      this._projectChanged.bind(this)\n    );\n    this.$.selectedchart.removeEventListener(\n      \"change\",\n      this._chartChanged.bind(this)\n    );\n  },\n  /**\n   * Set ourselves as having focus after the modal closes.\n   */\n  _accessibleFocus: function(e) {\n    document.body.classList.remove(\"scroll-disabled\");\n    // focus on our dialog triggering button\n    this.__rememberClick.focus();\n  },\n  /**\n   * Handle response for the whole projects object.\n   */\n  _handleProjectResponse: function(event) {\n    this.$.loading.hidden = true;\n    this.set(\"projects\", this._projectData.data.projects);\n  },\n  /**\n   * Handle response for the whole projects object.\n   */\n  _handleStudentResponse: function(event) {\n    this.$.loading.hidden = true;\n    this.set(\"students\", []);\n    this.set(\"students\", this._studentData.data.students);\n    this.set(\"assignments\", []);\n    this.set(\"assignments\", this._studentData.data.assignments);\n    this.stats = this._studentData.data.stats;\n    this.set(\n      \"stats.header\",\n      \"Statistics for \" +\n        this.projects[\"project-\" + this.activeProject].attributes.title\n    );\n    // make sure default is asc data\n    setTimeout(() => {\n      this.shadowRoot.querySelector(\"#sorter\").direction = \"asc\";\n    }, 200);\n  },\n  /**\n   * Pie menu operation handler based on which was clicked.\n   */\n  _changeActiveItem: function(e) {\n    document.body.classList.add(\"scroll-disabled\");\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    var newstudent;\n    var newassignment;\n    // use button id in order to move around in the grid as far as active\n    switch (local.id) {\n      case \"prevstudent\":\n        newstudent = this._getObjectByPosition(\n          this.students,\n          this.activeData.student.id,\n          -1\n        );\n        if (\n          newstudent != -1 &&\n          typeof newstudent.assignments[this.activeData.assignment.id] !==\n            typeof undefined\n        ) {\n          this.set(\"activeData.student\", {});\n          this.set(\"activeData.student\", newstudent);\n          this.set(\"activeData.submission\", {});\n          this.set(\n            \"activeData.submission\",\n            newstudent.assignments[this.activeData.assignment.id]\n          );\n          this.set(\n            \"route.path\",\n            this.endPoint + \"/submissions/\" + this.activeData.submission.id\n          );\n        }\n        break;\n      case \"nextstudent\":\n        newstudent = this._getObjectByPosition(\n          this.students,\n          this.activeData.student.id,\n          1\n        );\n        if (\n          newstudent != -1 &&\n          typeof newstudent.assignments[this.activeData.assignment.id] !==\n            typeof undefined\n        ) {\n          this.set(\"activeData.student\", {});\n          this.set(\"activeData.student\", newstudent);\n          this.set(\"activeData.submission\", {});\n          this.set(\n            \"activeData.submission\",\n            newstudent.assignments[this.activeData.assignment.id]\n          );\n          this.set(\n            \"route.path\",\n            this.endPoint + \"/submissions/\" + this.activeData.submission.id\n          );\n        }\n        break;\n      case \"prevassignment\":\n        newassignment = this._getObjectByPosition(\n          this.assignments,\n          this.activeData.assignment.id,\n          -1\n        );\n        if (newassignment != -1) {\n          this.set(\"activeData.assignment\", {});\n          this.set(\"activeData.assignment\", newassignment);\n          if (\n            typeof this.activeData.student.assignments[newassignment.id].id !==\n            typeof undefined\n          ) {\n            this.set(\n              \"activeData.submission\",\n              this.activeData.student.assignments[newassignment.id]\n            );\n            this.set(\"activeData.submission\", {});\n            this.set(\n              \"route.path\",\n              this.endPoint +\n                \"/submissions/\" +\n                this.activeData.student.assignments[newassignment.id].id\n            );\n          } else {\n            this.set(\"activeData.submission\", false);\n          }\n        }\n        break;\n      case \"nextassignment\":\n        newassignment = this._getObjectByPosition(\n          this.assignments,\n          this.activeData.assignment.id,\n          1\n        );\n        if (newassignment != -1) {\n          this.set(\"activeData.assignment\", {});\n          this.set(\"activeData.assignment\", newassignment);\n          if (\n            typeof this.activeData.student.assignments[newassignment.id].id !==\n            typeof undefined\n          ) {\n            this.set(\"activeData.submission\", {});\n            this.set(\n              \"activeData.submission\",\n              this.activeData.student.assignments[newassignment.id]\n            );\n            this.set(\n              \"route.path\",\n              this.endPoint +\n                \"/submissions/\" +\n                this.activeData.student.assignments[newassignment.id].id\n            );\n          } else {\n            this.set(\"activeData.submission\", false);\n          }\n        }\n        break;\n    }\n  },\n  /**\n   * Helper to move back and forth in an object like you can an array\n   */\n  _getObjectByPosition: function(items, key, i) {\n    var keys = Object.keys(items).sort(function(a, b) {\n      if (typeof items[a].sis !== typeof undefined) {\n        if (items[a].sis.sortable_name > items[b].sis.sortable_name) {\n          return 1;\n        } else if (items[a].sis.sortable_name < items[b].sis.sortable_name) {\n          return -1;\n        }\n        return 0;\n      } else {\n        return a - b;\n      }\n    });\n    if (key !== undefined) {\n      key = key.toString();\n    }\n    var index = keys.indexOf(key);\n    // try fallback for type issues\n    if (index == -1) {\n      index = keys.indexOf(parseInt(key));\n    }\n    if ((i == -1 && index > 0) || (i == 1 && index < keys.length - 1)) {\n      return items[keys[index + i]];\n    } else {\n      return -1;\n    }\n  },\n  /**\n   * Test student submission status relative to assignments\n   */\n  _submissionStatus: function(student, assignment, dataType) {\n    if (student != null) {\n      if (\n        !dataType &&\n        typeof student.assignments[assignment.id] !== typeof undefined &&\n        typeof student.assignments[assignment.id].id !== typeof undefined\n      ) {\n        return true;\n      } else if (\n        dataType &&\n        typeof student.assignmentComments[assignment.id] !== typeof undefined &&\n        this._toArray(student.assignmentComments[assignment.id]).length > 0\n      ) {\n        return true;\n      }\n    }\n    return false;\n  },\n  /**\n   * Test student submission status relative to assignments\n   */\n  _submissionID: function(student, assignment) {\n    if (\n      student != null &&\n      typeof student.assignments[assignment.id] !== typeof undefined &&\n      typeof student.assignments[assignment.id].id !== typeof undefined\n    ) {\n      return student.assignments[assignment.id].id;\n    }\n    return false;\n  },\n  /**\n   * Return a piece of the submission needed for visualization bc of template scope\n   */\n  _submissionPiece: function(student, assignment, piece) {\n    if (\n      student != null &&\n      typeof student.assignments[assignment.id] !== typeof undefined &&\n      typeof student.assignments[assignment.id].id !== typeof undefined\n    ) {\n      var submission = student.assignments[assignment.id];\n      switch (piece) {\n        case \"url\":\n          return (\n            this.basePath +\n            \"lrnapp-studio-submission/submissions/\" +\n            submission.id\n          );\n          break;\n        case \"title\":\n          return submission.attributes.title;\n          break;\n        case \"icon\":\n          return submission.meta.state_icon;\n          break;\n        case \"color\":\n          return submission.meta.state_color;\n          break;\n        case \"comments\":\n          return this._toArray(student.assignmentComments[assignment.id]);\n          break;\n      }\n    }\n    return \"\";\n  },\n  /**\n   * Return number of comments on an assignment for display.\n   */\n  _commentCount: function(student, assignment, dataType) {\n    if (\n      !dataType &&\n      student != null &&\n      typeof student.assignmentComments[assignment.id] !== typeof undefined\n    ) {\n      return this._toArray(student.assignmentComments[assignment.id]).length;\n    }\n    return false;\n  },\n  /**\n   * Set route for active submission to load\n   */\n  _setActiveSubmission: function(e) {\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    this.__rememberClick = local;\n    var item = local.id.split(\"-\");\n    // find the active elements\n    this.set(\"activeData.student\", this.students[item[1]]);\n    this.set(\"activeData.assignment\", this.assignments[item[3]]);\n    this.set(\n      \"activeData.submission\",\n      this.students[item[1]].assignments[item[3]]\n    );\n    this.set(\n      \"route.path\",\n      this.endPoint + \"/submissions/\" + item[item.length - 1]\n    );\n    document.body.classList.add(\"scroll-disabled\");\n    this.$.dialog.toggleDialog();\n  },\n  /**\n   * Set route for active submission via comment click\n   */\n  _setActiveComment: function(e) {\n    // disable all buttons for in modal nav\n    this.$.nextassignment.disabled = true;\n    this.$.prevassignment.disabled = true;\n    this.$.nextstudent.disabled = true;\n    this.$.prevstudent.disabled = true;\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    this.__rememberClick = local;\n    var item = local.id.split(\"-\");\n    // find the active elements\n    this.set(\"activeData.student\", this.students[item[1]]);\n    this.set(\"activeData.assignment\", this.assignments[item[3]]);\n    this.set(\n      \"activeData.submission\",\n      this.students[item[1]].assignments[item[3]]\n    );\n    this.set(\n      \"route.path\",\n      this.endPoint + \"/submissions/\" + item[item.length - 1]\n    );\n    document.body.classList.add(\"scroll-disabled\");\n    this.$.dialog.toggleDialog();\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/paper-toast/paper-toast.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\n\n/*\n`lrnapp-studio-project-button`\nAllows users to create new projects.\n\nUsage:\n```\n<lrnapp-studio-project-button classes=\"amber white-text\" icon=\"add\" display-errors=\"true\" end-point=\"[[endPoint]]\" csrf-token=[[csrfToken]]></lrnapp-studio-project-button>\n*/\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n    </style>\n    <template is=\"dom-if\" if=\"[[createProjectsUrl]]\">\n      <lrnsys-button\n        raised=\"\"\n        class\\$=\"[[classes]]\"\n        button-class\\$=\"[[classes]]\"\n        icon=\"[[icon]]\"\n        on-tap=\"_createProject\"\n        label=\"Create project\"\n      ></lrnsys-button>\n      <iron-ajax\n        id=\"ajaxCreateStub\"\n        url=\"[[createProjectsUrl]]\"\n        method=\"POST\"\n        handle-as=\"json\"\n        on-response=\"_ajaxCreateStubHandler\"\n      ></iron-ajax>\n    </template>\n    <template is=\"dom-if\" if=\"[[displayErrors]]\">\n      <paper-toast id=\"toast\"></paper-toast>\n    </template>\n  `,\n\n  is: \"lrnapp-studio-project-button\",\n\n  properties: {\n    auto: {\n      type: Boolean,\n      reflectToAttribute: true,\n      value: false,\n      notify: true\n    },\n    displayErrors: {\n      type: Boolean,\n      value: true\n    },\n    createProjectsUrl: {\n      type: String,\n      value: null\n    },\n    classes: {\n      type: String,\n      value: \"\"\n    },\n    icon: {\n      type: String,\n      value: \"\"\n    }\n  },\n\n  ready: function(e) {\n    this.createProjectsUrl =\n      this.endPoint + \"/api/projects/create-stub?token=\" + this.csrfToken;\n  },\n\n  _createProject: function() {\n    this.shadowRoot.querySelector(\"#ajaxCreateStub\").generateRequest();\n  },\n\n  _ajaxCreateStubHandler: function(e) {\n    var status = e.detail.response.status;\n    var response = e.detail.response;\n    if (status === 201) {\n      var project = e.detail.response.data;\n      if (project) {\n        this.fire(\"project-created\", { project: project });\n      }\n    }\n    // if we have errors to display\n    if (typeof response.errors !== \"undefined\") {\n      var ul = document.createElement(\"ul\");\n      var text = \"\";\n      response.errors.forEach(function(error) {\n        text = text + \" \" + error;\n      });\n      this.shadowRoot.querySelector(\"#toast\").show(text);\n    }\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/paper-toast/paper-toast.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\n/*\n`lrnapp-studio-assignment-button`\nAllows users to either start a assignment or link to a assignment.\n\nUsage:\n```\n<lrnapp-studio-assignment-button assignment-id=\"[[id]]\" assignment-id=\"{{assignmentId}}\" end-point=\"[[endPoint]]\" csrf-token=[[csrfToken]]></lrnapp-studio-assignment-button>\n*/\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n    </style>\n    <lrnsys-button\n      on-tap=\"_createAssignment\"\n      icon-class=\"[[iconClass]]\"\n      alt=\"[[alt]]\"\n      class\\$=\"[[classes]]\"\n      button-class\\$=\"[[classes]]\"\n      hover-class=\"[[hoverClass]]\"\n      icon=\"[[icon]]\"\n    ></lrnsys-button>\n    <iron-ajax\n      id=\"ajaxCreateStub\"\n      url=\"[[createAssignmentUrl]]\"\n      method=\"POST\"\n      body=\"[[projectId]]\"\n      handle-as=\"json\"\n      on-response=\"_ajaxCreateStubHandler\"\n    ></iron-ajax>\n    <template is=\"dom-if\" if=\"[[displayErrors]]\">\n      <paper-toast id=\"toast\"></paper-toast>\n    </template>\n  `,\n\n  is: \"lrnapp-studio-assignment-button\",\n\n  properties: {\n    auto: {\n      type: Boolean,\n      reflectToAttribute: true,\n      value: false,\n      notify: true\n    },\n    displayErrors: {\n      type: Boolean,\n      value: true\n    },\n    projectId: {\n      type: String\n    },\n    createAssignmentUrl: {\n      type: String,\n      value: null\n    },\n    iconClass: {\n      type: String,\n      value: null\n    },\n    alt: {\n      type: String,\n      value: null\n    },\n    classes: {\n      type: String,\n      value: null\n    },\n    hoverClass: {\n      type: String,\n      value: null\n    },\n    icon: {\n      type: String,\n      value: null\n    },\n    endPoint: String,\n    csrfToken: String\n  },\n  ready: function(e) {\n    // @todo need to load a assignment if one exists ahead of time\n    this.createAssignmentUrl =\n      this.endPoint + \"/api/assignments/create-stub?token=\" + this.csrfToken;\n  },\n  _createAssignment: function() {\n    this.shadowRoot.querySelector(\"#ajaxCreateStub\").generateRequest();\n  },\n  _ajaxCreateStubHandler: function(e) {\n    var status = e.detail.response.status;\n    var response = e.detail.response;\n    if (status === 201) {\n      var assignment = e.detail.response.data;\n      if (assignment) {\n        this.fire(\"assignment-created\", { assignment: assignment });\n      }\n    }\n    // if we have errors to display\n    if (typeof response.errors !== \"undefined\") {\n      var ul = document.createElement(\"ul\");\n      var text = \"\";\n      response.errors.forEach(function(error) {\n        text = text + \" \" + error;\n      });\n      this.shadowRoot.querySelector(\"#toast\").show(text);\n    }\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/app-route/app-location.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\nimport \"@polymer/paper-badge/paper-badge.js\";\nimport \"@polymer/paper-toggle-button/paper-toggle-button.js\";\nimport \"@polymer/app-layout/app-toolbar/app-toolbar.js\";\nimport \"@polymer/paper-card/paper-card.js\";\nimport \"@polymer/iron-list/iron-list.js\";\nimport \"@polymer/paper-toast/paper-toast.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@polymer/paper-dialog/paper-dialog.js\";\nimport \"@lrnwebcomponents/lrnsys-render-html/lrnsys-render-html.js\";\nimport \"@lrnwebcomponents/lrnsys-layout/lib/lrnsys-dialog.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\nimport \"./lrnapp-studio-project-button.js\";\nimport \"./lrnapp-studio-assignment-button.js\";\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\">\n      :host {\n        display: block;\n      }\n\n      #loading {\n        width: 100%;\n        z-index: 1000;\n        opacity: 0.8;\n        text-align: center;\n        align-content: center;\n        justify-content: center;\n        height: 100vh;\n        position: absolute;\n        background-color: white;\n      }\n\n      .projects-container {\n        -webkit-box-pack: start;\n        -ms-flex-pack: start;\n        justify-content: flex-start;\n        -webkit-box-align: start;\n        -ms-flex-align: start;\n        align-items: flex-start;\n        min-height: 30em;\n        width: 150vw;\n        padding-top: 1em;\n      }\n\n      .projects-window {\n        width: 100vw;\n        overflow-x: scroll;\n        overflow-y: hidden;\n        scrollbar-face-color: #833900;\n        scrollbar-shadow-color: #ffc107;\n        scrollbar-highlight-color: #ffc107;\n        scrollbar-3dlight-color: #ffc107;\n        scrollbar-darkshadow-color: #ffc107;\n        scrollbar-track-color: #ffc107;\n        scrollbar-arrow-color: #ffc107;\n      }\n\n      .projects-window::-webkit-scrollbar-track {\n        background-color: #833900;\n      }\n      /* the new scrollbar will have a flat appearance with the set background color */\n\n      .projects-window::-webkit-scrollbar-thumb {\n        background-color: #ffc107;\n      }\n      /* this will style the thumb, ignoring the track */\n\n      .projects-window::-webkit-scrollbar-button {\n        background-color: #833900;\n      }\n      /* optionally, you can style the top and the bottom buttons (left and right for horizontal bars) */\n\n      .projects-window::-webkit-scrollbar-corner {\n        background-color: #833900;\n      }\n      /* if both the vertical and the horizontal bars appear, then perhaps the right bottom corner*/\n\n      .projects-window::-webkit-scrollbar {\n        width: 1rem;\n        height: 1rem;\n      }\n      /* this targets the default scrollbar (compulsory) */\n\n      paper-button {\n        padding: 0;\n        margin: 0;\n        min-width: 1rem;\n      }\n\n      .project-card {\n        width: 100%;\n        min-width: 20em;\n        max-width: 20em;\n        margin: 0;\n        height: 100%;\n        min-height: 10em;\n      }\n      .project-container {\n        padding: 1em;\n      }\n      .project-card .card-content {\n        height: 100%;\n        min-height: 8em;\n        max-height: 10em;\n        overflow: scroll;\n      }\n\n      .project-operations {\n        position: absolute;\n        top: 0;\n        right: 0;\n        padding: 1em;\n      }\n\n      .project-operations .operation {\n        display: inline-flex;\n        height: 2.5em;\n        width: 2.5em;\n      }\n      .project-operations .operation[hidden] {\n        display: none;\n      }\n\n      .assignment-row {\n        border: 1px solid #000000;\n        background-color: #ffffff;\n      }\n\n      .assignment-row .assignment-row-button.active {\n        background-color: var(--paper-amber-50);\n        font-weight: bold;\n      }\n\n      .assignment-row:hover .assignment-operations {\n        display: block;\n        overflow: visible;\n        margin: 0.2em;\n      }\n\n      .assignment-row-button {\n        width: 100%;\n        justify-content: flex-start;\n        height: 3em;\n        text-transform: none;\n      }\n\n      .status-indicator {\n        border-right: 1px solid grey;\n        padding: 0.5em;\n        margin: 0 0.5em 0 0;\n        display: inline-flex;\n        line-height: 2em;\n        height: 2em;\n        justify-content: center;\n        align-items: center;\n      }\n\n      .button-contents {\n        display: flex;\n        align-content: center;\n      }\n\n      .assignment-title {\n        display: inline-flex;\n        align-items: center;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        line-height: 1em;\n      }\n\n      .assignment-operations {\n        position: absolute;\n        top: 0;\n        right: 0;\n        padding: 0;\n        display: none;\n      }\n\n      .assignment-operations.show {\n        display: block;\n        overflow: visible;\n      }\n\n      .assignment-operations .operation {\n        display: inline-flex;\n        width: 2.5em;\n        height: 2.5em;\n      }\n      .assignment-operations .operation[hidden] {\n        display: none;\n      }\n\n      lrnapp-studio-project-button {\n        margin: 0em auto 1em;\n        max-width: 20em;\n      }\n    </style>\n    <iron-ajax\n      auto=\"\"\n      id=\"projectbackend\"\n      url=\"[[sourcePath]]\"\n      handle-as=\"json\"\n      last-response=\"{{projectResponse}}\"\n      on-response=\"_handleProjectResponse\"\n    >\n    </iron-ajax>\n    <iron-ajax\n      id=\"backend\"\n      url=\"[[sourcePath]]\"\n      params=\"\"\n      handle-as=\"json\"\n      last-response=\"{{backendResponse}}\"\n      on-response=\"_handleUpdateResponse\"\n    >\n    </iron-ajax>\n\n    <app-location\n      route=\"{{route}}\"\n      query-params=\"{{queryParams}}\"\n    ></app-location>\n    <app-route\n      route=\"{{route}}\"\n      pattern=\"[[endPoint]]/:page\"\n      data=\"{{data}}\"\n      tail=\"{{tail}}\"\n      query-params=\"{{queryParams}}\"\n    >\n    </app-route>\n    <div id=\"loading\">\n      <h3>Loading..</h3>\n      <elmsln-loading color=\"grey-text\" size=\"large\"></elmsln-loading>\n    </div>\n    <lrnapp-studio-project-button\n      hidden\\$=\"[[!projectResponse.data.canCreateProjects]]\"\n      classes=\"amber darken-3 white-text\"\n      end-point=\"[[endPoint]]\"\n      csrf-token=\"[[csrfToken]]\"\n      icon=\"add\"\n    ></lrnapp-studio-project-button>\n    <div class=\"projects-window\">\n      <iron-list\n        items=\"[[_toArray(projectResponse.data.projects)]]\"\n        as=\"project\"\n        class=\"projects-container\"\n        grid=\"\"\n      >\n        <template class=\"projects-container-items\">\n          <div class=\"project-container\">\n            <paper-card\n              id\\$=\"project-[[project.id]]\"\n              class=\"project-card grey lighten-3\"\n              heading=\"{{project.attributes.title}}\"\n              elevation=\"2\"\n            >\n              <div class=\"project-operations\">\n                <lrnsys-button\n                  icon-class=\"no-margin\"\n                  id\\$=\"project-[[project.id]]-edit\"\n                  alt=\"Edit project\"\n                  class=\"circle operation\"\n                  hover-class=\"amber lighten-2\"\n                  hidden=\"[[!project.meta.canUpdate]]\"\n                  icon=\"create\"\n                  on-tap=\"_makeProjectEditLink\"\n                >\n                </lrnsys-button>\n                <lrnapp-studio-assignment-button\n                  project-id=\"[[project.id]]\"\n                  icon-class=\"no-margin\"\n                  id\\$=\"project-[[project.id]]-add\"\n                  alt=\"Add assignment\"\n                  class=\"circle operation\"\n                  hover-class=\"amber lighten-2\"\n                  hidden=\"[[!project.meta.canUpdate]]\"\n                  icon=\"add\"\n                  end-point=\"[[endPoint]]\"\n                  csrf-token=\"[[csrfToken]]\"\n                >\n                </lrnapp-studio-assignment-button>\n                <lrnsys-button\n                  id\\$=\"project-[[project.id]]-delete\"\n                  alt=\"Delete project!\"\n                  class=\"circle operation\"\n                  hover-class=\"red darken-2 white-text\"\n                  header=\"Delete project!\"\n                  hidden=\"[[!project.meta.canDelete]]\"\n                  icon=\"delete-forever\"\n                  on-tap=\"_deleteProjectDialog\"\n                  icon-class=\"no-margin\"\n                >\n                </lrnsys-button>\n              </div>\n              <div class=\"card-content\">\n                <iron-list\n                  items=\"[[_toArray(project.relationships.assignments)]]\"\n                  as=\"assignment\"\n                >\n                  <template>\n                    <div class=\"assignment-row\" id=\"assignment\">\n                      <lrnsys-dialog\n                        body-append=\"\"\n                        on-focusin=\"assignmentFocusIn\"\n                        class=\"assignment-row-button\"\n                        id\\$=\"assignment-[[project.id]]-[[assignment.id]]\"\n                        header=\"[[assignment.attributes.title]]\"\n                        hover-class=\"amber lighten-5\"\n                      >\n                        <span slot=\"button\" class=\"button-contents\">\n                          <div\n                            class\\$=\"status-indicator [[assignment.meta.relatedSubmissions.complete.color]]\"\n                          >\n                            <iron-icon\n                              icon=\"[[assignment.meta.relatedSubmissions.complete.icon]]\"\n                              disabled\\$=\"[[!assignment.meta.relatedSubmissions.canCreate]]\"\n                            ></iron-icon>\n                          </div>\n                          <div class=\"assignment-title\">\n                            [[assignment.attributes.title]]\n                          </div>\n                        </span>\n                        <div slot=\"content\">\n                          <app-toolbar\n                            class\\$=\"[[assignment.meta.relatedSubmissions.complete.color]]\"\n                          >\n                            <div>\n                              <iron-icon\n                                icon=\"[[assignment.meta.relatedSubmissions.complete.icon]]\"\n                                disabled\\$=\"[[!assignment.meta.relatedSubmissions.canCreate]]\"\n                              ></iron-icon>\n                              [[assignment.meta.relatedSubmissions.complete.submission.title]]\n                            </div>\n                            <div\n                              spacer=\"\"\n                              class=\"comment-box\"\n                              hidden\\$=\"[[!assignment.meta.relatedSubmissions.complete.submission.id]]\"\n                            >\n                              <paper-button\n                                id\\$=\"assignment-[[project.id]]-[[assignment.id]]-comments\"\n                                style=\"margin:0;padding:.25em;text-transform:none;\"\n                              >\n                                <iron-icon\n                                  icon=\"communication:forum\"\n                                ></iron-icon>\n                                [[assignment.meta.relatedSubmissions.complete.submission.meta.comments.count]]\n                                Comments\n                              </paper-button>\n                              <paper-badge\n                                hidden\\$=\"[[displayNewBadge(assignment.meta.relatedSubmissions.complete.submission.meta.new)]]\"\n                                for\\$=\"assignment-[[project.id]]-[[assignment.id]]-comments\"\n                                label\\$=\"[[assignment.meta.relatedSubmissions.complete.submission.meta.comments.new]]\"\n                              ></paper-badge>\n                            </div>\n\n                            <lrnapp-studio-submission-button\n                              spacer=\"\"\n                              auto=\"\"\n                              assignment-id=\"[[assignment.id]]\"\n                              submission=\"{{submission}}\"\n                              end-point=\"[[buildSubmissionPath(basePath)]]\"\n                              csrf-token=\"[[csrfToken]]\"\n                              submission-id=\"[[assignment.meta.relatedSubmissions.complete.submission.id]]\"\n                            ></lrnapp-studio-submission-button>\n                            <div main-title=\"\"></div>\n                            <paper-toggle-button\n                              id\\$=\"assignment-[[project.id]]-[[assignment.id]]-toggle\"\n                              on-tap=\"statusToggle\"\n                            ></paper-toggle-button>\n                            <span\n                              id\\$=\"assignment-[[project.id]]-[[assignment.id]]-toggle-text\"\n                            ></span>\n                            <div bottom-item=\"\" class=\"status-rationale\">\n                              [[assignment.meta.relatedSubmissions.complete.rationale.text]]\n                            </div>\n                          </app-toolbar>\n                          <lrnsys-render-html\n                            style=\"padding:2em;\"\n                            html=\"[[assignment.attributes.body]]\"\n                          ></lrnsys-render-html>\n                        </div>\n                      </lrnsys-dialog>\n                      <span class=\"assignment-operations\">\n                        <lrnsys-button\n                          id\\$=\"assignment-[[project.id]]-[[assignment.id]]-add-critique\"\n                          icon=\"editor:insert-comment\"\n                          alt=\"Add critique\"\n                          class=\"circle operation\"\n                          hover-class=\"green lighten-2\"\n                          hidden=\"[[!assignment.meta.canCritique]]\"\n                          href\\$=\"[[assignment.meta.critiqueLink]]\"\n                          icon-class=\"no-margin\"\n                        ></lrnsys-button>\n                        <lrnsys-button\n                          id\\$=\"assignment-[[project.id]]-[[assignment.id]]-edit\"\n                          icon=\"editor:mode-edit\"\n                          alt=\"Edit\"\n                          class=\"circle operation\"\n                          hover-class=\"amber lighten-4\"\n                          hidden=\"[[!assignment.meta.canUpdate]]\"\n                          on-tap=\"_makeAssignmentEditLink\"\n                          icon-class=\"no-margin green-text text-darken-4\"\n                        ></lrnsys-button>\n                        <lrnsys-button\n                          id\\$=\"assignment-[[project.id]]-[[assignment.id]]-delete\"\n                          icon=\"delete\"\n                          alt=\"Delete\"\n                          class=\"circle operation\"\n                          hover-class=\"amber lighten-4\"\n                          hidden=\"[[!assignment.meta.canDelete]]\"\n                          on-tap=\"_deleteAssignmentDialog\"\n                          icon-class=\"no-margin red-text text-darken-4\"\n                        ></lrnsys-button>\n                      </span>\n                    </div>\n                  </template>\n                </iron-list>\n              </div>\n            </paper-card>\n          </div>\n        </template>\n      </iron-list>\n    </div>\n    <paper-toast text=\"Updated\" id=\"toast\"></paper-toast>\n    <paper-dialog id=\"delete\" modal=\"\">\n      <h3>[[_deleteTitle]]</h3>\n      <p>[[_deleteText]]</p>\n      <div class=\"buttons\">\n        <paper-button dialog-dismiss=\"\">Decline</paper-button>\n        <paper-button\n          id=\"deleteaccept\"\n          on-tap=\"_handleDelete\"\n          dialog-confirm=\"\"\n          autofocus=\"\"\n          >Accept</paper-button\n        >\n      </div>\n    </paper-dialog>\n  `,\n\n  is: \"lrnapp-studio-kanban\",\n\n  properties: {\n    /**\n     * Tracks the active assignment.\n     */\n    activeAssignment: {\n      type: String,\n      value: null,\n      notify: true\n    },\n    projectToDelete: {\n      type: String,\n      value: null,\n      notify: true\n    },\n    assignmentToDelete: {\n      type: String,\n      value: null,\n      notify: true\n    },\n    sourcePath: {\n      type: String,\n      notify: true\n    },\n    /**\n     * Submission for two-way data binding on return from the button being pushed\n     */\n    submission: {\n      type: Object,\n      notify: true\n    },\n    /**\n     * Response from the server.\n     */\n    projectResponse: {\n      type: Object,\n      notify: true\n    },\n    /**\n     * Response from the server for non-project requests.\n     */\n    backendResponse: {\n      type: Object,\n      notify: true\n    }\n  },\n\n  listeners: {\n    \"project-created\": \"_handleProjectCreated\",\n    \"assignment-created\": \"_handleAssignmentCreated\"\n  },\n\n  observers: [\n    \"_routeChanged(route, endPoint)\",\n    \"_deleteToast(queryParams.deletetoast)\"\n  ],\n\n  // If the current route is outside the scope of our app\n  // then allow the website to break out of the single page\n  // application routing\n  _routeChanged: function(route, endPoint) {\n    if (typeof route.path === \"string\") {\n      if (typeof endPoint === \"string\") {\n        if (route.path.startsWith(endPoint)) {\n          return;\n        }\n      }\n      window.location = route.path;\n    }\n  },\n\n  /**\n   * Support having a toast message because of delete or error elsewhere.\n   */\n  _deleteToast: function(deletetoast, old) {\n    if (typeof deletetoast !== typeof undefined) {\n      if (deletetoast == \"error\") {\n        this.$.toast.show(\"That submission on longer exists!\");\n      } else {\n        this.$.toast.show(\"Submission deleted successfully!\");\n      }\n      this.set(\"queryParams.deletetoast\", undefined);\n      this.notifyPath(\"queryParams.deletetoast\");\n    }\n  },\n\n  /**\n   * @todo  remove this once we have a modal for it\n   */\n  _makeProjectEditLink: function(e) {\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    var parts = local.id.split(\"-\");\n    window.location.href =\n      this.basePath +\n      \"../node/\" +\n      parts[1] +\n      \"/edit?destination=apps/lrnapp-studio-kanban\";\n  },\n\n  /**\n   * @todo  remove this once we have a modal for it\n   */\n  _makeAssignmentEditLink: function(e) {\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    var parts = local.id.split(\"-\");\n    window.location.href =\n      this.basePath +\n      \"../node/\" +\n      parts[2] +\n      \"/edit?destination=apps/lrnapp-studio-kanban\";\n  },\n\n  /**\n   * Handle the push to delete a project, pop up the modal.\n   */\n  _deleteProjectDialog: function(e) {\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    var parts = local.id.split(\"-\");\n    // set values so we know what to drop\n    this.projectToDelete = parts[1];\n    this._deleteTitle = \"Delete project\";\n    this._deleteText =\n      \"Are you sure you want to delete this project and all related assignments!?\";\n    this._deleteType = \"project\";\n    this.$.delete.open();\n  },\n\n  /**\n   * Handle the call to delete the assignment specified.\n   */\n  _handleDelete: function() {\n    if (this._deleteType == \"project\") {\n      this.$.backend.method = \"DELETE\";\n      this.$.backend.body = this.projectToDelete;\n      this.$.backend.url =\n        this.endPoint +\n        \"/api/projects/\" +\n        this.projectToDelete +\n        \"?token=\" +\n        this.csrfToken;\n      this.$.backend.generateRequest();\n    } else if (this._deleteType == \"assignment\") {\n      this.$.backend.method = \"DELETE\";\n      this.$.backend.body = this.assignmentToDelete;\n      this.$.backend.url =\n        this.endPoint +\n        \"/api/assignments/\" +\n        this.assignmentToDelete +\n        \"?token=\" +\n        this.csrfToken;\n      this.$.backend.generateRequest();\n    }\n  },\n\n  /**\n   * Handle the push to delete an assignment, pop up the modal.\n   */\n  _deleteAssignmentDialog: function(e) {\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    var parts = local.id.split(\"-\");\n    this.assignmentToDelete = parts[2];\n    // set values so we know what to drop\n    this._deleteTitle = \"Delete assignment\";\n    this._deleteText = \"Are you sure you want to delete this assignment?\";\n    this._deleteType = \"assignment\";\n    this.$.delete.open();\n  },\n\n  /**\n   * if we should show new badge based on new comment count.\n   */\n  displayNewBadge: function(count) {\n    if (count == 0) {\n      return true;\n    }\n    return false;\n  },\n\n  /**\n   * Handle toggling the status for the submission.\n   */\n  statusToggle: function(e) {\n    // find our xhr for callbacks\n    var xhr = this.$.backend;\n    // break the id out into project and assignment\n    var parts = this.activeAssignment.split(\"-\");\n    // focus in on the submissions / assignment meta\n    var submission = this.projectResponse.data.projects[\"project-\" + parts[1]]\n      .relationships.assignments[\"assignment-\" + parts[2]].meta\n      .relatedSubmissions.complete;\n    // ensure this isn't disabled though it shouldn't be possible\n    if (\n      !this.shadowRoot.querySelector(\"#\" + this.activeAssignment + \"-toggle\")\n        .disabled\n    ) {\n      // hide the loading screen\n      this.$.loading.hidden = false;\n      // queue of the request parameters\n      xhr.params = {\n        submissionid: submission.submission.id,\n        status: this.shadowRoot.querySelector(\n          \"#\" + this.activeAssignment + \"-toggle\"\n        ).checked\n      };\n      // send the request\n      xhr.generateRequest();\n    }\n  },\n\n  /**\n   * Handle toggle for mouse class and manage classList array for paper-button.\n   */\n  assignmentFocusIn: function(e) {\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    if (this.activeAssignment != null && this.activeAssignment != local.id) {\n      this.shadowRoot\n        .querySelector(\"#\" + this.activeAssignment)\n        .nextElementSibling.classList.remove(\"show\");\n      this.shadowRoot\n        .querySelector(\"#\" + this.activeAssignment)\n        .classList.remove(\"active\");\n    }\n    this.activeAssignment = local.id;\n    this._setToggle(false);\n    local.nextElementSibling.classList.add(\"show\");\n    local.classList.add(\"active\");\n  },\n\n  /**\n   * Handle response for the whole projects object.\n   */\n  _handleProjectResponse: function(event) {\n    this.$.loading.hidden = true;\n    this._setToggle(true);\n  },\n\n  /**\n   * buildSubmissionPath for generating a new submission or linking to existing.\n   */\n  buildSubmissionPath: function(path) {\n    return path + \"lrnapp-studio-submission\";\n  },\n\n  /**\n   * Handle a response from updating an item\n   */\n  _handleUpdateResponse: function(event) {\n    if (this.backendResponse.status == 200) {\n      this.$.toast.text = \"Updated successfully\";\n      this.$.toast.toggle();\n      this.$.projectbackend.generateRequest();\n    } else {\n      // this would imply an error\n      this.$.loading.hidden = true;\n    }\n  },\n\n  /**\n   * set the toggle state when assignment gets focus\n   */\n  _setToggle: function(update) {\n    if (this.activeAssignment != null) {\n      var parts = this.activeAssignment.split(\"-\");\n      // focus in on the submissions / assignment meta\n      var submission = this.projectResponse.data.projects[\"project-\" + parts[1]]\n        .relationships.assignments[\"assignment-\" + parts[2]].meta\n        .relatedSubmissions.complete;\n      // not finished but also not started\n      if (submission.status == 0 && submission.submission.length == 0) {\n        if (!update) {\n          this.shadowRoot.querySelector(\n            \"#\" + this.activeAssignment + \"-toggle\"\n          ).disabled = true;\n          this.shadowRoot.querySelector(\n            \"#\" + this.activeAssignment + \"-toggle\"\n          ).checked = false;\n        }\n        this.shadowRoot.querySelector(\n          \"#\" + this.activeAssignment + \"-toggle\"\n        ).title = \"Submission not started\";\n        this.shadowRoot.querySelector(\n          \"#\" + this.activeAssignment + \"-toggle-text\"\n        ).textContent = \"Submission not started\";\n      } else if (submission.status == 0) {\n        if (!update) {\n          this.shadowRoot.querySelector(\n            \"#\" + this.activeAssignment + \"-toggle\"\n          ).disabled = false;\n          this.shadowRoot.querySelector(\n            \"#\" + this.activeAssignment + \"-toggle\"\n          ).checked = false;\n        }\n        this.shadowRoot.querySelector(\n          \"#\" + this.activeAssignment + \"-toggle\"\n        ).title = \"Submission started\";\n        this.shadowRoot.querySelector(\n          \"#\" + this.activeAssignment + \"-toggle-text\"\n        ).textContent = \"Submission in progress\";\n      } else {\n        if (!update) {\n          this.shadowRoot.querySelector(\n            \"#\" + this.activeAssignment + \"-toggle\"\n          ).disabled = false;\n          this.shadowRoot.querySelector(\n            \"#\" + this.activeAssignment + \"-toggle\"\n          ).checked = true;\n        }\n        this.shadowRoot.querySelector(\n          \"#\" + this.activeAssignment + \"-toggle\"\n        ).title = \"Submission ready\";\n        this.shadowRoot.querySelector(\n          \"#\" + this.activeAssignment + \"-toggle-text\"\n        ).textContent = \"Submission ready\";\n      }\n    }\n  },\n\n  /**\n   * Event came from the project button to indicate it was successful.\n   */\n  _handleProjectCreated: function(e) {\n    this.$.toast.text = \"Project added\";\n    this.$.toast.toggle();\n    this.$.projectbackend.generateRequest();\n  },\n\n  /**\n   * Event came from the assignment button to indicate it was successful.\n   */\n  _handleAssignmentCreated: function(e) {\n    this.$.toast.text = \"Assignment added\";\n    this.$.toast.toggle();\n    this.$.projectbackend.generateRequest();\n  },\n\n  /*\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/app-route/app-location.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\nimport \"@polymer/iron-list/iron-list.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/paper-card/paper-card.js\";\nimport \"@polymer/iron-selector/iron-selector.js\";\nimport \"@polymer/iron-pages/iron-pages.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"@lrnwebcomponents/elmsln-apps/lib/lrnapp-studio-dashboard/lrnapp-studio-dashboard.js\";\nimport \"@lrnwebcomponents/elmsln-apps/lib/lrnapp-studio-kanban/lrnapp-studio-kanban.js\";\nimport \"@lrnwebcomponents/elmsln-apps/lib/lrnapp-open-studio/lrnapp-open-studio.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n    </style>\n\n    <app-location\n      route=\"{{route}}\"\n      query-params=\"{{queryParams}}\"\n    ></app-location>\n    <app-route\n      route=\"{{route}}\"\n      pattern=\"[[basePath]]/:page\"\n      data=\"{{data}}\"\n      tail=\"{{tail}}\"\n      query-params=\"{{queryParams}}\"\n    >\n    </app-route>\n\n    <iron-selector\n      selected=\"{{data.page}}\"\n      attr-for-selected=\"name\"\n      role=\"navigation\"\n    >\n      <a tabindex=\"-1\" name=\"lrnapp-studio-dashboard\" on-tap=\"_dashboardClicked\"\n        >A</a\n      >\n      <a tabindex=\"-1\" name=\"lrnapp-studio-kanban\" on-tap=\"_kanbanClicked\">B</a>\n      <a tabindex=\"-1\" name=\"lrnapp-open-studio\" on-tap=\"_openstudioClicked\"\n        >C</a\n      >\n    </iron-selector>\n\n    <iron-pages\n      selected=\"{{data.page}}\"\n      attr-for-selected=\"name\"\n      fallback-selection=\"lrnapp-studio-dashboard\"\n      role=\"main\"\n    >\n      <lrnapp-studio-dashboard\n        name=\"lrnapp-studio-dashboard\"\n        csrf-token=\"[[csrfToken]]\"\n        end-point=\"[[_endPoint('lrnapp-studio-dashboard')]]\"\n        base-path=\"[[basePath]]\"\n        elmsln-course=\"[[elmslnCourse]]\"\n        elmsln-section=\"[[elmslnSection]]\"\n        route=\"[[tail]]\"\n      >\n      </lrnapp-studio-dashboard>\n      <lrnapp-studio-kanban\n        name=\"lrnapp-studio-kanban\"\n        csrf-token=\"[[csrfToken]]\"\n        end-point=\"[[_endPoint('lrnapp-studio-dashboard')]]\"\n        base-path=\"[[basePath]]\"\n        source-path=\"[[_sourcePath('lrnapp-studio-kanban/kanban-data')]]\"\n        elmsln-course=\"[[elmslnCourse]]\"\n        elmsln-section=\"[[elmslnSection]]\"\n        route=\"[[tail]]\"\n      ></lrnapp-studio-kanban>\n      <lrnapp-open-studio\n        name=\"lrnapp-open-studio\"\n        csrf-token=\"[[csrfToken]]\"\n        end-point=\"[[_endPoint('lrnapp-open-studio')]]\"\n        base-path=\"[[basePath]]\"\n        source-path=\"[[_sourcePath('lrnapp-open-studio/data')]]\"\n        elmsln-course=\"[[elmslnCourse]]\"\n        elmsln-section=\"[[elmslnSection]]\"\n        route=\"[[tail]]\"\n      >\n      </lrnapp-open-studio>\n    </iron-pages>\n  `,\n  is: \"lrnapp-studio-root\",\n  properties: {\n    /**\n     * sourcePath for submission data.\n     */\n    sourcePath: {\n      type: String,\n      notify: true,\n      reflectToAttribute: true\n    },\n    elmslnSection: {\n      type: String,\n      notify: true,\n      reflectToAttribute: true\n    },\n    elmslnCourse: {\n      type: String,\n      notify: true,\n      reflectToAttribute: true\n    },\n    csrfToken: {\n      type: String,\n      notify: true,\n      reflectToAttribute: true\n    },\n    /**\n     * base path for the app\n     */\n    basePath: {\n      type: String,\n      notify: true\n    },\n    _endPoint: function(path) {\n      return this.basePath + path;\n    },\n    _sourcePath: function(path) {\n      return this.basePath + path + \"?token=\" + this.csrfToken;\n    },\n    listeners: {\n      \"route-change\": \"_routeChange\"\n    },\n    observers: [\n      \"_routeChanged(route, basePath)\",\n      \"_deleteToast(queryParams.deletetoast)\"\n    ],\n    // If the current route is outside the scope of our app\n    // then allow the website to break out of the single page\n    // application routing\n    _routeChanged: function(route, basePath) {\n      if (typeof route.path === \"string\") {\n        if (typeof basePath === \"string\") {\n          if (route.path.startsWith(basePath)) {\n            return;\n          }\n        }\n        // reload the page which since route changed will load that page\n        window.location.reload();\n      }\n    },\n    /**\n     * Change route from deeper in the app.\n     */\n    _routeChange: function(e) {\n      var details = e.detail;\n      if (typeof details.queryParams.assignment !== typeof undefined) {\n        this.set(\"queryParams.assignment\", details.queryParams.assignment);\n        this.notifyPath(\"queryParams.assignment\");\n      }\n      if (typeof details.queryParams.project !== typeof undefined) {\n        this.set(\"queryParams.project\", details.queryParams.project);\n        this.notifyPath(\"queryParams.project\");\n      }\n      if (typeof details.queryParams.author !== typeof undefined) {\n        this.set(\"queryParams.author\", details.queryParams.author);\n        this.notifyPath(\"queryParams.author\");\n      }\n      if (typeof details.data.page !== typeof undefined) {\n        this.set(\"data.page\", details.data.page);\n        this.notifyPath(\"data.path\");\n      }\n    },\n    /**\n     * Support having a toast message because of delete or error elsewhere.\n     */\n    _deleteToast: function(deletetoast, old) {\n      if (typeof deletetoast !== typeof undefined) {\n        if (deletetoast == \"error\") {\n          this.$.toast.show(\"That submission on longer exists!\");\n        } else {\n          this.$.toast.show(\"Submission deleted successfully!\");\n        }\n        this.set(\"queryParams.deletetoast\", undefined);\n        this.notifyPath(\"queryParams.deletetoast\");\n      }\n    },\n    _dashboardClicked: function(e) {\n      this.set(\"route.path\", this.basePath + \"/lrnapp-studio-dashboard\");\n      this.notifyPath(\"route.path\");\n    },\n    _kanbanClicked: function(e) {\n      this.set(\"route.path\", this.basePath + \"/lrnapp-studio-kanban\");\n      this.notifyPath(\"route.path\");\n    },\n    _openstudioClicked: function(e) {\n      this.set(\"route.path\", this.basePath + \"/lrnapp-open-studio\");\n      this.notifyPath(\"route.path\");\n    },\n    /**\n     * Simple way to convert from object to array.\n     */\n    _toArray: function(obj) {\n      return Object.keys(obj).map(function(key) {\n        return obj[key];\n      });\n    }\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-card/paper-card.js\";\nimport \"@polymer/marked-element/marked-element.js\";\nimport \"@polymer/iron-image/iron-image.js\";\nimport \"@lrnwebcomponents/image-inspector/image-inspector.js\";\nimport \"@lrnwebcomponents/lrndesign-avatar/lrndesign-avatar.js\";\nimport \"@lrnwebcomponents/word-count/word-count.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"@lrnwebcomponents/lrndesign-contentblock/lrndesign-contentblock.js\";\nimport \"@lrnwebcomponents/lrnsys-layout/lib/lrnsys-dialog.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n      p {\n        font-size: 14px;\n        line-height: 18px;\n      }\n      h1,\n      h2,\n      h3 {\n        margin: 0;\n        text-align: left;\n      }\n      iron-selector {\n        line-height: 1em;\n      }\n      iron-selector lrnsys-button {\n        display: inline-flex;\n      }\n      marked-element {\n        display: block;\n        margin: 0 5em 0 5em;\n      }\n      iron-image {\n        margin: 0 0.5em;\n      }\n      lrnsys-dialog {\n        display: inline;\n      }\n      .contain {\n        width: 10em;\n        height: 10em;\n        background: #ddd;\n      }\n      .center {\n        margin: auto;\n        width: 100%;\n      }\n      .title {\n        color: #222;\n        font-size: 2rem;\n        font-weight: 600;\n        line-height: 2.5rem;\n        padding: 0.25rem 0;\n        white-space: nowrap;\n        overflow-x: hidden;\n        text-overflow: ellipsis;\n        margin-top: 1rem;\n        text-align: center;\n      }\n      .author {\n        color: #555;\n        font-size: 1rem;\n        font-weight: 500;\n        font-style: normal;\n        line-height: 1rem;\n        padding: 0.25rem 0 0.5rem 0;\n        margin: 0;\n        text-transform: capitalize;\n      }\n      .date {\n        color: #555;\n        font-size: 16px;\n        font-style: normal;\n        padding: 0.25rem 0 0.5rem 0;\n        margin: 0;\n      }\n      .flex-wrap {\n        display: flex;\n      }\n      .submission-page-card {\n        width: 100%;\n        margin: 0;\n      }\n      :host([edit-page]) .submission-page {\n        width: 100%;\n      }\n      .image-dialog-header {\n        display: flex;\n      }\n      app-toolbar {\n        width: 36em;\n        background: #ddd;\n      }\n      lrnsys-button {\n        padding: 0.75em;\n      }\n      .top {\n        top: 8em;\n      }\n    </style>\n    <div class=\"submission-page\">\n      <paper-card class=\"submission-page-card ferpa-protect\">\n        <div class=\"card-content\">\n          <lrndesign-avatar\n            class=\"center\"\n            label=\"{{submission.relationships.author.data.name}}\"\n            src=\"{{submission.relationships.author.data.avatar}}\"\n          ></lrndesign-avatar>\n          <div class=\"author center\">\n            {{submission.relationships.author.data.display_name}}\n          </div>\n          <h2 class=\"title center\">{{submission.attributes.title}}</h2>\n          <div class=\"date center\">\n            Created: [[date(submission.meta.created)]]\n          </div>\n          <div class=\"date center\">\n            Last updated: [[date(submission.meta.changed)]]\n          </div>\n          <!-- ----- Text Submission -----  -->\n          <template is=\"dom-if\" if=\"[[submission.attributes.body]]\">\n            <word-count\n              ><marked-element\n                markdown=\"[[submission.attributes.body]]\"\n              ></marked-element\n            ></word-count>\n          </template>\n          <!-- ----- Images Submission -----  -->\n          <template is=\"dom-if\" if=\"[[submission.attributes.images]]\">\n            <lrndesign-contentblock class=\"center\">\n              <template\n                is=\"dom-repeat\"\n                items=\"[[_toArray(submission.attributes.images)]]\"\n                as=\"image\"\n              >\n                <lrnsys-dialog alt=\"View Image\" dynamic-images=\"\">\n                  <div class=\"image-dialog-header\"></div>\n                  <span slot=\"button\">\n                    <iron-image\n                      style=\"width:200px; height:200px; background-color: lightgray;\"\n                      sizing=\"contain\"\n                      class=\"contain\"\n                      src=\"[[image.thumbnail]]\"\n                      preload=\"\"\n                      fade=\"\"\n                    ></iron-image>\n                  </span>\n                  <div style=\"text-align: center;\">\n                    <template is=\"dom-if\" if=\"[[!_isGif(image.url)]]\">\n                      <image-inspector src=\"[[image.url]]\">\n                        <span slot=\"toolbar\">\n                          <lrnsys-button\n                            alt=\"Download all images\"\n                            icon=\"icons:file-download\"\n                            href=\"[[submission.attributes.download_files]]\"\n                            target=\"_blank\"\n                          ></lrnsys-button>\n                        </span>\n                      </image-inspector>\n                    </template>\n                    <template is=\"dom-if\" if=\"[[_isGif(image.url)]]\">\n                      <iron-image\n                        style=\"width:500px; height:500px; background-color: lightgray;\"\n                        sizing=\"contain\"\n                        class=\"contain\"\n                        src=\"[[image.url]]\"\n                        preload=\"\"\n                        fade=\"\"\n                      ></iron-image>\n                    </template>\n                  </div>\n                </lrnsys-dialog>\n              </template>\n            </lrndesign-contentblock>\n          </template>\n          <!-- ----- Video Submission -----  -->\n          <template is=\"dom-if\" if=\"[[submission.attributes.video]]\">\n            <lrndesign-contentblock class=\"center\">\n              <template\n                is=\"dom-repeat\"\n                items=\"[[_toArray(submission.attributes.video)]]\"\n                as=\"video\"\n              >\n                <iframe\n                  width=\"460\"\n                  height=\"249\"\n                  src=\"[[video.video_src]]\"\n                ></iframe>\n              </template>\n            </lrndesign-contentblock>\n          </template>\n          <!-- ----- Links Submission -----  -->\n          <template is=\"dom-if\" if=\"[[submission.attributes.links]]\">\n            <lrndesign-contentblock>\n              <template\n                is=\"dom-repeat\"\n                items=\"[[_toArray(submission.attributes.links)]]\"\n                as=\"link\"\n              >\n                <p>\n                  <strong>[[link.title]]:</strong>\n                  <a class=\"link\" href=\"[[link.url]]\" target=\"_blank\"\n                    >[[link.url]]</a\n                  >\n                </p>\n              </template>\n            </lrndesign-contentblock>\n          </template>\n          <!-- ----- Files Submission -----  -->\n          <template is=\"dom-if\" if=\"[[submission.attributes.files]]\">\n            <lrndesign-contentblock title=\"Files Submitted\">\n              <template\n                is=\"dom-repeat\"\n                items=\"[[_toArray(submission.attributes.files)]]\"\n                as=\"file\"\n              >\n                <p>\n                  <strong>[[file.filename]]:</strong>\n                  <a class=\"link\" href=\"[[file.url]]\" target=\"_blank\"\n                    >[[file.url]]</a\n                  >\n                </p>\n              </template>\n            </lrndesign-contentblock>\n          </template>\n        </div>\n      </paper-card>\n    </div>\n  `,\n  is: \"lrnapp-studio-submission-display\",\n  properties: {\n    /**\n     * Object that has all the details of a submission that\n     * is being viewed.\n     */\n    submission: {\n      type: Object,\n      notify: true\n    }\n  },\n  date: function(time) {\n    if (time) {\n      var parts = time.split(\"-\");\n      let times = time.split(\"T\");\n      let month = parts[2].split(\"T\");\n      times = times[1].split(\"-\");\n      return parts[1] + \"/\" + month[0] + \" - \" + times[0];\n    }\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    if (typeof obj === \"object\" && obj !== null) {\n      return Object.keys(obj).map(function(key) {\n        return obj[key];\n      });\n    }\n    return [];\n  },\n  /**\n   * See if this is a GIF, if it is then report back so we\n   * know which player to display.\n   */\n  _isGif: function(url) {\n    if (url.indexOf(\".gif\") != -1) {\n      return true;\n    }\n    return false;\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-icon-button/paper-icon-button.js\";\nimport \"@polymer/paper-ripple/paper-ripple.js\";\nimport \"@polymer/paper-dialog/paper-dialog.js\";\nimport \"@polymer/paper-dialog-scrollable/paper-dialog-scrollable.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: flex;\n        align-items: stretch;\n        justify-content: stretch;\n      }\n\n      .wrapper {\n        position: relative;\n        z-index: 1;\n        overflow: hidden;\n        display: flex;\n        align-items: center;\n      }\n\n      .actions {\n        overflow: hidden;\n        position: absolute;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        top: 0;\n        left: 0;\n        z-index: 5;\n        color: white;\n        background: rgba(0, 0, 0, 0.7);\n        height: 100%;\n        width: 100%;\n        transition: all 0.2s ease-in-out;\n        transform: translateY(-100%);\n      }\n\n      .wrapper:hover .actions {\n        transform: translateY(0);\n      }\n\n      paper-dialog {\n        width: 50%;\n        width: 50vmax;\n        padding: 1em;\n      }\n    </style>\n\n    <div class=\"wrapper\">\n      <slot></slot>\n      <div class=\"actions\">\n        <template is=\"dom-if\" if=\"[[embedcode]]\">\n          <paper-icon-button\n            icon=\"code\"\n            class=\"embed\"\n            on-click=\"_embedClicked\"\n          ></paper-icon-button>\n        </template>\n        <paper-icon-button\n          icon=\"delete\"\n          class=\"delete\"\n          on-click=\"_deleteClicked\"\n        ></paper-icon-button>\n        <paper-ripple></paper-ripple>\n      </div>\n    </div>\n\n    <template is=\"dom-if\" if=\"[[embedcode]]\">\n      <paper-dialog\n        id=\"dialog\"\n        entry-animation=\"scale-up-animation\"\n        exit-animation=\"fade-out-animation\"\n        with-backdrop=\"\"\n      >\n        <h2>Embed Code</h2>\n        <p>Paste this into the text area and your image will appear.</p>\n        <paper-dialog-scrollable>\n          <pre>{{embedcode}}</pre>\n        </paper-dialog-scrollable>\n      </paper-dialog>\n    </template>\n  `,\n\n  is: \"lrnapp-studio-submission-media-editoverlay\",\n\n  properties: {\n    embedcode: {\n      type: String\n    }\n  },\n\n  _embedClicked: function(e) {\n    // @todo switch to singleton\n    this.shadowRoot.querySelector(\"#dialog\").open();\n  },\n\n  _deleteClicked: function(e) {\n    this.fire(\"delete\");\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\nimport \"@polymer/paper-ripple/paper-ripple.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        cursor: pointer;\n      }\n      :host([display=\"box\"]) {\n        display: block;\n        width: 200px;\n        height: 200px;\n        background: lightgray;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        position: relative;\n      }\n      :host([display=\"pill\"]) {\n        display: block;\n        background: lightgray;\n        display: inline-flex;\n        align-items: center;\n        justify-content: center;\n        position: relative;\n      }\n      iron-icon {\n        color: gray;\n        --iron-icon-height: 50px;\n        --iron-icon-width: 50px;\n      }\n      :host([display=\"pill\"]) iron-icon {\n        --iron-icon-height: 50px;\n        --iron-icon-width: 50px;\n      }\n    </style>\n    <paper-button>\n      <iron-icon icon=\"[[icon]]\"></iron-icon>\n      <paper-ripple></paper-ripple>\n    </paper-button>\n  `,\n\n  is: \"lrnapp-studio-submission-edit-add-asset\",\n\n  properties: {\n    icon: {\n      type: String,\n      value: \"add\"\n    },\n    /**\n     * Change the display of the add asset element\n     *\n     * @type String Options: 'box', 'pill'\n     */\n    display: {\n      type: String,\n      value: \"box\",\n      reflectToAttribute: true\n    }\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-image/iron-image.js\";\nimport \"./lrnapp-studio-submission-media-editoverlay.js\";\nPolymer({\n  _template: html`\n    <custom-style>\n      <style is=\"custom-style\">\n        :host {\n          display: inline-flex;\n          justify-content: space-around;\n          min-height: 100px;\n          position: relative;\n        }\n\n        iron-image {\n          --iron-image-height: 200px;\n          display: block;\n        }\n      </style>\n    </custom-style>\n    <lrnapp-studio-submission-media-editoverlay\n      on-delete=\"_delete\"\n      data-index\\$=\"[[index]]\"\n      embedcode=\"{{embedcode}}\"\n    >\n      <iron-image\n        src=\"[[thumbnail]]\"\n        style=\"width:200px; height:200px; background-color: lightgray;\"\n        sizing=\"contain\"\n        class=\"contain\"\n        preload=\"\"\n        fade=\"\"\n      ></iron-image>\n    </lrnapp-studio-submission-media-editoverlay>\n  `,\n\n  is: \"lrnapp-studio-submission-edit-image\",\n\n  properties: {\n    image: {\n      type: Object,\n      notify: true\n    },\n    thumbnail: {\n      type: String,\n      notify: true,\n      computed: \"_getThumbnail(image)\"\n    },\n    embedcode: {\n      type: String,\n      computed: \"_computeEmbedCode(image)\"\n    }\n  },\n\n  _getThumbnail: function(image) {\n    return image.url;\n  },\n\n  _computeEmbedCode: function(image) {\n    return \"![Alternative Text Here](\" + image.url + \")\";\n  },\n\n  _delete: function(e) {\n    this.fire(\"deleted\");\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-dialog/paper-dialog.js\";\nimport \"@polymer/paper-dialog-scrollable/paper-dialog-scrollable.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@vaadin/vaadin-upload/vaadin-upload.js\";\nimport \"@lrnwebcomponents/secure-request/secure-request.js\";\nimport \"./lrnapp-studio-submission-edit-add-asset.js\";\nimport \"./lrnapp-studio-submission-edit-image.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n        position: relative;\n        min-height: 200px;\n      }\n      #pages {\n        display: block;\n      }\n      .images__images {\n        display: flex;\n        flex-wrap: wrap;\n      }\n      .images__images > * {\n        margin-right: 16px;\n        min-width: 200px;\n      }\n      neon-animated-pages .iron-selected {\n        position: static;\n      }\n      paper-dialog {\n        width: 50%;\n        width: 50vmax;\n        padding: 16px;\n      }\n    </style>\n    <div class=\"images__images\">\n      <template is=\"dom-repeat\" items=\"{{images}}\" as=\"image\">\n        <lrnapp-studio-submission-edit-image\n          image=\"{{image}}\"\n          on-deleted=\"_deleteImage\"\n          data-index\\$=\"[[index]]\"\n        ></lrnapp-studio-submission-edit-image>\n      </template>\n      <lrnapp-studio-submission-edit-add-asset\n        on-click=\"_addImage\"\n        icon=\"image:photo-library\"\n      ></lrnapp-studio-submission-edit-add-asset>\n    </div>\n    <paper-dialog\n      id=\"dialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n      with-backdrop=\"\"\n    >\n      <h2>Add Image(s)</h2>\n      <paper-dialog-scrollable>\n        <div class=\"images__upload\">\n          <template is=\"dom-if\" if=\"[[uploadUrl]]\">\n            <vaadin-upload\n              accept=\"[[fileTypes]]\"\n              target=\"[[uploadUrl]]\"\n              method=\"POST\"\n              form-data-name=\"file-upload\"\n              on-upload-success=\"_handleImageUploadSuccess\"\n            >\n              <div class=\"images__drop-label\">\n                <iron-icon icon=\"description\"></iron-icon>\n                Upload files here:\n              </div>\n            </vaadin-upload>\n          </template>\n        </div>\n      </paper-dialog-scrollable>\n      <div class=\"buttons\">\n        <paper-button dialog-dismiss=\"\">Cancel</paper-button>\n      </div>\n    </paper-dialog>\n  `,\n\n  is: \"lrnapp-studio-submission-edit-images\",\n  behaviors: [SecureRequest.xhr],\n\n  properties: {\n    images: {\n      type: Array,\n      notify: true,\n      value: []\n    },\n    selectedPage: {\n      type: String,\n      value: 0\n    },\n    uploadUrl: {\n      type: String,\n      value: null\n    }\n  },\n\n  _addImage: function(e) {\n    // @todo switch to singleton\n    this.$.dialog.open();\n  },\n\n  _selectPage: function(e) {\n    var normalizedEvent = dom(e);\n    var page = normalizedEvent.localTarget.getAttribute(\"data-page\");\n    this.set(\"selectedPage\", page);\n  },\n\n  _handleImageUploadSuccess: function(e) {\n    this.set(\"selectedPage\", 0);\n    var images = [];\n    var response = e.detail.xhr.response;\n    // normalize response string\n    var response = JSON.parse(response);\n    // get the newely created file\n    if (response.data.file) {\n      var file = response.data.file;\n      // add it to the list of submission images.\n      // find out if the image is already referenced in the submission\n      // images array and if it is replace it.\n      var replacement = false;\n      if (this.images) {\n        images = this.images.map(function(image) {\n          if (image.fid === file.fid) {\n            replacement = true;\n            return file;\n          } else {\n            return image;\n          }\n        });\n      }\n      // if the image was not a replacement then add it to the array\n      if (!replacement) {\n        images.push(file);\n      }\n      this.set(\"images\", []);\n      this.set(\"images\", images);\n      this.$.dialog.close();\n    }\n  },\n\n  _deleteImage: function(e) {\n    var normalizedEvent = dom(e);\n    // console.log(normalizedEvent.localTarget);\n    var deleteIndex = normalizedEvent.localTarget.getAttribute(\"data-index\");\n    // console.log(deleteIndex);\n    this.splice(\"images\", deleteIndex, 1);\n  },\n  /**\n   * attached life cycle\n   */\n  attached: function() {\n    const uploadUrl = this.generateUrl(\"/api/files\");\n    if (uploadUrl !== null) {\n      this.set(\"uploadUrl\", uploadUrl);\n    }\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"./lrnapp-studio-submission-media-editoverlay.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: inline-flex;\n        justify-content: space-around;\n        align-items: stretch;\n        min-height: 100px;\n        width: 100px;\n        position: relative;\n        background: lightgray;\n        color: #333333;\n      }\n\n      lrnapp-studio-submission-media-editoverlay {\n        display: flex;\n      }\n\n      .file_url {\n        margin: 1em;\n      }\n    </style>\n\n    <lrnapp-studio-submission-media-editoverlay\n      on-delete=\"_delete\"\n      data-index\\$=\"[[index]]\"\n      embedcode=\"{{embedcode}}\"\n    >\n      <div class=\"file_url\">[[file.filename]]</div>\n    </lrnapp-studio-submission-media-editoverlay>\n  `,\n\n  is: \"lrnapp-studio-submission-edit-file\",\n\n  properties: {\n    file: {\n      type: Object\n    },\n    embedcode: {\n      type: String,\n      computed: \"_computeEmbedCode(file)\"\n    }\n  },\n\n  observers: [],\n\n  _computeEmbedCode: function(file) {\n    return \"[Alternative Text Here](\" + file.url + \")\";\n  },\n\n  _delete: function(e) {\n    this.fire(\"deleted\");\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-dialog/paper-dialog.js\";\nimport \"@polymer/paper-dialog-scrollable/paper-dialog-scrollable.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@vaadin/vaadin-upload/vaadin-upload.js\";\nimport \"@lrnwebcomponents/secure-request/secure-request.js\";\nimport \"./lrnapp-studio-submission-edit-add-asset.js\";\nimport \"./lrnapp-studio-submission-edit-file.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n        position: relative;\n        min-height: 200px;\n      }\n\n      #pages {\n        display: block;\n      }\n\n      .files__files {\n        display: flex;\n        flex-wrap: wrap;\n      }\n\n      .files__files > * {\n        margin-right: 16px;\n        min-width: 200px;\n      }\n\n      neon-animated-pages .iron-selected {\n        position: static;\n      }\n\n      paper-dialog {\n        width: 50%;\n        width: 50vmax;\n        padding: 16px;\n      }\n    </style>\n\n    <div class=\"files__files\">\n      <template is=\"dom-repeat\" items=\"{{files}}\" as=\"file\">\n        <lrnapp-studio-submission-edit-file\n          file=\"{{file}}\"\n          on-deleted=\"_deleteImage\"\n          data-index\\$=\"[[index]]\"\n        ></lrnapp-studio-submission-edit-file>\n      </template>\n      <lrnapp-studio-submission-edit-add-asset\n        on-click=\"_addImage\"\n        icon=\"editor:attach-file\"\n      ></lrnapp-studio-submission-edit-add-asset>\n    </div>\n\n    <paper-dialog\n      id=\"dialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n      with-backdrop=\"\"\n    >\n      <h2>Add Files(s)</h2>\n      <paper-dialog-scrollable>\n        <div class=\"files__upload\">\n          <template is=\"dom-if\" if=\"[[uploadUrl]]\">\n            <vaadin-upload\n              accept=\"[[fileTypes]]\"\n              target=\"[[uploadUrl]]\"\n              method=\"POST\"\n              form-data-name=\"file-upload\"\n              on-upload-success=\"_handleImageUploadSuccess\"\n            >\n              <div class=\"files__drop-label\">\n                <iron-icon icon=\"description\"></iron-icon>\n                Upload files here:\n              </div>\n            </vaadin-upload>\n          </template>\n        </div>\n      </paper-dialog-scrollable>\n      <div class=\"buttons\">\n        <paper-button dialog-dismiss=\"\">Cancel</paper-button>\n      </div>\n    </paper-dialog>\n  `,\n\n  is: \"lrnapp-studio-submission-edit-files\",\n  behaviors: [SecureRequest.xhr],\n\n  properties: {\n    files: {\n      type: Array,\n      notify: true,\n      value: null\n    },\n    selectedPage: {\n      type: String,\n      value: 0\n    },\n    uploadUrl: {\n      type: String,\n      value: null,\n      observer: \"log\"\n    },\n    fileTypes: {\n      type: String,\n      value: \"\"\n    }\n  },\n\n  observers: [\"_filesChanged(files)\"],\n\n  _filesChanged: function(files) {},\n\n  _addImage: function(e) {\n    // @todo switch to singleton\n    this.$.dialog.open();\n  },\n\n  _selectPage: function(e) {\n    var normalizedEvent = dom(e);\n    var page = normalizedEvent.localTarget.getAttribute(\"data-page\");\n    this.set(\"selectedPage\", page);\n  },\n\n  _handleImageUploadSuccess: function(e) {\n    this.set(\"selectedPage\", 0);\n    var files = [];\n    var response = e.detail.xhr.response;\n    // normalize response string\n    var response = JSON.parse(response);\n    // get the newely created file\n    if (response.data.file) {\n      var file = response.data.file;\n      if (this.files === null) {\n        this.set(\"files\", []);\n      }\n      this.push(\"files\", file);\n      this.$.dialog.close();\n    }\n  },\n\n  _deleteImage: function(e) {\n    var normalizedEvent = dom(e);\n    var deleteIndex = normalizedEvent.localTarget.getAttribute(\"data-index\");\n    this.splice(\"files\", Number(deleteIndex), 1);\n  },\n\n  _canUpload: function() {\n    const uploadUrl = this.uploadUrl;\n    if (uploadUrl !== null) {\n      return true;\n    } else {\n      return false;\n    }\n  },\n\n  log: function(property) {},\n  /**\n   * attached life cycle\n   */\n  attached: function() {\n    const uploadUrl = this.generateUrl(\"/api/files\");\n    if (uploadUrl !== null) {\n      this.set(\"uploadUrl\", uploadUrl);\n    }\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-dialog/paper-dialog.js\";\nimport \"@polymer/paper-dialog-scrollable/paper-dialog-scrollable.js\";\nimport \"@polymer/paper-input/paper-input.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@lrnwebcomponents/secure-request/secure-request.js\";\nimport \"./lrnapp-studio-submission-edit-add-asset.js\";\nimport \"./lrnapp-studio-submission-media-editoverlay.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: flex;\n        position: relative;\n        align-items: stretch;\n      }\n\n      :host * {\n        background: lightgray;\n        display: flex;\n        align-items: center;\n        margin-right: 1em;\n      }\n\n      iframe {\n        display: block;\n      }\n\n      .videosfield__create {\n        display: block;\n        height: 250px;\n        width: 300px;\n      }\n\n      paper-dialog {\n        width: 50%;\n        width: 50vmax;\n        padding: 1em;\n      }\n    </style>\n\n    <template is=\"dom-repeat\" items=\"{{videos}}\" as=\"video\">\n      <lrnapp-studio-submission-media-editoverlay\n        on-delete=\"_videoDelete\"\n        data-index\\$=\"[[index]]\"\n      >\n        <iframe class=\"videosfield__iframe\" src=\"{{video.video_src}}\"></iframe>\n      </lrnapp-studio-submission-media-editoverlay>\n    </template>\n\n    <lrnapp-studio-submission-edit-add-asset\n      icon=\"av:video-library\"\n      on-click=\"_openDialog\"\n    ></lrnapp-studio-submission-edit-add-asset>\n\n    <paper-dialog\n      id=\"dialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n      with-backdrop=\"\"\n    >\n      <h2>Add Video</h2>\n      <paper-dialog-scrollable>\n        <paper-input label=\"Video URL\" value=\"{{newvideo}}\"></paper-input>\n      </paper-dialog-scrollable>\n      <div class=\"buttons\">\n        <paper-button dialog-dismiss=\"\">Cancel</paper-button>\n        <paper-button dialog-confirm=\"\" on-click=\"_addImage\"\n          >Add Video</paper-button\n        >\n      </div>\n    </paper-dialog>\n\n    <template is=\"dom-if\" if=\"[[videoGenerateSourceUrl]]\">\n      <!-- Generate Video Source Url for preview -->\n      <iron-ajax\n        id=\"videoGenerateSourceUrl\"\n        url=\"[[videoGenerateSourceUrl]]\"\n        method=\"POST\"\n        body=\"[[newvideo]]\"\n        content-type=\"application/json\"\n        handle-as=\"json\"\n        on-response=\"_addImage\"\n      ></iron-ajax>\n    </template>\n  `,\n\n  is: \"lrnapp-studio-submission-edit-video\",\n  behaviors: [SecureRequest.xhr],\n\n  properties: {\n    videos: {\n      type: Array,\n      value: [],\n      notify: true\n    },\n    selectedPage: {\n      type: String,\n      value: \"0\"\n    },\n    newvideo: {\n      type: String,\n      value: \"\"\n    },\n    videoGenerateSourceUrl: {\n      type: String,\n      value: null\n    }\n  },\n  _openDialog: function(e) {\n    // @todo use singleton\n    this.$.dialog.open();\n  },\n\n  _addImage: function(e) {\n    var video_url = this.newvideo;\n    var normalizedEvent = dom(e);\n    var tagname = normalizedEvent.localTarget.tagName;\n    // find out if the component that called this function\n    // if it's the iron-ajax then that means we have what we\n    // need to add this new video to the array.\n    if (tagname === \"IRON-AJAX\") {\n      var video_src = e.detail.response.data;\n      // make sure we upgrade from NULL to an array if needed\n      if (Object.prototype.toString.call(this.videos) != \"[object Array]\") {\n        this.videos = [];\n      }\n      this.push(\"videos\", { video_url: this.newvideo, video_src: video_src });\n      this.newvideo = \"\";\n    }\n    // if it wasn't iron ajax, then we need to go get the\n    // newvideo's source url from the api\n    else {\n      this.shadowRoot\n        .querySelector(\"#videoGenerateSourceUrl\")\n        .generateRequest();\n    }\n  },\n\n  _videoDelete: function(e) {\n    var normalizedEvent = dom(e);\n    var deleteIndex = normalizedEvent.localTarget.getAttribute(\"data-index\");\n    this.splice(\"videos\", deleteIndex, 1);\n  },\n\n  ready: function() {\n    const url = this.generateUrl(\"/api/video/generate-source-url\");\n    this.set(\"videoGenerateSourceUrl\", url);\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-icon-button/paper-icon-button.js\";\nimport \"@polymer/paper-dialog/paper-dialog.js\";\nimport \"@polymer/paper-dialog-scrollable/paper-dialog-scrollable.js\";\nimport \"@polymer/paper-input/paper-input.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"./lrnapp-studio-submission-edit-add-asset.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n\n      .item {\n        display: flex;\n        margin: auto;\n      }\n\n      .info {\n        flex: 1 1 auto;\n      }\n\n      .create {\n        display: flex;\n        align-items: center;\n      }\n\n      .input {\n        flex: 1 1 auto;\n      }\n\n      paper-dialog {\n        width: 50%;\n        width: 50vmax;\n        padding: 1em;\n      }\n    </style>\n\n    <template is=\"dom-repeat\" items=\"{{links}}\" as=\"link\">\n      <div class=\"item\">\n        <div class=\"info\"><div class=\"linksfield__url\">{{link.url}}</div></div>\n        <div class=\"linksfield__actions\">\n          <paper-icon-button\n            icon=\"delete\"\n            class=\"linksfield__delete\"\n            data-index\\$=\"{{index}}\"\n            on-click=\"_deleteLink\"\n          ></paper-icon-button>\n        </div>\n      </div>\n    </template>\n    <lrnapp-studio-submission-edit-add-asset\n      icon=\"link\"\n      display=\"pill\"\n      on-click=\"_openDialog\"\n    ></lrnapp-studio-submission-edit-add-asset>\n\n    <paper-dialog\n      id=\"dialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n      with-backdrop=\"\"\n    >\n      <h2>Add Link</h2>\n      <paper-dialog-scrollable>\n        <paper-input\n          id=\"link-input\"\n          class=\"input\"\n          label=\"URL\"\n          value=\"{{newlink}}\"\n        ></paper-input>\n      </paper-dialog-scrollable>\n      <div class=\"buttons\">\n        <paper-button dialog-dismiss=\"\">Cancel</paper-button>\n        <paper-button dialog-confirm=\"\" on-click=\"_createLink\"\n          >Add Link</paper-button\n        >\n      </div>\n    </paper-dialog>\n  `,\n\n  is: \"lrnapp-studio-submission-edit-links\",\n\n  properties: {\n    links: {\n      type: Array,\n      value: null,\n      notify: true\n    },\n    newlink: {\n      type: String,\n      value: \"\"\n    }\n  },\n\n  _openDialog: function() {\n    // @todo switch to singleton\n    this.$.dialog.open();\n  },\n\n  _createLink: function(e) {\n    var links = this.links;\n    if (links === null) {\n      this.set(\"links\", []);\n    }\n    this.push(\"links\", { url: this.newlink });\n    this.newlink = \"\";\n  },\n\n  _deleteLink: function(e) {\n    var normalizedEvent = dom(e);\n    var deleteIndex = normalizedEvent.localTarget.getAttribute(\"data-index\");\n    this.splice(\"links\", deleteIndex, 1);\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@lrnwebcomponents/lrn-markdown-editor/lrn-markdown-editor.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n    </style>\n    <lrn-markdown-editor content=\"{{content}}\"></lrn-markdown-editor>\n  `,\n\n  is: \"lrnapp-studio-submission-edit-textarea\",\n\n  properties: {\n    content: {\n      type: String,\n      notify: true\n    }\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-input/paper-input.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"./lrnapp-studio-submission-media-editoverlay.js\";\nimport \"./lrnapp-studio-submission-edit-images.js\";\nimport \"./lrnapp-studio-submission-edit-files.js\";\nimport \"./lrnapp-studio-submission-edit-video.js\";\nimport \"./lrnapp-studio-submission-edit-links.js\";\nimport \"./lrnapp-studio-submission-edit-textarea.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n        padding: 16px;\n      }\n      .field {\n        padding-bottom: 16px;\n      }\n      .actions {\n        display: flex;\n        border-top: 2px solid gainsboro;\n        margin-top: 16px;\n      }\n      .actions .spacer {\n        flex: 1 1 auto;\n      }\n      iron-icon {\n        margin-right: 6px;\n        --iron-icon-height: 32px;\n        --iron-icon-width: 32px;\n      }\n      .imagesfiled__image_delete {\n        position: absolute;\n        top: 0;\n        right: 0;\n      }\n    </style>\n    <template is=\"dom-if\" if=\"{{submission}}\">\n      <div class=\"field\">\n        <paper-input\n          label=\"Title\"\n          value=\"{{submission.attributes.title}}\"\n        ></paper-input>\n      </div>\n      <!-- Body -->\n      <div class=\"field\">\n        <label>Submission Text</label>\n        <lrnapp-studio-submission-edit-textarea\n          content=\"{{submission.attributes.body}}\"\n        ></lrnapp-studio-submission-edit-textarea>\n      </div>\n\n      <!-- Images -->\n      <div class=\"imagesfield field\">\n        <label for=\"image-upload\">Images</label>\n        <lrnapp-studio-submission-edit-images\n          images=\"{{submission.attributes.images}}\"\n          file-types=\"[[submission.meta.imagefieldTypes]]\"\n        ></lrnapp-studio-submission-edit-images>\n      </div>\n\n      <!-- Files -->\n      <div class=\"filesfield field\">\n        <label for=\"file-upload\">Files</label>\n        <lrnapp-studio-submission-edit-files\n          files=\"{{submission.attributes.files}}\"\n          file-types=\"[[submission.meta.filefieldTypes]]\"\n        >\n        </lrnapp-studio-submission-edit-files>\n      </div>\n\n      <!-- Links -->\n      <div id=\"linksfield\" class=\"linksfield field\">\n        <label for=\"links-input\">Links</label>\n        <lrnapp-studio-submission-edit-links\n          links=\"{{submission.attributes.links}}\"\n        ></lrnapp-studio-submission-edit-links>\n      </div>\n\n      <!-- Videos -->\n      <div id=\"videosfield\" class=\"videosfield field\">\n        <label for=\"videos-input\">Videos</label>\n        <lrnapp-studio-submission-edit-video\n          videos=\"{{submission.attributes.video}}\"\n          end-point=\"[[endPoint]]\"\n          csrf-token=\"[[csrfToken]]\"\n        ></lrnapp-studio-submission-edit-video>\n      </div>\n\n      <div class=\"actions\">\n        <lrnsys-button\n          id=\"publish\"\n          icon=\"check\"\n          label=\"Publish to Studio\"\n          on-click=\"_publishClicked\"\n          hover-class=\"amber lighten-5 green-text text-darken-4\"\n          icon-class=\"green-text\"\n        ></lrnsys-button>\n        <lrnsys-button\n          id=\"save-draft\"\n          icon=\"drafts\"\n          label=\"Save Draft\"\n          on-click=\"_saveDraftClicked\"\n          hover-class=\"amber lighten-5 amber-text text-darken-4\"\n          icon-class=\"amber-text text-darken-4\"\n        ></lrnsys-button>\n        <span class=\"spacer\"></span>\n        <lrnsys-button\n          id=\"delete\"\n          label=\"Delete\"\n          icon=\"delete\"\n          on-click=\"_deleteClicked\"\n          hover-class=\"amber lighten-5 red-text\"\n          icon-class=\"red-text text-darken-4\"\n        >\n        </lrnsys-button>\n      </div>\n    </template>\n  `,\n  is: \"lrnapp-studio-submission-edit\",\n  properties: {\n    submission: {\n      type: Object,\n      notify: true\n    },\n    uploadFilesUrl: {\n      type: String\n    },\n    newlink: {\n      type: String\n    },\n    newvideo: {\n      type: String\n    },\n    videoGenerateSourceUrl: {\n      type: String\n    },\n    submission: {\n      type: Object,\n      notify: true\n    }\n  },\n\n  observers: [\"_bodyChanged(title)\"],\n  _publishClicked: function(e) {\n    this.set(\"submission.attributes.state\", \"submission_ready\");\n    this.notifyPath(\"submission.attributes.state\");\n    this.fire(\"submissionPublishClicked\");\n  },\n\n  _saveDraftClicked: function(e) {\n    this.set(\"submission.attributes.state\", \"submission_in_progress\");\n    this.notifyPath(\"submission.attributes.state\");\n    this.fire(\"submissionSaveDraftClicked\");\n  },\n\n  _deleteClicked: function(e) {\n    this.fire(\"submissionDeleteClicked\");\n  },\n\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n        font-size: 12px;\n      }\n      .studio-block__header {\n        padding: 16px;\n        display: flex;\n        align-items: center;\n        justify-content: flex-start;\n        border: 1px solid lightgray;\n        border-bottom: none;\n      }\n      .studio-block__content {\n        padding: 0 16px;\n        border: 1px solid lightgray;\n      }\n      .studio-block__icon-wrapper {\n        width: 32px;\n      }\n      .studio-block__header h3 {\n        margin: 0;\n        font-style: none;\n        font-size: inherit;\n      }\n    </style>\n    <div class=\"studio-block__header\">\n      <div class=\"studio-block__icon-wrapper\">\n        <iron-icon icon=\"[[icon]]\" hidden\\$=\"[[!icon]]\"></iron-icon>\n      </div>\n      <h3 hidden\\$=\"[[!title]]\">[[title]]</h3>\n    </div>\n    <div class=\"studio-block__content\"><slot></slot></div>\n  `,\n\n  is: \"lrnapp-studio-block\",\n\n  properties: {\n    title: {\n      type: String,\n      value: null\n    },\n    icons: {\n      type: String,\n      value: null\n    }\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/marked-element/marked-element.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"./lrnapp-studio-block.js\";\nimport \"./lrnapp-studio-submission-edit-textarea.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n      .field {\n        padding-top: 32px;\n        padding-bottom: 32px;\n      }\n\n      .actions {\n        display: flex;\n        border-top: 2px solid gainsboro;\n        margin-top: 16px;\n        font-size: 14px;\n      }\n\n      .actions .spacer {\n        flex: 1 1 auto;\n      }\n\n      .submission-critique-outline + .submission-critique-outline {\n        margin-top: 16px;\n      }\n\n      :host([edit]) .submission-critique-outline--feedback lrnapp-studio-block {\n        padding: 0;\n      }\n    </style>\n    <!-- Body -->\n    <div class=\"field\">\n      <div class=\"submission-critique-outline\">\n        <lrnapp-studio-block title=\"Directions\" icon=\"info-outline\">\n          <marked-element\n            markdown=\"[[submission.relationships.assignment.attributes.critiqueOutline]]\"\n          ></marked-element>\n        </lrnapp-studio-block>\n      </div>\n      <div\n        class=\"submission-critique-outline submission-critique-outline--feedback\"\n      >\n        <lrnapp-studio-block title=\"Feedback\" icon=\"communication:comment\">\n          <template is=\"dom-if\" if=\"[[edit]]\">\n            <lrnapp-studio-submission-edit-textarea\n              content=\"{{submission.attributes.body}}\"\n            ></lrnapp-studio-submission-edit-textarea>\n          </template>\n          <template is=\"dom-if\" if=\"[[!edit]]\">\n            <marked-element\n              markdown=\"{{submission.attributes.body}}\"\n            ></marked-element>\n          </template>\n        </lrnapp-studio-block>\n      </div>\n    </div>\n    <template is=\"dom-if\" if=\"[[edit]]\">\n      <div class=\"actions\">\n        <lrnsys-button\n          id=\"publish\"\n          icon=\"check\"\n          label=\"Publish Feedback\"\n          on-click=\"_publishClicked\"\n          hover-class=\"amber lighten-5 green-text text-darken-4\"\n          icon-class=\"green-text\"\n        ></lrnsys-button>\n        <lrnsys-button\n          id=\"save-draft\"\n          icon=\"drafts\"\n          label=\"Save Draft\"\n          on-click=\"_saveDraftClicked\"\n          hover-class=\"amber lighten-5 amber-text text-darken-4\"\n          icon-class=\"amber-text text-darken-4\"\n        ></lrnsys-button>\n        <span class=\"spacer\"></span>\n        <lrnsys-button\n          id=\"delete\"\n          label=\"Delete Feedback\"\n          icon=\"delete\"\n          on-click=\"_deleteClicked\"\n          hover-class=\"amber lighten-5 red-text\"\n          icon-class=\"red-text text-darken-4\"\n        >\n        </lrnsys-button>\n      </div>\n    </template>\n  `,\n  is: \"lrnapp-studio-submission-critique-panel\",\n  properties: {\n    submission: {\n      type: Object,\n      notify: true\n    },\n    edit: {\n      type: Boolean,\n      value: false,\n      reflectToAttribute: true\n    }\n  },\n  _publishClicked: function(e) {\n    this.set(\"submission.attributes.state\", \"submission_ready\");\n    this.notifyPath(\"submission.attributes.state\");\n    this.fire(\"submissionPublishClicked\");\n  },\n  _saveDraftClicked: function(e) {\n    this.set(\"submission.attributes.state\", \"submission_in_progress\");\n    this.notifyPath(\"submission.attributes.state\");\n    this.fire(\"submissionSaveDraftClicked\");\n  },\n  _deleteClicked: function(e) {\n    this.fire(\"submissionDeleteClicked\");\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@vaadin/vaadin-split-layout/vaadin-split-layout.js\";\nimport \"./lrnapp-studio-submission-media-editoverlay.js\";\nimport \"./lrnapp-studio-submission-edit-images.js\";\nimport \"./lrnapp-studio-submission-edit-files.js\";\nimport \"./lrnapp-studio-submission-edit-video.js\";\nimport \"./lrnapp-studio-submission-edit-links.js\";\nimport \"./lrnapp-studio-submission-display.js\";\nimport \"./lrnapp-studio-submission-edit-textarea.js\";\nimport \"./lrnapp-studio-block.js\";\nimport \"./lrnapp-studio-submission-critique-panel.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n\n      .submission-critique {\n        display: flex;\n        justify-content: space-around;\n      }\n\n      .submission-critique-panel {\n        flex: 1 1 auto;\n        width: 100%;\n        flex-wrap: nowrap;\n        margin: 0.3em;\n      }\n    </style>\n    <template is=\"dom-if\" if=\"{{submission}}\">\n      <template is=\"dom-if\" if=\"[[!edit]]\">\n        <div class=\"submission-critique\">\n          <!-- critique panel -->\n          <div class=\"submission-critique-panel\" id=\"crititque-panel\">\n            <lrnapp-studio-submission-display\n              submission=\"[[submission.relationships.relatedSubmission]]\"\n            ></lrnapp-studio-submission-display>\n          </div>\n          <!-- critique panel -->\n          <div class=\"submission-critique-panel\">\n            <lrnapp-studio-submission-critique-panel\n              submission=\"[[submission]]\"\n              edit=\"[[edit]]\"\n            ></lrnapp-studio-submission-critique-panel>\n          </div>\n        </div>\n      </template>\n      <template is=\"dom-if\" if=\"[[edit]]\">\n        <vaadin-split-layout class=\"submission-critique\">\n          <!-- critique panel -->\n          <div class=\"submission-critique-panel\" id=\"crititque-panel\">\n            <lrnapp-studio-submission-display\n              submission=\"[[submission.relationships.relatedSubmission]]\"\n            ></lrnapp-studio-submission-display>\n          </div>\n          <!-- critique panel -->\n          <div class=\"submission-critique-panel\">\n            <lrnapp-studio-submission-critique-panel\n              submission=\"{{submission}}\"\n              edit=\"[[edit]]\"\n            ></lrnapp-studio-submission-critique-panel>\n          </div>\n        </vaadin-split-layout>\n      </template>\n    </template>\n  `,\n\n  is: \"lrnapp-studio-submission-critique\",\n\n  properties: {\n    submission: {\n      type: Object,\n      notify: true\n    },\n    edit: {\n      type: Boolean,\n      value: false,\n      reflectToAttribute: true\n    }\n  },\n\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-pages/iron-pages.js\";\nimport \"./lrnapp-studio-submission-display.js\";\nimport \"./lrnapp-studio-submission-edit.js\";\nimport \"./lrnapp-studio-submission-critique.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n    </style>\n    <iron-pages selected=\"[[selectedPage]]\">\n      <lrnapp-studio-submission-display\n        submission=\"{{submission}}\"\n      ></lrnapp-studio-submission-display>\n      <lrnapp-studio-submission-edit\n        submission=\"{{submission}}\"\n      ></lrnapp-studio-submission-edit>\n      <lrnapp-studio-submission-critique\n        submission=\"{{submission}}\"\n        edit=\"[[edit]]\"\n      ></lrnapp-studio-submission-critique>\n    </iron-pages>\n  `,\n  is: \"lrnapp-studio-submission-object\",\n  properties: {\n    submission: {\n      type: Object,\n      value: null,\n      notify: true\n    },\n    edit: {\n      type: Boolean,\n      value: false\n    },\n    selectedPage: {\n      type: Number,\n      value: 0\n    }\n  },\n\n  observers: [\"_selectedPageChanged(edit, submission.meta.submissionType)\"],\n\n  _selectedPageChanged: function(edit, type) {\n    var selected = 0;\n    if (edit) {\n      switch (type) {\n        case \"default\":\n          selected = 1;\n          break;\n        case \"critique\":\n          selected = 2;\n          break;\n      }\n    } else {\n      switch (type) {\n        case \"default\":\n          selected = 0;\n          break;\n        case \"critique\":\n          selected = 2;\n          break;\n      }\n    }\n    this.set(\"selectedPage\", selected);\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/paper-card/paper-card.js\";\nimport \"@polymer/paper-icon-button/paper-icon-button.js\";\nimport \"@polymer/paper-tooltip/paper-tooltip.js\";\nimport \"@lrnwebcomponents/word-count/word-count.js\";\nimport \"@lrnwebcomponents/lrndesign-avatar/lrndesign-avatar.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: flex;\n      }\n      paper-card {\n        margin: 20px;\n        padding: 16px;\n      }\n      h1,\n      h2,\n      h3,\n      h4 {\n        text-align: left;\n      }\n      p {\n        font-size: 14px;\n        line-height: 18px;\n        text-align: left;\n      }\n      .nowrap p {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n      .right-actions {\n        float: right;\n      }\n      .paper-card-length-1 {\n        width: 85%;\n        margin-bottom: 8px;\n      }\n      .paper-card-length-2 {\n        width: 81%;\n        margin-top: 0;\n        margin-bottom: 8px;\n      }\n      .paper-card-length-3 {\n        width: 77%;\n        margin-top: 0;\n        margin-bottom: 8px;\n      }\n      .comment-depth-2 {\n        margin: 8px;\n      }\n      .comment-depth-3 {\n        margin: 16px;\n      }\n      .comment-depth-4 {\n        margin: 16px;\n      }\n      .comment-depth-5 {\n        margin: 16px;\n      }\n      .comment-depth-6 {\n        margin: 16px;\n      }\n      .center {\n        padding: 0;\n      }\n    </style>\n    <div class\\$=\"center comment-depth-[[comment.attributes.threadDepth]]\">\n      <lrndesign-avatar\n        label=\"[[comment.relationships.author.data.name]]\"\n        class=\"float-left\"\n      ></lrndesign-avatar>\n    </div>\n    <paper-card class\\$=\"paper-card-length-[[comment.attributes.threadDepth]]\">\n      <div id=\"body\" class=\"comment-body nowrap\">\n        <h4>\n          [[comment.relationships.author.data.name]]\n          <span class=\"grey-said\"> said:</span>\n        </h4>\n        <word-count>[[comment.attributes.body]]</word-count>\n      </div>\n      <div class\\$=\"card-actions\">\n        <paper-icon-button\n          class=\"right-actions\"\n          id=\"reply\"\n          icon=\"icons:reply\"\n        ></paper-icon-button>\n        <paper-tooltip for=\"reply\" animation-delay=\"0\">Reply</paper-tooltip>\n        <paper-icon-button\n          class=\"right-actions\"\n          id=\"edit\"\n          icon=\"icons:create\"\n        ></paper-icon-button>\n        <paper-tooltip for=\"edit\" animation-delay=\"0\">Edit</paper-tooltip>\n        <paper-icon-button\n          class=\"right-actions\"\n          id=\"delete\"\n          icon=\"icons:delete-forever\"\n        ></paper-icon-button>\n        <paper-tooltip for=\"delete\" animation-delay=\"0\">Delete</paper-tooltip>\n      </div>\n    </paper-card>\n  `,\n  is: \"lrnapp-studio-submission-comment\",\n  properties: {\n    comment: {\n      type: Object\n    }\n  },\n  /**\n   * attached life cycle\n   */\n  attached: function() {\n    this.$.body.addEventListener(\"click\", e => {\n      this.$.body.classList.toggle(\"nowrap\");\n    });\n  },\n  /**\n   * detached life cycle\n   */\n  detached: function() {\n    this.$.body.removeEventListener(\"click\", e => {\n      this.$.body.classList.toggle(\"nowrap\");\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"./lrnapp-studio-submission-comment.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n    </style>\n    <template is=\"dom-if\" if=\"[[submission.relationships.comments]]\">\n      <template\n        is=\"dom-repeat\"\n        items=\"[[_toArray(submission.relationships.comments.data)]]\"\n        as=\"comment\"\n      >\n        <lrnapp-studio-submission-comment\n          comment=\"{{comment}}\"\n        ></lrnapp-studio-submission-comment>\n      </template>\n    </template>\n  `,\n  is: \"lrnapp-studio-submission-comments\",\n  properties: {\n    submission: {\n      type: Object\n    }\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport * as async from \"@polymer/polymer/lib/utils/async.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/app-layout/app-toolbar/app-toolbar.js\";\nimport \"@polymer/marked-element/marked-element.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\nimport \"@polymer/paper-dialog/paper-dialog.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@polymer/paper-badge/paper-badge.js\";\nimport \"@polymer/paper-toast/paper-toast.js\";\nimport \"@vaadin/vaadin-split-layout/vaadin-split-layout.js\";\nimport \"@lrnwebcomponents/lrnsys-layout/lib/lrnsys-dialog.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\nimport \"@lrnwebcomponents/lrnsys-comment/lib/lrnsys-comment-list.js\";\nimport \"@lrnwebcomponents/elmsln-loading/elmsln-loading.js\";\nimport \"./lrnapp-studio-submission-object.js\";\nimport \"./lrnapp-studio-submission-comments.js\";\nimport \"./lrnapp-studio-submission-comment.js\";\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n        position: relative;\n      }\n\n      p {\n        font-size: 14px;\n        line-height: 18px;\n      }\n\n      h1 {\n        margin: 0;\n        text-align: left;\n      }\n\n      iron-selector {\n        line-height: 1em;\n      }\n\n      iron-selector lrnsys-button {\n        display: inline-flex;\n      }\n\n      iron-image {\n        margin: 0 0.5em;\n      }\n\n      lrnsys-dialog {\n        display: inline;\n      }\n\n      .contain {\n        width: 10em;\n        height: 10em;\n        background: #ddd;\n      }\n\n      .center {\n        margin: auto;\n        width: 100%;\n      }\n\n      .title {\n        color: #222;\n        font-size: 2rem;\n        font-weight: 600;\n        line-height: 2.5rem;\n        padding: 0.25rem 0;\n        white-space: nowrap;\n        overflow-x: hidden;\n        text-overflow: ellipsis;\n        margin-top: 1rem;\n        text-transform: uppercase;\n        text-align: left;\n      }\n\n      .author {\n        color: #555;\n        font-size: 1rem;\n        font-weight: 500;\n        font-style: normal;\n        line-height: 1rem;\n        padding: 0.25rem 0 0.5rem 0;\n        margin: 0;\n        text-transform: capitalize;\n      }\n\n      .comments {\n        text-align: right;\n        margin: 0;\n        font-size: 1.5em;\n      }\n\n      .submission-page-wrapper {\n        padding: 0;\n        --vaadin-split-layout-splitter: {\n          min-width: 0.4em;\n          background: var(--paper-amber-200);\n        }\n      }\n\n      .submission-page {\n        width: 70vw;\n      }\n\n      .submission-page-card {\n        width: 100%;\n        margin: 0;\n        padding: 0 0 2em 1em;\n      }\n\n      .submission-comments {\n        overflow-y: hidden;\n        padding: 0;\n        margin: 0;\n      }\n\n      elmsln-loading {\n        position: absolute;\n        display: none;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(255, 255, 255, 0.8);\n        z-index: 10;\n        align-items: flex-end;\n        justify-content: center;\n      }\n\n      :host([saving]) elmsln-loading {\n        display: block;\n      }\n\n      elmsln-loading {\n        top: calc(50% - 5vmax);\n        left: calc(50% - 5vmax);\n        position: fixed;\n        transform-origin: center center;\n        width: 10vmax !important;\n        height: 10vmax !important;\n      }\n\n      iron-pages {\n        width: 100%;\n      }\n\n      paper-dialog {\n        width: 50%;\n        width: 50vmax;\n        padding: 1em;\n        z-index: 99999;\n      }\n\n      lrnapp-studio-submission-object {\n        width: 100%;\n      }\n\n      .assignment-body {\n        padding: 2em;\n      }\n\n      iron-icon {\n        margin: 0.2em;\n      }\n    </style>\n\n    <app-route\n      route=\"{{route}}\"\n      pattern=\"/edit\"\n      tail=\"{{tail}}\"\n      active=\"{{editPage}}\"\n    >\n    </app-route>\n\n    <iron-ajax\n      id=\"ajaxRequest\"\n      auto=\"\"\n      url=\"[[reqUrl]]\"\n      method=\"GET\"\n      params=\"[[reqParams]]\"\n      content-type=\"application/json\"\n      handle-as=\"json\"\n      on-response=\"_handleResponse\"\n    ></iron-ajax>\n    <!-- Update Submission Node -->\n    <iron-ajax\n      id=\"ajaxUpdateRequest\"\n      url=\"[[reqUrl]]\"\n      method=\"PUT\"\n      body=\"[[submission]]\"\n      params=\"[[reqParams]]\"\n      content-type=\"application/json\"\n      handle-as=\"json\"\n      on-response=\"_handleUpdateResponse\"\n    ></iron-ajax>\n    <!-- Delete Submission Node -->\n    <iron-ajax\n      id=\"ajaxDeleteRequest\"\n      url=\"[[reqUrl]]\"\n      method=\"DELETE\"\n      params=\"[[reqParams]]\"\n      content-type=\"application/json\"\n      handle-as=\"json\"\n      on-response=\"_handleDeleteResponse\"\n    ></iron-ajax>\n\n    <app-toolbar class=\"amber lighten-3\" hidden\\$=\"[[hideMenuBar]]\">\n      <template is=\"dom-if\" if=\"[[showComments]]\">\n        <lrnsys-button\n          on-tap=\"_backToStudio\"\n          icon=\"arrow-back\"\n          label=\"See in studio\"\n          hover-class=\"amber darken-4 white-text\"\n        ></lrnsys-button>\n      </template>\n      <template is=\"dom-if\" if=\"[[!showComments]]\">\n        <lrnsys-button\n          on-tap=\"_backToKanban\"\n          icon=\"arrow-back\"\n          label=\"Back to project management\"\n          hover-class=\"amber darken-4 white-text\"\n        ></lrnsys-button>\n      </template>\n      <div spacer=\"\" main-title=\"\">[[submission.attributes.title]]</div>\n      <div spacer=\"\">\n        <lrnsys-dialog\n          body-append=\"\"\n          header=\"[[submission.relationships.assignment.attributes.title]]\"\n        >\n          <span slot=\"button\"\n            ><iron-icon icon=\"icons:assignment\"></iron-icon>Assignment\n            Details</span\n          >\n          <div class=\"assignment-body\">\n            <marked-element\n              id=\"assignment-body\"\n              markdown=\"[[submission.relationships.assignment.attributes.body]]\"\n            ></marked-element>\n          </div>\n        </lrnsys-dialog>\n      </div>\n      <div>\n        <paper-button\n          id=\"comment-count\"\n          style=\"margin:0;padding:.25em;text-transform:none;\"\n        >\n          <iron-icon icon=\"communication:forum\"></iron-icon>\n          [[submission.meta.comment_count]] Comments\n        </paper-button>\n        <paper-badge\n          hidden\\$=\"[[displayNewBadge(submission.meta.comment_new)]]\"\n          for=\"comment-count\"\n          label\\$=\"[[submission.meta.comment_new]]\"\n        ></paper-badge>\n      </div>\n      <div hidden\\$=\"[[editPage]]\">\n        <lrnsys-button\n          on-tap=\"_setEditRoute\"\n          icon=\"create\"\n          label=\"Edit\"\n          hover-class=\"amber darken-4 white-text\"\n          hidden\\$=\"[[!submission.meta.canUpdate]]\"\n        ></lrnsys-button>\n      </div>\n      <div hidden\\$=\"[[!editPage]]\">\n        <lrnsys-button\n          on-tap=\"_resetRoute\"\n          icon=\"cancel\"\n          label=\"Cancel\"\n          hover-class=\"amber darken-4 white-text\"\n          hidden\\$=\"[[!submission.meta.canUpdate]]\"\n        ></lrnsys-button>\n      </div>\n    </app-toolbar>\n\n    <vaadin-split-layout class=\"submission-page-wrapper\">\n      <div\n        id=\"commentcolumn\"\n        class=\"submission-comments\"\n        style=\"min-width: 25%; max-width: 40%; width:30%;\"\n      >\n        <template is=\"dom-if\" if=\"[[showComments]]\">\n          <lrnsys-comment-list\n            comment-ops-base=\"{{commentOpsBase}}\"\n            csrf-token=\"[[csrfToken]]\"\n            source-path=\"{{commentsUrl}}\"\n            create-stub-url=\"{{createStubUrl}}\"\n          ></lrnsys-comment-list>\n        </template>\n      </div>\n      <div id=\"submissioncolumn\" style=\"width:70%;\">\n        <lrnapp-studio-submission-object\n          submission=\"{{submission}}\"\n          edit=\"[[editPage]]\"\n        ></lrnapp-studio-submission-object>\n      </div>\n      <iron-icon class=\"splitter-handle\" icon=\"more-vert\"></iron-icon>\n    </vaadin-split-layout>\n\n    <elmsln-loading></elmsln-loading>\n\n    <paper-dialog\n      id=\"deletedialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n      with-backdrop=\"\"\n    >\n      <h2>Delete submission?</h2>\n      <p>Are you sure you want to delete this submission?</p>\n      <div class=\"buttons\">\n        <paper-button dialog-dismiss=\"\">Cancel</paper-button>\n        <paper-button dialog-confirm=\"\" on-click=\"_submissionDeleteConfirmed\"\n          >Delete</paper-button\n        >\n      </div>\n    </paper-dialog>\n    <paper-dialog\n      id=\"publishdialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n      with-backdrop=\"\"\n    >\n      <h2>Ready to publish?</h2>\n      <p>\n        By publishing, the author of this submission will be able to view your\n        feedback. Are you ready to publish?\n      </p>\n      <div class=\"buttons\">\n        <paper-button dialog-dismiss=\"\">Cancel</paper-button>\n        <paper-button dialog-confirm=\"\" on-click=\"_submissionPublishConfirmed\"\n          >Yes Publish</paper-button\n        >\n      </div>\n    </paper-dialog>\n\n    <paper-toast id=\"toast\"></paper-toast>\n  `,\n\n  is: \"lrnapp-studio-submission-page\",\n\n  properties: {\n    id: {\n      type: String\n    },\n    hideMenuBar: {\n      type: Boolean,\n      value: false\n    },\n    endPoint: {\n      type: String\n    },\n    basePath: {\n      type: String\n    },\n    csrfToken: {\n      type: String\n    },\n    reqUrl: {\n      type: String\n    },\n    reqParams: {\n      type: Object\n    },\n    submission: {\n      type: Object\n    },\n    commentsUrl: {\n      type: String,\n      computed: \"_computeCommentsUrl(id, endPoint, csrfToken)\"\n    },\n    createStubUrl: {\n      type: String,\n      computed: \"_computeCommentsStubUrl(id, endPoint, csrfToken)\"\n    },\n    commentOpsBase: {\n      type: String,\n      computed: \"_computeCommentsOpsUrl(id, endPoint, csrfToken)\"\n    },\n    editPage: {\n      type: Boolean,\n      reflectToAttribute: true\n    },\n    saving: {\n      type: Boolean,\n      value: false,\n      notify: true,\n      reflectToAttribute: true\n    },\n    showComments: {\n      type: Boolean,\n      computed: \"_computeShowComments(submission)\"\n    }\n  },\n\n  observers: [\n    \"_urlVarsChanged(id, endPoint)\",\n    \"_paramsChanged(csrfToken)\",\n    \"_bodyChanged(title)\"\n  ],\n\n  listeners: {\n    submissionDeleteClicked: \"_submissionDeleteClicked\",\n    submissionPublishClicked: \"_submissionPublishClicked\",\n    submissionSaveDraftClicked: \"_submissionSaveDraftClicked\"\n  },\n\n  /**\n   * Go back to the studio relative to the app's path.\n   */\n  _backToStudio: function(e) {\n    window.location.href = this.basePath + \"lrnapp-open-studio\";\n  },\n\n  /**\n   * Go back to the studio relative to the app's path.\n   */\n  _backToKanban: function(e) {\n    window.location.href = this.basePath + \"lrnapp-studio-kanban\";\n  },\n\n  /**\n   * Trigger the page router to invoke edit state.\n   */\n  _setEditRoute: function(e) {\n    this.set(\"route.path\", \"edit\");\n    this.notifyPath(\"route.path\");\n  },\n\n  /**\n   * Trigger the page router to invoke edit state.\n   */\n  _resetRoute: function(e) {\n    this.set(\"route.path\", \"\");\n    this.notifyPath(\"route.path\");\n  },\n\n  /**\n   * if we should show new badge based on new comment count.\n   */\n  displayNewBadge: function(count) {\n    if (count == 0) {\n      return true;\n    }\n    return false;\n  },\n\n  _computeCommentsUrl: function(id, endPoint, csrfToken) {\n    return endPoint + \"/api/submissions/\" + id + \"/comments?token=\" + csrfToken;\n  },\n\n  _computeCommentsOpsUrl: function(id, endPoint, csrfToken) {\n    return endPoint + \"/api/submissions/\" + id + \"/comments\";\n  },\n\n  _computeCommentsStubUrl: function(id, endPoint, csrfToken) {\n    return (\n      endPoint +\n      \"/api/submissions/\" +\n      id +\n      \"/comments/create-stub?token=\" +\n      csrfToken\n    );\n  },\n\n  _urlVarsChanged: function(id, endPoint) {\n    this.reqUrl = endPoint + \"/api/submissions/\" + id;\n  },\n\n  _paramsChanged: function(csrfToken) {\n    var params = this.reqParams || {};\n    params.token = csrfToken;\n    this.reqParams = params;\n  },\n\n  _handleResponse: function(data) {\n    // empty response means no access or deleted item\n    if (data.detail.response.data) {\n      this.set(\"submission\", []);\n      this.set(\"submission\", data.detail.response.data);\n      async.microTask.run(() => {\n        window.dispatchEvent(new Event(\"resize\"));\n      });\n    }\n  },\n\n  _isReply: function(data) {\n    this.thread = submission.relationships.comments.data.attributes.thread;\n  },\n\n  _submissionSaveDraftClicked: function(e) {\n    this.saving = true;\n    this.shadowRoot.querySelector(\"#ajaxUpdateRequest\").generateRequest();\n  },\n\n  _submissionPublishClicked: function(e) {\n    this.shadowRoot.querySelector(\"#publishdialog\").open();\n  },\n\n  _submissionPublishConfirmed: function(e) {\n    this.saving = true;\n    this.shadowRoot.querySelector(\"#ajaxUpdateRequest\").generateRequest();\n  },\n\n  _submissionDeleteClicked: function(e) {\n    this.shadowRoot.querySelector(\"#deletedialog\").open();\n  },\n\n  _submissionDeleteConfirmed: function(e) {\n    this.saving = true;\n    this.$.ajaxDeleteRequest.generateRequest();\n  },\n\n  _handleUpdateResponse: function(res) {\n    var root = this;\n    var status = res.detail.response.status;\n    var submission = res.detail.response.data;\n    root.saving = false;\n    if (status === 200) {\n      root.set(\"submission\", {});\n      root.set(\"submission\", submission);\n      root.set(\"route.path\", \"\");\n      // display a submission published notification\n      if (submission.attributes.state === \"submission_ready\") {\n        this.$.toast.show(\"Published!\");\n      }\n      // @todo replace this with the page just being there once we fix the lazy load dilema\n      window.location.href = this.endPoint + \"/submissions/\" + submission.id;\n    }\n  },\n\n  _handleDeleteResponse: function(res) {\n    var root = this;\n    var status = res.detail.response.status;\n    root.saving = false;\n    if (status === 200) {\n      window.location.href = this.basePath + \"lrnapp-studio-kanban?deletetoast\";\n    }\n  },\n\n  _computeShowComments: function(submission) {\n    try {\n      var type = submission.meta.submissionType;\n      if (\n        type !== \"critique\" &&\n        submission.attributes.state == \"submission_ready\"\n      ) {\n        return true;\n      }\n    } catch (error) {}\n    return false;\n  },\n\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    if (typeof obj === \"object\" && obj !== null) {\n      return Object.keys(obj).map(function(key) {\n        return obj[key];\n      });\n    }\n    return [];\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/paper-toast/paper-toast.js\";\nimport \"@lrnwebcomponents/lrnsys-button/lrnsys-button.js\";\n/*\n`lrnapp-studio-submission-button`\nAllows users to either start a submission or link to a submission.\n\nUsage:\n```\n<lrnapp-studio-submission-button assignment-id=\"[[id]]\" submission-id=\"{{submissionId}}\" end-point=\"[[endPoint]]\" csrf-token=[[csrfToken]]></lrnapp-studio-submission-button>\n*/\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n    </style>\n\n    <template is=\"dom-if\" if=\"[[!submissionId]]\">\n      <lrnsys-button\n        raised=\"\"\n        on-tap=\"_createSubmission\"\n        label=\"Create submission\"\n      ></lrnsys-button>\n      <iron-ajax\n        id=\"ajaxCreateStub\"\n        url=\"[[createStubUrl]]\"\n        method=\"POST\"\n        body=\"[[assignmentId]]\"\n        handle-as=\"json\"\n        on-response=\"_ajaxCreateStubHandler\"\n      ></iron-ajax>\n    </template>\n    <template is=\"dom-if\" if=\"[[submissionId]]\">\n      <lrnsys-button\n        raised=\"\"\n        label=\"View submission\"\n        show-href=\"[[_submissionUrl(submissionId)]]\"\n        href=\"[[_submissionUrl(submissionId)]]\"\n      ></lrnsys-button>\n    </template>\n\n    <template is=\"dom-if\" if=\"[[displayErrors]]\">\n      <paper-toast id=\"toast\"></paper-toast>\n    </template>\n  `,\n\n  is: \"lrnapp-studio-submission-button\",\n\n  properties: {\n    auto: {\n      type: Boolean,\n      reflectToAttribute: true,\n      value: false,\n      notify: true\n    },\n    assignmentId: {\n      type: String,\n      reflectToAttribute: true\n    },\n    submissionId: {\n      type: String,\n      value: false,\n      reflectToAttribute: true\n    },\n    endPoint: String,\n    csrfToken: String,\n    displayErrors: {\n      type: Boolean,\n      value: true\n    }\n  },\n\n  observers: [\"_requestUrlChanged(endPoint, csrfToken)\"],\n\n  _requestUrlChanged: function(endPoint, csrfToken) {\n    this.createStubUrl =\n      endPoint + \"/api/submissions/create-stub?token=\" + csrfToken;\n  },\n\n  _createSubmission: function() {\n    this.shadowRoot.querySelector(\"#ajaxCreateStub\").generateRequest();\n  },\n\n  _ajaxCreateStubHandler: function(e) {\n    var status = e.detail.response.status;\n    var response = e.detail.response;\n    if (status === 201) {\n      var submissionId = e.detail.response.data.id;\n      if (submissionId) {\n        this.submissionId = submissionId;\n        // auto implies we should just go there to the edit form after creation\n        if (this.auto) {\n          window.location.href = this._submissionUrl(submissionId) + \"/edit\";\n        }\n      }\n    }\n    // if we have errors to display\n    if (typeof response.errors !== \"undefined\") {\n      var ul = document.createElement(\"ul\");\n      var text = \"\";\n      response.errors.forEach(function(error) {\n        text = text + \" \" + error;\n      });\n      this.shadowRoot.querySelector(\"#toast\").show(text);\n    }\n  },\n\n  _submissionUrl: function(id) {\n    return this.endPoint + \"/submissions/\" + id;\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/app-route/app-location.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@polymer/paper-toast/paper-toast.js\";\nimport \"./lrnapp-studio-submission-page.js\";\nimport \"./lrnapp-studio-submission-button.js\";\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\">\n      :host {\n        display: block;\n      }\n      paper-button {\n        padding: 0;\n        margin: 0;\n        min-width: 1rem;\n      }\n    </style>\n    <app-location route=\"{{route}}\"></app-location>\n    <app-route\n      route=\"{{route}}\"\n      pattern=\"[[endPoint]]/submissions/:submission\"\n      data=\"{{data}}\"\n      tail=\"{{tail}}\"\n    >\n    </app-route>\n\n    <template is=\"dom-if\" if=\"[[data.submission]]\">\n      <lrnapp-studio-submission-page\n        base-path=\"{{basePath}}\"\n        route=\"{{tail}}\"\n        id=\"[[data.submission]]\"\n        end-point=\"[[endPoint]]\"\n        csrf-token=\"[[csrfToken]]\"\n        data=\"{{data}}\"\n      ></lrnapp-studio-submission-page>\n    </template>\n    <template is=\"dom-if\" if=\"[[!data.submission]]\">\n      This is the lrnapp-studio-submission page.\n    </template>\n\n    <paper-toast id=\"toast\"></paper-toast>\n  `,\n\n  is: \"lrnapp-studio-submission\",\n  behaviors: [SecureRequest.xhr],\n\n  properties: {\n    activePage: {\n      type: String\n    },\n    basePath: {\n      type: String\n    },\n    endPoint: {\n      type: String\n    },\n    csrfToken: {\n      type: String\n    }\n  },\n\n  observers: [\n    \"_routeChanged(route, endPoint)\",\n    \"_updateCookies(endPoint, csrfToken)\"\n  ],\n\n  listeners: {\n    submissionDeleted: \"_handleSubmissionDeletion\",\n    displaymessage: \"_handleDisplayMessage\"\n  },\n\n  _handleRouteChange: function(event) {\n    var path = event.detail.path;\n    if (path) {\n      this.set(\"route.path\", path);\n      this.notifyPath(\"route.path\");\n    }\n  },\n\n  // If the current route is outside the scope of our app\n  // then allow the website to break out of the single page\n  // application routing\n  _routeChanged: function(route, endPoint) {\n    if (typeof route.path === \"string\") {\n      if (typeof endPoint === \"string\") {\n        if (route.path.startsWith(endPoint)) {\n          return;\n        }\n      }\n      // reload the page which since route changed will load that page\n      window.location.reload();\n    }\n  },\n\n  _handleSubmissionDeletion: function(e) {\n    var submission = e.detail.submission;\n    if (submission) {\n      this.set(\"route.path\", this.endPoint);\n      this.notifyPath(\"route.path\");\n      this.$.toast.show(\"Submission has been deleted.\");\n    }\n  },\n\n  _updateCookies: function(endPoint, csrfToken) {\n    if (endPoint && csrfToken) {\n      this.setCookies(endPoint, csrfToken);\n    }\n  },\n\n  _handleDisplayMessage: function(e, detail) {\n    if (typeof e.detail.messsage !== \"undefined\") {\n      this.$.toast.show(e.detail.message);\n    }\n  },\n\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  }\n});\n","import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport * as async from \"@polymer/polymer/lib/utils/async.js\";\nimport \"@polymer/iron-icons/iron-icons.js\";\nimport \"@polymer/iron-icons/hardware-icons.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/paper-icon-button/paper-icon-button.js\";\nimport \"@polymer/paper-styles/color.js\";\nimport \"@polymer/paper-tooltip/paper-tooltip.js\";\nimport \"@polymer/app-route/app-location.js\";\nimport \"@polymer/app-route/app-route.js\";\nimport \"@lrnwebcomponents/grid-plate/grid-plate.js\";\nimport \"@lrnwebcomponents/responsive-grid/lib/responsive-grid-row.js\";\nimport \"@lrnwebcomponents/responsive-grid/lib/responsive-grid-col.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\n/**\n * `lrnapp-book`\n * A LRN element\n *\n * @demo demo/index.html\n * @microcopy\n * - node / circle - A progress circle on the line\n * - nodes / items - the list of items in the progress bar\n * - bubble - reserved for when events fire out of an element or value is tracking events\n * - percentage - amount complete either in the bar or the nodes themselves\n * - bar - the underlayed bar that's tracking overall progression\n * - author mode - authoring mode\n */\nPolymer({\n  _template: html`\n    <style include=\"materializecss-styles\">\n      :host {\n        display: block;\n        font-size: 16px;\n        box-sizing: content-box;\n      }\n      :host([loading]) #content {\n        opacity: .2;\n      }\n      #content {\n        opacity: 1;\n        visibility: visible;\n        transition: all .4s ease;\n      }\n    </style>\n    <div id=\"hackycontainer\"><style id=\"hackycsspotterhates\"></style></div>\n    <iron-ajax\n      id=\"fulloutlinepath\"\n      url=\"[[fullOutlinePath]]\"\n      handle-as=\"json\"\n      on-response=\"handleOutlineResponse\"\n      last-response=\"{{outlineData}}\"></iron-ajax>\n    <iron-ajax\n      id=\"pageajax\"\n      params=\"[[requestParams]]\"\n      url=\"[[sourcePath]]\"\n      handle-as=\"json\"\n      on-response=\"handleResponse\"\n      last-response=\"{{pageData}}\"\n      loading=\"{{_loading}}\"></iron-ajax>\n    <app-location route=\"{{route}}\" query-params=\"{{queryParams}}\"></app-location>\n    <app-route\n      route=\"{{route}}\"\n      pattern=\"[[endPoint]]/:type/:id\"\n      data=\"{{data}}\"\n      tail=\"{{tail}}\"\n      query-params=\"{{queryParams}}\">\n    </app-route>\n    <main id=\"etb-tool-nav\" data-offcanvas=\"\">\n      <div id=\"anchor\"></div>\n      <div class=\"inner-wrap\">\n        <section class=\"main-section etb-book\" style=\"min-height: 318px;\">\n          <h2 class=\"element-invisible\">Content navigation</h2>\n          <div class=\"r-header row\">\n            <div class=\"r-header__left\">\n              <div class=\"book-navigation-header book-sibling-nav-container book-navigation-header-2\">\n                <div class=\"book-navigation-header book-sibling-nav-container book-navigation-header-<?php print $count ?>\">\n                  <lrnsys-dialog id=\"outlinepopover\" data-voicecommand=\"open outline\" class=\"black-text\" hover-class=\"grey darken-3 white-text\" label=\"Outline\" header=\"Outline\">\n                    <span slot=\"button\">\n                      <iron-icon icon=\"explore\"></iron-icon>\n                      Outline\n                    </span>\n                    <div class=\"elmsln-modal-content\" id=\"block-mooc-helper-mooc-helper-toc-nav-modal\">\n                      <div id=\"outlinemodal\" on-tap=\"_modalTap\"><slot name=\"outlinemodal\"></slot></div>\n                    </div>\n                  </lrnsys-dialog>\n                  <div id=\"navigation\"><slot name=\"navigation\"></slot></div>\n                </div>\n              </div>\n            </div>\n            <div id=\"options\" class=\"r-header__right\">\n              <slot name=\"options\"></slot>\n            </div>\n          </div>\n          <div class=\"elmsln-content-wrap\" role=\"main\">\n          <responsive-grid-row gutter=\"4\">\n            <responsive-grid-col xl=\"3\" lg=\"3\" md=\"3\" sm=\"4\" xs=\"12\">\n              <section id=\"block-mooc-nav-block-mooc-nav-nav\" class=\"mooc-nav-block-left block block-mooc-nav-block contextual-links-region block-mooc-nav-block-mooc-nav column\" role=\"navigation\" aria-label$=\"[[outlineTitle]]\">\n                <div class=\"block-mooc-nav-block-mooc-title black white-text\">[[outlineTitle]]</div>\n                <div id=\"outline\"><slot name=\"outline\"></slot></div>\n              </section>\n              <div id=\"blocks\"><slot name=\"blocks\"></slot></div>\n            </responsive-grid-col>\n            <responsive-grid-col xl=\"8\" lg=\"8\" md=\"9\" sm=\"7\" xs=\"12\">\n              <a id=\"main-content\" class=\"scrollspy\" data-scrollspy=\"scrollspy\"></a>\n              <div class=\"column\">\n                <div id=\"content\"><slot name=\"content\"></slot></div>\n              </div>\n            </responsive-grid-col>\n          </responsive-grid-row>\n        </section>\n        <a class=\"exit-off-canvas\"></a>\n      </div>\n    </main>`,\n  is: \"mooc-content\",\n  observers: [\"_routeChanged(data, route, endPoint)\"],\n  properties: {\n    /**\n     * Source of data\n     */\n    sourcePath: {\n      type: String\n    },\n    /**\n     * Full outline path\n     */\n    fullOutlinePath: {\n      type: String\n    },\n    /**\n     * App route tracking.\n     */\n    route: {\n      type: Object,\n      notify: true\n    },\n    /**\n     * Title for the content\n     */\n    currentTitle: {\n      type: String\n    },\n    /**\n     * Params for the request for outline/book to load.\n     */\n    requestParams: {\n      type: Object,\n      notify: true,\n      value: {\n        node: null\n      }\n    },\n    /**\n     * Returned data for processing.\n     */\n    pageData: {\n      type: Object,\n      value: {}\n    },\n    /**\n     * Returned data for processing.\n     */\n    outlineData: {\n      type: Object,\n      value: {}\n    },\n    /**\n     * Ensure scrolling doesn't influence during a transition.\n     */\n    resetScroll: {\n      type: Boolean,\n      value: false\n    },\n    /**\n     * Store current page data.\n     */\n    responseData: {\n      type: Object,\n      value: {}\n    },\n    /**\n     * BasePath from drupal\n     */\n    basePath: {\n      type: String\n    },\n    /**\n     * elmslnCourse from drupal\n     */\n    elmslnCourse: {\n      type: String\n    },\n    /**\n     * nav title\n     */\n    outlineTitle: {\n      type: String\n    },\n    /**\n     * Node ID\n     */\n    nid: {\n      type: Number\n    },\n    /**\n     * loading pegged to the ajax call running\n     */\n    _loading: {\n      type: Boolean,\n      observer: \"_contentLoading\",\n      value: false\n    },\n    /**\n     * loading pegged to the ajax call running\n     */\n    loading: {\n      type: Boolean,\n      reflectToAttribute: true,\n      value: false\n    },\n    /**\n     * Aliases\n     */\n    aliases: {\n      type: Array\n    },\n    /**\n     * active item for tracking reference after clicks.\n     */\n    activeNodeItem: {\n      type: Object,\n      value: null\n    }\n  },\n  /**\n   * Ensure modal is closed on tap of an item.\n   */\n  _modalTap: function _modalTap(e) {\n    var normalizedEvent = dom(e);\n    var local = normalizedEvent.localTarget;\n    // verify that it is a buttonß\n    if (local.tagName === \"LRNSYS-BUTTON\") {\n      if (this.activeNodeItem != null) {\n        this.activeNodeItem.classList.remove(\"book-menu-item-active\");\n      }\n      this.activeNodeItem = local;\n      this.activeNodeItem.classList.add(\"book-menu-item-active\");\n      this.$.outlinepopover.toggleDialog();\n    }\n  },\n  /**\n   * Notice loading state has changed.\n   */\n  _contentLoading: function _contentLoading(newValue, oldValue) {\n    var _this = this;\n    if (\n      (typeof newValue === \"undefined\" ? \"undefined\" : typeof newValue) !==\n        (typeof undefined === \"undefined\" ? \"undefined\" : typeof undefined) &&\n      !newValue\n    ) {\n      setTimeout(function() {\n        _this.loading = false;\n        _this._resetScroll(\"anchor\");\n        _this.$[\"main-content\"].focus();\n      }, 500);\n    } else {\n      this.loading = true;\n    }\n  },\n  /**\n   * Callback to push the data into the page.\n   */\n  handleResponse: function handleResponse(e) {\n    // handle the HTML we just got\n    if (\n      typeof this.pageData.data !==\n      (typeof undefined === \"undefined\" ? \"undefined\" : typeof undefined)\n    ) {\n      var data = this.pageData.data;\n      // test for advanced ops\n      if (\n        typeof data.ops.redirect !==\n        (typeof undefined === \"undefined\" ? \"undefined\" : typeof undefined)\n      ) {\n        this.set(\"route.path\", data.ops.redirect);\n        this._routeChanged(this.data, this.route, this.endPoint);\n      } else {\n        this.outlineTitle = data.bookOutline.subject;\n        this.$.content.innerHTML = data.content;\n        this.$.navigation.innerHTML = data.topNavigation;\n        this.$.outline.innerHTML = data.bookOutline.content;\n        this.$.options.innerHTML = data.options;\n        // inject styles, destroying previous ones\n        this.__injectStyle(data.styles);\n        // fire drupal behaviors.. this is evil. Polymer is invoking Drupal behaviors..\n        window.Drupal.attachBehaviors(document, window.Drupal.settings);\n        // first time this fires let's get the outline block in the background\n        if (\n          typeof this.outlineData.data ===\n          (typeof undefined === \"undefined\" ? \"undefined\" : typeof undefined)\n        ) {\n          this.$.fulloutlinepath.generateRequest();\n        }\n        async.microTask.run(() => {\n          window.dispatchEvent(new Event(\"resize\"));\n        });\n      }\n    }\n  },\n  /**\n   * Callback to push the data into the page.\n   */\n  handleOutlineResponse: function handleOutlineResponse(e) {\n    // handle the HTML we just got\n    var data = this.outlineData.data;\n    if (\n      (typeof data === \"undefined\" ? \"undefined\" : typeof data) !==\n      (typeof undefined === \"undefined\" ? \"undefined\" : typeof undefined)\n    ) {\n      this.$.outlinemodal.innerHTML = data.outline;\n      this.aliases = data.aliases;\n    }\n  },\n  /**\n   * If the current route is outside the scope of our app then allow\n   * the website to break out of the single page application routing.\n   *\n   * This is really critical that we get happy paths that don't trigger a redirec\n   * loop so some of the logic will seem a bit repetative but we're trying to trap\n   * may different potentially valid addresses / use-cases which still must trigger\n   * a reload within the app (without looping) and still allow outbound links to go\n   * through as they should.\n   */\n  _routeChanged: function _routeChanged(data, route, endPoint) {\n    if (typeof route.path === \"string\") {\n      // target for url alias that might be delivered into content\n      // and menu items throughout the UI\n      var urlAlias = route.path.replace(\"/\" + this.elmslnCourse + \"/\", \"\");\n      if (route.path.startsWith(\"/\" + this.elmslnCourse + \"/node/\")) {\n        var tmp = route.path.split(\"/\");\n        // ensure this is a number so we know what we're doing\n        if (\n          !isNaN(parseFloat(tmp[tmp.length - 1])) &&\n          isFinite(tmp[tmp.length - 1])\n        ) {\n          this.nid = tmp[tmp.length - 1];\n          // trigger change if data location changed\n          this.requestParams.node = this.nid;\n          // send request out the door to the actual end point\n          this.$.pageajax.generateRequest();\n          // @todo better state management in the modal itself\n          // so that we can detect if it's open or not without\n          // something stupid like this\n          // close outline dialog if it's open\n          if (this.$.outlinepopover.$.modal.opened) {\n            this.$.outlinepopover.$.modal.opened = false;\n          }\n          return;\n        } else if (tmp[tmp.length - 1] == \"edit\") {\n          window.location.reload();\n        }\n      }\n      // test for an node alias, then send off\n      else if (\n        typeof this.aliases[urlAlias] !==\n        (typeof undefined === \"undefined\" ? \"undefined\" : typeof undefined)\n      ) {\n        this.nid = this.aliases[urlAlias].replace(\"node/\", \"\");\n        // trigger change if data location changed\n        this.requestParams.node = this.nid;\n        this.$.pageajax.generateRequest();\n        // @todo better state management in the modal itself\n        // so that we can detect if it's open or not without\n        // something stupid like this\n        if (this.$.outlinepopover.$.modal.opened) {\n          this.$.outlinepopover.$.modal.opened = false;\n        }\n        return;\n      }\n      // implies front page on first load, so fix that\n      else if (urlAlias == \"\") {\n        this.requestParams.node = this.nid;\n        // ensure that we don't see this again\n        this.set(\"route.path\", \"/\" + this.elmslnCourse + \"/node/\" + this.nid);\n        this.$.pageajax.generateRequest();\n        return;\n      }\n    }\n    // ensure nothing went super wrong which may be leading to a busted site\n    // so we can avoid an infinite loop\n    if (this.elmslnCourse != \"\") {\n      // reload the page which since route changed will load that page\n      window.location.reload();\n    }\n  },\n  /**\n   * Reset scroll position visually and internally data wise.\n   */\n  _resetScroll: function _resetScroll() {\n    var item =\n      arguments.length > 0 && arguments[0] !== undefined\n        ? arguments[0]\n        : \"anchor\";\n    this.resetScroll = true;\n    this.$[item].scrollIntoView({ block: \"nearest\", behavior: \"smooth\" });\n  },\n  /**\n   * Simple way to convert from object to array.\n   */\n  _toArray: function _toArray(obj) {\n    return Object.keys(obj).map(function(key) {\n      return obj[key];\n    });\n  },\n  /**\n   * Inject styles dynamically from inline CSS blocks.\n   * This is a function and capability that will drive Potter nuts.\n   * Because of this we're using the unheard of ___ convention. This\n   * means that it's such a private function that we wish we'd never\n   * actually have thought of it. Fortunately, it came from a stackoverflow\n   * article so we don't have to take credit for our own undoing with\n   * what this enables.\n   */\n  __injectStyle: function __injectStyle(style) {\n    // target and wipe our id area by force\n    if (this.shadowRoot.querySelector(\"#hackycsspotterhates\") != null) {\n      dom(this.$.hackycontainer).innerHTML = \"\";\n    }\n    // construct a new style tag and inject it overtop of what was there previously\n    var customStyle = document.createElement(\"style\", \"custom-style\");\n    customStyle.id = \"hackycsspotterhates\";\n    // inject our styles\n    customStyle.textContent = style;\n    // we have now successfully ruined something encapsulated and once beautiful\n    dom(this.$.hackycontainer).appendChild(customStyle);\n  }\n});\n"],"names":["Polymer","_template","html","is","properties","form","type","Object","value","observers","_formChanged","path","replace","propValue","fire","selectable","Boolean","reflectToAttribute","String","title","remove","e","this","filters","_filtersArray","Array","computed","_filtersArrayCompute","filtersArray","prop","f","values","split","forEach","push","icon","requestEndPoint","queryParams","_computeRequestEndPoint","endPoint","csrfToken","_filterChanged","newParams","assign","detail","_cleanParams","set","params","x","toggleSearch","searchEnabled","$","haxSource","search","toggleFilters","filterDialog","toggle","removeFilter","currentParams","newValue","_","get","filter","v","join","newCleanParams","ready","addEventListener","_this","detached","removeEventListener","_this2","listeners","uploadPath","notify","uploadTitle","hasLightbox","_uploadSuccess","event","response","JSON","parse","xhr","data","node","content","innerHTML","nid","dialog","open","routeData","observer","requestParams","sourcePath","readTimeData","userData","showProgress","_routeDataChanged","oldValue","_typeof","id","progressChanged","dataajax","generateRequest","_showProgressChanged","handleDataResponse","obj","bodyloading","hidden","userdata","dashboardItems","_toArray","items","keys","map","key","appStoreConnection","url","progressDashboardPath","showSearch","createRequestBody","updatePageData","attributes","pageUpdatePath","editMode","drawerOpened","route","currentTitle","outlineTitle","bookTitle","soundFinish","sound","completeSound","finishedSound","scrollPosition","Number","activePage","activeOutline","outlineItems","bookItems","itemResponses","pageParams","load","outlineData","bookData","pageData","outlinePath","bookPath","pagePath","hasPrevPage","prevLabel","hasNextPage","nextLabel","resetScroll","currentPageData","responseData","rebuildOutline","fullWidth","outlineajax","setTimeout","_resetScroll","attached","progress","testMilestone","bind","haxpanel","_haxContentInsert","_routeChange","_fullWidthChanged","updateStyles","progressdashboardopen","progressdashboard","_computePageUpdatePath","haxbody","haxInsert","tag","_computeCreateRequestBody","page","bid","relationships","book","pid","parent","_toggleEditMode","_editModeChanged","editbutton","fablabel","window","HaxStore","write","currenttitle","contentEditable","toast","show","updated","haxcontent","haxToContent","body","pageupdateajax","_handleUpdateResponse","_bookOutlineTap","local","dom","localTarget","getAttribute","_activeOutlineChanged","_routeChanged","startsWith","pageajax","outlineloading","location","reload","anchor","scrollIntoView","block","behavior","inline","_activePageChanged","length","_outlineItemsChanged","percentage","console","log","_scrollChanged","max","_nextBtn","_prevBtn","toggleBook","bookdrawer","opened","handleOutlineResponse","i","parseInt","bookajax","handleBookResponse","mapmenu","render","handlePageResponse","_currentPageDataUpdated","slot","firstChild","removeChild","tmp","document","createElement","frag","createRange","createContextualFragment","appendChild","tmp2","outerHTML","meta","canUpdate","elmslnCourses","canvasCourses","roster","queryResponse","activeCourse","collapseToggle","target","nextElementSibling","_triggerDialog","shadowRoot","querySelector","toggleDialog","sis_course_id","style","display","handleResponse","loading","handleRosterResponse","mouseenter","mouseleave","size","image","name","color","elevation","_mouseEnter","__oldElevation","_mouseLeave","_cisResponse","_courseResponse","_makeServiceResponse","courses","originalCourses","programs","academics","courseDataPath","makeServicePath","basePath","details","course","academic","program","_handleMakeServiceResponse","__addServiceLinks","message","_handleCourseResponse","loadingCourse","courseObject","topology","Network","services","machine_name","distro","weight","_exists","sort","a","b","_handleResponse","index","element","_makeService","active","service","pop","makeservice","_activeService","confirm","_confirmBuild","_accessibleFocus","__rememberClick","focus","_loadCourseUrl","findCourse","_courseDataParams","courserequest","_coursesCompute","filteredCourses","root","ironlist","click","submissions","activeImage","activeTitle","activeAuthor","activeComments","activeUrl","nodeName","src","parentElement","author","comments","openUrl","_loadMoreData","clearTriggers","images","_numWidth","activeSubmission","_loadProjectRoute","project","_loadSubmissionUrl","href","projects","renderSubmissions","activeProjectId","activeProject","activeAuthorId","showSubmissions","_renderSubmissionsCompute","parentAssignments","steps","step","submission","includes","assignment","_activeProjectCompute","find","_showSubmissions","_getSubmissionIcon","_getSubmissionClass","_scrollToTarget","assignments","activeAssignmentId","activeAssignment","_activeAssignmentCompute","studioResponse","originalSubmissions","authors","_blockcycle","_submissionsCompute","filteredSubmissions","_deleteToast","deletetoast","old","undefined","notifyPath","_assignmentFilterChanged","_projectFilterChanged","_submissionsClicked","_projectsClicked","_assignmentsClicked","_tableClicked","hasProject","_getHasProject","_getViewLink","behaviors","IronResizableBehavior","onHeightChange","comment","offsetHeight","btn","classList","commentTitle","actionView","dateUpdated","commentUser","wrapper","inactive","username","_getEndPoint","_getDataSource","dataPoint","dataType","dataTypeText","students","_projectData","studentParams","projectId","_studentData","elmslnCourse","elmslnSection","activeData","student","stats","activeChart","_chartChanged","_formatChartData","labels","series","parts","_dataTypeChanged","_commentIndex","_activeDataChanged","_getObjectByPosition","prevstudent","disabled","nextstudent","prevassignment","nextassignment","_projectChanged","statsdialog","datatype","studentrequest","selectedproject","selectedchart","_handleProjectResponse","_handleStudentResponse","direction","_changeActiveItem","newstudent","newassignment","add","sis","sortable_name","toString","indexOf","_submissionStatus","assignmentComments","_submissionID","_submissionPiece","piece","state_icon","state_color","_commentCount","_setActiveSubmission","item","_setActiveComment","auto","displayErrors","createProjectsUrl","classes","_createProject","_ajaxCreateStubHandler","status","errors","text","error","createAssignmentUrl","iconClass","alt","hoverClass","_createAssignment","projectToDelete","assignmentToDelete","projectResponse","backendResponse","_makeProjectEditLink","_makeAssignmentEditLink","_deleteProjectDialog","_deleteTitle","_deleteText","_deleteType","delete","_handleDelete","backend","method","_deleteAssignmentDialog","displayNewBadge","count","statusToggle","relatedSubmissions","complete","submissionid","checked","assignmentFocusIn","_setToggle","buildSubmissionPath","projectbackend","update","textContent","_handleProjectCreated","_handleAssignmentCreated","_endPoint","_sourcePath","_dashboardClicked","_kanbanClicked","_openstudioClicked","date","time","times","month","_isGif","embedcode","_embedClicked","_deleteClicked","thumbnail","_getThumbnail","_computeEmbedCode","_delete","SecureRequest","selectedPage","uploadUrl","_addImage","_selectPage","_handleImageUploadSuccess","file","replacement","fid","close","_deleteImage","deleteIndex","splice","generateUrl","files","fileTypes","_filesChanged","_canUpload","property","videos","newvideo","videoGenerateSourceUrl","_openDialog","tagName","video_src","prototype","call","video_url","_videoDelete","links","newlink","_createLink","_deleteLink","uploadFilesUrl","_publishClicked","_saveDraftClicked","icons","edit","_selectedPageChanged","selected","hideMenuBar","reqUrl","reqParams","commentsUrl","createStubUrl","commentOpsBase","editPage","saving","showComments","submissionDeleteClicked","submissionPublishClicked","submissionSaveDraftClicked","_backToStudio","_backToKanban","_setEditRoute","_resetRoute","_computeCommentsUrl","_computeCommentsOpsUrl","_computeCommentsStubUrl","_urlVarsChanged","_paramsChanged","token","async","run","dispatchEvent","Event","_isReply","thread","_submissionSaveDraftClicked","_submissionPublishClicked","_submissionPublishConfirmed","_submissionDeleteClicked","_submissionDeleteConfirmed","ajaxDeleteRequest","res","state","_handleDeleteResponse","_computeShowComments","submissionType","assignmentId","submissionId","_requestUrlChanged","_createSubmission","_submissionUrl","submissionDeleted","displaymessage","_handleRouteChange","_handleSubmissionDeletion","_updateCookies","setCookies","_handleDisplayMessage","messsage","fullOutlinePath","_loading","aliases","activeNodeItem","_modalTap","outlinepopover","_contentLoading","ops","redirect","bookOutline","subject","navigation","topNavigation","outline","options","__injectStyle","styles","Drupal","attachBehaviors","settings","fulloutlinepath","outlinemodal","urlAlias","isNaN","parseFloat","isFinite","modal","arguments","hackycontainer","customStyle"],"mappings":"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"}