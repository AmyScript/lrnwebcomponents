!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("@polymer/polymer/lib/legacy/polymer.dom.js"),require("@polymer/iron-ajax/iron-ajax.js"),require("@polymer/paper-dialog/paper-dialog.js"),require("@polymer/polymer/polymer-legacy.js"),require("@polymer/iron-a11y-keys/iron-a11y-keys.js"),require("@lrnwebcomponents/relative-heading/relative-heading.js")):"function"==typeof define&&define.amd?define(["@polymer/polymer/lib/legacy/polymer.dom.js","@polymer/iron-ajax/iron-ajax.js","@polymer/paper-dialog/paper-dialog.js","@polymer/polymer/polymer-legacy.js","@polymer/iron-a11y-keys/iron-a11y-keys.js","@lrnwebcomponents/relative-heading/relative-heading.js"],t):t(e.polymer_dom_js,null,null,e.polymerLegacy_js)}(this,function(e,t,n,i){"use strict";function o(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function l(){var e=o(['\n    <style>\n      :host {\n        display: none;\n      }\n      :host #desc {\n        margin: 0 0 15px;\n      }\n      @media print {\n        :host {\n          display: block;\n        }\n      }\n    </style>\n    <relative-heading hidden$="[[!label]]" id="heading" text$="[[label]]">\n    </relative-heading>\n    <div id="desc"><slot></slot></div>\n'],['\n    <style>\n      :host {\n        display: none;\n      }\n      :host #desc {\n        margin: 0 0 15px;\n      }\n      @media print {\n        :host {\n          display: block;\n        }\n      }\n    </style>\n    <relative-heading hidden\\$="[[!label]]" id="heading" text\\$="[[label]]">\n    </relative-heading>\n    <div id="desc"><slot></slot></div>\n']);return l=function(){return e},e}function s(){var e=o(['\n    <style>\n      :host {\n        display: block;\n      }\n      :host #buttons {\n        position: absolute;\n        left: -999999px;\n        top: 0;\n        overflow: hidden;\n        opacity: 0;\n      }\n      :host paper-dialog {\n        border: 1px solid #000;\n        border-radius: 4px;\n      }\n      :host paper-dialog > #title, \n      :host paper-dialog > #desc {\n        padding: 15px;\n        margin: 0;\n      }\n      :host paper-dialog > #title {\n        position: absolute;\n        left: -9999px;\n        overflow: hidden;\n        height: 0;\n        width: 0;\n      }\n      :host paper-dialog > #title > * {\n        margin: 0;\n      }\n      /*::slotted([hotspot]) {\n        display: none;\n      }*/\n      @media print {\n        :host > #svg {\n          display: none;\n        }\n        /*::slotted(#screen-only) {\n          display: none;\n        }\n        ::slotted([hotspot]) {\n          display: block;\n        }*/\n      }\n    </style>\n    <relative-heading hidden$="[[!label]]" id="heading" subtopic-of$="[[subtopicOf]]" tag$="[[tag]]" text$="[[label]]">\n    </relative-heading>\n    <div id="desc"><slot name="desc"></slot></div>\n    <div id="svg"></div>\n    <div id="buttons"></div>\n    <slot></slot>\n    <paper-dialog id="hdetails">\n      <div id="title"></div>\n      <div id="desc"></div>\n    </paper-dialog>\n    <iron-ajax auto="" id="get_svg" url="[[src]]" handle-as="text" on-response="_getSVGHandler"></iron-ajax>\n'],['\n    <style>\n      :host {\n        display: block;\n      }\n      :host #buttons {\n        position: absolute;\n        left: -999999px;\n        top: 0;\n        overflow: hidden;\n        opacity: 0;\n      }\n      :host paper-dialog {\n        border: 1px solid #000;\n        border-radius: 4px;\n      }\n      :host paper-dialog > #title, \n      :host paper-dialog > #desc {\n        padding: 15px;\n        margin: 0;\n      }\n      :host paper-dialog > #title {\n        position: absolute;\n        left: -9999px;\n        overflow: hidden;\n        height: 0;\n        width: 0;\n      }\n      :host paper-dialog > #title > * {\n        margin: 0;\n      }\n      /*::slotted([hotspot]) {\n        display: none;\n      }*/\n      @media print {\n        :host > #svg {\n          display: none;\n        }\n        /*::slotted(#screen-only) {\n          display: none;\n        }\n        ::slotted([hotspot]) {\n          display: block;\n        }*/\n      }\n    </style>\n    <relative-heading hidden\\$="[[!label]]" id="heading" subtopic-of\\$="[[subtopicOf]]" tag\\$="[[tag]]" text\\$="[[label]]">\n    </relative-heading>\n    <div id="desc"><slot name="desc"></slot></div>\n    <div id="svg"></div>\n    <div id="buttons"></div>\n    <slot></slot>\n    <paper-dialog id="hdetails">\n      <div id="title"></div>\n      <div id="desc"></div>\n    </paper-dialog>\n    <iron-ajax auto="" id="get_svg" url="[[src]]" handle-as="text" on-response="_getSVGHandler"></iron-ajax>\n']);return s=function(){return e},e}i.Polymer({_template:i.html(l()),is:"lrndesign-imagemap-hotspot",properties:{label:{type:String,value:null},hotspotId:{type:String,value:null}},setParentHeading:function(e){this.$.heading._setParent(e)}}),i.Polymer({_template:i.html(s()),is:"lrndesign-imagemap",properties:{label:{type:String,value:null},src:{type:String,value:null},hotspotDetails:{type:Array,value:[]},subtopicOf:{type:String,value:null,reflectToAttribute:!0},tag:{type:String,value:null,reflectToAttribute:!0}},ready:function(){var e=this;this.$.hdetails.addEventListener("blur",function(){e.closeHotspot()}),this.$.hdetails.addEventListener("mouseout",function(){e.closeHotspot()}),this.$.hdetails.addEventListener("keyup",function(t){13!==t.keyCode&&32!==t.keyCode||e.closeHotspot()})},_getSVGHandler:function(t){var n=this,i=document.createElement("div"),o=function(e,t){return null===e.getAttribute("id")&&e.setAttribute("id",t),e.getAttribute("id")},l=function(e,t,i){var l=function(l){var s="title"===l?"label":l,a=(e=null!==e?e:n).querySelector("#"+s),r=t.querySelector(l);return null===r&&(r=document.createElement(l),t.prepend(r)),null!==e.getAttribute(s)?r.innerHTML=e.getAttribute(s):null!==a&&""!==a.innerHTML&&(r.innerHTML=a.innerHTML),o(r,i+"-"+s)};t.setAttribute("aria-labelledby",l("desc")+" "+l("label"))};i.innerHTML=t.detail.response;var s=i.querySelector("svg"),a=o(s,"svg-"+Date.now()),r=e.dom(n).querySelectorAll("lrndesign-imagemap-hotspot");l(n,s,a),this.$.svg.appendChild(s);for(var d=function(e){var t=r[e].getAttribute("hotspot-id"),i=s.querySelector("#"+t),o=s.cloneNode(!0);l(r[e],o,t),r[e].appendChild(o),r[e].querySelector("#"+t).classList.add("selected"),r[e].setParentHeading(n.$.heading);for(var a=0;a<r.length;a++)r[e].querySelector("#"+r[a].getAttribute("hotspot-id")).classList.add("hotspot");var d=document.createElement("button");d.setAttribute("aria-controls","hdetails"),d.setAttribute("tabindex",0),d.setAttribute("aria-label",r[e].label),n.$.buttons.appendChild(d),d.addEventListener("focus",function(){console.log("focus",e,i),i.classList.add("focus")}),d.addEventListener("blur",function(){i.classList.remove("focus")}),i.classList.add("hotspot"),i.addEventListener("click",function(t){n.openHotspot(i,r[e])}),d.addEventListener("keyup",function(t){13!==t.keyCode&&32!==t.keyCode||i.classList.contains("selected")||n.openHotspot(i,r[e])})},p=0;p<r.length;p++)d(p)},openHotspot:function(t,n){e.dom(this).querySelector('lrndesign-imagemap-hotspot[hotspot-id="'+t.getAttribute("id")+'"]');this.$.hdetails.querySelector("#title").innerHTML=n.getAttribute("label"),this.$.desc.appendChild(document.createTextNode(n.querySelector("#desc").innerHTML)),this.$.hdetails.positionTarget=t,this.__activeHotspot=t,this.$.hdetails.open(),this.resetHotspots(),t.classList.add("selected")},closeHotspot:function(){this.$.hdetails.querySelector("#title").innerHTML="",this.$.hdetails.querySelector("#desc").innerHTML="",this.resetHotspots(),this.$.hdetails.close(),this.__activeHotspot.focus()},resetHotspots:function(){for(var e=this.querySelectorAll('.hotspot[role="button"]'),t=0;t<e.length;t++)e[t].classList.remove("selected")}})});
//# sourceMappingURL=lrndesign-imagemap.umd.js.map
