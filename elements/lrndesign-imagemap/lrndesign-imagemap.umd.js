!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("@polymer/polymer/polymer-legacy.js"),require("@polymer/iron-a11y-keys/iron-a11y-keys.js"),require("@lrnwebcomponents/relative-heading/relative-heading.js"),require("@polymer/polymer/lib/legacy/polymer.dom.js"),require("@polymer/iron-ajax/iron-ajax.js"),require("@polymer/paper-dialog/paper-dialog.js")):"function"==typeof define&&define.amd?define(["@polymer/polymer/polymer-legacy.js","@polymer/iron-a11y-keys/iron-a11y-keys.js","@lrnwebcomponents/relative-heading/relative-heading.js","@polymer/polymer/lib/legacy/polymer.dom.js","@polymer/iron-ajax/iron-ajax.js","@polymer/paper-dialog/paper-dialog.js"],t):t(e.polymerLegacy_js,null,null,e.polymer_dom_js)}(this,function(e,t,n,i){"use strict";function o(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function l(){var e=o(['\n    <style>\n      :host {\n        display: none;\n      }\n      :host #desc {\n        margin: 0 0 15px;\n      }\n      @media print {\n        :host {\n          display: block;\n        }\n      }\n    </style>\n    <relative-heading hidden$="[[!label]]" id="heading" text$="[[label]]">\n    </relative-heading>\n    <div id="desc"><slot></slot></div>\n'],['\n    <style>\n      :host {\n        display: none;\n      }\n      :host #desc {\n        margin: 0 0 15px;\n      }\n      @media print {\n        :host {\n          display: block;\n        }\n      }\n    </style>\n    <relative-heading hidden\\$="[[!label]]" id="heading" text\\$="[[label]]">\n    </relative-heading>\n    <div id="desc"><slot></slot></div>\n']);return l=function(){return e},e}function s(){var e=o(['\n    <style>\n      :host {\n        display: block;\n      }\n      :host #buttons {\n        position: absolute;\n        left: -999999px;\n        top: 0;\n        overflow: hidden;\n        opacity: 0;\n      }\n      :host paper-dialog {\n        border: 1px solid #000;\n        border-radius: 0.25em;\n      }\n      :host paper-dialog > #title, \n      :host paper-dialog > #desc {\n        padding: 15px;\n        margin: 0;\n      }\n      :host paper-dialog > #title {\n        position: absolute;\n        left: -9999px;\n        overflow: hidden;\n        height: 0;\n        width: 0;\n      }\n      :host paper-dialog > #title > * {\n        margin: 0;\n      }\n      /*::slotted([hotspot]) {\n        display: none;\n      }*/\n      @media print {\n        :host > #svg {\n          display: none;\n        }\n        /*::slotted(#screen-only) {\n          display: none;\n        }\n        ::slotted([hotspot]) {\n          display: block;\n        }*/\n      }\n    </style>\n    <relative-heading hidden$="[[!label]]" id="heading" subtopic-of$="[[subtopicOf]]" tag$="[[tag]]" text$="[[label]]">\n    </relative-heading>\n    <div id="desc"><slot name="desc"></slot></div>\n    <div id="svg"></div>\n    <div id="buttons"></div>\n    <slot></slot>\n    <paper-dialog id="hdetails">\n      <div id="title"></div>\n      <div id="desc"></div>\n    </paper-dialog>\n    <iron-ajax auto="" id="get_svg" url="[[src]]" handle-as="text" on-response="_getSVGHandler"></iron-ajax>\n'],['\n    <style>\n      :host {\n        display: block;\n      }\n      :host #buttons {\n        position: absolute;\n        left: -999999px;\n        top: 0;\n        overflow: hidden;\n        opacity: 0;\n      }\n      :host paper-dialog {\n        border: 1px solid #000;\n        border-radius: 0.25em;\n      }\n      :host paper-dialog > #title, \n      :host paper-dialog > #desc {\n        padding: 15px;\n        margin: 0;\n      }\n      :host paper-dialog > #title {\n        position: absolute;\n        left: -9999px;\n        overflow: hidden;\n        height: 0;\n        width: 0;\n      }\n      :host paper-dialog > #title > * {\n        margin: 0;\n      }\n      /*::slotted([hotspot]) {\n        display: none;\n      }*/\n      @media print {\n        :host > #svg {\n          display: none;\n        }\n        /*::slotted(#screen-only) {\n          display: none;\n        }\n        ::slotted([hotspot]) {\n          display: block;\n        }*/\n      }\n    </style>\n    <relative-heading hidden\\$="[[!label]]" id="heading" subtopic-of\\$="[[subtopicOf]]" tag\\$="[[tag]]" text\\$="[[label]]">\n    </relative-heading>\n    <div id="desc"><slot name="desc"></slot></div>\n    <div id="svg"></div>\n    <div id="buttons"></div>\n    <slot></slot>\n    <paper-dialog id="hdetails">\n      <div id="title"></div>\n      <div id="desc"></div>\n    </paper-dialog>\n    <iron-ajax auto="" id="get_svg" url="[[src]]" handle-as="text" on-response="_getSVGHandler"></iron-ajax>\n']);return s=function(){return e},e}e.Polymer({_template:e.html(l()),is:"lrndesign-imagemap-hotspot",properties:{label:{type:String,value:null},hotspotId:{type:String,value:null}},setParentHeading:function(e){this.$.heading._setParent(e)}}),e.Polymer({_template:e.html(s()),is:"lrndesign-imagemap",properties:{label:{type:String,value:null},src:{type:String,value:null},hotspotDetails:{type:Array,value:[]},subtopicOf:{type:String,value:null,reflectToAttribute:!0},tag:{type:String,value:null,reflectToAttribute:!0}},ready:function(){var e=this;this.$.hdetails.addEventListener("blur",function(){e.closeHotspot()}),this.$.hdetails.addEventListener("mouseout",function(){e.closeHotspot()}),this.$.hdetails.addEventListener("keyup",function(t){13!==t.keyCode&&32!==t.keyCode||e.closeHotspot()})},_getSVGHandler:function(e){var t=this,n=document.createElement("div"),o=function(e,t){return null===e.getAttribute("id")&&e.setAttribute("id",t),e.getAttribute("id")},l=function(e,n,i){var l=function(l){var s="title"===l?"label":l,r=(e=null!==e?e:t).querySelector("#"+s),a=n.querySelector(l);return null===a&&(a=document.createElement(l),n.prepend(a)),null!==e.getAttribute(s)?a.innerHTML=e.getAttribute(s):null!==r&&""!==r.innerHTML&&(a.innerHTML=r.innerHTML),o(a,i+"-"+s)};n.setAttribute("aria-labelledby",l("desc")+" "+l("label"))};n.innerHTML=e.detail.response;var s=n.querySelector("svg"),r=o(s,"svg-"+Date.now()),a=i.dom(t).querySelectorAll("lrndesign-imagemap-hotspot");l(t,s,r),this.$.svg.appendChild(s);for(var d=function(e){var n=a[e].getAttribute("hotspot-id"),i=s.querySelector("#"+n),o=s.cloneNode(!0);l(a[e],o,n),a[e].appendChild(o),a[e].querySelector("#"+n).classList.add("selected"),a[e].setParentHeading(t.$.heading);for(var r=0;r<a.length;r++)a[e].querySelector("#"+a[r].getAttribute("hotspot-id")).classList.add("hotspot");var d=document.createElement("button");d.setAttribute("aria-controls","hdetails"),d.setAttribute("tabindex",0),d.setAttribute("aria-label",a[e].label),t.$.buttons.appendChild(d),d.addEventListener("focus",function(){console.log("focus",e,i),i.classList.add("focus")}),d.addEventListener("blur",function(){i.classList.remove("focus")}),i.classList.add("hotspot"),i.addEventListener("click",function(n){t.openHotspot(i,a[e])}),d.addEventListener("keyup",function(n){13!==n.keyCode&&32!==n.keyCode||i.classList.contains("selected")||t.openHotspot(i,a[e])})},p=0;p<a.length;p++)d(p)},openHotspot:function(e,t){i.dom(this).querySelector('lrndesign-imagemap-hotspot[hotspot-id="'+e.getAttribute("id")+'"]');this.$.hdetails.querySelector("#title").innerHTML=t.getAttribute("label"),this.$.hdetails.querySelector("#desc").innerHTML=t.querySelector("#desc").innerHTML,this.$.hdetails.positionTarget=e,this.__activeHotspot=e,this.$.hdetails.open(),this.resetHotspots(),e.classList.add("selected")},closeHotspot:function(){this.$.hdetails.querySelector("#title").innerHTML="",this.$.hdetails.querySelector("#desc").innerHTML="",this.resetHotspots(),this.$.hdetails.close(),this.__activeHotspot.focus()},resetHotspots:function(){for(var e=this.querySelectorAll('.hotspot[role="button"]'),t=0;t<e.length;t++)e[t].classList.remove("selected")}})});
//# sourceMappingURL=lrndesign-imagemap.umd.js.map
