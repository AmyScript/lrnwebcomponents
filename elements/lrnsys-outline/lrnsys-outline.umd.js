!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@polymer/paper-dialog/paper-dialog.js"),require("@polymer/polymer/polymer-legacy.js"),require("@polymer/iron-list/iron-list.js"),require("@polymer/iron-a11y-keys/iron-a11y-keys.js"),require("@polymer/paper-input/paper-input.js"),require("@polymer/iron-icons/iron-icons.js"),require("@polymer/paper-icon-button/paper-icon-button.js"),require("@lrnwebcomponents/drawing-icons/drawing-icons.js")):"function"==typeof define&&define.amd?define(["exports","@polymer/paper-dialog/paper-dialog.js","@polymer/polymer/polymer-legacy.js","@polymer/iron-list/iron-list.js","@polymer/iron-a11y-keys/iron-a11y-keys.js","@polymer/paper-input/paper-input.js","@polymer/iron-icons/iron-icons.js","@polymer/paper-icon-button/paper-icon-button.js","@lrnwebcomponents/drawing-icons/drawing-icons.js"],e):e(t.LrnsysOutline={},null,t.polymerLegacy_js)}(this,function(t,e,n){"use strict";function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function s(){var t=o(['\n    <style>\n      :host {\n        display: block;\n        --indent-multiplier: 20px;\n      }\n      :host [data-indent="0"] #move {\n        margin-right: calc(var(--indent-multiplier) * 0);\n      }\n      :host [data-indent="1"] #move {\n        margin-right: calc(var(--indent-multiplier) * 1);\n      }\n      :host [data-indent="2"] #move {\n        margin-right: calc(var(--indent-multiplier) * 2);\n      }\n      :host [data-indent="3"] #move {\n        margin-right: calc(var(--indent-multiplier) * 3);\n      }\n      :host [data-indent="4"] #move {\n        margin-right: calc(var(--indent-multiplier) * 4);\n      }\n      :host [data-indent="5"] #move {\n        margin-right: calc(var(--indent-multiplier) * 5);\n      }\n      :host [data-indent="6"] #move {\n        margin-right: calc(var(--indent-multiplier) * 6);\n      }\n      :host #input {\n        flex-grow: 1;\n        margin-right: 10px;\n      }\n      :host #wrapper {\n        display: flex;\n        height: 40px;\n        border-radius: 0.16px;\n        background-color: white;\n      }\n      :host(:focus) #wrapper,\n      :host(:hover) #wrapper {\n        cursor: pointer;\n      }\n      #move {\n        font-size: 16px;\n        padding: 10px;\n        color: transparent;\n      }\n      :host(:focus) #move,\n      :host(:hover) #move {\n        color: var(--lrnsys-outline-move-icon-color, #aaaaaa);\n      }\n      paper-icon-button {\n        font-size: 16px;\n        height: 36px;\n        padding: 10px;\n        margin: 4px;\n        display: none;\n        border-radius: 0.16px;\n      }\n      :host(:focus) paper-icon-button,\n      :host(:hover) paper-icon-button {\n        width: 36px;\n        display: inline-flex;\n      }\n      paper-icon-button#add {\n        width: 36px;\n        margin-right: 2px;\n        color: white;\n        background-color: var(--lrnsys-outline-add-button-color, #018dff);\n      }\n      paper-icon-button#delete {\n        color: white;\n        background-color: var(--lrnsys-outline-delete-button-color, #cc0000);\n      }\n    </style>\n    <div id="wrapper" data-indent$="[[indentLevel]]">\n      <iron-icon\n        id="move"\n        title="Move"\n        icon="drawing:move"\n        role="presentation"\n      ></iron-icon>\n      <paper-input\n        id="input"\n        label="Enter a page title"\n        value="{{title}}"\n        no-label-float=""\n      >\n      </paper-input>\n      <paper-icon-button\n        id="add"\n        title="Add Item"\n        icon="icons:add"\n        on-tap="add"\n      ></paper-icon-button>\n      <paper-icon-button\n        id="delete"\n        title="Delete"\n        icon="icons:delete"\n        on-tap="delete"\n      ></paper-icon-button>\n    </div>\n    <paper-icon-button\n      id="down"\n      title="Move downwards"\n      icon="icons:arrow-downward"\n      on-tap="moveDown"\n    ></paper-icon-button>\n    <paper-icon-button\n      id="left"\n      title="Outdent"\n      icon="icons:arrow-back"\n      on-tap="moveOut"\n    ></paper-icon-button>\n    <paper-icon-button\n      id="right"\n      title="Indent"\n      icon="icons:arrow-forward"\n      on-tap="moveIn"\n    ></paper-icon-button>\n    <paper-icon-button\n      id="up"\n      title="Move upwards"\n      icon="icons:arrow-upward"\n      on-tap="moveUp"\n    ></paper-icon-button>\n    <iron-a11y-keys\n      id="a11y"\n      target="[[__inputTarget]]"\n      keys="enter"\n      on-keys-pressed="_onEnter"\n    ></iron-a11y-keys>\n    <iron-a11y-keys\n      id="a11y"\n      target="[[__inputTarget]]"\n      keys="backspace"\n      on-keys-pressed="_onBackspace"\n    ></iron-a11y-keys>\n    <iron-a11y-keys\n      id="a11y"\n      target="[[__inputTarget]]"\n      keys="up"\n      on-keys-pressed="_onArrowUp"\n    ></iron-a11y-keys>\n    <iron-a11y-keys\n      id="a11y"\n      target="[[__inputTarget]]"\n      keys="down"\n      on-keys-pressed="_onArrowDown"\n    ></iron-a11y-keys>\n    <iron-a11y-keys\n      id="a11y"\n      target="[[__inputTarget]]"\n      keys="tab"\n      on-keys-pressed="_onTab"\n    ></iron-a11y-keys>\n    <iron-a11y-keys\n      id="a11y"\n      target="[[__inputTarget]]"\n      keys="shift+tab"\n      on-keys-pressed="_onShiftTab"\n    ></iron-a11y-keys>\n    <iron-a11y-keys\n      id="a11y"\n      target="[[__inputTarget]]"\n      keys="shift+up"\n      on-keys-pressed="_onShiftArrowUp"\n    ></iron-a11y-keys>\n    <iron-a11y-keys\n      id="a11y"\n      target="[[__inputTarget]]"\n      keys="shift+down"\n      on-keys-pressed="_onShiftArrowDown"\n    ></iron-a11y-keys>\n  ']);return s=function(){return t},t}var r,a;function l(){var t=o(['\n    <style>\n      :host {\n        display: block;\n      }\n      :host kbd {\n        display: inline-block;\n        background: #333;\n        color: white;\n        border-radius: 4px;\n        margin: 4px 4px 4px 0;\n        padding: 8px;\n        font-family: Verdana, Geneva, Tahoma, sans-serif;\n        font-size: 85%;\n      }\n    </style>\n    <h1>\n      [[title]]<paper-icon-button\n        title="Keyboard directions"\n        id="dialogtrigger"\n        icon="icons:help"\n        on-tap="openDirections"\n      ></paper-icon-button>\n    </h1>\n    <paper-dialog id="modal" with-backdrop="">\n      <h2>Keyboard shortcuts</h2>\n      <div>\n        <paper-icon-button\n          title="close directions"\n          style="position: absolute;top: 0; right:0;"\n          icon="icons:cancel"\n          on-tap="closeDirections"\n        ></paper-icon-button>\n        <ul>\n          <li><kbd>Enter</kbd> to <strong>add</strong> an item</li>\n          <li>\n            <kbd>Backspace</kbd> <em>with entire item selected</em> to\n            <strong>delete</strong> an item.\n          </li>\n          <li>\n            <kbd>↑</kbd> / <kbd>↓</kbd> / <kbd>←</kbd> / <kbd>→</kbd> to\n            <strong>navigate</strong> through items\n          </li>\n          <li>\n            <kbd>Tab</kbd> / <kbd>Shift+Tab</kbd>\n            <em>at the beginning of a line</em> to\n            <strong>indent/outdent</strong>\n          </li>\n          <li><kbd>Shift+↑</kbd> / <kbd>Shift+↓</kbd> to items up/down</li>\n        </ul>\n      </div>\n    </paper-dialog>\n    <div id="itemslist">\n      <template is="dom-repeat" items="{{items}}" as="item">\n        <lrnsys-outline-item\n          disable-down="[[item.disableDown]]"\n          disable-left="[[item.disableLeft]]"\n          disable-right="[[item.disableRight]]"\n          disable-up="[[item.disableUp]]"\n          id$="[[item.id]]"\n          index$="[[item.index]]"\n          indent-level="{{item.indent}}"\n          parent="{{item.parent}}"\n          title="{{item.title}}"\n        >\n        </lrnsys-outline-item>\n      </template>\n    </div>\n  ']);return l=function(){return t},t}n.Polymer({_template:n.html(s()),is:"lrnsys-outline-item",listeners:{change:"_onChange"},properties:{indentLevel:{type:Number,value:0},index:{type:Number,value:0},parent:{type:String,value:null},value:{type:String,value:null,notify:!0,reflectToAttribute:!0}},attached:function(){this.fire("attached-item",{item:this})},ready:function(){var t=this;this.__inputTarget=this.$.input,this.fire("focus-item",this),this.addEventListener("focus",function(e){t.fire("focus-item",t)}),this.addEventListener("mouseover",function(e){t.fire("focus-item",t)}),this.addEventListener("blur",function(e){t.fire("blur-item",t)}),this.addEventListener("mouseout",function(e){t.fire("blur-item",t)})},detached:function(){var t=this;this.removeEventListener("focus",function(e){t.fire("focus-item",t)}),this.removeEventListener("mouseover",function(e){t.fire("focus-item",t)}),this.removeEventListener("blur",function(e){t.fire("blur-item",t)}),this.removeEventListener("mouseout",function(e){t.fire("blur-item",t)})},focus:function(){return this.$.input.focus(),this},value:function(){return this.title=this.$.input.value,this.title},delete:function(){this.fire("delete-item",{item:this})},setIndent:function(t){this.fire("indent-item",{item:this,increase:t>0})},add:function(){var t=this.$.input.selectionStart,e=this.$.input.value;this.fire("add-item",{item:this,value:e.slice(0,t),new:e.slice(t,e.length)})},move:function(t){this.fire("move-item",{item:this,moveUp:t<0})},moveUp:function(t){this.move(-1)},moveDown:function(t){this.move(1)},moveOut:function(t){this.setIndent(-1)},moveIn:function(t){this.setIndent(1)},setSelection:function(t,e){var n=void 0!==t?t:0,i=void 0!==e?e:n;try{this.$.input.querySelector("input").setSelectionRange(n,i)}catch(t){console.log(t)}this.focus()},_onChange:function(){this.fire("change-item",{item:this,value:this.$.input.value})},_onEnter:function(){var t=this.$.input.selectionStart,e=this.$.input.value;this.fire("add-item",{item:this,value:e.slice(0,t),new:e.slice(t,e.length)})},_onBackspace:function(t){window.getSelection().toString()==this.$.input.value?(t.detail.keyboardEvent.preventDefault(),this.fire("delete-item",{item:this})):0==this.$.input.selectionStart&&this.fire("indent-item",{item:this,increase:!1})},_onArrowUp:function(){0==this.$.input.selectionStart&&this.fire("focus-item",{item:this,moveUp:!0})},_onArrowDown:function(){this.$.input.selectionStart==this.$.input.value.length&&this.fire("focus-item",{item:this,moveUp:!1})},_onShiftTab:function(){this.setIndent(-1)},_onTab:function(t){0==this.$.input.selectionStart&&(t.preventDefault(),this.setIndent(1))},_onShiftArrowUp:function(){this.move(-1)},_onShiftArrowDown:function(){this.move(1)}});var d=n.Polymer((a={_template:n.html(l()),is:"lrnsys-outline",listeners:(r={"delete-item":"_handleRemoveItem","indent-item":"_handleIndentItem","focus-item":"_handleFocusItem","add-item":"_handleAddItem","move-item":"_handleMoveItem","change-item":"_handleChangeItem"},i(r,"focus-item","_handleFocusItem"),i(r,"blur-item","_handleBlurItem"),r),properties:{title:{type:String,value:"Content Outline"},data:{type:Array,value:null},items:{type:Array,value:null,notify:!0}},openDirections:function(t){this.$.modal.opened=!0},closeDirections:function(t){this.$.modal.opened=!1,this.$.dialogtrigger.focus()},attached:function(){this.__modal=this.$.modal,document.body.addEventListener("iron-overlay-canceled",this._accessibleFocus.bind(this)),document.body.appendChild(this.$.modal)},_accessibleFocus:function(t){t.detail===this.__modal&&this.$.dialogtrigger.focus()},ready:function(){(null===this.data||this.data.length<1)&&(this.__tempid=void 0===this.__tempid?0:this.__tempid+1,this.data=[{id:"outline-item-"+this.__tempid,title:"",order:0,parent:null}]),this.setData(this.data)},setData:function(t){if(this.items=[],this.items=t,void 0!==t&&t.length>0){var e=-1;for(var n in t){var i=parseInt(this._getIndent(t,n));this.__tempid=void 0===this.__tempid?0:this.__tempid+1,t[n].index=parseInt(n),t[n].indent=i,t[n].prevSibling=this._getSibling(parseInt(n),i,!0),t[n].nextSibling=this._getSibling(parseInt(n),i,!1),t[n].disableUp=null===t[n].prevSibling,t[n].disableDown=null===t[n].nextSibling,t[n].disableLeft=0===i,t[n].disableRight=i>e,t[n].id=void 0===t[n].id?"outline-item-"+this.__tempid:t[n].id,e=i}}this.items=[],this.items=t},getData:function(){for(var t in this.items)this.items[t].order=this._getOrder(this.items[t]);return this.items},addItem:function(t){var e=this.items,n=t.index;this.__tempid=this.__tempid+1,e.splice(n+1,0,{id:"outline-item-"+this.__tempid,title:"",indent:t.indent,parent:t.parent}),this._refreshData(),this.__focusedItem=t.nextElementSibling,void 0!==this.__focusedItem&&null!==this.__focusedItem&&this.__focusedItem.focus()},removeItem:function(t){var e=t.index;if(confirm("Do you really want to delete "+this.items[e].title+"?")){for(var n in this.__focusedItem=t.previousElementSibling,this.items)this.items[n].parent==this.items[e].id&&(this.items[n].parent=this.items[e].parent);this.items.splice(e,1),this._refreshData(),void 0!==this.__focusedItem&&null!==this.__focusedItem&&this.__focusedItem.focus()}},moveItem:function(t,e){var n=t.index,i=this._getLastChild(t),o=i-n+1,s=e?this.items[n].prevSibling:this._getLastChild(this.items[i+1])-o+1,r=this.items;s>-1&&s<this.items.length&&(e&&!t.disableUp||!e&&!t.disableDown)&&(r.splice(s,0,r.splice(n,o)),this.setData(r),this.__focusedItem=this.$.itemslist.querySelectorAll("lrnsys-outline-item")[s],void 0!==this.__focusedItem&&null!==this.__focusedItem&&this.__focusedItem.focus())},_refreshData:function(){var t=this.items;this.items=[],this.items=t,void 0!==this.__focusedItem&&null!==this.__focusedItem&&this.__focusedItem.focus()},_adjustIndent:function(t,e){if(e>0&&!t.disableRight||e<0&&!t.disableLeft){var n=parseInt(t.index),i=t.indent,o=t.indent+e,s=n+1,r=null!==t.prevSibling?t.prevSibling.id:null,a=this._getItemById(t.parent)&&this._getItemById(t.parent).parent?this._getItemById(t.parent).parent.id:null;for(t.indent=o,t.parent=e>0?r:a,t.prevSibling=this._getSibling(n,o,!0),t.nextSibling=this._getSibling(n,o,!1),t.disableUp=null===t.prevSibling,t.disableDown=null===t.nextSibling,t.disableLeft=0===o,t.disableRight=null===this.items[n-1]||o>this.items[n-1].indent;null!==this.items[s]&&void 0!==this.items[s]&&i<this.items[s].indent;)this.items[s].indent=this.items[s].indent+e,s++,next=this.items[s];this._refreshData()}},_getLastChild:function(t){var e=null!=t?this._getSibling(t.index,t.indent,!1):null;return null!=e?e-1:null!==t.parent&&null!==t.parent&&null!==this._getItemById(t.parent)?this._getLastChild(this._getItemById(t.parent)):this.items.length-1},_getIndent:function(t,e){if(void 0!==t[e].parent){var n=t.findIndex(function(n){return n.id===t[e].parent});if(void 0!==t[n]&&void 0!==t[n].indent)return t[n].indent+1}return 0},_getOrder:function(t){var e=0,n=0;for(var i in this.items)this.items[i].parent==t.parent&&this.items[i].id==t.id?n=e:this.items[i].parent==t.parent&&e++;return n},_getSibling:function(t,e,n){for(var i=n?-1:1,o=t+i,s=null;o<this.items.length&&o>-1;)null===s&&this.items[o].parent===this.items[t].parent&&(s=o),o+=i;return s},_getItemById:function(t,e){var n=this.items.findIndex(function(e){return e.id===t});return e=void 0===e?0:e,void 0!==this.items[n+e]?this.items[n+e]:null},_handleAddItem:function(t){this.addItem(t.detail.item)},_handleRemoveItem:function(t){this.removeItem(t.detail.item)},_handleMoveItem:function(t){this.moveItem(t.detail.item,t.detail.moveUp,t.detail.byGroup)},_handleFocusItem:function(t){(t.detail.moveUp?t.detail.item.previousElementSibling:t.detail.item.nextElementSibling).setSelection()},_handleIndentItem:function(t){var e=t.detail.increase?1:-1;this._adjustIndent(this._getItemById(t.detail.item.id),e)},_handleChangeItem:function(t){null!=this._getItemById(t.detail.item.id)&&(this._getItemById(t.detail.item.id).title=t.detail.value),this._refreshData()}},i(a,"_handleFocusItem",function(t){this.__focusedItem=t.srcElement}),i(a,"_handleBlurItem",function(t){}),a));t.LrnsysOutline=d,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=lrnsys-outline.umd.js.map
